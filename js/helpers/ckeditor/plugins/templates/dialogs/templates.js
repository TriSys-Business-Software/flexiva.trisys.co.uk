(function(){CKEDITOR['dialog']['add']('templates',function(c){function o(a,b){var k=CKEDITOR['dom']['element']['createFromHtml']('<a\x20href=\x22javascript:void(0)\x22\x20tabIndex=\x22-1\x22\x20role=\x22option\x22\x20><div\x20class=\x22cke_tpl_item\x22></div></a>'),d='<table\x20style=\x22width:350px;\x22\x20class=\x22cke_tpl_preview\x22\x20role=\x22presentation\x22><tr>';return a['image']&&b&&(d+='<td\x20class=\x22cke_tpl_preview_img\x22><img\x20src=\x22'+CKEDITOR['getUrl'](b+a['image'])+'\x22'+(CKEDITOR['env']['ie6Compat']?'\x20onload=\x22this.width=this.width\x22':'')+'\x20alt=\x22\x22\x20title=\x22\x22></td>'),d+='<td\x20style=\x22white-space:normal;\x22><span\x20class=\x22cke_tpl_title\x22>'+a['title']+'</span><br/>',a['description']&&(d+='<span>'+a['description']+'</span>'),k['getFirst']()['setHtml'](d+'</td></tr></table>'),k['on']('click',function(){p(a['html']);}),k;}function p(a){var b=CKEDITOR['dialog']['getCurrent']();b['getValueOf']('selectTpl','chkInsertOpt')?(c['fire']('saveSnapshot'),c['setData'](a,function(){b['hide']();var a=c['createRange']();a['moveToElementEditStart'](c['editable']()),a['select'](),setTimeout(function(){c['fire']('saveSnapshot');},0x0);})):(c['insertHtml'](a),b['hide']());}function i(a){var b=a['data']['getTarget'](),c=g['equals'](b);if(c||g['contains'](b)){var d=a['data']['getKeystroke'](),f=g['getElementsByTag']('a'),e;if(f){if(c)e=f['getItem'](0x0);else switch(d){case 0x28:e=b['getNext']();break;case 0x26:e=b['getPrevious']();break;case 0xd:case 0x20:b['fire']('click');}e&&(e['focus'](),a['data']['preventDefault']());}}}var h=CKEDITOR['plugins']['get']('templates');CKEDITOR['document']['appendStyleSheet'](CKEDITOR['getUrl'](h['path']+'dialogs/templates.css'));var g,h='cke_tpl_list_label_'+CKEDITOR['tools']['getNextNumber'](),f=c['lang']['templates'],l=c['config'];return{'title':c['lang']['templates']['title'],'minWidth':CKEDITOR['env']['ie']?0x1b8:0x190,'minHeight':0x154,'contents':[{'id':'selectTpl','label':f['title'],'elements':[{'type':'vbox','padding':0x5,'children':[{'id':'selectTplText','type':'html','html':'<span>'+f['selectPromptMsg']+'</span>'},{'id':'templatesList','type':'html','focus':!0x0,'html':'<div\x20class=\x22cke_tpl_list\x22\x20tabIndex=\x22-1\x22\x20role=\x22listbox\x22\x20aria-labelledby=\x22'+h+'\x22><div\x20class=\x22cke_tpl_loading\x22><span></span></div></div><span\x20class=\x22cke_voice_label\x22\x20id=\x22'+h+'\x22>'+f['options']+'</span>'},{'id':'chkInsertOpt','type':'checkbox','label':f['insertOption'],'default':l['templates_replaceContent']}]}]}],'buttons':[CKEDITOR['dialog']['cancelButton']],'onShow':function(){var a=this['getContentElement']('selectTpl','templatesList');g=a['getElement'](),CKEDITOR['loadTemplates'](l['templates_files'],function(){var b=(l['templates']||'default')['split'](',');if(b['length']){var c=g;c['setHtml']('');for(var d=0x0,h=b['length'];d<h;d++)for(var e=CKEDITOR['getTemplates'](b[d]),i=e['imagesPath'],e=e['templates'],n=e['length'],j=0x0;j<n;j++){var m=o(e[j],i);m['setAttribute']('aria-posinset',j+0x1),m['setAttribute']('aria-setsize',n),c['append'](m);}a['focus']();}else g['setHtml']('<div\x20class=\x22cke_tpl_empty\x22><span>'+f['emptyListMsg']+'</span></div>');}),this['_']['element']['on']('keydown',i);},'onHide':function(){this['_']['element']['removeListener']('keydown',i);}};});}());