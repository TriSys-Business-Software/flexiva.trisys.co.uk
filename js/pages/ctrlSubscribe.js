var ctrlSubscribe={'Load':function(){TriSysSDK['Titles']['LoadCombo']('txtSubscribeTitle'),TriSysWebJobs['CandidateRegistration']['LoadCountryLookup']('txtSubscribeCountry'),ctrlSubscribe['LoadTriSysCRMContactDetails']();},'LoadTriSysCRMContactDetails':function(){var payloadObject={};payloadObject['URL']='Customer/ReadTrialContactDetails',payloadObject['InboundDataFunction']=function(CReadTrialContactDetailsResponse){TriSysApex['UI']['HideWait']();if(CReadTrialContactDetailsResponse){if(CReadTrialContactDetailsResponse['Success']){var contact=CReadTrialContactDetailsResponse['Contact'];TriSysSDK['CShowForm']['SetTextInCombo']('txtSubscribeTitle',contact['Title']),$('#txtSubscribeForenames')['val'](contact['Forenames']),$('#txtSubscribeSurname')['val'](contact['Surname']),$('#txtSubscribeEMail')['val'](contact['WorkEMail']),$('#txtSubscribeCompany')['val'](contact['CompanyName']),$('#txtSubscribeJobTitle')['val'](contact['JobTitle']),$('#txtSubscribeStreet')['val'](contact['CompanyAddressStreet']),$('#txtSubscribeCity')['val'](contact['CompanyAddressCity']),$('#txtSubscribeCounty')['val'](contact['CompanyAddressCounty']),$('#txtSubscribePostCode')['val'](contact['CompanyAddressPostCode']),$('#txtSubscribeCountry')['val'](contact['CompanyAddressCountry']),$('#txtSubscribeWorkTelNo')['val'](contact['WorkTelNo']),$('#txtSubscribeWorkMobileTelNo')['val'](contact['WorkMobileTelNo']);}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlSubscribe.LoadTriSysCRMContactDetails:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Contact\x20Details...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowTermsAndConditions':function(){TriSysApex['ModalDialogue']['TermsAndConditions']['Show']();},'PostCodelookup':function(){var sPrefix='txtSubscribe';TriSysSDK['PostCode']['Lookup'](sPrefix+'PostCode',sPrefix+'Street',sPrefix+'City',sPrefix+'County',sPrefix+'Country');},'SubscribeNow':function(){var contact={};contact['Title']=TriSysSDK['CShowForm']['GetTextFromCombo']('txtSubscribeTitle'),contact['Forenames']=$('#txtSubscribeForenames')['val'](),contact['Surname']=$('#txtSubscribeSurname')['val'](),contact['WorkEMail']=$('#txtSubscribeEMail')['val'](),contact['CompanyName']=$('#txtSubscribeCompany')['val'](),contact['JobTitle']=$('#txtSubscribeJobTitle')['val'](),contact['CompanyAddressStreet']=$('#txtSubscribeStreet')['val'](),contact['CompanyAddressCity']=$('#txtSubscribeCity')['val'](),contact['CompanyAddressCounty']=$('#txtSubscribeCounty')['val'](),contact['CompanyAddressPostCode']=$('#txtSubscribePostCode')['val'](),contact['CompanyAddressCountry']=$('#txtSubscribeCountry')['val'](),contact['WorkTelNo']=$('#txtSubscribeWorkTelNo')['val'](),contact['WorkMobileTelNo']=$('#txtSubscribeWorkMobileTelNo')['val']();var bAgree=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkSubscribeAgreeToTerms');if(contact['CompanyName'])contact['CompanyName']=contact['CompanyName']['replace'](/,/g,'');var sError='';if(!contact['Forenames']||!contact['Surname'])sError+='Please\x20enter\x20your\x20full\x20name.'+'<br\x20/>';if(!contact['JobTitle'])sError+='Please\x20enter\x20your\x20job\x20title.'+'<br\x20/>';if(!TriSysApex['LoginCredentials']['validateEmail'](contact['WorkEMail']))sError+='Please\x20enter\x20your\x20valid\x20e-mail\x20address.'+'<br\x20/>';if(!contact['WorkTelNo'])sError+='Please\x20enter\x20your\x20work\x20telephone\x20number.'+'<br\x20/>';if(!contact['CompanyName'])sError+='Please\x20enter\x20your\x20company\x20name.'+'<br\x20/>';if(!contact['CompanyAddressStreet']||!contact['CompanyAddressCity']||!contact['CompanyAddressPostCode'])sError+='Please\x20enter\x20your\x20company\x20address.'+'<br\x20/>';if(!bAgree)sError+='Please\x20agree\x20to\x20our\x20terms\x20and\x20conditions.'+'<br\x20/>';if(sError!='')return TriSysApex['UI']['ShowMessage'](sError,TriSysApex['Copyright']['ShortProductName']+'\x20Subscription'),![];return ctrlSubscribe['QuestionConfirmationOfProvisioning'](contact),![];},'QuestionConfirmationOfProvisioning':function(contact){var fnCommence=function(){return TriSysApex['UI']['CloseModalPopup'](),ctrlSubscribe['StartProvisioning'](contact),!![];};setTimeout(function(){var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20subscribe\x20and\x20commence\x20the\x20provisioning\x20of\x20your\x20dedicated\x20recruitment\x20database?';TriSysApex['UI']['questionYesNo'](sMessage,TriSysApex['Copyright']['ShortProductName']+'\x20Subscription\x20Confirmation','Yes',fnCommence,'No');},0x64);},'StartProvisioning':function(contact){var fnCompletedProvisioningRequest=function(){TriSysApex['Trial']['SubscribeButtonVisible'](![]);var sMessage='Thank\x20you\x20for\x20subscribing\x20to\x20'+TriSysApex['Copyright']['ShortProductName']+'.'+'<br\x20/>'+'Our\x20provisioning\x20system\x20is\x20now\x20preparing\x20your\x20cloud\x20recruitment\x20service.'+'<br\x20/>'+'You\x20will\x20receive\x20an\x20automated\x20e-mail\x20in\x20a\x20few\x20minutes\x20with\x20full\x20instructions\x20about\x20connecting\x20from\x20your\x20computer\x20or\x20mobile\x20device.';TriSysApex['UI']['ShowMessage'](sMessage,TriSysApex['Copyright']['ShortProductName']+'\x20Provisioning');};ctrlSubscribe['CallProvisioningWebAPI'](contact,fnCompletedProvisioningRequest);},'CallProvisioningWebAPI':function(contact,fnComplete){var CSubscriptionRequest={'Apex':!![],'Contact':contact},payloadObject={};payloadObject['URL']='Customer/SubscriptionRequest',payloadObject['OutboundDataPacket']=CSubscriptionRequest,payloadObject['InboundDataFunction']=function(CSubscriptionResponse){TriSysApex['UI']['HideWait']();if(CSubscriptionResponse){if(CSubscriptionResponse['Success']){fnComplete();return;}else{TriSysApex['UI']['errorAlert'](CSubscriptionResponse['ErrorMessage']);return;}}TriSysApex['UI']['ShowMessage']('Something\x20went\x20wrong\x20with\x20this\x20process.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlSubscribe.CallProvisioningWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Scheduling\x20Provisioning...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};$(document)['ready'](function(){ctrlSubscribe['Load']();});