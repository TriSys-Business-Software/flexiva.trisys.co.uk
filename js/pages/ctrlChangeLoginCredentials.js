var ctrlChangeLoginCredentials={'Load':function(){var sEMail=null,userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser'])var sEMail=userCredentials['LoggedInUser']['FullName'];else $('#change-login-credentials-old-password-tr')['hide'](),$('#change-login-credentials-email')['attr']('readonly','readonly'),$('#change-login-credentials-password')['focus'](),TriSysApex['Forms']['Login']['resetPasswordData']&&(sEMail=TriSysApex['Forms']['Login']['resetPasswordData']['EMail']);$('#change-login-credentials-email')['val'](sEMail);},'SaveLoginCredentialsButtonClick':function(fnCallback){var CChangeLoginCredentials=ctrlChangeLoginCredentials['Validate']();if(CChangeLoginCredentials)ctrlChangeLoginCredentials['SubmitChangeRequest'](CChangeLoginCredentials,fnCallback);return![];},'SubmitChangeRequest':function(CChangeLoginCredentials,fnCallback){var payloadObject={};payloadObject['URL']='Users/ChangeLoginCredentials',payloadObject['OutboundDataPacket']=CChangeLoginCredentials,payloadObject['InboundDataFunction']=function(CChangeLoginCredentialsResponse){TriSysApex['UI']['HideWait']();if(CChangeLoginCredentialsResponse){if(CChangeLoginCredentialsResponse['Success']){ctrlChangeLoginCredentials['OnSuccessfulChange'](fnCallback,CChangeLoginCredentials['EMail']);return;}else TriSysApex['UI']['ShowMessage'](CChangeLoginCredentialsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlChangeLoginCredentials.SubmitChangeRequest:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Changes...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OnSuccessfulChange':function(fnCallback,sEMail){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();userCredentials&&userCredentials['LoggedInUser']&&(userCredentials['LoggedInUser']['FullName']=sEMail),TriSysApex['UI']['CloseModalPopup'](),setTimeout(function(){fnCallback(sEMail);},0x32);},'Validate':function(bActivate){var CChangeLoginCredentials={};CChangeLoginCredentials['EMail']=$('#change-login-credentials-email')['val'](),CChangeLoginCredentials['OldPassword']=$('#change-login-credentials-old-password')['val'](),CChangeLoginCredentials['NewPassword']=$('#change-login-credentials-password')['val']();var sPasswordConfirmation=$('#change-login-credentials-password-confirmation')['val']();if(!CChangeLoginCredentials['EMail'])return TriSysApex['UI']['ShowMessage']('Please\x20complete\x20e-mail\x20field.'),null;if(!CChangeLoginCredentials['NewPassword'])return TriSysApex['UI']['ShowMessage']('Please\x20complete\x20new\x20password\x20field.'),null;if(!bActivate&&!CChangeLoginCredentials['OldPassword'])return TriSysApex['UI']['ShowMessage']('Please\x20complete\x20old\x20password\x20field.'),null;if(!TriSysApex['LoginCredentials']['validateEmail'](CChangeLoginCredentials['EMail']))return TriSysApex['UI']['ShowMessage']('Please\x20enter\x20a\x20valid\x20e-mail\x20address.'),null;if(!bActivate){var sErrorOld=TriSysApex['LoginCredentials']['ValidatePassword'](CChangeLoginCredentials['OldPassword']);if(sErrorOld)return TriSysApex['UI']['ShowMessage'](sErrorOld),null;}var sError=TriSysApex['LoginCredentials']['ValidatePassword'](CChangeLoginCredentials['NewPassword']);if(sError)return TriSysApex['UI']['ShowMessage'](sError),null;if(CChangeLoginCredentials['NewPassword']!=sPasswordConfirmation)return TriSysApex['UI']['ShowMessage']('New\x20password\x20and\x20confirmation\x20do\x20not\x20match.'),null;return CChangeLoginCredentials;},'ActivateUserAccountButtonClick':function(fnCallback){var CChangeLoginCredentials=ctrlChangeLoginCredentials['Validate'](!![]);if(CChangeLoginCredentials)fnCallback(CChangeLoginCredentials);return![];}};$(document)['ready'](function(){ctrlChangeLoginCredentials['Load']();});