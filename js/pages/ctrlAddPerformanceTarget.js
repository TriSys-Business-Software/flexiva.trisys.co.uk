var ctrlAddPerformanceTarget={'Field':function(sField){return'ctrlAddPerformanceTarget-'+sField;},'Load':function(){ctrlAddPerformanceTarget['LoadPeriodsFromWebAPI']();},'LoadPeriodsFromWebAPI':function(){var payloadObject={};payloadObject['URL']='PerformanceTargets/Periods',payloadObject['InboundDataFunction']=function(CPerformanceTargetPeriodsResponse){TriSysApex['UI']['HideWait']();if(CPerformanceTargetPeriodsResponse){if(CPerformanceTargetPeriodsResponse['Success']){if(CPerformanceTargetPeriodsResponse['Periods']){var periodArray=[];for(var i=0x0;i<CPerformanceTargetPeriodsResponse['Periods']['length'];i++){var period=CPerformanceTargetPeriodsResponse['Periods'][i],periodArrayItem={'value':JSON['stringify'](period),'text':period['PeriodName']};periodArray['push'](periodArrayItem);}TriSysSDK['CShowForm']['populateComboFromDataSource'](ctrlAddPerformanceTarget['Field']('period'),periodArray,0x0);}}else TriSysApex['UI']['ShowError'](CPerformanceTargetPeriodsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlAddPerformanceTarget.LoadRecordFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Periods...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SaveButtonClick':function(fnOnSave){var sTargetName=$('#'+ctrlAddPerformanceTarget['Field']('target'))['val'](),sTargetPeriodJSON=TriSysSDK['CShowForm']['GetValueFromCombo'](ctrlAddPerformanceTarget['Field']('period')),sDescription=$('#'+ctrlAddPerformanceTarget['Field']('description'))['val'](),bLocked=TriSysSDK['CShowForm']['GetCheckBoxValue'](ctrlAddPerformanceTarget['Field']('locked')),sValidationError=null;if(!sTargetName)sValidationError='Enter\x20a\x20name\x20for\x20the\x20target\x20metric';else{if(!sDescription)sValidationError='Describe\x20what\x20the\x20target\x20metric\x20is';}if(sValidationError){TriSysApex['UI']['ShowMessage'](sValidationError);return;}var period=JSON['parse'](sTargetPeriodJSON),CPerformanceTargetAddMetricRequest={'PerformanceTargetPeriodId':period['PerformanceTargetPeriodId'],'TargetName':sTargetName,'Description':sDescription,'Locked':bLocked};ctrlAddPerformanceTarget['SubmitSaveToWebAPI'](CPerformanceTargetAddMetricRequest,fnOnSave);},'SubmitSaveToWebAPI':function(CPerformanceTargetAddMetricRequest,fnOnSave){var payloadObject={};payloadObject['URL']='PerformanceTargets/AddTargetMetric',payloadObject['OutboundDataPacket']=CPerformanceTargetAddMetricRequest,payloadObject['InboundDataFunction']=function(CPerformanceTargetAddMetricResponse){TriSysApex['UI']['HideWait']();if(CPerformanceTargetAddMetricResponse){if(CPerformanceTargetAddMetricResponse['Success']){if(fnOnSave)fnOnSave(CPerformanceTargetAddMetricRequest['TargetName'],CPerformanceTargetAddMetricRequest['PerformanceTargetPeriodId']);}else TriSysApex['UI']['ShowError'](CPerformanceTargetAddMetricResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlAddPerformanceTarget.SubmitSaveToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Target\x20Metric...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};