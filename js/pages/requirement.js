var ctrlRequirementForm={'Load':function(){var sEntityName='Requirement';TriSysSDK['EntityFormTabs']['AddClickEventHandlers']('requirement-form-tab-nav-horizontal',!![]),TriSysSDK['Controls']['Button']['Click']('requirement-form-tab-contract-li');var hideMenuItemPrefixes=['file-menu-saveas'];if(TriSysApex['Device']['isPhone']())$('#requirementForm-ActionsMenu')['hide'](),$('#requirementCandidateSearchResultsActionsMenu')['hide'](),$('#requirementLonglistActionsMenu')['hide'](),$('#requirementShortlistActionsMenu')['hide'](),$('#requirementRejectedActionsMenu')['hide'](),$('#requirementPlacementsActionsMenu')['hide']();else{var sCallbackFunction='ctrlRequirementForm.ActionInvocation',sMasterEntityCallbackFunction='ctrlRequirementForm.ActionInvocationMasterEntity';TriSysActions['Menus']['Draw']('requirementForm-ActionsMenu','Requirement',sCallbackFunction,sMasterEntityCallbackFunction),TriSysActions['Menus']['Draw']('requirementCandidateSearchResultsActionsMenu','Contact','ctrlRequirementForm.ActionInvocationCandidateSearchResults',sMasterEntityCallbackFunction),TriSysActions['Menus']['Draw']('requirementLonglistActionsMenu','Contact','ctrlRequirementForm.ActionInvocationCandidateLonglist',sMasterEntityCallbackFunction),TriSysActions['Menus']['Draw']('requirementShortlistActionsMenu','Contact','ctrlRequirementForm.ActionInvocationCandidateShortlist',sMasterEntityCallbackFunction),TriSysActions['Menus']['Draw']('requirementRejectedActionsMenu','Contact','ctrlRequirementForm.ActionInvocationCandidateRejected',sMasterEntityCallbackFunction),TriSysActions['Menus']['Draw']('requirementPlacementsActionsMenu','Placement',sCallbackFunction);const fnResizeActionsMenus=function(){$('#requirementForm-ActionsMenu\x20.dropdown-menu.dropdown-custom\x20>\x20li')['css']('max-height',$(window)['height']()-0x64+'px');const lstActionsMenus=['requirementCandidateSearchResultsActionsMenu','requirementLonglistActionsMenu','requirementShortlistActionsMenu','requirementRejectedActionsMenu','requirementPlacementsActionsMenu'];lstActionsMenus['forEach'](function(sMenuID){var iHeightFactor=$('#requirement-tab-panel-buttons')['position']()['top']+0x78;$('#'+sMenuID+'\x20.dropdown-menu.dropdown-custom\x20>\x20li')['css']('max-height',$(window)['height']()-iHeightFactor+'px');});};setTimeout(fnResizeActionsMenus,0x7d0);}var sMenuFile='ctrlRequirementCandidateGridFileMenu.html',sGrid='requirementForm-CandidateSearchResultsGrid',visibleMenuItems=['requirementCandidateGridFileMenu-addshortlist','requirementCandidateGridFileMenu-reject'];TriSysSDK['FormMenus']['DrawGridMenu']('requirementCandidateSearchResultsGridMenu',sGrid),sGrid='requirementForm-LonglistGrid',TriSysSDK['FormMenus']['DrawGridMenu']('requirementLonglistGridMenu',sGrid),sGrid='requirementForm-ShortlistGrid',visibleMenuItems=['requirementCandidateGridFileMenu-reject','requirementCandidateGridFileMenu-addcandidate'];var sJobBoardMenuFile='ctrlRequirementShortlistJobBoardMenu.html';visibleMenuItems=ctrlRequirementForm['AvailableJobBoardMenuItems'](),TriSysSDK['FormMenus']['DrawDropDownMenuFromTemplate']('requirementShortlistJobBoardApplicantsMenu',sGrid,sJobBoardMenuFile,ctrlRequirementForm['JobBoardMenuCallback'],'requirement-shortlist-job-board-menu-items',![],visibleMenuItems,'requirementShortlistJobBoardApplicantsMenu'),TriSysSDK['FormMenus']['DrawGridMenu']('requirementShortlistGridMenu',sGrid),sGrid='requirementForm-RejectedGrid',visibleMenuItems=['requirementCandidateGridFileMenu-remove'],TriSysSDK['FormMenus']['DrawGridMenu']('requirementRejectedGridMenu',sGrid),sGrid='requirementForm-PlacementsGrid',TriSysSDK['FormMenus']['DrawGridMenu']('requirementPlacementsGridMenu',sGrid),sGrid='requirementForm-NotesHistoryGrid',TriSysSDK['FormMenus']['DrawGridMenu']('requirementNotesHistoryGridMenu',sGrid),sGrid='requirementForm-ScheduledTasksGrid',TriSysSDK['FormMenus']['DrawGridMenu']('requirementScheduledTasksGridMenu',sGrid);var fnCallbackAfterLoadingSalary=function(){TriSysSDK['CShowForm']['CustomFieldsTab']['Load']('requirement-form-customfields','requirement-form-tab-custom-caption',sEntityName),TriSysSDK['CShowForm']['InitialiseFields'](sEntityName);};TriSysSDK['PermanentSalary']['Load'](sEntityName,TriSysApex['Pages']['RequirementForm']['RequirementId'],'requirement-form-permanent-salary',fnCallbackAfterLoadingSalary),!TriSysSDK['CShowForm']['JobTitlesCached']()&&($('#tr-RequirementConfigFields_JobTitle')['show'](),$('#RequirementConfigFields_JobTitle')['keyup'](function(e){if(e['keyCode']==0xd)ctrlRequirementForm['JobTitleLookup']();}));},'TabButtonCallback':function(sTabID){var sGrid=null;switch(sTabID){case'requirement-form-panel-contract':if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sTabID))return;TriSysSDK['ContractRates']['Load']('Requirement',TriSysApex['Pages']['RequirementForm']['RequirementId'],'requirement-form-contract-rates');break;case'requirement-form-panel-search':if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sTabID)){var sTabPaneId='ctrlSearchCriteria-tab-panel-boolean-requirement-candidate-search-criteria-id-'+TriSysApex['Pages']['RequirementForm']['RequirementId'];$('#'+sTabPaneId)['show']();var sBooleanTreeWidgetId='search-criteria-tree-requirement-candidate-search-criteria-id-'+TriSysApex['Pages']['RequirementForm']['RequirementId'];$('#'+sBooleanTreeWidgetId)['css']('visibility','visible');return;}var sSearchDiv='requirement-candidate-search-criteria',sSearchDivForRecord=sSearchDiv+'-id-'+TriSysApex['Pages']['RequirementForm']['RequirementId'];$('#'+sSearchDiv)['attr']('id',sSearchDivForRecord);var fnCommenceSearch=ctrlRequirementForm['InvokeCandidateSearchFromCriteria'];TriSysSDK['SearchCriteria']['Load']('Contact',TriSysApex['Pages']['RequirementForm']['RequirementId'],sSearchDivForRecord,fnCommenceSearch);break;case'requirement-form-panel-attributes':if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sTabID))return;TriSysSDK['Attributes']['Load']('Requirement',TriSysApex['Pages']['RequirementForm']['RequirementId'],'requirement-form-attributes');break;case'requirement-form-panel-longlist':sGrid='requirementForm-LonglistGrid';if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sGrid))return;ctrlRequirementForm['PopulateCandidateGrid'](sGrid,!![]);break;case'requirement-form-panel-shortlist':sGrid='requirementForm-ShortlistGrid';if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sGrid))return;ctrlRequirementForm['PopulateCandidateGrid'](sGrid,![],!![]);break;case'requirement-form-panel-rejected':sGrid='requirementForm-RejectedGrid';if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sGrid))return;ctrlRequirementForm['PopulateCandidateGrid'](sGrid,![],![],!![]);break;case'requirement-form-panel-placements':TriSysApex['Pages']['RequirementForm']['LoadPlacementsGrid']('requirementForm-PlacementsGrid',null);break;case'requirement-form-panel-documentlibrary':if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sTabID))return;TriSysSDK['DocumentLibrary']['Load']('Requirement',TriSysApex['Pages']['RequirementForm']['RequirementId'],'requirement-form-documentlibrary');break;case'requirement-form-panel-noteshistory':TriSysApex['Pages']['RequirementForm']['LoadNotesHistoryGrid']('requirementForm-NotesHistoryGrid',null);break;case'requirement-form-panel-scheduledtasks':TriSysApex['Pages']['RequirementForm']['LoadScheduledTasksGrid']('requirementForm-ScheduledTasksGrid',null);break;}},'FileMenuCallback':function(sFileMenuID){var fm=TriSysSDK['FormMenus']['Constants'];switch(sFileMenuID){case fm['File_New']:TriSysApex['Pages']['RequirementForm']['NewRecord']();break;case fm['File_Open']:TriSysApex['Pages']['RequirementForm']['OpenFindDialogue']();break;case fm['File_Save']:TriSysApex['Pages']['RequirementForm']['SaveRecord']();break;case fm['File_Save_As']:TriSysApex['UI']['ShowMessage']('Save\x20Requirement\x20As');break;case fm['File_Delete']:TriSysApex['Pages']['RequirementForm']['DeleteRecord']();break;case fm['File_Close']:TriSysApex['FormsManager']['CloseCurrentForm']();break;}},'NotesHistoryGridFileMenuCallback':function(sFileMenuID){ctrlRequirementForm['TaskGridFileMenuCallback'](sFileMenuID,'requirementForm-NotesHistoryGrid',![]);},'ScheduledTaskGridFileMenuCallback':function(sFileMenuID){ctrlRequirementForm['TaskGridFileMenuCallback'](sFileMenuID,'requirementForm-ScheduledTasksGrid',!![]);},'TaskGridFileMenuCallback':function(sFileMenuID,sGrid,bScheduled){var fm=TriSysSDK['FormMenus']['Constants'],lTaskId=null;switch(sFileMenuID){case fm['File_New']:ctrlRequirementForm['NewTask'](bScheduled);break;case fm['File_Open']:lTaskId=TriSysApex['ModalDialogue']['Task']['GetSelectedSingletonTaskIdFromTaskGrid'](sGrid);if(lTaskId>0x0)TriSysApex['ModalDialogue']['Task']['QuickShow'](lTaskId);break;case fm['File_Delete']:lTaskId=TriSysApex['ModalDialogue']['Task']['GetSelectedSingletonTaskIdFromTaskGrid'](sGrid);if(lTaskId>0x0)TriSysApex['ModalDialogue']['Task']['DeleteTask'](lTaskId);break;}},'NewTask':function(bScheduled){var lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],lContactId=TriSysApex['Pages']['RequirementForm']['ContactId'],sFullName=$('#Requirement_ContactId')['val'](),sCompany=$('#Requirement_CompanyId')['val'](),sJobTitle='?',sContactType='Client',params=new TriSysApex['ModalDialogue']['Task']['ShowParameters']();params['Scheduled']=bScheduled;var contact={'ContactId':lContactId,'FullName':sFullName,'CompanyName':sCompany,'JobTitle':sJobTitle,'ContactType':sContactType};params['Contacts']['push'](contact);var requirementLink={'Name':'Requirement','RecordId':lRequirementId,'Description':$('#RequirementConfigFields_RequirementReference')['val']()+':\x20'+TriSysSDK['CShowForm']['GetJobTitleFromField']('RequirementConfigFields_JobTitle')+'\x20at\x20'+sCompany+'\x20with\x20'+sFullName};params['Links']['push'](requirementLink),TriSysApex['ModalDialogue']['Task']['Show'](params);},'InvokeCandidateSearchFromCriteria':function(sEntityName,lRecordId,sJson,dynamicColumns){var sGrid='requirementForm-CandidateSearchResultsGrid';ctrlRequirementForm['PopulateCandidateSearchGrid'](sGrid,'grdCandidateSearchResults','Candidates',sJson,dynamicColumns);},'PopulateCandidateSearchGrid':function(sGrid,sGridName,sCaption,sJson,dynamicColumns){var fnPopulationByFunction={'API':'Contacts/List','Parameters':function(request){request['SearchTreeEnabled']=!![],request['SearchTreeJson']=sJson,request['RequirementId']=TriSysApex['Pages']['RequirementForm']['RequirementId'],request['CandidateSearchResults']=!![];},'DataTableFunction':function(response){return response['List'];}};ctrlRequirementForm['PopulateRequirementCandidateGrid'](sGrid,sGridName,sCaption,fnPopulationByFunction,dynamicColumns,'requirementForm-candidateSearch-grid-selected-counter',sJson),TriSysSDK['Controls']['Button']['Click']('requirement-form-tab-search-results-li');},'PopulateCandidateGrid':function(sGrid,bLonglist,bShortlist,bRejected){var sGridName='',sCaption='',fnPopulationByFunction={'API':'Contacts/List','Parameters':function(request){request['RequirementId']=TriSysApex['Pages']['RequirementForm']['RequirementId'],request['Longlist']=bLonglist,request['Shortlist']=bShortlist,request['Rejected']=bRejected;},'DataTableFunction':function(response){return response['List'];}};if(bLonglist)sGridName='Longlist',sCaption='Longlist';else{if(bShortlist){sGridName='Shortlist',sCaption='Shortlist',ctrlRequirementForm['ShortlistGrid']['PopulateGrid'](sGrid,sGridName,sCaption,fnPopulationByFunction);return;}else bRejected&&(sGridName='Shortlist',sCaption='Shortlist');}ctrlRequirementForm['PopulateRequirementCandidateGrid'](sGrid,sGridName,sCaption,fnPopulationByFunction,null,'requirementForm-rejected-grid-selected-counter');},'PopulateRequirementCandidateGrid':function(sGrid,sGridName,sCaption,fnPopulationByFunction,dynamicColumns,sSelectedRowsCounterId,sJson){var columns=JSON['parse'](JSON['stringify'](TriSysWeb['Pages']['Contacts']['Columns']));columns=TriSysSDK['Grid']['HideColumns'](columns,['Contact_Company','Contact_EMail','Contact_WorkTelNo']),columns=TriSysSDK['Grid']['ShowColumns'](columns,['Contact_DateOfBirth','Contact_HomeAddressCity','Contact_JobTitle','Contact_AvailabilityDate'],!![]);var options={'DynamicColumns':dynamicColumns,'SelectedRowsCounterId':sSelectedRowsCounterId,'Json':sJson};TriSysWeb['Pages']['Contacts']['PopulateGrid'](sGrid,sGridName,sCaption,fnPopulationByFunction,columns,options);},'ShortlistGrid':{'PopulateGrid':function(sDiv,sGridName,sTitle,fnPopulationByFunction){var bHorizontalScrolling=![];TriSysSDK['Grid']['VirtualMode']({'Div':sDiv,'ID':sGridName,'Title':sTitle,'RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':ctrlRequirementForm['ShortlistGrid']['Columns'],'MobileVisibleColumns':ctrlRequirementForm['ShortlistGrid']['MobileVisibleColumns'],'MobileRowTemplate':ctrlRequirementForm['ShortlistGrid']['MobileRowTemplate'],'KeyColumnName':'ContactId','DrillDownFunction':function(rowData){var lContactId=rowData['ContactId'];TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);},'PreviewButtonFunction':function(rowData){var lContactId=rowData['ContactId'];TriSysApex['EntityPreview']['Contact']['Open'](lContactId);},'PreviewButtonTooltip':'Contact\x20Preview','LinkedInButtonColumn':{'enabled':!![],'contactIdField':'ContactId'},'MultiRowSelect':!![],'ColumnFilters':!![],'Grouping':![],'HorizontalScrolling':bHorizontalScrolling,'HyperlinkedColumns':['Contact_FullName'],'SelectedRowsCounterId':'requirementForm-ShortlistGrid-selected-counter'});},'Columns':[{'field':'ContactId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Contact_FullName','title':'Candidate\x20Name','type':'string','width':0xaa,'sticky':!![],'lockable':!![]},{'field':'ShortlistSourceName','title':'Shortlist\x20Source','type':'string','width':0x8c,'lockable':!![]},{'field':'DateShortlisted','title':'Shortlisted','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x6e},{'field':'Called','title':'Called','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64},{'field':'Interested','title':'Interested','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64},{'field':'CVSend','title':'CV\x20Send','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64},{'field':'AssessmentInterview','title':'Assessment\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'TelephoneInterview','title':'Tel.\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x78},{'field':'FirstInterview','title':'First\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x78},{'field':'SecondInterview','title':'Second\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82},{'field':'ThirdInterview','title':'Third\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'FourthInterview','title':'Fourth\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'FifthInterview','title':'Fifth\x20Interview','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'ReferencesTaken','title':'References\x20Taken','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x8c,'hidden':!![]},{'field':'OfferMade','title':'Offer\x20Made','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x6e},{'field':'OfferAccepted','title':'Offer\x20Accepted','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82},{'field':'OfferRejected','title':'Offer\x20Rejected','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82},{'field':'Placed','title':'Placed','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64},{'field':'Withdrawn','title':'Withdrawn','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x6e},{'field':'Rejected','title':'Rejected','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64,'hidden':!![]},{'field':'Contact_Company','title':'Company','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_EMail','title':'Work\x20E-Mail','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeEMail','title':'Home\x20E-Mail','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_WorkTelNo','title':'Work\x20Tel.\x20No','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_MobileTelNo','title':'Personal\x20Mobile','type':'string','width':0x82,'hidden':!![],'lockable':!![]},{'field':'Contact_WorkMobile','title':'Work\x20Mobile','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressTelNo','title':'Home\x20Tel.\x20No','type':'string','width':0x82,'hidden':!![],'lockable':!![]},{'field':'Contact_DateOfBirth','title':'Date\x20of\x20Birth','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'Contact_Title','title':'Title','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_OwnerUser','title':'Owner\x20User','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_CompanyAddressStreet','title':'Company\x20Street\x20Address','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_CompanyAddressCity','title':'Company\x20Street\x20City','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_CompanyAddressCounty','title':'Company\x20Street\x20County','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_CompanyAddressPostCode','title':'Company\x20Street\x20Post/ZIP\x20Code','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_CompanyAddressCountry','title':'Company\x20Street\x20Country','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressStreet','title':'Home\x20Street\x20Address','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressCity','title':'Home\x20Street\x20City','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressCounty','title':'Home\x20Street\x20County','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressPostCode','title':'Home\x20Street\x20Post/ZIP\x20Code','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_HomeAddressCountry','title':'Home\x20Street\x20Country','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_ContactType','title':'Contact\x20Type','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_JobTitle','title':'Job\x20Title','type':'string','width':0x82,'hidden':!![]},{'field':'Contact_AvailabilityDate','title':'Availability\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x82,'hidden':!![]},{'field':'Contact_ContactSource','title':'Source','type':'string','width':0x82,'hidden':!![],'lockable':!![]},{'field':'Contact_Status','title':'Status','type':'string','width':0x82,'hidden':!![]}],'MobileVisibleColumns':[{'field':'Contact_FullName'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20Contact_FullName\x20#\x20</strong><br\x20/>#:\x20ShortlistSourceName\x20#<br\x20/>'+'<i>Shortlisted:\x20#:\x20DateShortlisted\x20#</i><br\x20/>'+'Called:\x20#:\x20Called\x20#<br\x20/>'+'Interested:\x20#:\x20Interested\x20#<br\x20/>'+'CV\x20Send:\x20#:\x20CVSend\x20#<br\x20/>'+'Tel.\x20Interview:\x20#:\x20TelephoneInterview\x20#<br\x20/>'+'1st.\x20Interview:\x20#:\x20FirstInterview\x20#<br\x20/>'+'Offer:\x20#:\x20OfferMade\x20#<br\x20/>'+'Accepted:\x20#:\x20OfferAccepted\x20#<br\x20/>'+'Placed:\x20#:\x20Placed\x20#<br\x20/>'+'<hr></td>'},'CandidateGridMenuCallback':function(sMenuItemID){var sPrefix='requirementCandidateGridFileMenu-';sMenuItemID=sMenuItemID['substring'](sPrefix['length']);var iFirstDash=sMenuItemID['indexOf']('-'),sGrid=sMenuItemID['substring'](iFirstDash+0x1);sMenuItemID=sMenuItemID['substring'](0x0,iFirstDash);switch(sMenuItemID){case'view':ctrlRequirementForm['OpenCandidate'](sGrid);break;case'opencv':ctrlRequirementForm['OpenCandidateCV'](sGrid);break;case'addlonglist':ctrlRequirementForm['AddCandidateToList'](sGrid,!![]);break;case'addshortlist':ctrlRequirementForm['AddCandidateToList'](sGrid,![],!![]);break;case'reject':ctrlRequirementForm['AddCandidateToList'](sGrid,![],![],!![]);break;case'remove':ctrlRequirementForm['AddCandidateToList'](sGrid,![],![],![],!![]);break;case'addcandidate':ctrlRequirementForm['AddCandidateToShortlist']();break;}},'OpenCandidate':function(sGrid){var lstContactID=TriSysSDK['Grid']['GetListOfSelectedContactIdFromGrid'](sGrid);if(lstContactID['length']!=0x1){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20candidate\x20to\x20open.');return;}TriSysApex['FormsManager']['OpenForm']('Contact',lstContactID[0x0]);},'OpenCandidateCV':function(sGrid){var lstContactID=TriSysSDK['Grid']['GetListOfSelectedContactIdFromGrid'](sGrid);if(lstContactID['length']!=0x1){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20candidate\x20CV\x20to\x20open.');return;}var payloadObject={};payloadObject['URL']='ContactCV/GetCVFilePaths',payloadObject['OutboundDataPacket']={'ContactId':lstContactID[0x0]},payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CContactCVPathsRequest=data;if(CContactCVPathsRequest){if(CContactCVPathsRequest['Success']){var sCVFileRef=CContactCVPathsRequest['CVFileRef'];ctrlRequirementForm['OpenCandidateCVFileRefCallback'](sCVFileRef,'Original\x20CV');}else TriSysApex['UI']['errorAlert'](CContactCVPathsRequest['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlRequirementForm.OpenCandidateCV:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Reading\x20CV...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenCandidateCVFileRefCallback':function(sPath,sName){if(sPath)TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](sPath);else TriSysApex['UI']['ShowMessage']('No\x20CV\x20found\x20for\x20the\x20selected\x20candidate.');},'AddCandidateToList':function(sGrid,bLonglist,bShortlist,bRejected,bRemoveRejected){var lstContactID=TriSysSDK['Grid']['GetListOfSelectedContactIdFromGrid'](sGrid);ctrlRequirementForm['MoveCandidateListToSpecifiedGrid'](lstContactID,bLonglist,bShortlist,bRejected,bRemoveRejected);},'MoveCandidateListToSpecifiedGrid':function(lstContactID,bLonglist,bShortlist,bRejected,bRemoveRejected,bManuallyAdded){if(lstContactID['length']>=0x1){if(TriSysAPI['Operators']['isEmpty'](bManuallyAdded))bManuallyAdded=![];var CMoveCandidateBetweenRequirementListRequest={'RequirementId':TriSysApex['Pages']['RequirementForm']['RequirementId'],'ContactIdList':lstContactID,'AddToLonglist':bLonglist,'AddToShortlist':bShortlist,'AddToRejectedlist':bRejected,'RemoveFromRejectedlist':bRemoveRejected,'ManuallyAdded':bManuallyAdded},payloadObject={};payloadObject['URL']='Vacancy/MoveCandidateBetweenRequirementLists',payloadObject['OutboundDataPacket']=CMoveCandidateBetweenRequirementListRequest,payloadObject['InboundDataFunction']=function(data){var CMoveCandidateBetweenRequirementListResponse=data;CMoveCandidateBetweenRequirementListResponse&&(CMoveCandidateBetweenRequirementListResponse['Success']&&ctrlRequirementForm['RemoveSelectedCandidates'](bLonglist,bShortlist,bRejected,bRemoveRejected,bManuallyAdded,lstContactID));},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('ctrlRequirementForm.AddCandidateToList:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);return;}TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20candidates\x20to\x20long/short/rejected\x20lists.');},'ActionInvocation':function(sEntityName){switch(sEntityName){case'Requirement':var requirementIds=[TriSysApex['Pages']['RequirementForm']['RequirementId']];return requirementIds;case'Placement':var placementIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid']('requirementForm-PlacementsGrid','Placement_PlacementId');return placementIds;}},'ActionInvocationCandidateSearchResults':function(sEntityName){return ctrlRequirementForm['ActionInvocationCandidateGrid']('requirementForm-CandidateSearchResultsGrid');},'ActionInvocationCandidateLonglist':function(sEntityName){return ctrlRequirementForm['ActionInvocationCandidateGrid']('requirementForm-LonglistGrid');},'ActionInvocationCandidateShortlist':function(sEntityName){return ctrlRequirementForm['ActionInvocationCandidateGrid']('requirementForm-ShortlistGrid','ContactId');},'ActionInvocationCandidateRejected':function(sEntityName){return ctrlRequirementForm['ActionInvocationCandidateGrid']('requirementForm-RejectedGrid');},'ActionInvocationCandidateGrid':function(sGrid,sContactIdColumn){if(!sContactIdColumn)sContactIdColumn='Contact_ContactId';var contactIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sContactIdColumn);return contactIds;},'ActionInvocationMasterEntity':function(){var masterEntity={'EntityName':'Requirement','EntityId':TriSysApex['Pages']['RequirementForm']['RequirementId']};return masterEntity;},'ReloadCandidateGrids':function(){TriSysSDK['Grid']['SelectAllRows']('requirementForm-CandidateSearchResultsGrid',![]),TriSysSDK['Grid']['SelectAllRows']('requirementForm-ShortlistGrid',![]),TriSysSDK['Grid']['SelectAllRows']('requirementForm-RejectedGrid',![]),TriSysSDK['Grid']['RefreshData']('requirementForm-CandidateSearchResultsGrid'),ctrlRequirementForm['PopulateCandidateGrid']('requirementForm-ShortlistGrid',![],!![]),ctrlRequirementForm['PopulateCandidateGrid']('requirementForm-RejectedGrid',![],![],!![]);},'RemoveSelectedCandidates':function(bLonglist,bShortlist,bRejected,bRemoveRejected,bManuallyAdded,lstContactID){var sGridRemoveCheckedRowsDiv=null,sGridUnPopulate=null,bViewingShortlist=![],bViewingLonglist=![],bViewingSearchResults=![],sSelectedTabId=TriSysSDK['EntityFormTabs']['SelectedTabId']('requirement-form-tab-nav-horizontal');switch(sSelectedTabId){case'requirement-form-tab-search-results-li':sGridRemoveCheckedRowsDiv='requirementForm-CandidateSearchResultsGrid',sGridUnPopulate='requirementForm-ShortlistGrid',bViewingSearchResults=!![];break;case'requirement-form-tab-longlist-li':sGridRemoveCheckedRowsDiv='requirementForm-LonglistGrid',sGridUnPopulate='requirementForm-RejectedGrid',bViewingLonglist=!![];break;case'requirement-form-tab-shortlist-li':sGridRemoveCheckedRowsDiv='requirementForm-ShortlistGrid',sGridUnPopulate='requirementForm-RejectedGrid',bViewingShortlist=!![];break;case'requirement-form-tab-rejected-li':sGridRemoveCheckedRowsDiv='requirementForm-RejectedGrid',sGridUnPopulate='requirementForm-CandidateSearchResultsGrid';break;}if(bShortlist&&bManuallyAdded)sGridUnPopulate='requirementForm-ShortlistGrid',sGridRemoveCheckedRowsDiv=null;else{if(bLonglist)sGridUnPopulate='requirementForm-LonglistGrid';}if(sGridRemoveCheckedRowsDiv)TriSysSDK['Grid']['RemoveCheckedRows'](sGridRemoveCheckedRowsDiv);if(sGridUnPopulate)TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Requirement',sGridUnPopulate);if(bRejected||bRemoveRejected)TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Requirement','requirementForm-CandidateSearchResultsGrid');bShortlist&&bManuallyAdded&&TriSysSDK['Grid']['RefreshData'](sGridUnPopulate);if(bViewingShortlist)TriSysSDK['Grid']['RefreshData']('requirementForm-RejectedGrid');if(bShortlist&&bViewingLonglist)TriSysSDK['Grid']['RefreshData']('requirementForm-ShortlistGrid');if(bRejected&&bViewingSearchResults)TriSysSDK['Grid']['RefreshData']('requirementForm-RejectedGrid');if(bRejected)ctrlRequirementForm['PostInvocationListOperation'](lstContactID,'rejected\x20list');else{if(bRemoveRejected)ctrlRequirementForm['PostInvocationListOperation'](lstContactID,'rejected\x20list','Removed','from');}TriSysSDK['Grid']['RefreshData']('requirementForm-NotesHistoryGrid');},'AddCandidateToShortlist':function(){var fnSelectCandidate=function(selectedRow){if(!selectedRow)return;var lCandidateId=selectedRow['ContactId'],lstContactID=[lCandidateId],bManuallyAdded=!![];return ctrlRequirementForm['MoveCandidateListToSpecifiedGrid'](lstContactID,![],!![],![],![],bManuallyAdded),!![];};TriSysApex['ModalDialogue']['CandidateContacts']['Select'](fnSelectCandidate);},'JobTitleLookup':function(){var sJobTitleField='RequirementConfigFields_JobTitle',sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField'](sJobTitleField);TriSysSDK['JobTitle']['Lookup'](sJobTitle,sJobTitleField);},'PlacementGridFileMenuCallback':function(sFileMenuID){var fm=TriSysSDK['FormMenus']['Constants'],sGrid='requirementForm-PlacementsGrid',lPlacementId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](sGrid,'Placement_PlacementId','placement',![]);switch(sFileMenuID){case fm['File_Open']:if(lPlacementId>0x0)TriSysApex['FormsManager']['OpenForm']('Placement',lPlacementId);break;case fm['File_Delete']:break;}},'ReAssignUser':function(){var sUser=TriSysSDK['CShowForm']['GetTextFromCombo']('Requirement_UserId'),userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),sLoggedInUserFullName=userCredentials['LoggedInUser']['Contact']['FullName'],bAllowOwnershipChange=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['SystemSettingManager']['GetValue']('Requirement:\x20Allow\x20Ownership\x20Change',![])),bCanChangeOwnership=sUser==sLoggedInUserFullName||bAllowOwnershipChange;if(!bCanChangeOwnership){TriSysApex['UI']['ShowMessage']('You\x20are\x20not\x20the\x20owner\x20of\x20this\x20requirement\x20so\x20cannot\x20change\x20the\x20user.');return;}var fnSelectUser=function(selectedRow){if(!selectedRow)return![];var lUserId=selectedRow['UserId'],sFullName=selectedRow['FullName'];if(lUserId<=0x0)return![];return setTimeout(function(){ctrlRequirementForm['ReAssignUserViaWebService'](lUserId,sFullName);},0x32),!![];},options={'Title':'Select\x20the\x20new\x20Requirement\x20Owner','NotLocked':!![]};TriSysApex['ModalDialogue']['Users']['Select'](fnSelectUser,options);},'ReAssignUserViaWebService':function(lUserId,sFullName){var payloadObject={};payloadObject['URL']='Requirement/ReAssignUser',payloadObject['OutboundDataPacket']={'RequirementId':TriSysApex['Pages']['RequirementForm']['RequirementId'],'UserId':lUserId},payloadObject['InboundDataFunction']=function(CReAssignRequirementUserResponse){TriSysApex['UI']['HideWait']();if(CReAssignRequirementUserResponse){if(CReAssignRequirementUserResponse['Success']){TriSysSDK['CShowForm']['SetTextInCombo']('Requirement_UserId',sFullName),TriSysApex['Pages']['RequirementForm']['UserId']=lUserId;if(typeof ApexCustomerModule!=TriSysApex['Constants']['Undefined']&&typeof ApexCustomerModule['RequirementRules']!=TriSysApex['Constants']['Undefined']&&typeof ApexCustomerModule['RequirementRules']['AfterReAssigningOwnerUser']!=TriSysApex['Constants']['Undefined'])try{ApexCustomerModule['RequirementRules']['AfterReAssigningOwnerUser'](TriSysApex['Pages']['RequirementForm']['RequirementId'],lUserId,sFullName);}catch(e){}}else TriSysApex['UI']['errorAlert'](CReAssignRequirementUserResponse['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlRequirementForm.ReAssignUserViaWebService:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Updating...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ReAssignClientContactViaWebService':function(lRequirementId,lContactId,fnCompleted){var payloadObject={};payloadObject['URL']='Requirement/ReAssignClientContact',payloadObject['OutboundDataPacket']={'RequirementId':lRequirementId,'ContactId':lContactId},payloadObject['InboundDataFunction']=function(CReAssignRequirementClientContactResponse){TriSysApex['UI']['HideWait']();if(CReAssignRequirementClientContactResponse)CReAssignRequirementClientContactResponse['Success']?fnCompleted():TriSysApex['UI']['errorAlert'](CReAssignRequirementClientContactResponse['ErrorMessage']);else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlRequirementForm.ReAssignClientContactViaWebService:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Updating...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'EditWebSiteJobDetails':function(){var sFieldID='RequirementConfigFields_WebText',fieldElement=$('#'+sFieldID),sHTML=fieldElement['val'](),fnSavedChanges=function(sEditedHTML){fieldElement['val'](sEditedHTML);};TriSysSDK['Controls']['FileManager']['OpenUserFriendlyHTMLEditor']('Edit\x20External/Web\x20Site\x20Job\x20Details',sHTML,fnSavedChanges);},'EditInternalComments':function(){var txt=$('#RequirementConfigFields_Comments'),sComments=txt['val'](),fnEditedComments=function(sText){return txt['val'](sText),!![];},options={'Label':'Internal\x20Comments','Value':sComments};TriSysApex['ModalDialogue']['BigEdit']['Popup']('Edit\x20Requirement\x20'+options['Label'],'gi-pen',fnEditedComments,options);},'PreInvocationShortlistAction':function(lstContactID){var bLonglist=![],bShortlist=!![],bRejected=![],bRemoveRejected=![];ctrlRequirementForm['MoveCandidateListToSpecifiedGrid'](lstContactID,bLonglist,bShortlist),ctrlRequirementForm['PostInvocationListOperation'](lstContactID,'shortlist');},'PreInvocationLonglistAction':function(lstContactID){var bLonglist=!![],bShortlist=![],bRejected=![],bRemoveRejected=![];ctrlRequirementForm['MoveCandidateListToSpecifiedGrid'](lstContactID,bLonglist,bShortlist),ctrlRequirementForm['PostInvocationListOperation'](lstContactID,'longlist');},'PostInvocationListOperation':function(lstContactID,sWhatList,sOperation,sToOrFrom){if(!sOperation)sOperation='Added';if(!sToOrFrom)sToOrFrom='to';var sMessage=sOperation+'\x20'+lstContactID['length']+'\x20contact'+(lstContactID['length']==0x1?'':'s')+'\x20'+sToOrFrom+'\x20'+sWhatList+'.';TriSysApex['Toasters']['Success'](sMessage);},'Display3rdPartySearchInEyeFrame':function(lRequirementId,sURL,sTitle){setTimeout(function(){$('#requirement-candidate-search-criteria-id-0')['hide']();},0x1f4),setTimeout(function(){$('#requirement-candidate-search-criteria-id-'+lRequirementId)['hide']();},0x1f4),$('#requirement-candidate-search-3rd-party-block')['show'](),$('#requirement-candidate-search-3rd-party-block-title')['html'](sTitle);var iframe=document['getElementById']('requirement-candidate-search-3rd-party-block-iframe');iframe['src']=sURL,$('#requirement-form-tab-search-results-li')['hide'](),$('#requirement-form-tab-search-criteria-li')['trigger']('click'),TriSysSDK['Controls']['Button']['Click']('requirement-form-tab-search-results-li');},'AvailableJobBoardMenuItems':function(){var sBroadbeanLoginName=TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanLoginName'),sBroadbeanPassword=TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanPassword'),sLogicMelonLoginName=TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonLoginName'),sLogicMelonPassword=TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonPassword'),sPrefix='jobBoard-',items=[];if(sBroadbeanLoginName&&sBroadbeanPassword)items['push'](sPrefix+'Broadbean');if(sLogicMelonLoginName&&sLogicMelonPassword)items['push'](sPrefix+'LogicMelon');return items['length']==0x0&&items['push'](sPrefix+ctrlRequirementForm['_JobBoardWhatIsThis']),items;},'_JobBoardWhatIsThis':'None','JobBoardMenuCallback':function(sMenuItemID){var sSufffix='-requirementForm-ShortlistGrid',parts=sMenuItemID['split'](sSufffix);sMenuItemID=parts[0x0],parts=sMenuItemID['split']('jobBoard-');var sJobBoard=parts[0x1];if(!sJobBoard)return;if(sJobBoard==ctrlRequirementForm['_JobBoardWhatIsThis']){var sInstructions='If\x20you\x20use\x20job\x20boards\x20and\x20have\x20a\x20subscription\x20to\x20a\x20\x27job-broadcaster\x27\x20such\x20as\x20Broadbean,\x20LogicMelon\x20or\x20Idibu,\x20'+'you\x20can\x20input\x20your\x20credentials\x20into\x20your\x20user\x20options\x20to\x20pull\x20applicants\x20from\x20job\x20boards\x20directly\x20into\x20your\x20shortlist.';TriSysApex['UI']['ShowMessage'](sInstructions,'Job\x20Board\x20Applicants');return;}var requirement={'RequirementId':TriSysApex['Pages']['RequirementForm']['RequirementId'],'Reference':$('#RequirementConfigFields_RequirementReference')['val'](),'JobTitle':$('#RequirementConfigFields_JobTitle')['val'](),'JobBroadcaster':sJobBoard},fnLoadModal=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Job\x20Board\x20Applicants',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['Image']='gi-globe_af',parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlJobBoardApplicants.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='View\x20Applicants\x20in\x20'+sJobBoard,parametersObject['ButtonLeftFunction']=function(){return ctrlJobBoardApplicants['OpenJobAdvert'](),![];},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightFunction']=function(){return!![];},parametersObject['OnLoadCallback']=function(){ctrlJobBoardApplicants['Load'](requirement);},TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlJobBoardApplicants.js',null,fnLoadModal);}};$(document)['ready'](function(){ctrlRequirementForm['Load']();});