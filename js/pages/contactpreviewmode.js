var ContactPreviewMode={'Title':'TriSys\x20Contact\x20Preview','_ContactId':0x0,'Load':function(){TriSysWeb['Security']['AfterRecruiterUserAuthentication'](),document['title']=ContactPreviewMode['Title'];},'PostLogin':function(){$('#page-wrapper')['hide']();var lContactId=TriSysApex['EntityPreview']['Contact']['_MostRecentContactId'],sSearchCriteriaJson=TriSysApex['EntityPreview']['Contact']['_MostRecentSearchCriteriaJson'];ContactPreviewMode['ShowContact'](lContactId,sSearchCriteriaJson,{'PostLogin':!![]});var fnMaxy=function(){var sID='Contact-preview',dialog=$('#'+sID)['data']('kendoWindow');if(dialog){dialog['maximize']();if(TriSysApex['EntityPreview']['Contact']['Data']['BrowserExtension'])setTimeout(ContactPreviewMode['BrowserExtensionUITweaks'],0x64);}else setTimeout(fnMaxy,0x64);};setTimeout(fnMaxy,0xa);return;},'ContactLoadedInPreview':function(lContactId){$('#ctrlContactPreview-Action')['hide'](),$('#ctrlContactPreview-Close')['hide']();},'ShowContact':function(lContactId,sSearchCriteriaJson,options){if(ContactPreviewMode['_ContactId']==lContactId)return;ContactPreviewMode['_ContactId']=lContactId,TriSysApex['EntityPreview']['Contact']['Open'](lContactId,sSearchCriteriaJson,options);var fnOverrideTitle=function(){var sTitle=ContactPreviewMode['Title']+':\x20'+$('#ctrlContactPreview-contactname')['text']();document['title']=sTitle;};setTimeout(fnOverrideTitle,0xa),setTimeout(fnOverrideTitle,0x7d0);},'ReceiveSignalRMessage':function(lContactId,sSearchCriteriaJson){ContactPreviewMode['SendContactPreviewModeAcknowledgementSignalRMessage'](lContactId),ContactPreviewMode['ShowContact'](lContactId,sSearchCriteriaJson);},'SendContactPreviewModeAcknowledgementSignalRMessage':function(lContactId){var msg={'RecordId':lContactId,'Type':TriSysApex['SignalR']['Communication']['MessageType']['ContactPreviewAcknowledgement']},sJSON=JSON['stringify'](msg),sRecipientLoginName=null;TriSysApex['SignalR']['Communication']['Send'](sRecipientLoginName,sJSON);},'BrowserExtensionMessageToSubscriber':function(CSocketIOInstructions){var payloadObject={};payloadObject['URL']='WebBrowserExtension/ReadMessageSentToSubscriber',payloadObject['OutboundDataPacket']=CSocketIOInstructions,payloadObject['InboundDataFunction']=function(CReadMessageSentToSubscriberResponse){if(CReadMessageSentToSubscriberResponse){if(CReadMessageSentToSubscriberResponse['Success'])ContactPreviewMode['ProcessExtensionMessage'](CReadMessageSentToSubscriberResponse['Message']);else TriSysApex['UI']['errorAlert'](CReadMessageSentToSubscriberResponse['ErrorMessage'],TriSysWeb['Constants']['ApplicationName']);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ContactPreviewMode.BrowserExtensionMessageToSubscriber:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ProcessExtensionMessage':function(CMessage){if(ContactPreviewMode['HaveWeJustReceivedThisMessage'](CMessage))return;switch(CMessage['action']){case'selectedText':TriSysApex['Toasters']['Success']('Selected\x20Text:\x20'+CMessage['text']);break;case'serviceWorkerContext':ContactPreviewMode['LookupRecord'](CMessage['data']['DOM']);break;}},'HaveWeJustReceivedThisMessage':function(CMessage){var bMatched=![],dNow=new Date(),sJSON=JSON['stringify'](CMessage);if(ContactPreviewMode['_LastMessageReceived']['JSON']==sJSON){if(ContactPreviewMode['_LastMessageReceived']['timestamp']){var dLast=new Date(ContactPreviewMode['_LastMessageReceived']['timestamp']),iDiff=dNow-dLast;if(iDiff<0x3e8)bMatched=!![];}}return!bMatched&&(ContactPreviewMode['_LastMessageReceived']['timestamp']=dNow,ContactPreviewMode['_LastMessageReceived']['JSON']=sJSON),bMatched;},'_LastMessageReceived':{'timestamp':null,'JSON':null},'SummariseProfile':function(CDOM){var sSummary='';const sURL=CDOM['URL'],sTitle=CDOM['Title'];return sSummary=sTitle,sSummary;},'LookupRecord':function(CDOM){var payloadObject={};payloadObject['URL']='WebBrowserExtension/LookupRecord',payloadObject['OutboundDataPacket']=CDOM,payloadObject['InboundDataFunction']=function(CLookupRecordResponse){if(CLookupRecordResponse){if(CLookupRecordResponse['Success'])ContactPreviewMode['TakeActionAfterLookingUpRecord'](CLookupRecordResponse);else TriSysApex['UI']['errorAlert'](CLookupRecordResponse['ErrorMessage'],TriSysWeb['Constants']['ApplicationName']);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ContactPreviewMode.LookupRecord:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'TakeActionAfterLookingUpRecord':function(lookupResults){debugger;TriSysApex['UI']['CloseModalPopup']();if(lookupResults['EntityName']&&lookupResults['RecordId']){if(lookupResults['RecordId']['length']==0x1){ContactPreviewMode['ShowContact'](lookupResults['RecordId'][0x0],null);return;}else{if(lookupResults['RecordId']['length']>0x1){}}}if(!lookupResults['Fields'])return;ContactPreviewMode['_ContactId']=0x0;const contact=ContactPreviewMode['GenerateContactObjectFromWebPageFields'](lookupResults['URL'],lookupResults['Fields']);ctrlContactPreview['DisplayContact'](contact),ctrlContactPreview['Data']['URL']=lookupResults['URL'];const bDoNotCheckBrowserPopup=!![];ctrlContactPreview['DisplaySecondaryContactDetails']({'Requirements':[],'Placements':[],'NotesHistory':[],'TotalNotesHistoryRecords':0x0,'ScheduledTasks':[],'TotalScheduledTaskRecords':0x0},bDoNotCheckBrowserPopup);},'GenerateContactObjectFromWebPageFields':function(sURL,lstField){const contact={};return lstField&&lstField['forEach'](function(field){switch(field['Name']){case'linkedin-name':contact['FullName']=field['Value'];break;case'linkedin-jobTitle':var parts=field['Value']['split']('\x20at\x20');if(parts['length']>=0x1){contact['JobTitle']=parts[0x0];if(parts['length']>=0x2)contact['CompanyName']=parts[0x1];}else contact['JobTitle']=field['Value'];break;case'linkedin-photo':contact['PhotoURL']=field['Value'];break;case'linkedin-company':contact['CompanyName']=field['Value'];break;case'linkedin-address':contact['CompanyAddressCity']=field['Value'];break;case'linkedin-phone1':contact['WorkTelNo']=field['Value'];break;case'linkedin-email':contact['WorkEMail']=field['Value'];break;}}),contact;},'BrowserExtensionUITweaks':function(){const elemSplitter=$('#ctrlContactPreview-splitter');elemSplitter['css']('border',0x0),elemSplitter['parent']()['css']('padding','0px');const resizeEvent=new Event('resize');window['dispatchEvent'](resizeEvent);}};$(document)['ready'](function(){ContactPreviewMode['Load']();});