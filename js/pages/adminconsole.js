var AdminConsole={'UserGridID':'adminConsoleForm-UserGrid','GroupTreeID':'adminConsoleForm-GroupTree','PerformanceTargetsGridID':'adminConsoleForm-PerformanceTargetsGrid','PerformanceTargetComboID':'adminConsoleForm-PerformanceTargetCombo','PerformanceTargetComboUserID':'adminConsoleForm-PerformanceTargetCombo-Users','SkillCategoryGridID':'adminConsoleForm-SkillCategoryGrid','SkillGridID':'adminConsoleForm-SkillGrid','SystemSettingsGridID':'adminConsoleForm-SystemSettingsGrid','SQLManagerGridID':'adminConsoleForm-SQLManagerGrid','DocumentGridID':'adminConsoleForm-DocumentGrid','InvalidCVPathGridID':'adminConsoleForm-InvalidCVPathGrid','FieldDescriptionsGridID':'adminConsoleForm-FieldDescriptionsGrid','UserGridActionsMenu':'adminConsoleForm-User-ActionsMenu','AuditTrailGridID':'adminConsoleForm-AuditTrailGrid','Load':function(){TriSysSDK['EntityFormTabs']['AddClickEventHandlers']('admin-console-tab-nav-horizontal',!![]);var bUsersTabVisible=!TriSysApex['Resourcer']['isResourcerWebSite']();if(bUsersTabVisible)TriSysSDK['Controls']['Button']['Click']('admin-console-tab-users');else TriSysSDK['Controls']['Button']['Click']('admin-console-tab-attributes');TriSysSDK['FormMenus']['DrawGridMenu']('adminConsoleForm-User-GridMenu',AdminConsole['UserGridID']),AdminConsole['UserActionsMenu']['Draw'](),TriSysSDK['FormMenus']['DrawGridMenu']('adminConsoleForm-PerformanceTargets-GridMenu',AdminConsole['PerformanceTargetsGridID']),TriSysSDK['FormMenus']['DrawGridMenu'](AdminConsole['AuditTrailGridID']+'-GridMenu',AdminConsole['AuditTrailGridID']),AdminConsole['FieldDescriptions']['ReadEntitiesFromWebAPI'](AdminConsole['FieldDescriptions']['LoadEntityDescriptions']),AdminConsole['StyleManager']['Load']();},'TabClickEvent':function(sTabID){switch(sTabID){case'system-admin-panel-users':AdminConsole['PopulateUserGrid']();break;case'system-admin-panel-groups':AdminConsole['PopulateGroupTree']();break;case'system-admin-panel-performance-targets':AdminConsole['LoadPerformanceTargetSubsystem']();break;case'system-admin-panel-attributes':AdminConsole['PopulateSkillCategoryGrid']();break;case'system-admin-panel-system-settings':AdminConsole['PopulateSystemSettingsGrid']();break;case'system-admin-panel-field-descriptions':break;case'system-admin-panel-document-manager':AdminConsole['DocumentManager']['LoadFolders']();break;case'system-admin-panel-invalid-cvpaths':AdminConsole['InvalidCVPaths']['LoadContacts']();break;case'system-admin-panel-security':AdminConsole['Security']['Load']();break;case'system-admin-panel-user-settings':AdminConsole['UserSettings']['Load']();break;case'system-admin-panel-audit-trail':AdminConsole['AuditTrail']['Load']();break;}},'EditUserId':0x0,'CloneFromUserId':0x0,'PopulateUserGrid':function(){var fnPopulationByFunction={'API':'Users/List','Parameters':null,'DataTableFunction':function(response){return AdminConsole['ShowActivationMetricsDuringUserGridPopulation'](response['Metrics']),AdminConsole['TweakSubscriberList'](response['List']);}};AdminConsole['PopulateUserGridFromFunction'](fnPopulationByFunction);},'ShowActivationMetricsDuringUserGridPopulation':function(metrics){metrics&&($('#system-admin-users-activated-count')['html'](metrics['ActivatedCount']),$('#system-admin-users-deactivated-count')['html'](metrics['DeActivatedCount']),$('#system-admin-users-expiring-count')['html'](metrics['ExpiringSoonCount']));},'TweakSubscriberList':function(subscribers){if(subscribers){var bPricesShown=![];$['each'](subscribers,function(index,subscriber){var bActive=subscriber['Active']=='Yes';subscriber['ActiveStatus']=bActive?'success':'danger',subscriber['ActiveStatusText']=bActive?'A':'I';var iDaysTillEndOfSubscription=subscriber['DaysTillEndOfSubscription']==''?0x0:parseInt(subscriber['DaysTillEndOfSubscription']);bActive&&iDaysTillEndOfSubscription<=0x7&&(subscriber['ActiveStatus']='warning',subscriber['ActiveStatusText']='E');var sDaysToExpiry=bActive?iDaysTillEndOfSubscription:'';switch(''+iDaysTillEndOfSubscription){case'-1':sDaysToExpiry='Yesterday';break;case'0':case'':if(bActive)sDaysToExpiry='Today';break;case'1':if(bActive)sDaysToExpiry='Tomorrow';break;}var dtExpiryDate=new Date(subscriber['ExpiryDate']),sExpiryDateString=moment(dtExpiryDate)['format']('DD\x20MMM\x20YYYY');dtExpiryDate['getFullYear']()<=0x1&&(sExpiryDateString='',sDaysToExpiry=bActive?'Never':'',subscriber['ActiveStatus']=bActive?'success':'danger',subscriber['ActiveStatusText']=bActive?'A':'I');subscriber['ExpiryDateString']=sExpiryDateString;var dtLastLogin=new Date(subscriber['LastLogin']),sLastLoginString=moment(dtLastLogin)['format']('DD\x20MMM\x20YYYY');dtLastLogin['getFullYear']()<=0x1&&(sLastLoginString='');subscriber['LastLoginString']=sLastLoginString,subscriber['DaysToExpiry']=sDaysToExpiry;if(subscriber['PlanPriceSummary'])bPricesShown=!![];});if(!bPricesShown){var grid=$('#'+AdminConsole['UserGridID'])['data']('kendoGrid');grid['hideColumn']('PlanPriceSummary'),AdminConsole['_UserAccountManagementCanPayOnline']=![];}}return subscribers;},'_UserAccountManagementCanPayOnline':!![],'UserGridColumns':[{'field':'UserId','title':'Id','type':'number','width':0x46,'filterable':![],'hidden':!![]},{'field':'Name','title':'Name','type':'string'},{'field':'Active','title':'Active','template':'<span\x20class=\x22label\x20label-#:\x20ActiveStatus\x20#\x22>\x20#:\x20Active\x20#\x20</span>','width':0x5a},{'field':'EMail','title':'E-Mail/Login','type':'string'},{'field':'AccountMaintainer','title':'Administrator','type':'string','width':0x82},{'field':'StartDate','title':'Start\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy}','hidden':!![]},{'field':'ExpiryDateString','title':'Expiry\x20Date','type':'string','width':0x78},{'field':'DaysToExpiry','title':'Days\x20to\x20Expiry','type':'string','width':0x82,'filterable':![]},{'field':'PlanPriceSummary','title':'Price\x20Plan','type':'string','width':0x82},{'field':'TelNo','title':'Tel.\x20No.','type':'string','hidden':!![]},{'field':'LoggedIn','title':'Logged\x20In','type':'string','hidden':!![]},{'field':'Locked','title':'Locked','type':'string','hidden':!![]},{'field':'CRMContactId','title':'CRMContactId','type':'string','hidden':!![]},{'field':'LastLoginString','title':'Last\x20Login','type':'string','width':0x82,'hidden':!![]},{'field':'LoginCount','title':'Login\x20Count','type':'number','width':0x82,'hidden':!![]}],'PopulateUserGridFromFunction':function(fnPopulationByFunction){var sGridName=AdminConsole['UserGridID']-'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['UserGridID'],'ID':sGridName,'Title':'Users','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':AdminConsole['UserGridColumns'],'KeyColumnName':'UserId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),AdminConsole['OpenUserDialogue'](rowData['UserId'],0x0,rowData['CRMContactId']);},'MultiRowSelect':!![],'Grouping':![],'ColumnFilters':![],'Sortable':![],'OpenButtonCaption':'Open'});},'EditUser':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['UserGridID'],'UserId','user\x20account'),lCRMContactId=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'CRMContactId','user\x20account',![]);if(lUserId>0x0)return AdminConsole['OpenUserDialogue'](lUserId,0x0,lCRMContactId),!![];},'CloneUser':function(){var lUserId=0x3;if(lUserId>0x0)return AdminConsole['OpenUserDialogue'](0x0,lUserId,0x0),!![];},'ActivateUser':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['UserGridID'],'UserId','user\x20account'),sName=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'Name','user\x20account',![]),sActive=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'Active','user\x20account',![]),sExpiryDate=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'ExpiryDate','user\x20account',![]),lCRMContactId=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'CRMContactId','user\x20account',![]);if(lUserId>0x0){if(!AdminConsole['inUserAccountManagementCanPayOnline']())return;var fnExtendSubscription=function(){return AdminConsole['RequestPaymentForSpecifiedUserAccount'](lUserId,sName,lCRMContactId),!![];};if(sActive=='Yes'){sExpiryDate=moment(sExpiryDate)['format']('dddd\x20DD\x20MMMM\x20YYYY');var sMessage='The\x20account\x20for\x20'+sName+'\x20is\x20already\x20active\x20until\x20'+sExpiryDate+'.'+'<br/>'+'Would\x20you\x20like\x20to\x20extend\x20this\x20subscription\x20beyond\x20this\x20date?';TriSysApex['UI']['questionYesNo'](sMessage,'Activate\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20User\x20Account','Yes',fnExtendSubscription,'No');return;}fnExtendSubscription();}},'DeleteUser':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['UserGridID'],'UserId','user\x20account'),sName=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'Name','user\x20account',![]),sActive=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'Active','user\x20account',![]),sAccountMaintainer=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['UserGridID'],'AccountMaintainer','user\x20account',![]);if(lUserId>0x0){if(!AdminConsole['inUserAccountManagementCanPayOnline']())return;if(sActive!='Yes'){var sMessage='The\x20account\x20for\x20'+sName+'\x20is\x20not\x20active.'+'<br/>'+'Would\x20you\x20like\x20to\x20request\x20deletion\x20of\x20this\x20account?',fnContactUs=function(){return TriSysApex['FormsManager']['OpenForm']('ContactUs'),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Deactivate\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20User\x20Account','Yes',fnContactUs,'No');return;}var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),bMyUserAccount=userCredentials['LoggedInUser']['UserId']==lUserId;if(bMyUserAccount){var sMessage='You\x20are\x20not\x20permitted\x20to\x20deactivate\x20your\x20own\x20account\x20to\x20prevent\x20you\x20locking\x20your\x20own\x20subscription.';return TriSysApex['UI']['ShowMessage'](sMessage,'Deactivate\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20User\x20Account'),!![];}var fnDeletePrompt=function(){return setTimeout(function(){AdminConsole['ConfirmUserAccountDeletion'](lUserId,sName);},0x32),!![];};if(bMyUserAccount){var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20deactivate\x20your\x20own\x20account?'+'<br\x20/>You\x20will\x20be\x20logged\x20out\x20immediately\x20after\x20completion,\x20and\x20you\x20will\x20be\x20unable\x20to\x20log\x20back\x20in.';return TriSysApex['UI']['questionYesNo'](sMessage,'Deactivate\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20User\x20Account','Yes',fnDeletePrompt,'No'),!![];}return fnDeletePrompt(),!![];}},'ConfirmUserAccountDeletion':function(lUserId,sName){var fnDeleteUser=function(){return AdminConsole['ConfirmedUserAccountDeletion'](lUserId,sName),!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20deactivate\x20the\x20user\x20account\x20assigned\x20to\x20'+sName+'?';TriSysApex['UI']['questionYesNo'](sMessage,'Deactivate\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20User\x20Account','Yes',fnDeleteUser,'No');},'ConfirmedUserAccountDeletion':function(lUserId,sName){var CDeleteUserRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='User/Delete',payloadObject['OutboundDataPacket']=CDeleteUserRequest,payloadObject['InboundDataFunction']=function(CDeleteUserResponse){TriSysApex['UI']['HideWait']();if(CDeleteUserResponse){if(CDeleteUserResponse['Success']){TriSysApex['Cache']['cachedStandingDataInMemory']['Users']=CDeleteUserResponse['Users'];if(CDeleteUserResponse['LogoutAfterDeletion']){TriSysApex['LoginCredentials']['ConfirmedLogoff']();return;}else CDeleteUserResponse['Deleted']&&AdminConsole['PopulateUserGrid']();CDeleteUserResponse['DeletionMessage']&&TriSysApex['UI']['ShowMessage'](CDeleteUserResponse['DeletionMessage']);}else TriSysApex['UI']['ShowError'](CDeleteUserResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.ConfirmedUserAccountDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20User...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'inUserAccountManagementCanPayOnline':function(sWhat){if(!AdminConsole['_UserAccountManagementCanPayOnline']){var sMessage='Please\x20visit\x20our\x20support\x20portal\x20at\x20<a\x20href=\x22https://support.trisys.co.uk\x22\x20target=\x22_blank\x22>support.trisys.co.uk</a>\x20in\x20order\x20to\x20manage\x20accounts'+'\x20in\x20<strong>My\x20Company</strong>:';sMessage+='<br><br><img\x20src=\x22https://api.trisys.co.uk/apex/custom/trisys-technical-support-portal/images/support-portal-my-company-accounts-500.png\x22>',TriSysApex['UI']['ShowMessage'](sMessage);}return AdminConsole['_UserAccountManagementCanPayOnline'];},'OpenUserDialogue':function(lUserId,lCloneUserId,lCRMContactId){if(!AdminConsole['inUserAccountManagementCanPayOnline']())return;AdminConsole['EditUserId']=lUserId,AdminConsole['CloneFromUserId']=lCloneUserId;var bClone=lCloneUserId>0x0,userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),bMyUserAccount=userCredentials['LoggedInUser']['UserId']==lUserId,parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(!bClone?'Edit':'Add')+'\x20User\x20Account',parametersObject['Image']='fa-user',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlUser.html',parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],!bClone&&!bMyUserAccount&&(parametersObject['ButtonCentreText']='Send\x20Activation\x20Code',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){ctrlUser['SendActivationCodeForExistingUserAccount']();}),parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){ctrlUser['SaveButtonClick'](lCRMContactId);},TriSysApex['UI']['PopupMessage'](parametersObject);},'PostSaveUserAccountEvent':function(CWriteUserAccountResponse,lUserId){TriSysSDK['Grid']['ClearCheckedRows'](AdminConsole['UserGridID']),AdminConsole['PopulateUserGrid'](),TriSysApex['UI']['CloseModalPopup']();if(CWriteUserAccountResponse){var sPrompt=null;if(CWriteUserAccountResponse['NewAccount'])sPrompt='new';else{if(!CWriteUserAccountResponse['Active'])sPrompt='updated';}if(sPrompt){sPrompt='Would\x20you\x20like\x20to\x20activate\x20the\x20'+sPrompt+'\x20account\x20of\x20'+CWriteUserAccountResponse['FullName']+'?'+'<br/>'+'(You\x20will\x20be\x20redirected\x20to\x20our\x20payment\x20gateway\x20for\x20activation)';var fnRequestPayment=function(){return setTimeout(function(){AdminConsole['RequestPaymentForSpecifiedUserAccount'](CWriteUserAccountResponse['UserId'],CWriteUserAccountResponse['FullName'],CWriteUserAccountResponse['CRMContactId']);},0xa),!![];};TriSysApex['UI']['questionYesNo'](sPrompt,'Activate\x20User\x20Account','Yes',fnRequestPayment,'No');}}},'RequestPaymentForSpecifiedUserAccount':function(lUserId,sName,lCRMContactId){var payloadObject={},CActivateApexSubscriberRequest={'ContactId':lCRMContactId,'UserId':lUserId};payloadObject['URL']='Users/ActivateApexSubscriber',payloadObject['OutboundDataPacket']=CActivateApexSubscriberRequest,payloadObject['InboundDataFunction']=function(CActivateApexSubscriberResponse){TriSysApex['UI']['HideWait']();if(CActivateApexSubscriberResponse){if(CActivateApexSubscriberResponse['Success'])AdminConsole['PromptForUserAccountPayment'](CActivateApexSubscriberResponse['GUID'],sName,CActivateApexSubscriberResponse);else TriSysApex['UI']['ShowMessage'](CActivateApexSubscriberResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.RequestPaymentForSpecifiedUserAccount:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Preparing\x20Payment\x20Gateway...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PromptForUserAccountPayment':function(sGUID,sName,CActivateApexSubscriberResponse){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Activate\x20User\x20Account',parametersObject['Image']='gi-gbp',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlPaymentGateway.html'),parametersObject['OnLoadCallback']=function(){var options={'UserOnly':sName,'FreePlan':CActivateApexSubscriberResponse['FreePlan']},bTargetParent=!![];ctrlPaymentGateway['Load'](sGUID,CActivateApexSubscriberResponse,bTargetParent,options);},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Cancel',parametersObject['ButtonLeftFunction']=function(){return!![];},TriSysApex['UI']['PopupMessage'](parametersObject);},'UserActionsMenu':{'BroadcastMessageID':'Broadcast\x20Message','Draw':function(){TriSysApex['FormsManager']['loadControlReplacingDiv'](AdminConsole['UserGridActionsMenu'],'ctrlAdminConsoleUserGridActionsMenu.html',function(response,status,xhr){$('#admin-console-usergrid-broadcastmessage')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick'](AdminConsole['UserActionsMenu']['BroadcastMessageID'],'to');}),$('#admin-console-usergrid-logout')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick']('Logout');}),$('#admin-console-usergrid-removecachedlogin')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick']('Remove\x20Cached\x20Login');}),$('#admin-console-usergrid-resetgrids')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick']('Reset\x20Grids');}),$('#admin-console-usergrid-setfont')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick']('Set\x20Font');}),$('#admin-console-usergrid-settheme')['click'](function(e){e['preventDefault'](),AdminConsole['UserActionsMenu']['MenuClick']('Set\x20Theme');});});},'MenuClick':function(sWhat,sHow){var lstUserId=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](AdminConsole['UserGridID'],'UserId');if(!lstUserId||lstUserId['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20at\x20least\x20one\x20user\x20record.');return;}sHow=!sHow?'for':sHow;switch(sWhat){case AdminConsole['UserActionsMenu']['BroadcastMessageID']:AdminConsole['UserActionsMenu']['BroadcastMessageToUsers'](lstUserId);return;}var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20\x27'+sWhat+'\x27\x20'+sHow+'\x20the\x20selected\x20'+lstUserId['length']+'\x20user'+(lstUserId['length']==0x1?'':'s')+'?';TriSysApex['UI']['questionYesNo'](sMessage,'User\x20Action','Yes',function(){return AdminConsole['UserActionsMenu']['SendToWebAPI'](sWhat,lstUserId);},'No');},'BroadcastMessageToUsers':function(lstUserId){var fnReadMessage=function(sText){return setTimeout(function(){AdminConsole['UserActionsMenu']['BroadcastMessage'](lstUserId,sText);},0xa),!![];},options={'Instructions':'Please\x20type\x20in\x20your\x20message\x20to\x20broadcast\x20to\x20'+lstUserId['length']+'\x20user'+(lstUserId['length']>0x1?'s':'')+':','ButtonLabel':'Send','Label':'your\x20message','Value':''};TriSysApex['ModalDialogue']['BigEdit']['Popup'](AdminConsole['UserActionsMenu']['BroadcastMessageID'],'gi-chat',fnReadMessage,options);},'BroadcastMessage':function(lstUserId,sMessage){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),sAdministratorName=userCredentials['LoggedInUser']['ForenameAndSurname'],msg={'Type':TriSysApex['SignalR']['Communication']['MessageType']['BroadcastedMessage'],'ShowMessage':{'Popup':!![],'Text':sMessage,'Title':'Message\x20from\x20'+sAdministratorName}},sJSON=JSON['stringify'](msg);lstUserId['forEach'](function(lUserId){var userRecipient=TriSysApex['Cache']['UsersManager']['UserFromId'](lUserId);TriSysApex['SignalR']['Communication']['Send'](userRecipient['LoginName'],sJSON);});var sConfirmation='Your\x20message\x20was\x20broadcasted\x20to\x20'+lstUserId['length']+'\x20user'+(lstUserId['length']>0x1?'s':'')+'.';TriSysApex['UI']['ShowMessage'](sConfirmation);},'SendToWebAPI':function(sWhat,lstUserId){var CUserActionRequest={'ActionName':sWhat,'UserIdList':lstUserId},payloadObject={};return payloadObject['URL']='Users/Action',payloadObject['OutboundDataPacket']=CUserActionRequest,payloadObject['InboundDataFunction']=function(CUserActionResponse){TriSysApex['UI']['HideWait']();if(CUserActionResponse){if(CUserActionResponse['Success']){var sMessage='Action\x20\x27'+sWhat+'\x27\x20Completed\x20for\x20'+lstUserId['length']+'\x20user'+(lstUserId['length']==0x1?'':'s');TriSysApex['UI']['ShowMessage'](sMessage);}else TriSysApex['UI']['ShowMessage'](CUserActionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.UserActionsMenu.SendToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Users:\x20'+sWhat+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];}},'PopulateGroupTree':function(lExpandedUserGroupId){var ds=[],userGroups=TriSysApex['Cache']['UserGroups']();if(!userGroups)return;for(var c=0x0;c<userGroups['length'];c++){var group=userGroups[c],userIdList=group['UserIdList'],dsItems=[];if(userIdList)for(var s=0x0;s<userIdList['length'];s++){var iUserId=userIdList[s],user=TriSysApex['Cache']['UsersManager']['UserFromId'](iUserId);if(user){var bAddUser=user['UserId']>0x2;if(bAddUser){var userItem={'text':user['FullName'],'id':user['UserId']};dsItems['push'](userItem);}}}var bExpanded=lExpandedUserGroupId==group['UserGroupId']?!![]:![],sDisplayGroup=group['Name']+':\x20'+group['Description'],dsItem={'text':sDisplayGroup,'id':group['UserGroupId'],'expanded':bExpanded,'items':dsItems};ds['push'](dsItem);}var treeview=$('#'+AdminConsole['GroupTreeID'])['data']('kendoTreeView');!treeview?($('#'+AdminConsole['GroupTreeID'])['kendoTreeView']({'dragAndDrop':![],'dataSource':ds,'checkboxes':{'checkChildren':!![]}}),setTimeout(TriSysProUI['kendoUI_Overrides'],0x3e8)):treeview['dataSource']['data'](ds);},'AddUserGroup':function(){AdminConsole['ModalUserGroupDialogue'](0x0);},'RemoveUserGroup':function(){var selectedGroups=AdminConsole['ReadSelectedGroups']();if(selectedGroups['length']!=0x1)TriSysApex['UI']['ShowMessage']('Choose\x20only\x20one\x20group\x20to\x20remove\x20at\x20any\x20one\x20time.');else{var group=selectedGroups[0x0];if(group['UserGroupId']<=0x2){TriSysApex['UI']['ShowMessage']('You\x20are\x20not\x20permitted\x20to\x20remove\x20this\x20group.');return;}var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20group:\x20'+group['Name']+'?',fnYes=function(){return setTimeout(function(){AdminConsole['SubmitUserGroupDeletion'](group);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20User\x20Group','Yes',fnYes,'No');}},'SubmitUserGroupDeletion':function(group){var CDeleteUserGroupRequest={'Group':group},payloadObject={};payloadObject['URL']='UserGroup/Delete',payloadObject['OutboundDataPacket']=CDeleteUserGroupRequest,payloadObject['InboundDataFunction']=function(CDeleteUserGroupResponse){TriSysApex['UI']['HideWait']();if(CDeleteUserGroupResponse){if(CDeleteUserGroupResponse['Success'])TriSysApex['Cache']['cachedStandingDataInMemory']['UserGroups']=CDeleteUserGroupResponse['UserGroups'],AdminConsole['PopulateGroupTree']();else TriSysApex['UI']['ShowMessage'](CDeleteUserGroupResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.RemoveUserGroup:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Removing\x20Group...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'EditGroup':function(){var selectedGroups=AdminConsole['ReadSelectedGroups']();if(selectedGroups['length']!=0x1)TriSysApex['UI']['ShowMessage']('Choose\x20only\x20one\x20group\x20to\x20edit.');else{var group=selectedGroups[0x0];AdminConsole['ModalUserGroupDialogue'](group['UserGroupId']);}},'ModalUserGroupDialogue':function(iUserGroupId){AdminConsole['EditingUserGroupId']=iUserGroupId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(iUserGroupId>0x0?'Edit':'New')+'\x20User\x20Group',parametersObject['Image']='fa-users',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlUserGroup.html',parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){ctrlUserGroup['SaveButtonClick']();},TriSysApex['UI']['PopupMessage'](parametersObject);},'EditingUserGroupId':0x0,'AddUserToGroup':function(){var selectedGroups=AdminConsole['ReadSelectedGroups']();if(selectedGroups['length']==0x0)TriSysApex['UI']['ShowMessage']('Choose\x20one\x20or\x20more\x20groups.');else{var fnSelectUser=function(selectedRow){if(!selectedRow)return![];var lUserId=selectedRow['UserId'];if(lUserId<=0x0)return![];return setTimeout(function(){AdminConsole['SubmitUserToSelectedGroups'](lUserId,selectedGroups);},0x32),!![];};TriSysApex['ModalDialogue']['Users']['Select'](fnSelectUser);}},'SubmitUserToSelectedGroups':function(lUserId,selectedGroups){var CAddUserToGroupRequest={'Groups':selectedGroups,'UserId':lUserId},firstGroup=selectedGroups[0x0],payloadObject={};payloadObject['URL']='UserGroup/AddUser',payloadObject['OutboundDataPacket']=CAddUserToGroupRequest,payloadObject['InboundDataFunction']=function(CAddUserToGroupResponse){TriSysApex['UI']['HideWait']();if(CAddUserToGroupResponse){if(CAddUserToGroupResponse['Success'])TriSysApex['Cache']['cachedStandingDataInMemory']['UserGroups']=CAddUserToGroupResponse['UserGroups'],AdminConsole['PopulateGroupTree'](firstGroup['UserGroupId']);else TriSysApex['UI']['ShowMessage'](CAddUserToGroupResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitUserToSelectedGroups:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Adding\x20User...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'RemoveUserFromGroup':function(){var groups=AdminConsole['ReadSelectedGroupUsers']();if(groups['length']==0x0){TriSysApex['UI']['ShowMessage']('Choose\x20one\x20or\x20more\x20users\x20in\x20one\x20or\x20more\x20group.');return;}var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20all\x20selected\x20users\x20from\x20all\x20selected\x20groups?',fnYes=function(){return setTimeout(function(){AdminConsole['SubmitUsersFromGroupDeletion'](groups);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20Users\x20From\x20Groups','Yes',fnYes,'No');},'SubmitUsersFromGroupDeletion':function(groups){var CDeleteUsersFromGroupsRequest={'Groups':groups},firstGroup=groups[0x0],payloadObject={};payloadObject['URL']='UserGroup/DeleteUsers',payloadObject['OutboundDataPacket']=CDeleteUsersFromGroupsRequest,payloadObject['InboundDataFunction']=function(CDeleteUsersFromGroupsResponse){TriSysApex['UI']['HideWait']();if(CDeleteUsersFromGroupsResponse){if(CDeleteUsersFromGroupsResponse['Success'])TriSysApex['Cache']['cachedStandingDataInMemory']['UserGroups']=CDeleteUsersFromGroupsResponse['UserGroups'],AdminConsole['PopulateGroupTree'](firstGroup['UserGroupId']);else TriSysApex['UI']['ShowMessage'](CDeleteUsersFromGroupsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitUsersFromGroupDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Removing\x20Users...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ReadSelectedGroups':function(){var treeview=$('#'+AdminConsole['GroupTreeID'])['data']('kendoTreeView'),nodes=treeview['dataSource']['view'](),groups=[];for(var i=0x0;i<nodes['length'];i++){var node=nodes[i];if(node['checked']){var iUserGroupId=node['id'],group=TriSysApex['Cache']['UserGroupManager']['GroupFromId'](iUserGroupId);if(group)groups['push'](group);}}return groups;},'ReadSelectedGroupUsers':function(){var treeview=$('#'+AdminConsole['GroupTreeID'])['data']('kendoTreeView'),nodes=treeview['dataSource']['view'](),groups=[];for(var i=0x0;i<nodes['length'];i++){var node=nodes[i];if(node['hasChildren']){var iUserGroupId=node['id'],group=TriSysApex['Cache']['UserGroupManager']['GroupFromId'](iUserGroupId);group['UserIdList']=[];var userNodes=node['children']['view']();for(var u=0x0;u<userNodes['length'];u++){var userNode=userNodes[u];if(userNode['checked']){var iUserId=userNode['id'];group['UserIdList']['push'](iUserId);}}if(group['UserIdList']['length']>0x0)groups['push'](group);}}return groups;},'PopulateSkillCategoryGrid':function(){var sGridName=AdminConsole['SkillCategoryGridID']-'-GridInstance',fnRowClickHandler=function(e,gridObject,gridLayout){var selectedItem=TriSysSDK['Grid']['GetFirstGridCheckedItem'](gridObject);if(selectedItem){var lSkillCategoryId=selectedItem['SkillCategoryId'],sCategory=selectedItem['Category'];$('#adminConsoleForm-SelectedCategory')['html'](sCategory),AdminConsole['SelectedSkillCategoryId']=lSkillCategoryId,AdminConsole['SelectedSkillCategory']=sCategory,AdminConsole['PopulateSkillGrid'](sCategory),TriSysSDK['Grid']['DoubleClickHandler']['LastSelectedItem']=selectedItem;}},bPopulated=![],fnPostPopulationCallback=function(lRecordCount){!bPopulated&&TriSysSDK['Grid']['SelectFirstRow'](AdminConsole['SkillCategoryGridID']);};TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['SkillCategoryGridID'],'ID':sGridName,'Title':'Categories','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':{'API':'SkillCategory/List','Parameters':null,'DataTableFunction':function(response){return response['SkillCategories'];}},'Columns':[{'field':'SkillCategoryId','title':'SkillCategoryId','type':'number','width':0x46,'hidden':!![]},{'field':'FieldId','title':'FieldId','type':'number','width':0x46,'hidden':!![]},{'field':'Category','title':'Category','type':'string'},{'field':'Description','title':'Description','type':'string'},{'field':'Locked','title':'Locked','type':'string'}],'KeyColumnName':'SkillCategoryId','DrillDownFunction':null,'MultiRowSelect':![],'SingleRowSelect':!![],'RowClickHandler':fnRowClickHandler,'PostPopulationCallback':fnPostPopulationCallback,'Grouping':![]});},'PopulateSkillGrid':function(sCategory){var sGridName=AdminConsole['SkillGridID']-'-GridInstance',details=AdminConsole['GetCategoryDisplayAndEditDetails'](sCategory);TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['SkillGridID'],'ID':sGridName,'Title':'Attributes/Lookups','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':details['PopulationByFunction'],'Columns':details['Columns'],'KeyColumnName':details['KeyField'],'DrillDownFunction':null,'MultiRowSelect':!![],'Grouping':![]});},'GetCategoryDisplayAndEditDetails':function(sCategory){var fnPopulationByFunction={'API':'Skills/ListByCategory','Parameters':function(request){request['Category']=sCategory;},'DataTableFunction':function(response){return response['Skills'];}},sKeyField='SkillId',sNameLabel='Attribute',columns=[{'field':'SkillId','title':'SkillId','type':'number','width':0x46,'hidden':!![]},{'field':'Skill','title':'Attribute','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=null;switch(sCategory){case'Contact\x20Priorities':fnPopulationByFunction={'API':'Skills/ContactPriorityList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='ContactPriorityId',sNameLabel='Priority',columns=[{'field':'ContactPriorityId','title':'ContactPriorityId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Priority','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var priority=TriSysApex['Cache']['ContactPrioritiesManager']['PriorityFromId'](lRecordId);if(priority)return{'Name':priority['ContactPriority'],'Description':priority['Description'],'Colour':priority['HTMLColour']};};break;case'Contact\x20Titles':fnPopulationByFunction={'API':'Skills/ContactTitleList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='ContactTitleId',sNameLabel='Title',columns=[{'field':'ContactTitleId','title':'ContactTitleId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Title','type':'string'},{'field':'Description','title':'Description','type':'string'},{'field':'Sex','title':'Gender','type':'string'},{'field':'Married','title':'Married','type':'string'}],fnGetRecord=function(lRecordId){var contactTitle=TriSysApex['Cache']['ContactTitleManager']['ContactTitleFromId'](lRecordId);if(contactTitle)return{'Name':contactTitle['Name'],'Description':contactTitle['Description'],'Male':contactTitle['Male'],'Married':contactTitle['Married']};};break;case'Currencies':fnPopulationByFunction={'API':'Skills/CurrencyList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='CurrencyId',sNameLabel='Symbol',columns=[{'field':'CurrencyId','title':'CurrencyId','type':'number','width':0x46,'hidden':!![]},{'field':'Symbol','title':'Symbol','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var currency=TriSysApex['Cache']['CurrenciesManager']['CurrencyFromId'](lRecordId);if(currency)return{'Name':currency['Symbol'],'Description':currency['Description']};};break;case'Industries':fnPopulationByFunction={'API':'Skills/IndustryList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='IndustryId',sNameLabel='Industry',columns=[{'field':'IndustryId','title':'IndustryId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Industry','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var industry=TriSysApex['Cache']['IndustryManager']['IndustryFromId'](lRecordId);if(industry)return{'Name':industry['Name'],'Description':industry['Description']};};break;case'Job\x20Titles':fnPopulationByFunction={'API':'Skills/JobTitleList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='JobTitleId',sNameLabel='Job\x20Title',columns=[{'field':'JobTitleId','title':'JobTitleId','type':'number','width':0x46,'hidden':!![]},{'field':'JobTitle','title':'Job\x20Title','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var jobTitle=TriSysApex['Cache']['JobTitleManager']['JobTitleFromId'](lRecordId);if(jobTitle)return{'Name':jobTitle['JobTitle'],'Description':jobTitle['Description']};};break;case'Task\x20Types':fnPopulationByFunction={'API':'Skills/TaskTypeList','Parameters':null,'DataTableFunction':function(response){return response['List'];}},sKeyField='TaskTypeId',sNameLabel='Task\x20Type',columns=[{'field':'TaskTypeId','title':'TaskTypeId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Task\x20Type','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var taskType=TriSysApex['Cache']['TaskTypesManager']['TaskTypeFromId'](lRecordId);if(taskType)return{'Name':taskType['Name'],'Description':taskType['Description'],'Icon':taskType['Icon16'],'Colour':taskType['HTMLColour']};};break;case'Company\x20Relationship\x20Types':sKeyField='CompanyRelationshipTypeId',sNameLabel='Company\x20Relationship\x20Type',columns=[{'field':'CompanyRelationshipTypeId','title':'CompanyRelationshipTypeId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Company\x20Relationship\x20Type','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var relationship=TriSysApex['Cache']['Relationships']['RelationshipFromId'](lRecordId,'Company');if(relationship)return{'Name':relationship['Name'],'Description':relationship['Description']};};break;case'Contact\x20Relationship\x20Types':sKeyField='ContactRelationshipTypeId',sNameLabel='Contact\x20Relationship\x20Type',columns=[{'field':'ContactRelationshipTypeId','title':'ContactRelationshipTypeId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Contact\x20Relationship\x20Type','type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){var relationship=TriSysApex['Cache']['Relationships']['RelationshipFromId'](lRecordId,'Contact');if(relationship)return{'Name':relationship['Name'],'Description':relationship['Description']};};break;case'Address\x20Types':sKeyField='AddressTypeId',sNameLabel='Address\x20Type',columns=[{'field':sKeyField,'title':'AddressTypeId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':sNameLabel,'type':'string'},{'field':'Description','title':'Description','type':'string'}],fnGetRecord=function(lRecordId){debugger;var addressType=TriSysApex['Cache']['AddressTypesManager']['AddressTypeFromId'](lRecordId);if(addressType)return{'Name':addressType['Name'],'Description':addressType['Description']};};break;}var details={'PopulationByFunction':fnPopulationByFunction,'KeyField':sKeyField,'NameLabel':sNameLabel,'Columns':columns,'GetRecord':fnGetRecord};return details;},'AddSkillCategory':function(){AdminConsole['OpenSkillCategoryDialogue'](0x0);},'EditSkillCategory':function(){if(AdminConsole['SelectedSkillCategoryId']>0x0)AdminConsole['OpenSkillCategoryDialogue'](AdminConsole['SelectedSkillCategoryId']);},'RemoveSkillCategory':function(){if(AdminConsole['SelectedSkillCategoryId']>0x0){var lSkillCategoryId=AdminConsole['SelectedSkillCategoryId'],skillCategory=TriSysApex['Cache']['SkillCategoriesManager']['CategoryFromId'](lSkillCategoryId);if(skillCategory){if(skillCategory['Locked']){TriSysApex['UI']['ShowMessage']('Category\x20is\x20locked.');return;}if(skillCategory['FieldId']>0x0){TriSysApex['UI']['ShowMessage']('Category\x20is\x20a\x20field\x20and\x20can\x20therefore\x20only\x20be\x20removed\x20from\x20field\x20descriptions\x20applet.');return;}if(TriSysApex['Cache']['SkillCategoriesManager']['hasLockedSkills'](skillCategory)){TriSysApex['UI']['ShowMessage']('Category\x20has\x20locked\x20skills.');return;}var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20category:\x20'+skillCategory['Category']+'?',fnYes=function(){return setTimeout(function(){AdminConsole['DeleteSkillCategory'](skillCategory);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20Category','Yes',fnYes,'No');}}},'AddSkill':function(){AdminConsole['OpenAttributeOrLookupDialogue'](0x0);},'EditSkill':function(){var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory'](),lAttributeId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SkillGridID'],sKeyField,'attribute/lookup');lAttributeId>0x0&&AdminConsole['OpenAttributeOrLookupDialogue'](lAttributeId);},'OpenAttributeOrLookupDialogue':function(lAttributeId){var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory']();switch(sKeyField){case'SkillId':AdminConsole['OpenSkillDialogue'](lAttributeId);break;default:AdminConsole['OpenLookupDialogue'](lAttributeId);break;}},'GetDetailsForSelectedCategory':function(){var details=AdminConsole['GetCategoryDisplayAndEditDetails'](AdminConsole['SelectedSkillCategory']);return details;},'GetEntityIdFieldForSelectedCategory':function(){var details=AdminConsole['GetDetailsForSelectedCategory']();return details['KeyField'];},'isSelectedCategorySkills':function(){var details=AdminConsole['GetCategoryDisplayAndEditDetails'](AdminConsole['SelectedSkillCategory']);return details['KeyField']=='SkillId';},'ReAssignSkillLinks':function(){var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory'](),lAttributeId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SkillGridID'],sKeyField,'attribute/lookup');if(lAttributeId>0x0){if(sKeyField=='SkillId'){var skill=TriSysApex['Cache']['SkillManager']['SkillFromId'](lAttributeId);if(skill)AdminConsole['PromptForCrossCategoryReAssignLinks'](skill);}}},'MoveSkill':function(){var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory'](),lAttributeId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SkillGridID'],sKeyField,'attribute/lookup');if(lAttributeId>0x0){if(sKeyField=='SkillId'){var skill=TriSysApex['Cache']['SkillManager']['SkillFromId'](lAttributeId);if(skill)AdminConsole['PromptForSkillCategoryToMoveSkill'](skill);}}},'RemoveSkill':function(){var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory'](),lAttributeId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SkillGridID'],sKeyField,'attribute/lookup');if(lAttributeId>0x0){if(sKeyField=='SkillId')AdminConsole['RemoveSkillFromSkillId'](lAttributeId);else AdminConsole['RemoveLookup'](lAttributeId);}},'RemoveSkillFromSkillId':function(lSkillId){var skill=TriSysApex['Cache']['SkillManager']['SkillFromId'](lSkillId);if(skill){if(skill['Locked'])TriSysApex['UI']['ShowMessage']('Attribute\x20is\x20locked.');else{var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20attribute:\x20'+skill['Skill']+'?',fnYes=function(){return setTimeout(function(){AdminConsole['PromptForReassignSkill'](skill);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20Attribute','Yes',fnYes,'No');}}},'RemoveLookup':function(lLookupId){var sCategory=AdminConsole['SelectedSkillCategory'],sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20this\x20lookup?',fnYes=function(){return setTimeout(function(){AdminConsole['PromptForReassignLookup'](sCategory,lLookupId);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20Lookup','Yes',fnYes,'No');},'PromptForReassignLookup':function(sCategory,lAttributeId){var fnSelectedLookup=function(selectedRow){if(!selectedRow)return;var sKeyField=AdminConsole['GetEntityIdFieldForSelectedCategory'](),lLookupId=selectedRow[sKeyField];lLookupId>0x0&&AdminConsole['SubmitLookupDeletion'](sCategory,lAttributeId,lLookupId);},sTitle='Re-Assign\x20Deleted\x20Lookup';AdminConsole['SelectReAssignLookup'](sCategory,lAttributeId,sTitle,fnSelectedLookup);},'PromptForReassignSkill':function(skill){var fnSelectedSkill=function(selectedRow){if(!selectedRow)return;var lSkillId=selectedRow['SkillId'];if(lSkillId>0x0){var reAssignSkill=TriSysApex['Cache']['SkillManager']['SkillFromId'](lSkillId);if(reAssignSkill)AdminConsole['SubmitSkillDeletion'](skill,reAssignSkill['SkillId']);}},sTitle='Re-Assign\x20Deleted\x20Attribute';TriSysApex['ModalDialogue']['Skill']['Select'](skill['SkillCategoryId'],skill['SkillId'],sTitle,fnSelectedSkill);},'PromptForCrossCategoryReAssignLinks':function(skill){var fnSelectedSkill=function(selectedRow){if(!selectedRow)return;var lSkillId=selectedRow['SkillId'];if(lSkillId>0x0){var reAssignSkill=TriSysApex['Cache']['SkillManager']['SkillFromId'](lSkillId);if(reAssignSkill){var fnYes=function(){return setTimeout(function(){AdminConsole['SubmitSkillReAssignment'](skill,reAssignSkill['SkillId']);},0x32),!![];},sMessage='Please\x20confirm\x20all\x20links\x20to\x20\x27'+skill['Category']+'\x20>\x20'+skill['Skill']+'\x27\x20will\x20be\x20re-assigned\x20to\x20\x27'+reAssignSkill['Category']+'\x20>\x20'+reAssignSkill['Skill']+'\x27?';TriSysApex['UI']['questionYesNo'](sMessage,'Re-Assign\x20Attribute\x20Link','Yes',fnYes,'No');}}},sTitle='Re-Assign\x20Links\x20to\x20\x27'+skill['Skill']+'\x27';TriSysApex['ModalDialogue']['Skill']['SelectNonFieldFromAnyCategory'](skill['SkillId'],sTitle,fnSelectedSkill);},'PromptForSkillCategoryToMoveSkill':function(skill){var fnSelectedSkillCategory=function(selectedRow){if(!selectedRow)return;var lSkillCategoryId=selectedRow['SkillCategoryId'];if(lSkillCategoryId>0x0){var skillCategory=TriSysApex['Cache']['SkillCategoriesManager']['CategoryFromId'](lSkillCategoryId);if(skillCategory){var fnYes=function(){return setTimeout(function(){AdminConsole['SubmitSkillMoveToAnotherCategory'](skill,skillCategory['SkillCategoryId']);},0x32),!![];},sMessage='Please\x20confirm\x20\x27'+skill['Category']+'\x20>\x20'+skill['Skill']+'\x27\x20will\x20be\x20moved\x20to\x20category\x20\x27'+skillCategory['Category']+'\x27?';TriSysApex['UI']['questionYesNo'](sMessage,'Move\x20Attribute','Yes',fnYes,'No');}}},sTitle='Move\x20\x27'+skill['Category']+'\x20>\x20'+skill['Skill']+'\x27\x20to\x20another\x20category';TriSysApex['ModalDialogue']['Skill']['SelectAnyCategory'](skill['SkillCategoryId'],sTitle,fnSelectedSkillCategory);},'SelectReAssignLookup':function(sCategory,lIgnoreLookupId,sTitle,fnSelectedLookup){var details=AdminConsole['GetCategoryDisplayAndEditDetails'](sCategory),sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['PopulationByFunction']=details['PopulationByFunction'],sqlParameters['Columns']=details['Columns'],sqlParameters['CallbackFunction']=fnSelectedLookup,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'SelectedSkillCategoryId':0x0,'SelectedSkillCategory':null,'EditingSkillCategoryId':0x0,'EditingSkillId':0x0,'OpenSkillCategoryDialogue':function(lSkillCategoryId,fnCallback,options){AdminConsole['EditingSkillCategoryId']=lSkillCategoryId;var bAllowSave=!![];if(lSkillCategoryId>0x0){var skillCategory=TriSysApex['Cache']['SkillCategoriesManager']['CategoryFromId'](lSkillCategoryId);if(skillCategory)bAllowSave=!skillCategory['Locked'];}var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lSkillCategoryId>0x0?'Edit':'New')+'\x20Category',parametersObject['Image']='gi-list',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlSkillCategory.html',parametersObject['ButtonRightText']=bAllowSave?'Cancel':'Close',parametersObject['ButtonRightVisible']=!![],bAllowSave&&(parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlSkillCategory['SaveButtonClick'](fnCallback,options);}),TriSysApex['UI']['PopupMessage'](parametersObject);},'OpenSkillDialogue':function(lSkillId){AdminConsole['EditingSkillId']=lSkillId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lSkillId>0x0?'Edit':'New')+'\x20Attribute',parametersObject['Image']='gi-list',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlSkill.html',parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){ctrlSkill['SaveButtonClick']();},TriSysApex['UI']['PopupMessage'](parametersObject);},'OpenLookupDialogue':function(lLookupId){AdminConsole['EditingSkillId']=lLookupId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lLookupId>0x0?'Edit':'New')+'\x20Lookup',parametersObject['Image']='gi-list',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlLookup.html',parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){ctrlLookup['SaveButtonClick']();},TriSysApex['UI']['PopupMessage'](parametersObject);},'SubmitSkillDeletion':function(skill,lReassignSkillId){var CDeleteSkillRequest={'Skill':skill,'ReassignSkillId':lReassignSkillId},payloadObject={};payloadObject['URL']='Skills/Delete',payloadObject['OutboundDataPacket']=CDeleteSkillRequest,payloadObject['InboundDataFunction']=function(CDeleteSkillResponse){TriSysApex['UI']['HideWait']();if(CDeleteSkillResponse){if(CDeleteSkillResponse['Success']){TriSysApex['Cache']['cachedStandingDataInMemory']['Skills']=CDeleteSkillResponse['Skills'],AdminConsole['PopulateSkillGrid'](AdminConsole['SelectedSkillCategory']),TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CDeleteSkillResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitSkillDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Attribute...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SubmitSkillReAssignment':function(skill,lReassignSkillId){var CReAssignSkillRequest={'Skill':skill,'ReassignSkillId':lReassignSkillId},payloadObject={};payloadObject['URL']='Skills/ReAssign',payloadObject['OutboundDataPacket']=CReAssignSkillRequest,payloadObject['InboundDataFunction']=function(CReAssignSkillResponse){TriSysApex['UI']['HideWait']();if(CReAssignSkillResponse){if(CReAssignSkillResponse['Success']){TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CReAssignSkillResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitSkillReAssignment:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Re-Assigning\x20Attribute...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SubmitSkillMoveToAnotherCategory':function(skill,lSkillCategoryId){var CMoveSkillToAnotherCategoryRequest={'Skill':skill,'SkillCategoryId':lSkillCategoryId},payloadObject={};payloadObject['URL']='Skills/MoveToAnotherCategory',payloadObject['OutboundDataPacket']=CMoveSkillToAnotherCategoryRequest,payloadObject['InboundDataFunction']=function(CMoveSkillToAnotherCategoryResponse){TriSysApex['UI']['HideWait']();if(CMoveSkillToAnotherCategoryResponse){if(CMoveSkillToAnotherCategoryResponse['Success']){TriSysApex['Cache']['cachedStandingDataInMemory']['Skills']=CMoveSkillToAnotherCategoryResponse['Skills'],AdminConsole['PopulateSkillGrid'](AdminConsole['SelectedSkillCategory']),TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CMoveSkillToAnotherCategoryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitSkillMoveToAnotherCategory:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Moving\x20Attribute...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SubmitLookupDeletion':function(sCategory,lLookupId,lReassignToLookupId){var details=AdminConsole['GetCategoryDisplayAndEditDetails'](sCategory),CDeleteLookupRequest={'KeyField':details['KeyField'],'LookupId':lLookupId,'ReassignLookupId':lReassignToLookupId},payloadObject={};payloadObject['URL']='Lookup/Delete',payloadObject['OutboundDataPacket']=CDeleteLookupRequest,payloadObject['InboundDataFunction']=function(CDeleteLookupResponse){TriSysApex['UI']['HideWait']();if(CDeleteLookupResponse){if(CDeleteLookupResponse['Success']){var standingData=CDeleteLookupResponse['StandingData'];if(standingData)TriSysApex['Cache']['SetStandingData'](standingData);AdminConsole['PopulateSkillGrid'](sCategory),TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CDeleteLookupResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.SubmitLookupDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Lookup...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteSkillCategory':function(skillCategory){var CDeleteSkillCategoryRequest={'SkillCategory':skillCategory},payloadObject={};payloadObject['URL']='SkillCategory/Delete',payloadObject['OutboundDataPacket']=CDeleteSkillCategoryRequest,payloadObject['InboundDataFunction']=function(CDeleteSkillCategoryResponse){TriSysApex['UI']['HideWait']();if(CDeleteSkillCategoryResponse){if(CDeleteSkillCategoryResponse['Success']){TriSysApex['Cache']['cachedStandingDataInMemory']['SkillCategories']=CDeleteSkillCategoryResponse['SkillCategories'],AdminConsole['PopulateSkillCategoryGrid']();return;}else TriSysApex['UI']['ShowMessage'](CDeleteSkillCategoryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.DeleteSkillCategory:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Category...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PopulateSystemSettingsGrid':function(){var sGridName=AdminConsole['SystemSettingsGridID']-'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['SystemSettingsGridID'],'ID':sGridName,'Title':'System\x20Settings','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':{'API':'SystemSetting/List','Parameters':null,'DataTableFunction':function(response){return response['SystemSettings'];}},'Columns':[{'field':'SystemSettingId','title':'SystemSettingId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Name','type':'string'},{'field':'Value','title':'Value','type':'string'},{'field':'Description','title':'Description','type':'string'}],'KeyColumnName':'SystemSettingId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),AdminConsole['OpenSystemSetting'](rowData['SystemSettingId']);},'MultiRowSelect':!![],'Grouping':![],'ColumnFilters':!![],'OpenButtonCaption':'Open'});},'SystemSettingId':0x0,'OpenSystemSetting':function(lSystemSettingId){AdminConsole['SystemSettingId']=lSystemSettingId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lSystemSettingId>0x0?'Edit':'Add')+'\x20System\x20Setting',parametersObject['Image']='gi-settings',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlSystemSetting.html',parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){ctrlSystemSetting['SaveButtonClick']();},TriSysApex['UI']['PopupMessage'](parametersObject);},'AddSystemSetting':function(){AdminConsole['OpenSystemSetting'](0x0);},'EditSystemSetting':function(){var lSystemSettingId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SystemSettingsGridID'],'SystemSettingId','system\x20setting');if(lSystemSettingId>0x0)AdminConsole['OpenSystemSetting'](lSystemSettingId);},'RemoveSystemSetting':function(){var lSystemSettingId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['SystemSettingsGridID'],'SystemSettingId','system\x20setting');if(lSystemSettingId>0x0){var systemSetting=TriSysApex['Cache']['SystemSettingManager']['Get'](lSystemSettingId),sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20the\x20system\x20setting\x20'+systemSetting['Name']+'?',fnYes=function(){return setTimeout(function(){AdminConsole['DeleteSystemSetting'](systemSetting);},0xfa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20System\x20Setting','Yes',fnYes,'No');}},'DeleteSystemSetting':function(systemSetting){var CDeleteSystemSettingRequest={'SystemSetting':systemSetting},payloadObject={};payloadObject['URL']='SystemSetting/Delete',payloadObject['OutboundDataPacket']=CDeleteSystemSettingRequest,payloadObject['InboundDataFunction']=function(CDeleteSystemSettingResponse){TriSysApex['UI']['HideWait']();if(CDeleteSystemSettingResponse){if(CDeleteSystemSettingResponse['Success']){TriSysApex['Cache']['SystemSettingManager']['Set'](CDeleteSystemSettingResponse['SystemSettings']),AdminConsole['PopulateSystemSettingsGrid']();return;}else TriSysApex['UI']['ShowMessage'](CDeleteSystemSettingResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.DeleteSystemSetting:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20System\x20Setting...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'FieldDescriptions':{'ReadEntitiesFromWebAPI':function(fnCallback){var CEntitiesListRequest={},payloadObject={};payloadObject['URL']='Entities/List',payloadObject['OutboundDataPacket']=CEntitiesListRequest,payloadObject['InboundDataFunction']=function(CEntitiesListResponse){if(CEntitiesListResponse){if(CEntitiesListResponse['Success']){fnCallback(CEntitiesListResponse['Entities']);return;}else TriSysApex['UI']['ShowMessage'](CEntitiesListResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('AdminConsole.FieldDescriptions.ReadEntitiesFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'LoadEntityDescriptions':function(lstEntities){var sFieldID='adminConsoleForm-Entity',entities=[],selectedEntity=null;lstEntities['forEach'](function(entity){entities['push']({'text':entity['EntityName'],'value':entity['Description']});if(!selectedEntity)selectedEntity=entity;});var fnSelectEntity=function(sDescription,sEntity){$('#adminConsoleForm-EntityDescription')['html'](sDescription),AdminConsole['FieldDescriptions']['PopulateGrid'](sEntity);};TriSysSDK['CShowForm']['populateComboFromDataSource'](sFieldID,entities,0x0,fnSelectEntity),fnSelectEntity(selectedEntity['Description'],selectedEntity['EntityName']),TriSysSDK['FormMenus']['DrawGridMenu']('adminConsoleForm-FieldDescription-GridMenu',AdminConsole['FieldDescriptionsGridID']);},'RecacheAllStandingDataAfterUpdateOrDeletion':function(fnCallback){TriSysApex['UI']['ShowWait'](null,'Standing\x20data...');var fnCallbackAfterRecache=function(){TriSysApex['UI']['HideWait']();if(fnCallback)fnCallback();};TriSysApex['LoginCredentials']['CacheStandingData'](null,fnCallbackAfterRecache);},'UpdatedFieldDescription':function(fieldDescription,fnCallback){AdminConsole['FieldDescriptions']['RecacheAllStandingDataAfterUpdateOrDeletion'](fnCallback);return;var bAddedToCache=![],fieldDescriptions=TriSysApex['Cache']['FieldDescriptions']();for(var i=0x0;i<fieldDescriptions['length'];i++){var cachedFieldDescription=fieldDescriptions[i];if(fieldDescription['TableName']==cachedFieldDescription['TableName']&&fieldDescription['TableFieldName']==cachedFieldDescription['TableFieldName']){fieldDescriptions[i]=fieldDescription,bAddedToCache=!![];break;}}!bAddedToCache&&(fieldDescriptions['push'](fieldDescription),fieldDescriptions['sort'](function(a,b){var x=a['TableName']['toLowerCase']()+'_'+a['TableFieldName']['toLowerCase'](),y=b['TableName']['toLowerCase']()+'_'+b['TableFieldName']['toLowerCase']();return x<y?-0x1:x>y?0x1:0x0;})),TriSysApex['Cache']['cachedStandingDataInMemory']['FieldDescriptions']=fieldDescriptions;},'RemoveFieldDescription':function(lFieldId,fnCallback){AdminConsole['FieldDescriptions']['RecacheAllStandingDataAfterUpdateOrDeletion'](fnCallback);return;var bRemovedFromCache=![],fieldDescriptions=TriSysApex['Cache']['FieldDescriptions']();for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i];if(fieldDescription['FieldId']==lFieldId){fieldDescriptions['splice'](i,0x1),bRemovedFromCache=!![];break;}}if(bRemovedFromCache)TriSysApex['Cache']['cachedStandingDataInMemory']['FieldDescriptions']=fieldDescriptions;},'PopulateGrid':function(sEntity){var cachedFieldDescriptions=TriSysApex['Cache']['FieldDescriptions'](),fieldDescriptions=[];for(var i=0x0;i<cachedFieldDescriptions['length'];i++){var fieldDescription=cachedFieldDescriptions[i];fieldDescription['TableName']['indexOf'](sEntity)==0x0&&fieldDescriptions['push'](fieldDescription);}var fieldDescriptionsForGridArray=JSON['parse'](JSON['stringify'](fieldDescriptions)),sDivTag=AdminConsole['FieldDescriptionsGridID'],sGridName=sDivTag+'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sGridName,'Title':'Field\x20Descriptions','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':fieldDescriptionsForGridArray,'Columns':[{'field':'FieldId','title':'FieldId','type':'number','width':0x46,'hidden':!![]},{'field':'TableName','title':'TableName','type':'string'},{'field':'TableFieldName','title':'TableFieldName','type':'string'},{'field':'FieldTypeId','title':'FieldTypeId','type':'number','hidden':!![]},{'field':'FieldTypeName','title':'Field\x20Type','type':'string'},{'field':'Lookup','title':'Lookup','type':'string','template':'#\x20if(Lookup\x20==\x20\x22true\x22){#Yes#}else{#No#}\x20#'},{'field':'DefaultValue','title':'Default\x20Value','type':'string'},{'field':'Description','title':'Description','type':'string'}],'KeyColumnName':'FieldId','DrillDownFunction':function(rowData){AdminConsole['FieldDescriptions']['Open'](rowData['FieldId']);},'MultiRowSelect':!![],'Grouping':![]});},'GetSelectedSingletonFieldIdFromGrid':function(){var lFieldId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['FieldDescriptionsGridID'],'FieldId','field\x20description');return lFieldId;},'GetSelectedFieldFromGrid':function(sField){var sFieldValue=TriSysSDK['Grid']['GetSelectedSingletonRowFieldValueFromGrid'](AdminConsole['FieldDescriptionsGridID'],sField,'field\x20description');return sFieldValue;},'Open':function(lFieldId){if(TriSysAPI['Operators']['isEmpty'](lFieldId)){lFieldId=AdminConsole['FieldDescriptions']['GetSelectedSingletonFieldIdFromGrid']();if(!lFieldId||lFieldId<=0x0)return;}var sEntityName=TriSysSDK['CShowForm']['GetTextFromCombo']('adminConsoleForm-Entity'),parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lFieldId==0x0?'New':'Edit')+'\x20Field\x20Description',parametersObject['Image']='gi-wrench',parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlFieldDescription.html',parametersObject['OnLoadCallback']=function(){ctrlFieldDescription['Load'](lFieldId,sEntityName);},parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){var fnOnSave=function(fieldDescription){TriSysApex['UI']['CloseModalPopup'](),AdminConsole['FieldDescriptions']['UpdatedFieldDescription'](fieldDescription,function(){AdminConsole['FieldDescriptions']['PopulateGrid'](sEntityName);});};ctrlFieldDescription['SaveButtonClick'](fnOnSave);},TriSysApex['UI']['PopupMessage'](parametersObject);},'Delete':function(){lFieldId=AdminConsole['FieldDescriptions']['GetSelectedSingletonFieldIdFromGrid']();if(!lFieldId||lFieldId<=0x0)return;var sTable=AdminConsole['FieldDescriptions']['GetSelectedFieldFromGrid']('TableName');if(sTable['indexOf']('ConfigFields')<0x0){TriSysApex['UI']['ShowMessage']('You\x20are\x20not\x20permitted\x20to\x20remove\x20fixed\x20fields.');return;}var fnYes=function(){var CFieldDescriptionDeleteRequest={'FieldId':lFieldId},payloadObject={};return payloadObject['OutboundDataPacket']=CFieldDescriptionDeleteRequest,payloadObject['URL']='FieldDescription/Delete',payloadObject['InboundDataFunction']=function(CFieldDescriptionDeleteResponse){TriSysApex['UI']['HideWait']();if(CFieldDescriptionDeleteResponse){if(CFieldDescriptionDeleteResponse['Success']){AdminConsole['FieldDescriptions']['RemoveFieldDescription'](lFieldId,function(){AdminConsole['FieldDescriptions']['PopulateGrid'](sTable);});return;}else TriSysApex['UI']['ShowMessage'](CFieldDescriptionDeleteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.FieldDescriptions.Delete:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Field\x20Description...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];},sField=sTable+'.'+AdminConsole['FieldDescriptions']['GetSelectedFieldFromGrid']('TableFieldName'),sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20field\x20description:\x20<br\x20/><br\x20/>\x20&nbsp;\x20'+sField+'<br\x20/><br\x20/>'+'Warning:\x20All\x20data\x20held\x20in\x20this\x20field\x20will\x20also\x20be\x20deleted.';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Field\x20Description','Yes',fnYes,'No');},'EntityBuilder':function(){var sMessage='The\x20entity\x20builder\x20is\x20currently\x20in\x20development.'+'<br>Last\x20updated\x20January\x202023.';TriSysApex['UI']['ShowMessage'](sMessage);},'CustomEntityFields':function(){var sEntityName=TriSysSDK['CShowForm']['GetTextFromCombo']('adminConsoleForm-Entity'),sTitle=sEntityName+'\x20Form\x20Custom\x20Tab',sImage='gi\x20gi-cargo',fnOpenModalDialogue=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlEntityFormCustomTab.html'),parametersObject['OnLoadCallback']=function(){ctrlEntityFormCustomTab['Load'](sEntityName);};var sSaveText='Save';parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sSaveText,parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlEntityFormCustomTab['Save'](sEntityName);return bSaved;},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlEntityFormCustomTab.js',null,fnOpenModalDialogue);}},'RunSQLQuery':function(){var sSQL=$('#admin-console-sql-query')['val']();if(!sSQL)return;AdminConsole['CurrentSQLQuery']=sSQL,TriSysSDK['Database']['GetDataSet'](sSQL,AdminConsole['PopulateSQLGrid']);},'CurrentSQLQuery':null,'PopulateSQLGrid':function(CSQLDatabaseSearchResults){if(CSQLDatabaseSearchResults){if(CSQLDatabaseSearchResults['DataTable']){var searchColumns=CSQLDatabaseSearchResults['Columns'];if(searchColumns){var columns=[];for(var i=0x0;i<searchColumns['length'];i++){var searchColumn=searchColumns[i],column={'field':searchColumn,'title':searchColumn,'type':'string'};columns['push'](column);}var sGridName=AdminConsole['SQLManagerGridID']-'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['SQLManagerGridID'],'ID':sGridName,'Title':'SQL\x20Manager','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'SQL':AdminConsole['CurrentSQLQuery'],'Columns':columns,'MultiRowSelect':![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![]});}}else TriSysApex['UI']['errorAlert'](CSQLDatabaseSearchResults['ErrorMessage']);}},'DocumentManager':{'LoadFolders':function(){AdminConsole['DocumentManager']['PopulateFolders'](),TriSysSDK['FormMenus']['DrawGridMenu']('adminConsoleForm-DocumentGridMenu',AdminConsole['DocumentGridID']),setTimeout(TriSysProUI['kendoUI_Overrides'],0x1f4);},'PopulateFolders':function(){var payloadObject={};payloadObject['URL']='Files/DocumentManagerFolders',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(CDocumentManagerFoldersResponse){if(CDocumentManagerFoldersResponse){if(CDocumentManagerFoldersResponse['Success']){AdminConsole['DocumentManager']['DisplayFolders'](CDocumentManagerFoldersResponse['Folders']);return;}else TriSysApex['UI']['ShowMessage'](CDocumentManagerFoldersResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('AdminConsole.DocumentManager.PopulateFolders:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayFolders':function(folders){var sDivTag='adminConsoleForm-FolderGrid',sGridName=sDivTag+'-GridInstance',fnRowClickHandler=function(e,gridObject,gridLayout){var selectedItem=TriSysSDK['Grid']['GetFirstGridCheckedItem'](gridObject);if(selectedItem){var sFolder=selectedItem['FolderName'];$('#adminConsoleForm-SelectedFolder')['html'](sFolder),AdminConsole['DocumentManager']['PopulateFiles'](sFolder);}},foldersDataSource=[];for(var i=0x0;i<folders['length'];i++){var sFolder=folders[i];foldersDataSource['push']({'FolderName':sFolder});}TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sGridName,'Title':'Folders','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':foldersDataSource,'Columns':[{'field':'FolderName','title':'Folder\x20Name','type':'string'}],'DrillDownFunction':null,'MultiRowSelect':![],'SingleRowSelect':!![],'RowClickHandler':fnRowClickHandler,'Grouping':![],'PageSelector':![],'PageSizeSelector':![]});try{var grid=$('#'+sDivTag)['data']('kendoGrid');grid['select'](0x1);}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}AdminConsole['DocumentManager']['DragAndDropFileHandler']();},'PopulateFiles':function(sFolder){var payloadObject={};payloadObject['URL']='Files/DocumentManagerFiles';var CDocumentManagerFilesRequest={'Folder':sFolder};payloadObject['OutboundDataPacket']=CDocumentManagerFilesRequest,payloadObject['InboundDataFunction']=function(CDocumentManagerFilesResponse){if(CDocumentManagerFilesResponse){if(CDocumentManagerFilesResponse['Success']){AdminConsole['DocumentManager']['DisplayFiles'](CDocumentManagerFilesResponse['Files']);return;}else TriSysApex['UI']['ShowMessage'](CDocumentManagerFilesResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('AdminConsole.DocumentManager.PopulateFiles:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayFiles':function(files){if(!files)files=[];var columns=[{'field':'FullPath','title':'Full\x20Path','type':'string','hidden':!![]},{'field':'Name','title':'Document','type':'string'},{'field':'DateModified','title':'Date\x20Last\x20Modified','type':'date','format':'{0:dd\x20MMM\x20yyyy}','width':0x82},{'field':'Size','title':'Size','type':'string','width':0x82}];TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['DocumentGridID'],'ID':AdminConsole['DocumentGridID']+'grd','Title':'Documents','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':files,'Columns':columns,'MobileVisibleColumns':[{'field':'FullPath'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20FullPath\x20#</strong><br\x20/>'+'<i>#:\x20DateModified\x20#</i></td>','KeyColumnName':'FullPath','DrillDownFunction':function(rowData){AdminConsole['DocumentManager']['OpenDocument'](rowData['FullPath'],rowData['Name']);},'MultiRowSelect':!![],'Grouping':![],'ColumnFilters':![],'OpenButtonCaption':'Open','HyperlinkedColumns':['Name']});},'OpenDocument':function(sURL,sName){var sTitle='Document\x20Manager';if(TriSysSDK['Controls']['FileManager']['isHTMLFile'](sURL)){var fnAfterSave=function(){var sFolder=AdminConsole['DocumentManager']['GetFolderPath']();AdminConsole['DocumentManager']['PopulateFiles'](sFolder);};TriSysSDK['Controls']['FileManager']['OpenHTMLEditor'](sTitle,sURL,sName,fnAfterSave);}else TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](sURL);},'DragAndDropFileHandler':function(){var obj=$('#'+AdminConsole['DocumentGridID']);obj['on']('dragenter',function(e){e['stopPropagation'](),e['preventDefault']();}),obj['on']('dragover',function(e){e['stopPropagation'](),e['preventDefault']();}),obj['on']('drop',function(e){e['preventDefault']();var fileCollection=e['originalEvent']['dataTransfer']['files'],multipleUploadFiles=[];for(var i=0x0;i<fileCollection['length'];i++){multipleUploadFiles['push'](fileCollection[i]);}AdminConsole['DocumentManager']['UploadFiles'](multipleUploadFiles);});},'GetFolderPath':function(){var sFolder=$('#adminConsoleForm-SelectedFolder')['html']();return sFolder;},'UploadFiles':function(uploadFiles){if(!uploadFiles)return![];if(uploadFiles['length']==0x0)return![];var nextFile=uploadFiles[0x0],fnCallback=function(myFile){AdminConsole['DocumentManager']['UploadDocument'](myFile,uploadFiles);};return TriSysSDK['Controls']['FileManager']['UploadFile'](nextFile,fnCallback),uploadFiles['splice'](0x0,0x1),!![];},'Add':function(){TriSysSDK['Controls']['FileManager']['FindFileUpload']('Upload\x20Document',AdminConsole['DocumentManager']['UploadDocument']);},'UploadDocument':function(sFilePath,uploadFiles){var payloadObject={};payloadObject['URL']='Files/MoveUploadedFileReferenceDocument';var sFolder=AdminConsole['DocumentManager']['GetFolderPath']();payloadObject['OutboundDataPacket']={'UploadedFilePath':sFilePath,'SubFolder':sFolder},payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var JSONdataset=data;if(JSONdataset){if(JSONdataset['Success']){var sFilePath=JSONdataset['FolderFilePath'];AdminConsole['DocumentManager']['PopulateFiles'](sFolder);if(uploadFiles)AdminConsole['DocumentManager']['UploadFiles'](uploadFiles);}else TriSysApex['UI']['errorAlert'](JSONdataset['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('AdminConsole.DocumentManager.UploadDocument:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Uploading\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'Remove':function(){var lstFiles=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](AdminConsole['DocumentGridID'],'FullPath');if(lstFiles&&lstFiles['length']>0x0){var sFileList='';for(var i=0x0;i<lstFiles['length'];i++){var sFilePath=lstFiles[i],sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);if(sFileList['length']>0x0)sFileList+='<br\x20/>';sFileList+=sName;}var trailingS=lstFiles['length']==0x1?'':'s',sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20remove\x20the\x20following\x20file'+trailingS+'?'+'<br\x20/><br\x20/>'+sFileList;TriSysApex['UI']['questionYesNo'](sMessage,'Remove\x20Document'+trailingS,'Yes',function(){return AdminConsole['DocumentManager']['RemoveFilesAfterConfirmation'](lstFiles),!![];},'No');}else TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20documents.');},'RemoveFilesAfterConfirmation':function(lstFiles){for(var i=0x0;i<lstFiles['length'];i++){var sFilePath=lstFiles[i];AdminConsole['DocumentManager']['DeleteFile'](sFilePath);}},'DeleteFile':function(sFilePath){var payloadObject={};payloadObject['URL']='Files/DeleteFile';var CDeleteFileRequest={'FilePath':sFilePath};payloadObject['OutboundDataPacket']=CDeleteFileRequest,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CDeleteFileResponse=data;if(CDeleteFileResponse){if(CDeleteFileResponse['Success']){var sFolder=AdminConsole['DocumentManager']['GetFolderPath']();AdminConsole['DocumentManager']['PopulateFiles'](sFolder);}else TriSysApex['UI']['errorAlert'](CDeleteFileResponse['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('AdminConsole.DocumentManager.DeleteFile:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Deleting\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'InvalidCVPaths':{'LoadContacts':function(){var payloadObject={};payloadObject['URL']='ContactCV/InvalidCVFilePaths',payloadObject['InboundDataFunction']=function(CInvalidCVFilePathsResponse){TriSysApex['UI']['HideWait']();if(CInvalidCVFilePathsResponse){if(CInvalidCVFilePathsResponse['Success']){AdminConsole['InvalidCVPaths']['DisplayContactAndFileGrid'](CInvalidCVFilePathsResponse['Contacts']);return;}else TriSysApex['UI']['ShowMessage'](CInvalidCVFilePathsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.InvalidCVPaths.LoadContacts:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Checking\x20CV\x27s...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayContactAndFileGrid':function(contacts){if(!contacts)contacts=[];var columns=[{'field':'ContactId','title':'ID','type':'number','hidden':!![]},{'field':'FullName','title':'Candidate\x20Name','type':'string'},{'field':'CVFileRef','title':'CVFileRef','type':'string'},{'field':'FormattedCVFileRef1','title':'FormattedCVFileRef1','type':'string'},{'field':'FormattedCVFileRef2','title':'FormattedCVFileRef2','type':'string'},{'field':'FormattedCVFileRef3','title':'FormattedCVFileRef3','type':'string'},{'field':'FormattedCVFileRef4','title':'FormattedCVFileRef4','type':'string'}];TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['InvalidCVPathGridID'],'ID':AdminConsole['InvalidCVPathGridID']+'grd','Title':'Invalid\x20CV','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':contacts,'Columns':columns,'KeyColumnName':'ContactId','DrillDownFunction':function(rowData){TriSysApex['FormsManager']['OpenForm']('Contact',rowData['ContactId']);},'MultiRowSelect':!![],'Grouping':![],'ColumnFilters':![],'OpenButtonCaption':'Open'});}},'_LoadedPerformanceTargetSubsystem':![],'LoadPerformanceTargetSubsystem':function(){if(AdminConsole['_LoadedPerformanceTargetSubsystem']){if(AdminConsole['arePerformanceTargetsShownByUser']()){var lUserId=TriSysSDK['CShowForm']['GetValueFromCombo'](AdminConsole['PerformanceTargetComboUserID']);AdminConsole['PopulatePerformanceTargetsGridForUser'](lUserId);}else{var sTargetAndPeriodValueJSON=TriSysSDK['CShowForm']['GetValueFromCombo'](AdminConsole['PerformanceTargetComboID']),CPerformanceTargetsGridSQLRequest=JSON['parse'](sTargetAndPeriodValueJSON);AdminConsole['PopulatePerformanceTargetsGrid'](CPerformanceTargetsGridSQLRequest['PerformanceTargetId'],CPerformanceTargetsGridSQLRequest['PerformanceTargetPeriodId']);}return;}AdminConsole['_LoadedPerformanceTargetSubsystem']=!![],$('#adminConsoleForm-PerformanceTargetByUser')['click'](function(){var bShowUsersInCombo=$(this)['is'](':checked');bShowUsersInCombo?($('#adminConsoleForm-PerformanceTargetCombo-ByTarget')['hide'](),$('#adminConsoleForm-PerformanceTargetCombo-ByUser')['show']()):($('#adminConsoleForm-PerformanceTargetCombo-ByTarget')['show'](),$('#adminConsoleForm-PerformanceTargetCombo-ByUser')['hide']()),AdminConsole['LoadPerformanceTargetSubsystem']();}),AdminConsole['LoadPerformanceTargetCombo']();var fnSelectUser=function(lUserId,sUserName){AdminConsole['PopulatePerformanceTargetsGridForUser'](lUserId);};TriSysSDK['CShowForm']['UserCombo'](AdminConsole['PerformanceTargetComboUserID'],fnSelectUser);},'arePerformanceTargetsShownByUser':function(){var bChecked=TriSysSDK['CShowForm']['GetCheckBoxValue']('adminConsoleForm-PerformanceTargetByUser');return bChecked;},'LoadPerformanceTargetCombo':function(sTargetMetricByPeriod){var payloadObject={};payloadObject['URL']='PerformanceTargets/TargetList',payloadObject['InboundDataFunction']=function(CPerformanceTargetListResponse){TriSysApex['UI']['HideWait']();if(CPerformanceTargetListResponse){if(CPerformanceTargetListResponse['Success']){var fnSelectTarget=function(sTargetAndPeriodJSONstring,sTargetNameByPeriod){var targetAndPeriod=JSON['parse'](sTargetAndPeriodJSONstring),lPerformanceTargetId=targetAndPeriod['PerformanceTargetId'],lPerformanceTargetPeriodId=targetAndPeriod['PerformanceTargetPeriodId'];AdminConsole['PopulatePerformanceTargetsGrid'](lPerformanceTargetId,lPerformanceTargetPeriodId);},targets=[],firstTarget=null;for(var i=0x0;i<CPerformanceTargetListResponse['TargetList']['length'];i++){var target=CPerformanceTargetListResponse['TargetList'][i],targetAndPeriod={'PerformanceTargetId':target['PerformanceTargetId'],'PerformanceTargetPeriodId':target['PerformanceTargetPeriodId']},sTargetAndPeriodJSONstring=JSON['stringify'](targetAndPeriod),targetItem={'value':sTargetAndPeriodJSONstring,'text':target['TargetNameByPeriod']};targets['push'](targetItem);if(!firstTarget)firstTarget=targetItem;}TriSysSDK['CShowForm']['populateComboFromDataSource'](AdminConsole['PerformanceTargetComboID'],targets,null,fnSelectTarget);if(firstTarget)fnSelectTarget(firstTarget['value'],firstTarget['text']);}else TriSysApex['UI']['ShowError'](CPerformanceTargetListResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.LoadPerformanceTargetCombo:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Populating\x20Targets...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PopulatePerformanceTargetsGrid':function(lPerformanceTargetId,lPerformanceTargetPeriodId){var fnPopulationByFunction={'API':'PerformanceTargets/List','Parameters':function(request){request['PerformanceTargetId']=lPerformanceTargetId,request['PerformanceTargetPeriodId']=lPerformanceTargetPeriodId;},'DataTableFunction':function(response){return response['List'];}};AdminConsole['PopulatePerformanceTargetsGridByFunction'](fnPopulationByFunction);},'PopulatePerformanceTargetsGridByFunction':function(fnPopulationByFunction,bByUser){var sGridName=AdminConsole['PerformanceTargetsGridID']-'-GridInstance',nameColumn=bByUser?{'field':'TargetPeriod','title':'Target','type':'string'}:{'field':'Name','title':'User','type':'string'};TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['PerformanceTargetsGridID'],'ID':sGridName,'Title':'Performance\x20Targets','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':[{'field':'UserId','title':'UserId','type':'number','width':0x46,'hidden':!![]},{'field':'PerformanceTargetId','title':'PerformanceTargetId','type':'number','width':0x46,'hidden':!![]},{'field':'PerformanceTargetUserId','title':'PerformanceTargetUserId','type':'number','width':0x46,'hidden':!![]},{'field':'PerformanceTargetPeriodId','title':'PerformanceTargetPeriodId','type':'number','width':0x46,'hidden':!![]},nameColumn,{'field':'TargetValue','title':'Value','type':'string'},{'field':'StartDate','title':'Start','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'EndDate','title':'End','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'}],'KeyColumnName':'UserId','DrillDownFunction':function(rowData){AdminConsole['EditPerformanceTargetDialogue'](rowData['UserId'],rowData['PerformanceTargetId'],rowData['PerformanceTargetUserId'],rowData['PerformanceTargetPeriodId']);},'MultiRowSelect':!![],'Grouping':![],'ColumnFilters':!![],'OpenButtonCaption':'Open'});},'PopulatePerformanceTargetsGridForUser':function(lUserId){var fnPopulationByFunction={'API':'PerformanceTargets/List','Parameters':function(request){request['UserId']=lUserId;},'DataTableFunction':function(response){return response['List'];}};AdminConsole['PopulatePerformanceTargetsGridByFunction'](fnPopulationByFunction,!![]);},'EditPerformanceTargetDialogue':function(lUserId,lPerformanceTargetId,lPerformanceTargetUserId,lPerformanceTargetPeriodId,bClone){var sTargetAndPeriod=TriSysSDK['CShowForm']['GetTextFromCombo'](AdminConsole['PerformanceTargetComboID']),sUserName=TriSysApex['Cache']['UsersManager']['FullName'](lUserId),targetDialogueData={'TargetAndPeriod':sTargetAndPeriod,'UserName':sUserName,'UserId':lUserId,'PerformanceTargetId':lPerformanceTargetId,'PerformanceTargetUserId':lPerformanceTargetUserId,'PerformanceTargetPeriodId':lPerformanceTargetPeriodId,'Clone':bClone},parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Edit\x20User\x20Performance\x20Target',parametersObject['Image']='gi-money',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlUserPerformanceTarget.html',parametersObject['OnLoadCallback']=function(){ctrlUserPerformanceTarget['Load'](targetDialogueData);},parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){var fnOnSave=function(){TriSysApex['UI']['CloseModalPopup'](),AdminConsole['LoadPerformanceTargetSubsystem']();};ctrlUserPerformanceTarget['SaveButtonClick'](targetDialogueData,fnOnSave);},TriSysApex['UI']['PopupMessage'](parametersObject);},'AddTargetMetric':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Add\x20Performance\x20Target\x20Metric',parametersObject['Image']='gi-money',parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlAddPerformanceTarget.html',parametersObject['OnLoadCallback']=function(){ctrlAddPerformanceTarget['Load']();},parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){var fnOnSave=function(sTargetName,lPeriodId){TriSysApex['UI']['CloseModalPopup'](),AdminConsole['LoadPerformanceTargetSubsystem']();};ctrlAddPerformanceTarget['SaveButtonClick'](fnOnSave);},TriSysApex['UI']['PopupMessage'](parametersObject);},'DeleteTargetMetric':function(){var sTargetAndPeriod=TriSysSDK['CShowForm']['GetTextFromCombo'](AdminConsole['PerformanceTargetComboID']),sTargetAndPeriodValueJSON=TriSysSDK['CShowForm']['GetValueFromCombo'](AdminConsole['PerformanceTargetComboID']),CPerformanceTargetsGridSQLRequest=JSON['parse'](sTargetAndPeriodValueJSON),fnDeleteConfirmed=function(){return AdminConsole['DeleteTargetMetricViaWebAPI'](CPerformanceTargetsGridSQLRequest),!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20target\x20metric\x20\x27'+sTargetAndPeriod+'\x27?'+'<br\x20/>'+'Note\x20that\x20all\x20user\x20targets\x20for\x20this\x20metric\x20will\x20also\x20be\x20deleted.';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20Target\x20Metric','Yes',fnDeleteConfirmed,'No');},'DeleteTargetMetricViaWebAPI':function(CPerformanceTargetsDeleteMetricRequest){var payloadObject={};payloadObject['URL']='PerformanceTargets/DeleteTargetMetric',payloadObject['OutboundDataPacket']=CPerformanceTargetsDeleteMetricRequest,payloadObject['InboundDataFunction']=function(CPerformanceTargetsDeleteMetricResponse){TriSysApex['UI']['HideWait']();if(CPerformanceTargetsDeleteMetricResponse){if(CPerformanceTargetsDeleteMetricResponse['Success'])AdminConsole['LoadPerformanceTargetSubsystem']();else TriSysApex['UI']['ShowMessage'](CPerformanceTargetsDeleteMetricResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.DeleteTargetMetricViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Target\x20Metric...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'EditTarget':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'UserId','user\x20target'),lPerformanceTargetId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetId','target',![]),lPerformanceTargetUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetUserId','user\x20target',![]),lPerformanceTargetPeriodId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetPeriodId','target\x20period',![]);lUserId>0x0&&lPerformanceTargetId>0x0&&AdminConsole['EditPerformanceTargetDialogue'](lUserId,lPerformanceTargetId,lPerformanceTargetUserId,lPerformanceTargetPeriodId);},'AddTarget':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'UserId','user\x20target'),lPerformanceTargetId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetId','target',![]),lPerformanceTargetUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetUserId','user\x20target',![]),lPerformanceTargetPeriodId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetPeriodId','target\x20period',![]);lPerformanceTargetUserId>0x0?AdminConsole['EditPerformanceTargetDialogue'](lUserId,lPerformanceTargetId,lPerformanceTargetUserId,lPerformanceTargetPeriodId,!![]):AdminConsole['EditTarget']();},'DeleteTarget':function(){var lUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'UserId','user\x20target'),lPerformanceTargetId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetId','target',![]),lPerformanceTargetUserId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetUserId','user\x20target',![]),lPerformanceTargetPeriodId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](AdminConsole['PerformanceTargetsGridID'],'PerformanceTargetPeriodId','target\x20period',![]);if(lPerformanceTargetPeriodId>0x0){var CPerformanceTargetForUserDeleteRequest={'PerformanceTargetUserId':lPerformanceTargetUserId},payloadObject={};payloadObject['URL']='PerformanceTargets/DeleteUserTarget',payloadObject['OutboundDataPacket']=CPerformanceTargetForUserDeleteRequest,payloadObject['InboundDataFunction']=function(CPerformanceTargetForUserDeleteResponse){TriSysApex['UI']['HideWait']();if(CPerformanceTargetForUserDeleteResponse){if(CPerformanceTargetForUserDeleteResponse['Success'])TriSysApex['UI']['CloseModalPopup'](),AdminConsole['PopulatePerformanceTargetsGrid'](lPerformanceTargetId,lPerformanceTargetPeriodId);else TriSysApex['UI']['ShowError'](CPerformanceTargetForUserDeleteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.DeleteTarget:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Target...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'StyleManager':{'Load':function(){var bAllowed=TriSysApex['Pages']['Controller']['isDesigner']();if(bAllowed){var fnUploadCallback=function(sOperation,divTag,sFilePath,sDestinationFilePath){AdminConsole['StyleManager']['MoveAppFile'](sFilePath,sDestinationFilePath,'Please\x20Ctrl-F5\x20to\x20refresh\x20the\x20application\x20and\x20load\x20this\x20new\x20theme.');};TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-lightning',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/lightning.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-thunder',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/thunder.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-jasper',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/jasper.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-whistler',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/whistler.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-stratus',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/stratus.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-cumulus',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/cumulus.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-nimbus',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/nimbus.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-cirrus',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/cirrus.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-northernlights',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/northernlights.css');}),TriSysSDK['Controls']['FileReference']['Load']('admin-console-css-file-crimson',null,function(sOperation,divTag,sFilePath){fnUploadCallback(sOperation,divTag,sFilePath,'css/themes/crimson.css');});}},'MoveAppFile':function(sSourceFilePath,sDestinationFilePath,sSuccessInstructions){var CReplaceProductionFileRequest={'SourceFilePath':sSourceFilePath,'DestinationFilePath':sDestinationFilePath};TriSysApex['UI']['ShowWait'](null,'Uploading...');var payloadObject={};payloadObject['URL']='DeveloperStudio/ReplaceProductionFile',payloadObject['OutboundDataPacket']=CReplaceProductionFileRequest,payloadObject['InboundDataFunction']=function(CReplaceProductionFileResponse){TriSysApex['UI']['HideWait']();if(CReplaceProductionFileResponse){if(CReplaceProductionFileResponse['Success']){var sMessage='You\x20have\x20uploaded\x20and\x20replaced\x20'+sDestinationFilePath+'<br\x20/>'+sSuccessInstructions;TriSysApex['UI']['ShowMessage'](sMessage,TriSysWebJobs['Constants']['ApplicationName']);}else TriSysApex['UI']['errorAlert'](CReplaceProductionFileResponse['ErrorMessage'],TriSysWebJobs['Constants']['ApplicationName']);}else TriSysApex['UI']['ShowMessage']('No\x20response\x20from\x20'+payloadObject['URL'],TriSysWebJobs['Constants']['ApplicationName']);return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('AdminConsole.StyleManager.MoveAppFile:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'Security':{'Load':function(){AdminConsole['GenericFunctions']['PopulateUserGridFromFunction']({'GridID':'admin-console-security-UserGrid','SelectedUserFunction':AdminConsole['Security']['SelectedUser']}),AdminConsole['Security']['LoadObjects']();},'LoadObjects':function(){var iFudgeFactor=0x1a8,lHeight=$(window)['height']()-iFudgeFactor,objects=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Objects']();if(!objects)return;var securityItems=objects['SecurityItems'];if(!securityItems)return;var propertySheetData={'title':'Security\x20Permissions','propertyColumnName':'Function','valueColumnName':'Permission','height':lHeight,'objectList':securityItems,'fieldValueChange':AdminConsole['Security']['FieldValueChange']};TriSysApex['PropertySheet']['Draw']('admin-console-security-PropertySheet',propertySheetData);},'FieldValueChange':function(sCategory,sName,objValue){var lCurrentUserId=AdminConsole['Security']['_SelectedUserRecord']['UserId'],securityItem=AdminConsole['Security']['GetObjectFromCategoryAndName'](sCategory,sName);if(securityItem&&lCurrentUserId>0x0){TriSysApex['UserOptions']['WriteSetting'](lCurrentUserId,securityItem,objValue);if(securityItem['DOMidList']&&securityItem['DOMidList']['length']>0x0){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var user=userCredentials['LoggedInUser'];if(lCurrentUserId==user['UserId'])switch(securityItem['Type']){case'Boolean':$['each'](securityItem['DOMidList'],function(index,item){var bShow=objValue,elem=$('#'+item);bShow?elem['show']():elem['hide']();});break;}}}}},'GetObjectFromCategoryAndName':function(sCategory,sName){var objects=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Objects']();if(objects){var securityItems=objects['SecurityItems'];if(securityItems)for(var i=0x0;i<securityItems['length'];i++){var securityItem=securityItems[i];if(securityItem['Category']==sCategory&&securityItem['Name']==sName)return securityItem;}}},'CopyUserPermissions':function(){if(AdminConsole['Security']['_SelectedUserRecord']['UserId']>0x0){var sSelectedUser=JSON['stringify'](AdminConsole['Security']['_SelectedUserRecord']);AdminConsole['Security']['_CopiedUserRecord']=JSON['parse'](sSelectedUser);}},'PasteUserPermissions':function(){if(!AdminConsole['Security']['_CopiedUserRecord']){TriSysApex['UI']['ShowMessage']('Copy\x20an\x20existing\x20users\x27\x20permissions\x20before\x20pasting\x20into\x20anothers.');return;}if(AdminConsole['Security']['_CopiedUserRecord']['UserId']==AdminConsole['Security']['_SelectedUserRecord']['UserId']){TriSysApex['UI']['ShowMessage']('You\x20have\x20copied\x20\x27'+AdminConsole['Security']['_CopiedUserRecord']['Name']+'\x27\x20permissions,\x20so\x20cannot\x20paste\x20them\x20back\x20to\x20itself.');return;}AdminConsole['Security']['CloneUserSettings'](AdminConsole['Security']['_CopiedUserRecord']['UserId'],AdminConsole['Security']['_SelectedUserRecord']['UserId'],AdminConsole['Security']['_SelectedUserRecord']['Name']);},'ResetUserPermissions':function(){AdminConsole['Security']['_SelectedUserRecord']['UserId']>0x0&&AdminConsole['Security']['DeleteUserPermissions'](AdminConsole['Security']['_SelectedUserRecord']['UserId'],AdminConsole['Security']['_SelectedUserRecord']['Name']);},'SelectedUser':function(lUserId,sName){AdminConsole['Security']['_SelectedUserRecord']['UserId']=lUserId,AdminConsole['Security']['_SelectedUserRecord']['Name']=sName;var fnDisplayValues=function(serverSettings){var objects=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Objects']();AdminConsole['GenericFunctions']['UpdatePropertySheetValues'](objects['SecurityItems'],serverSettings,'admin-console-security-PropertySheet');};AdminConsole['Security']['ReadSettings'](lUserId,fnDisplayValues,![]);},'_SelectedUserRecord':{'UserId':0x0,'Name':null},'_CopiedUserRecord':null,'ReadSettings':function(lUserId,fnCallback,bShowWait){var CReadUserSettingsRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='User/ReadSettings',payloadObject['OutboundDataPacket']=CReadUserSettingsRequest,payloadObject['InboundDataFunction']=function(CReadUserSettingsResponse){if(bShowWait)TriSysApex['UI']['HideWait']();if(CReadUserSettingsResponse){if(CReadUserSettingsResponse['Success'])fnCallback(CReadUserSettingsResponse['Settings']);else TriSysApex['UI']['ShowError'](CReadUserSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(bShowWait)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('AdminConsole.Security.ReadSettings:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(bShowWait)TriSysApex['UI']['ShowWait'](null,'Reading\x20User\x20Permissions...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'CloneUserSettings':function(lSourceUserId,lDestinationUserId,sDestinationUserName){var CCloneUserSettingsRequest={'SourceUserId':lSourceUserId,'DestinationUserId':lDestinationUserId},payloadObject={};payloadObject['URL']='User/CloneSettings',payloadObject['OutboundDataPacket']=CCloneUserSettingsRequest,payloadObject['InboundDataFunction']=function(CCloneUserSettingsResponse){if(CCloneUserSettingsResponse){if(CCloneUserSettingsResponse['Success'])AdminConsole['Security']['SelectedUser'](lDestinationUserId,sDestinationUserName);else TriSysApex['UI']['ShowError'](CCloneUserSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('AdminConsole.Security.CloneUserSettings:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteUserPermissions':function(lUserId,sName){var CDeleteUserSettingsRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='User/DeleteSettings',payloadObject['OutboundDataPacket']=CDeleteUserSettingsRequest,payloadObject['InboundDataFunction']=function(CDeleteUserSettingsResponse){if(CDeleteUserSettingsResponse){if(CDeleteUserSettingsResponse['Success'])AdminConsole['Security']['SelectedUser'](lUserId,sName);else TriSysApex['UI']['ShowError'](CDeleteUserSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('AdminConsole.Security.DeleteUserPermissions:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'UserSettings':{'Load':function(){var fnLoadPropertySheetAndUsers=function(){AdminConsole['GenericFunctions']['PopulateUserGridFromFunction']({'GridID':'admin-console-user-settings-UserGrid','SelectedUserFunction':AdminConsole['UserSettings']['SelectedUser']}),AdminConsole['UserSettings']['LoadObjects']();};AdminConsole['UserSettings']['ReadAllUsrCfgUserSettingsFromWebAPI'](fnLoadPropertySheetAndUsers);},'ReadAllUsrCfgUserSettingsFromWebAPI':function(fnCallback){var payloadObject={};payloadObject['URL']='Users/UsrCfgSettings',payloadObject['InboundDataFunction']=function(CUserSettingsResponse){TriSysApex['UI']['HideWait']();if(CUserSettingsResponse){if(CUserSettingsResponse['Success'])AdminConsole['UserSettings']['UsrCfgUsersSettings']=CUserSettingsResponse['Settings'],fnCallback();else TriSysApex['UI']['ShowError'](CUserSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.UserSettings.ReadAllUsrCfgUserSettingsFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20User\x20Settings...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'UsrCfgUsersSettings':null,'PropertySheetData':null,'LoadObjects':function(){var iFudgeFactor=0x1a8,lHeight=$(window)['height']()-iFudgeFactor,objects=AdminConsole['UserSettings']['UsrCfgUsersSettings'];if(!objects)return;var propertySheetData=[];objects['forEach'](function(item){var objDefault='',sType='TextBox';switch(item['FType']){case'B':sType='Boolean',objDefault=![];break;case'I':sType='Integer',objDefault=0x0;break;}var propertySheetItem={'Category':'Setting','Description':[item['FName']],'Name':item['FName'],'Title':item['FName'],'Type':sType,'Default':objDefault};propertySheetData['push'](propertySheetItem);}),AdminConsole['UserSettings']['PropertySheetData']=propertySheetData;var propertySheetData={'title':'User\x20Settings','propertyColumnName':'Setting','valueColumnName':'Value','categoryColumnHide':!![],'descriptionColumnHide':!![],'height':lHeight,'objectList':propertySheetData,'fieldValueChange':AdminConsole['UserSettings']['FieldValueChange']};TriSysApex['PropertySheet']['Draw']('admin-console-user-settings-PropertySheet',propertySheetData);},'FieldValueChange':function(sCategory,sName,objValue){var lUserId=AdminConsole['UserSettings']['_SelectedUserRecord']['UserId'],item=AdminConsole['UserSettings']['GetObjectFromCategoryAndName'](sCategory,sName);if(lUserId<=0x0||!item)return;var sType='S';switch(item['Type']){case'Boolean':sType='B';break;case'Integer':sType='I';break;}var CUsrCfgSettingValue={'Category':item['Category'],'Name':item['Name'],'Value':objValue,'Type':sType},CWriteUsrCfgSetting={'UserId':lUserId,'Setting':CUsrCfgSettingValue},payloadObject={};payloadObject['URL']='User/WriteUsrCfgSetting',payloadObject['OutboundDataPacket']=CWriteUsrCfgSetting,payloadObject['InboundDataFunction']=function(data){return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('AdminConsole.UserSettings.FieldValueChange:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'GetObjectFromCategoryAndName':function(sCategory,sName){if(AdminConsole['UserSettings']['PropertySheetData']){var foundItem=null;return AdminConsole['UserSettings']['PropertySheetData']['forEach'](function(item){if(item['Category']==sCategory&&item['Name']==sName)foundItem=item;}),foundItem;}},'SelectedUser':function(lUserId,sName){AdminConsole['UserSettings']['_SelectedUserRecord']['UserId']=lUserId,AdminConsole['UserSettings']['_SelectedUserRecord']['Name']=sName;var fnDisplayValues=function(serverSettings){var objects=AdminConsole['UserSettings']['PropertySheetData'];AdminConsole['GenericFunctions']['UpdatePropertySheetValues'](objects,serverSettings,'admin-console-user-settings-PropertySheet');};AdminConsole['UserSettings']['ReadSettings'](lUserId,fnDisplayValues,![]);},'_SelectedUserRecord':{'UserId':0x0,'Name':null},'_CopiedUserRecord':null,'ReadSettings':function(lUserId,fnCallback,bShowWait){var CReadUsrCfgSettingsRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='User/ReadUsrCfgSettings',payloadObject['OutboundDataPacket']=CReadUsrCfgSettingsRequest,payloadObject['InboundDataFunction']=function(CReadUsrCfgSettingsResponse){if(bShowWait)TriSysApex['UI']['HideWait']();if(CReadUsrCfgSettingsResponse){if(CReadUsrCfgSettingsResponse['Success'])fnCallback(CReadUsrCfgSettingsResponse['Settings']);else TriSysApex['UI']['ShowError'](CReadUsrCfgSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(bShowWait)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('AdminConsole.UserSettings.ReadSettings:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(bShowWait)TriSysApex['UI']['ShowWait'](null,'Reading\x20User\x20Settings...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'NewSetting':function(){var fnNewSetting=function(sNewName,sType){return AdminConsole['UserSettings']['CreateNewSettingViaWebAPI'](sNewName,sType),!![];},sMessage='New\x20User\x20Setting',options={'TextLabel':'Name','ComboLabel':'Type','ComboList':['B','I','S'],'ComboSelectedItem':'S'};TriSysApex['ModalDialogue']['NewWithCombo']['Popup'](sMessage,'gi-settings',fnNewSetting,options);},'CreateNewSettingViaWebAPI':function(sName,sType){var CNewUsrCfgSettingRequest={'Name':sName,'Type':sType},payloadObject={};payloadObject['URL']='User/NewUsrCfgSetting',payloadObject['OutboundDataPacket']=CNewUsrCfgSettingRequest,payloadObject['InboundDataFunction']=function(CNewUsrCfgSettingResponse){TriSysApex['UI']['HideWait']();if(CNewUsrCfgSettingResponse){if(CNewUsrCfgSettingResponse['Success']){var elem=$('#admin-console-user-settings-PropertySheet-ctrlPropertySheet-Root');elem['empty'](),elem['replaceWith']('<div\x20id=\x22admin-console-user-settings-PropertySheet\x22></div>');var fnAfterRedrawingPropertySheet=function(){AdminConsole['UserSettings']['LoadObjects'](),AdminConsole['UserSettings']['SelectedUser'](AdminConsole['UserSettings']['_SelectedUserRecord']['UserId'],AdminConsole['UserSettings']['_SelectedUserRecord']['Name']);};AdminConsole['UserSettings']['ReadAllUsrCfgUserSettingsFromWebAPI'](fnAfterRedrawingPropertySheet);}else TriSysApex['UI']['ShowError'](CNewUsrCfgSettingResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('AdminConsole.UserSettings.CreateNewSettingViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Creating\x20Setting...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AssignUserSettings':function(){}},'AuditTrail':{'Load':function(){var fnPopulationByFunction={'API':'Users/AuditTrailList','Parameters':function(request){},'DataTableFunction':function(response){return response['List'];}},sGridName=AdminConsole['AuditTrailGridID']-'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':AdminConsole['AuditTrailGridID'],'ID':sGridName,'Title':'Audit\x20Trail','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':AdminConsole['AuditTrail']['Columns'],'KeyColumnName':'UserId','DrillDownFunction':function(rowData){TriSysApex['FormsManager']['OpenForm']('Contact',rowData['ContactId']);},'MultiRowSelect':![],'Grouping':!![],'ColumnFilters':!![],'Sortable':!![],'OpenButtonCaption':'Open'});},'Columns':[{'field':'UserId','title':'UserId','type':'number','width':0x46,'hidden':!![]},{'field':'ContactId','title':'UserContactId','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'User','type':'string','width':0xc8},{'field':'StartDate','title':'Date','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x78,'hidden':![]},{'field':'StartDate','title':'Time','type':'date','format':'{0:HH:mm:ss\x20}','width':0x4b,'hidden':![]},{'field':'Activity','title':'Activity','type':'string','hidden':![]}]},'GenericFunctions':{'PopulateUserGridFromFunction':function(options){var fnPopulationByFunction={'API':'Users/List','Parameters':function(request){request['DiaryManagerUsers']=!![];},'DataTableFunction':function(response){return response['List'];}},sGridID=options['GridID'],sGridName=sGridID+'-GridInstance',fnRowClickHandler=function(e,gridObject,gridLayout){var selectedItem=TriSysSDK['Grid']['GetFirstGridCheckedItem'](gridObject);if(selectedItem){var lUserId=selectedItem['UserId'],sName=selectedItem['Name'];options['SelectedUserFunction'](lUserId,sName);}},bPopulated=![],fnPostPopulationCallback=function(lRecordCount){!bPopulated&&TriSysSDK['Grid']['SelectFirstRow'](sGridID);},iFudgeFactor=0xaa,iHeightPerUser=0x1e,lHeight=$(window)['height']()-iFudgeFactor,iNumUsersPerPage=lHeight/ iHeightPerUser;TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':sGridName,'Title':'Users','RecordsPerPage':iNumUsersPerPage,'PopulationByFunction':fnPopulationByFunction,'Columns':[{'field':'UserId','title':'Id','type':'number','width':0x46,'hidden':!![]},{'field':'Name','title':'Name','type':'string'},{'field':'EMail','title':'E-Mail','type':'string','hidden':!![]},{'field':'TelNo','title':'Tel.\x20No.','type':'string','hidden':!![]},{'field':'LoggedIn','title':'Logged\x20In','type':'string','hidden':!![]},{'field':'Locked','title':'Locked','type':'string','hidden':!![]}],'KeyColumnName':'UserId','MultiRowSelect':![],'SingleRowSelect':!![],'RowClickHandler':fnRowClickHandler,'PostPopulationCallback':fnPostPopulationCallback,'ColumnFilters':!![],'Grouping':![],'PageSelector':![],'PageSizeSelector':![]});},'UpdatePropertySheetValues':function(items,serverSettings,sPropertySheetID){if(items&&serverSettings)for(var i=0x0;i<items['length'];i++){var item=items[i],applyItem=JSON['parse'](JSON['stringify'](item));for(var j=0x0;j<serverSettings['length'];j++){var serverSetting=serverSettings[j];if(serverSetting['Category']==applyItem['Category']&&serverSetting['Name']==applyItem['Name']){applyItem['Default']=serverSetting['Value'];break;}}ctrlPropertySheet['SetValue'](sPropertySheetID,applyItem);}}}};$(document)['ready'](function(){AdminConsole['Load']();});