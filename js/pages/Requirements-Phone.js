var RequirementsPhone={'SearchTextCookieName':'RequirementsPhone-Text','Load':function(sText){debugger;!sText&&(sText=TriSysAPI['Cookies']['getCookie'](RequirementsPhone['SearchTextCookieName'])),sText&&($('#requirements-form-lookup')['val'](sText),RequirementsPhone['LookupButtonClick']()),$('#requirements-form-lookup')['keyup'](function(e){e['keyCode']==0xd&&RequirementsPhone['LookupButtonClick']();}),$('#requirements-form-lookup-button')['click'](RequirementsPhone['LookupButtonClick']);},'LookupButtonClick':function(){var sText=$('#requirements-form-lookup')['val']();TriSysAPI['Cookies']['setCookie'](RequirementsPhone['SearchTextCookieName'],sText),$('#requirements-form-paged-list-container')['empty'](),RequirementsPhone['ShowFigures'](),RequirementsPhone['_CurrentPageNumber']=0x1,RequirementsPhone['WebAPISearch'](sText,RequirementsPhone['_CurrentPageNumber']);},'WebAPISearch':function(sWildcard,iPageNumber){var spinnerWait={'Div':'requirements-form-paged-list-container'},CRequirementsSearchRequest={'Wildcard':sWildcard,'PageNumber':iPageNumber,'RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'SortColumnName':'DateInitiated','SortAscending':![]};TriSysPhoneGap['ParseEntityIdInSearchExpression'](sWildcard,CRequirementsSearchRequest);var payloadObject={};payloadObject['URL']='Requirements/Search',payloadObject['OutboundDataPacket']=CRequirementsSearchRequest,payloadObject['InboundDataFunction']=function(CRequirementsSearchResponse){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]);if(CRequirementsSearchResponse){RequirementsPhone['ShowFigures'](CRequirementsSearchResponse['Results']);if(CRequirementsSearchResponse['Success'])RequirementsPhone['AppendRecordsToDOM'](CRequirementsSearchResponse['Results']);else{}return;}TriSysApex['UI']['ShowError']('RequirementsPhone.WebAPISearch\x20Error:\x20null\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]),TriSysApex['UI']['errorAlert']('RequirementsPhone.WebAPISearch:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,!![]),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowFigures':function(CRequirementsSearchResults){var figures=$('#requirements-form-lookup-figures');figures['html'](CRequirementsSearchResults?'No\x20records\x20found':'Searching...'),$('#requirements-form-first-page-button')['hide'](),$('#requirements-form-next-page-button')['hide']();if(CRequirementsSearchResults){figures['html']('Showing\x20rows\x201\x20to\x20'+CRequirementsSearchResults['LastRowNumber']+'\x20of\x20'+CRequirementsSearchResults['TotalRecordCount']+'\x20records');if(CRequirementsSearchResults['LastRowNumber']>0x8)$('#requirements-form-first-page-button')['show']();RequirementsPhone['_CurrentPageNumber']=CRequirementsSearchResults['PageNumber'];if(CRequirementsSearchResults['PageNumber']<CRequirementsSearchResults['TotalPageCount']){$('#requirements-form-next-page-button')['show']();var iNextPage=parseInt(CRequirementsSearchResults['PageNumber'])+0x1;$('#requirements-form-next-page-button-text')['html']('Next\x20Page\x20'+iNextPage+'\x20of\x20'+CRequirementsSearchResults['TotalPageCount']);}}},'AppendRecordsToDOM':function(CRequirementsSearchResults){if(CRequirementsSearchResults['TotalRecordCount']>0x0&&CRequirementsSearchResults['Requirements']){for(var i=0x0;i<CRequirementsSearchResults['Requirements']['length'];i++){var requirement=CRequirementsSearchResults['Requirements'][i],sHTML=RequirementsPhone['BuildRecordFromTemplate'](requirement);$('#requirements-form-paged-list-container')['append'](sHTML);}TriSysApex['Device']['FixTextEllipsesHack']('.truncated-requirements-text');if(RequirementsPhone['_CurrentPageNumber']>0x1)setTimeout(RequirementsPhone['ScrollToBottom'],0xa);}},'BuildRecordFromTemplate':function(CRequirementSummarySuperset){var sHTML=$('#requirements-form-template')['html']();sHTML=sHTML['replace']('#:RequirementId#',CRequirementSummarySuperset['RequirementId']),sHTML=sHTML['replace']('#:Reference#',CRequirementSummarySuperset['Reference']),sHTML=sHTML['replace']('#:Consultant#',CRequirementSummarySuperset['Consultant']),sHTML=sHTML['replace']('#:JobTitle#',CRequirementSummarySuperset['JobTitle']),sHTML=sHTML['replace']('#:Status#',CRequirementSummarySuperset['Status']),sHTML=sHTML['replace']('#:CompanyName#',CRequirementSummarySuperset['CompanyName']),sHTML=sHTML['replace']('#:Location#',CRequirementSummarySuperset['Location']),sHTML=sHTML['replace']('#:ClientContact#',CRequirementSummarySuperset['ClientName']);var sStart=moment(CRequirementSummarySuperset['EarliestStartDate'])['format']('ddd\x20DD\x20MMM\x20YYYY');sHTML=sHTML['replace']('#:StartDate#',sStart);if(!CRequirementSummarySuperset['CompanyLogoURL'])CRequirementSummarySuperset['CompanyLogoURL']=TriSysApex['Constants']['DefaultCompanyImage'];return sHTML=sHTML['replace']('#:CompanyLogoURL#',CRequirementSummarySuperset['CompanyLogoURL']),sHTML;},'RowClick':function(thisRow){var lRequirementId=thisRow;TriSysApex['FormsManager']['OpenForm']('Requirement',lRequirementId,!![]);},'New':function(){TriSysApex['Pages']['RequirementForm']['NewRecord'](0x0);},'ScrollToTop':function(){$(document['body'])['scrollTop']($('#requirements-form-top')['offset']()['top']-0x78);},'ScrollToBottom':function(){$(document['body'])['scrollTop']($('#requirements-form-first-page-button')['offset']()['top']);},'_CurrentPageNumber':0x0,'NextPage':function(){var sText=$('#requirements-form-lookup')['val']();RequirementsPhone['WebAPISearch'](sText,RequirementsPhone['_CurrentPageNumber']+0x1);}};