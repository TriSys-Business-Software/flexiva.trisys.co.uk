var ctrlEditRelationship={'Load':function(relationship){$('#ctrlEditRelationship-From')['val'](relationship['RecordName']);var options=null;switch(relationship['EntityName']){case'Contact':TriSysSDK['CShowForm']['skillCombo']('ctrlEditRelationship-Relationship',relationship['EntityName']+'\x20Relationship',relationship['Relationship']),options={'ContactId':relationship['LinkedRecordId'],'ContactName':relationship['LinkedRecordName']};if(relationship['LinkedRecordId']>0x0)options['PreventSelection']=!![];TriSysSDK['Controls']['ContactLookup']['Load']('ctrlEditRelationship-To',options);break;case'Company':ctrlEditRelationship['PopulateCompanyRelationshipTypesCombo']('ctrlEditRelationship-Relationship',relationship['Relationship']),options={'CompanyId':relationship['LinkedRecordId'],'CompanyName':relationship['LinkedRecordName']};if(relationship['LinkedRecordId']>0x0)options['PreventSelection']=!![];TriSysSDK['Controls']['CompanyLookup']['Load']('ctrlEditRelationship-To',options);break;}},'PopulateCompanyRelationshipTypesCombo':function(sFieldID,sRelationship){var sourceTypes=[],iCount=0x0,iTypeIndex=0x0;TriSysApex['Cache']['CompanyRelationshipTypes']()['forEach'](function(relationship){var sourceStruct={'value':relationship['CompanyRelationshipTypeId'],'text':relationship['Name']};sourceTypes['push'](sourceStruct);if(relationship['Name']==sRelationship)iTypeIndex=iCount;iCount+=0x1;}),TriSysSDK['CShowForm']['populateComboFromDataSource'](sFieldID,sourceTypes,iTypeIndex);},'_ReverseMode':![],'ReverseRelationship':function(){ctrlEditRelationship['_ReverseMode']=!ctrlEditRelationship['_ReverseMode'],ctrlEditRelationship['_ReverseMode']?($('#ctrlEditRelationship-Relationship-tr')['after']($('#ctrlEditRelationship-From-tr')),$('#ctrlEditRelationship-Relationship-tr')['before']($('#ctrlEditRelationship-To-tr'))):($('#ctrlEditRelationship-Relationship-tr')['before']($('#ctrlEditRelationship-From-tr')),$('#ctrlEditRelationship-Relationship-tr')['after']($('#ctrlEditRelationship-To-tr')));},'SaveButtonClick':function(relationship){var lSelectedRecordId=TriSysSDK['Controls']['ContactLookup']['ReadContactId']('ctrlEditRelationship-To');if(relationship['EntityName']=='Company')lSelectedRecordId=TriSysSDK['Controls']['CompanyLookup']['ReadCompanyId']('ctrlEditRelationship-To');if(lSelectedRecordId==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20'+relationship['EntityName']);return;}var lFromRecordId=ctrlEditRelationship['_ReverseMode']?lSelectedRecordId:relationship['RecordId'],lToRecordId=ctrlEditRelationship['_ReverseMode']?relationship['RecordId']:lSelectedRecordId;if(lFromRecordId==lToRecordId){TriSysApex['UI']['ShowMessage']('Please\x20select\x20another\x20'+relationship['EntityName']+'\x20because\x20you\x20cannot\x20have\x20a\x20relationship\x20between\x20identical\x20records');return;}relationship['Relationship']=TriSysSDK['CShowForm']['GetTextFromCombo']('ctrlEditRelationship-Relationship'),relationship['RecordId']=lFromRecordId,relationship['LinkedRecordId']=lToRecordId,ctrlEditRelationship['SaveRelationship'](relationship);},'SaveRelationship':function(relationship){var CRelationshipWriteRequest={'EntityName':relationship['EntityName'],'FromRecordId':relationship['RecordId'],'ToRecordId':relationship['LinkedRecordId'],'Relationship':relationship['Relationship']},payloadObject={};payloadObject['OutboundDataPacket']=CRelationshipWriteRequest,payloadObject['URL']='Relationships/Write',payloadObject['InboundDataFunction']=function(CRelationshipWriteResponse){TriSysApex['UI']['HideWait']();if(CRelationshipWriteResponse){if(CRelationshipWriteResponse['Success'])TriSysApex['UI']['CloseModalPopup'](),relationship['AfterUpdateCallback'](relationship);else TriSysApex['UI']['ShowMessage'](CRelationshipWriteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditRelationship.SaveRelationship:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Relationship...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};