var ctrlFormDesigner={'Load':function(sFile,sHTML){ctrlFormDesigner['Data']['FileName']=sFile,$('#ctrlFormDesigner-FilePath')['html'](sFile),ctrlFormDesigner['LoadHTML'](sHTML);},'LoadHTML':function(sHTML){ctrlFormDesigner['LoadFormIntoDOM'](sHTML),ctrlFormDesigner['PopulateTabs'](),ctrlFormDesigner['EventHandlers']();},'EventHandlers':function(){$('#ctrlFormDesigner-MinimizeTools')['on']('click',function(e){$('#ctrlFormDesigner-MinimizeTools')['hide'](),$('#ctrlFormDesigner-MaximizeTools')['show'](),$('#ctrlFormDesigner-LeftBlock-Title')['html'](''),ctrlFormDesigner['ResizeBlockColumns'](![]);}),$('#ctrlFormDesigner-MaximizeTools')['on']('click',function(e){$('#ctrlFormDesigner-MaximizeTools')['hide'](),$('#ctrlFormDesigner-MinimizeTools')['show'](),$('#ctrlFormDesigner-LeftBlock-Title')['html']('Tools'),ctrlFormDesigner['ResizeBlockColumns'](!![]);}),$('#ctrlFormDesigner-preview-checkbox')['on']('click',function(){var bShowPreview=$(this)['is'](':checked');$('#ctrlFormDesigner-add-row-button')['toggle'](),$('#ctrlFormDesigner-html-editor-button')['toggle'](),bShowPreview?ctrlFormDesigner['DesignMode'](![]):ctrlFormDesigner['DesignMode'](!![]);});},'isPreviewEnabled':function(){var bShowPreview=TriSysSDK['CShowForm']['GetCheckBoxValue']('ctrlFormDesigner-preview-checkbox',![]);return bShowPreview;},'ResizeBlockColumns':function(bLeftOpen){var sLeft='ctrlFormDesigner-LeftBlock',sRight='ctrlFormDesigner-RightBlock',sLargerLeftClass='col-md-2\x20col-lg-2',sSmallerLeftClass='col-md-1\x20col-lg-1',sSmallerRightClass='col-md-10\x20col-lg-10',sLargerRightClass='col-md-12\x20col-lg-12';$('#'+sLeft)['removeClass']()['addClass'](bLeftOpen?sLargerLeftClass:sSmallerLeftClass),$('#'+sRight)['removeClass']()['addClass'](bLeftOpen?sSmallerRightClass:sLargerRightClass);var accordion=$('#ctrlFormDesigner-Tools-group-panel');bLeftOpen?accordion['show']():accordion['hide'](),bLeftOpen?$('#'+sLeft)['show']():$('#'+sLeft)['hide']();},'InitialiseSplitter':function(){var iFudgeFactor=0x104,lHeight=$(window)['height']()-iFudgeFactor,splitterVertical=$('#ctrlFormDesigner-Splitter-vertical');splitterVertical['height'](lHeight),lHeight=lHeight-iFudgeFactor,$('#tools-pane')['height'](lHeight),splitterVertical['kendoSplitter']({'orientation':'vertical','panes':[{'collapsible':![]}]}),$('#ctrlFormDesigner-Splitter-horizontal')['kendoSplitter']({'panes':[{'collapsible':![],'size':'300px'},{'collapsible':![]}]});},'LoadFormIntoDOM':function(sHTML){ctrlFormDesigner['Data']['FileContents']=sHTML,ctrlFormDesigner['Data']['ParseOutTopAndBottomHTMLSegments'](sHTML),sHTML=ctrlFormDesigner['RemoveScriptTagsToPreventExecution'](sHTML),$('#'+ctrlFormDesigner['Settings']['HiddenDOM'])['html'](sHTML),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](null);var topTab={'Name':ctrlFormDesigner['Data']['TopMasterName'],'Caption':ctrlFormDesigner['Data']['TopMasterCaption'],'Icon':ctrlFormDesigner['Data']['WarningSignIcon'],'HTML':'','Visible':!![]};ctrlFormDesigner['Data']['Tabs']=[topTab],ctrlFormDesigner['ReadAndPopulateEntityFormTabCollection'](),ctrlFormDesigner['Data']['CurrentTab']=ctrlFormDesigner['Data']['Tabs'][0x0],ctrlFormDesigner['Data']['CurrentTab']['HTML']=ctrlFormDesigner['ReadTopMasterHTML']();return;ctrlFormDesigner['ReplaceEachTabHTMLWithEditableWidgets'](),ctrlFormDesigner['ReadTabListFromMemoryToTabLayout']();},'ReplaceEachTabHTMLWithEditableWidgets':function(){var dom=$('#'+ctrlFormDesigner['Settings']['HiddenDOM']);for(var i=0x0;i<ctrlFormDesigner['Data']['Tabs']['length'];i++){var tab=ctrlFormDesigner['Data']['Tabs'][i];dom['html'](tab['HTML']),ctrlFormDesigner['InjectEditorsIntoEditorCanvasForCurrentTab'](),tab['HTML']=dom['html']();}},'ReadAndPopulateEntityFormTabCollection':function(){$('#'+ctrlFormDesigner['Settings']['HiddenDOM']+'\x20a')['each'](function(){var sTabID=this['id'],bFoundTab=![],sHTML=null,sTabPaneID=null,sOuterHTML=this['outerHTML'];if(sOuterHTML){var sTabClickFunction='TriSysSDK.EntityFormTabs.TabContainerClickEvent';if(sOuterHTML['indexOf'](sTabClickFunction)>0x0){bFoundTab=!![];var parts=sOuterHTML['split']('\x27');if(parts){if(parts['length']==0x3){sTabPaneID=parts[0x1];var panel=$('#'+sTabPaneID);panel['show'](),sHTML=panel[0x0]['outerHTML'];}}}}if(bFoundTab){var sCaption=this['innerText']['trim']();if(!sTabID)sTabID=ctrlFormDesigner['TabIDFromCaption'](sCaption);var parentLI=this['parentNode'],bVisible=!parentLI['hidden'];bVisible=parentLI['outerHTML']['indexOf']('display:\x20none;')<0x0;var bActive=parentLI['outerHTML']['indexOf']('class=\x22active\x22')>0x0,formTab={'Name':sTabID,'Caption':sCaption,'Icon':this['children'][0x0]['className'],'HTML':sHTML,'outerHTML':parentLI['outerHTML'],'Visible':bVisible,'Active':bActive,'ID':parentLI['id'],'HyperlinkID':this['id'],'TabPaneID':sTabPaneID};ctrlFormDesigner['Data']['Tabs']['push'](formTab);if(!ctrlFormDesigner['Data']['TabPanelButtonsPrefix']){var parentUL=parentLI['parentNode'],parentDiv=parentUL['parentNode'],parentBlock=parentDiv['parentNode'],sOuterHTMLul=parentUL['outerHTML'],iFirstRightChevron=sOuterHTMLul['indexOf']('>');ctrlFormDesigner['Data']['TabPanelButtonsPrefix']=sOuterHTMLul['substring'](0x0,iFirstRightChevron+0x1);var sOuterHTMLdiv=parentDiv['outerHTML'];iFirstRightChevron=sOuterHTMLdiv['indexOf']('>'),ctrlFormDesigner['Data']['TabPanelButtonsPrefix']=sOuterHTMLdiv['substring'](0x0,iFirstRightChevron+0x1)+'\x0a\x09\x09\x09'+ctrlFormDesigner['Data']['TabPanelButtonsPrefix'];var sBlockHTMLdiv=parentBlock['outerHTML'];iFirstRightChevron=sBlockHTMLdiv['indexOf']('>'),ctrlFormDesigner['Data']['TabPanelButtonsPrefix']='\x09'+sBlockHTMLdiv['substring'](0x0,iFirstRightChevron+0x1)+'\x0a\x09\x09'+ctrlFormDesigner['Data']['TabPanelButtonsPrefix'],ctrlFormDesigner['Data']['TabPanelButtonsSuffix']='\x0a'+'\x09\x09\x09'+'</ul>'+'\x0a'+'\x09\x09'+'</div>';}}});},'TabIDFromCaption':function(sCaption){sCaption=sCaption['trim']();var sTabID=sCaption['replace']('/','-')['replace'](/ /g,'-');return sTabID=sTabID['replace'](/[|&;$%@"<>()+,]/g,''),sTabID;},'ReadTopMasterHTML':function(){var sHTML='Could\x20not\x20read\x20DOM';return $('#'+ctrlFormDesigner['Settings']['HiddenDOM']+'\x20>\x20div\x20>\x20div.row')['each'](function(){sHTML=this['outerHTML'];}),sHTML;},'RemoveScriptTagsToPreventExecution':function(sHTML){var iScriptStart=sHTML['indexOf']('<script'),iScriptEnd=sHTML['indexOf']('</script>');if(iScriptStart>0x0&&iScriptEnd>iScriptStart)sHTML=sHTML['substring'](0x0,iScriptStart,iScriptEnd+0x9);return sHTML;},'LoadHTMLintoEditor':function(sHTML){var bFullPage=![];TriSysSDK['Froala']['InitialiseEditor']({'ID':ctrlFormDesigner['Settings']['EditorCanvasId'],'FullPage':bFullPage,'DropEnabled':![],'HTML':sHTML});},'PopulateTabs':function(){ctrlFormDesigner['PopulateListOfTabs'](ctrlFormDesigner['Data']['Tabs']);},'PopulateListOfTabs':function(tabs,sSelectedTabName){var sUL='ctrlFormDesigner-tab-list',sItemPrefix=sUL+'-item-',sItemTemplate=sItemPrefix+'template',sRowTemplateHTML=document['getElementById'](sItemTemplate)['outerHTML'];$('#'+sUL)['find']('li')['each'](function(){var sID=this['id'];if(sID!=sItemTemplate)$(this)['remove']();});for(var i=0x0;i<tabs['length'];i++){var tab=tabs[i];tab['Ordering']=i+0x1;var sRowItemHTML=sRowTemplateHTML,sItemID=sItemPrefix+tab['Name'];sRowItemHTML=sRowItemHTML['replace'](sItemTemplate,sItemID),sRowItemHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowItemHTML);var sOnClick='ctrlFormDesigner.SelectTab(\x27'+tab['Name']+'\x27)';sRowItemHTML=sRowItemHTML['replace']('##tab-click-event##',sOnClick);var sIcon=tab['Icon'];if(sIcon){if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;}else sIcon=ctrlFormDesigner['Data']['WarningSignIcon'];sRowItemHTML=sRowItemHTML['replace']('##tab-icon##',sIcon),sRowItemHTML=sRowItemHTML['replace']('##tab-name##',tab['Name']),sRowItemHTML=sRowItemHTML['replace']('##tab-caption##',tab['Caption']),$('#'+sUL)['append'](sRowItemHTML);if(!sSelectedTabName){if(i==0x0)sSelectedTabName=tab['Name'];}if(sSelectedTabName==tab['Name'])ctrlFormDesigner['SelectTab'](tab['Name']);}},'SelectTab':function(sTabName){ctrlFormDesigner['SaveTabLayoutToTabListInMemory']();var tab=ctrlFormDesigner['Data']['TabFromName'](sTabName);if(!tab)return;$('#ctrlFormDesigner-TabName')['html'](tab['Caption']);var sUL='ctrlFormDesigner-tab-list';$('#'+sUL)['find']('li')['each'](function(){$(this)['removeClass']('active');});var sItemPrefix=sUL+'-item-',sItemID=sItemPrefix+sTabName;$('#'+sItemID)['addClass']('active'),ctrlFormDesigner['Data']['CurrentTab']=tab,ctrlFormDesigner['ReadTabListFromMemoryToTabLayout']();},'TabAdd':function(){ctrlFormDesigner['OpenTabEditor'](null);},'TabEdit':function(){var tab=ctrlFormDesigner['GetSelectedTab']();if(tab)ctrlFormDesigner['OpenTabEditor'](tab);},'TabDelete':function(){var tab=ctrlFormDesigner['GetSelectedTab']();if(!tab)return;if(tab['Name']==ctrlFormDesigner['Data']['TopMasterName']||ctrlFormDesigner['Data']['Tabs']['length']<=0x2){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20delete\x20this\x20tab.');return;}var fnDeleteTab=function(){var iIndex=ctrlFormDesigner['Data']['TabIndexFromName'](tab['Name']);if(iIndex>0x0)ctrlFormDesigner['Data']['Tabs']['splice'](iIndex,0x1);return ctrlFormDesigner['PopulateListOfTabs'](ctrlFormDesigner['Data']['Tabs']),!![];},sMessage='Are\x20you\x20sure\x20you\x20wish\x20to\x20delete\x20tab:\x20'+tab['Caption']+'?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Tab','Yes',fnDeleteTab,'No');},'TabMove':function(bUp){var tab=ctrlFormDesigner['GetSelectedTab']();if(!tab)return;var iIndex=ctrlFormDesigner['Data']['TabIndexFromName'](tab['Name']);if(iIndex<=0x0){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab.');return;}if(bUp){if(iIndex<=0x1){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab\x20upwards.');return;}var movedUpTab=ctrlFormDesigner['Data']['Tabs'][iIndex];ctrlFormDesigner['Data']['Tabs'][iIndex]=ctrlFormDesigner['Data']['Tabs'][iIndex-0x1],ctrlFormDesigner['Data']['Tabs'][iIndex-0x1]=movedUpTab;}else{if(iIndex==ctrlFormDesigner['Data']['Tabs']['length']-0x1){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab\x20downwards.');return;}var movedDownTab=ctrlFormDesigner['Data']['Tabs'][iIndex];ctrlFormDesigner['Data']['Tabs'][iIndex]=ctrlFormDesigner['Data']['Tabs'][iIndex+0x1],ctrlFormDesigner['Data']['Tabs'][iIndex+0x1]=movedDownTab;}ctrlFormDesigner['PopulateListOfTabs'](ctrlFormDesigner['Data']['Tabs'],tab['Name']);},'OpenTabEditor':function(tab){var bNewTab=![];if(!tab)tab={'Caption':'New\x20Tab','Icon':ctrlFormDesigner['Data']['WarningSignIcon'],'HTML':'','Visible':!![]},bNewTab=!![],ctrlFormDesigner['Data']['CurrentTab']=tab,ctrlFormDesigner['SaveTabLayoutToTabListInMemory']();else{if(tab['Caption']==ctrlFormDesigner['Data']['TopMasterCaption']){TriSysApex['UI']['ShowMessage'](ctrlFormDesigner['Data']['TopMasterCaption']+'\x20is\x20not\x20editable\x20as\x20it\x20fixed.');return;}}var properties=[{'Name':'Active','Description':['Whether\x20the\x20tab\x20is\x20active\x20when\x20form\x20opened'],'Type':'Boolean','Title':'Active','Default':tab['Active']},{'Name':'Caption','Description':['The\x20text\x20of\x20the\x20tab'],'Type':'TextBox','Default':tab['Caption']},{'Name':'HyperlinkID','Description':['The\x20JQuery\x20ID\x20of\x20the\x20tab\x20item\x20<a>\x20hyperlink'],'Type':'TextBox','Default':tab['HyperlinkID']},{'Name':'Icon','Description':['The\x20icon\x20shown\x20with\x20the\x20caption'],'Type':'Icon','Title':'Icon','Default':tab['Icon']},{'Name':'ID','Description':['The\x20JQuery\x20ID\x20of\x20the\x20tab\x20<li>\x20item'],'Type':'TextBox','Default':tab['ID']},{'Name':'Visible','Description':['Whether\x20the\x20tab\x20is\x20visible\x20or\x20not'],'Type':'Boolean','Title':'Visible','Default':tab['Visible']}],options={'Title':'Tab:\x20'+tab['Caption'],'Image':'gi-more','SubTitle':'Tab\x20Properties','Items':properties,'FieldValueChange':function(sCategory,sName,objValue){if(!ctrlFormDesigner['Data']['EditedPropertiesList'])ctrlFormDesigner['Data']['EditedPropertiesList']=ctrlFormDesigner['Data']['CurrentTab'];ctrlFormDesigner['Data']['EditedPropertiesList'][sName]=objValue;},'Apply':function(){if(ctrlFormDesigner['Data']['EditedPropertiesList']){var editedTab=ctrlFormDesigner['Data']['EditedPropertiesList'];editedTab['Name']=ctrlFormDesigner['TabIDFromCaption'](editedTab['Caption']);if(bNewTab){var bDuplicate=![];ctrlFormDesigner['Data']['Tabs']['forEach'](function(existingTab){if(existingTab['Name']==editedTab['Name'])bDuplicate=!![];});if(bDuplicate)return TriSysApex['UI']['ShowMessage']('Tabs\x20must\x20be\x20unique.'),![];var secondTab=ctrlFormDesigner['Data']['Tabs'][0x1],sOuterHTML=ctrlFormDesigner['ReplaceWithinTags'](secondTab['outerHTML'],'<i\x20','</i>','<i\x20class=\x22'+editedTab['Icon']+'\x22></i>');sOuterHTML=ctrlFormDesigner['ReplaceWithinTags'](sOuterHTML,'</i>','</a>','</i>\x20'+editedTab['Caption']+'</a>'),sOuterHTML=sOuterHTML['replace']('class=\x22active\x22',''),sOuterHTML=ctrlFormDesigner['RemoveAttribute'](sOuterHTML,'id');var parts=sOuterHTML['split']('TabContainerClickEvent($(this),\x20\x27');parts=parts[0x1]['split']('\x27');var sOriginalPanelName=parts[0x0],sFormPanel='-form-panel-';parts=sOriginalPanelName['split'](sFormPanel);var sPanelPrefix=parts[0x0]+sFormPanel,sPanelID=sPanelPrefix+editedTab['Name']['toLowerCase']();editedTab['TabPaneID']=sPanelID,sOuterHTML=sOuterHTML['replace'](sOriginalPanelName,sPanelID),editedTab['outerHTML']=sOuterHTML,ctrlFormDesigner['Data']['Tabs']['push'](editedTab),editedTab['HTML']=ctrlFormDesigner['NewTabPane'](sPanelID),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](editedTab['HTML']),ctrlFormDesigner['DesignOrPreview'](),ctrlFormDesigner['TriSysGridManager']['AddNewRow'](0x4);}else editedTab['outerHTML']=ctrlFormDesigner['ReplaceWithinTags'](editedTab['outerHTML'],'<i\x20','</i>','<i\x20class=\x22'+editedTab['Icon']+'\x22></i>'),editedTab['outerHTML']=ctrlFormDesigner['ReplaceWithinTags'](editedTab['outerHTML'],'</i>','</a>','</i>\x20'+editedTab['Caption']+'</a>'),ctrlFormDesigner['Data']['CurrentTab']=editedTab;return editedTab['Active']&&ctrlFormDesigner['Data']['Tabs']['forEach'](function(existingTab){existingTab['Name']!=editedTab['Name']&&(existingTab['Active']&&(existingTab['outerHTML']=existingTab['outerHTML']['replace']('class=\x22active\x22',''),existingTab['Active']=![]));}),ctrlFormDesigner['PopulateListOfTabs'](ctrlFormDesigner['Data']['Tabs'],editedTab['Name']),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20new\x20tab\x20properties.');}};ctrlFormDesigner['Data']['EditedPropertiesList']=null,ctrlFormDesigner['OpenPropertySheet'](options);},'OpenPropertySheet':function(options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=options['Title'],parametersObject['Image']=options['Image'];var lWidth=$(window)['width']()/0x2;parametersObject['Width']=lWidth,parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlFormDesignerPropertySheet.html',parametersObject['OnLoadCallback']=function(){var lHeight=$(window)['height']()*0.5,propertySheetData={'title':options['SubTitle'],'propertyColumnName':'Property','valueColumnName':'Setting','categoryColumnHide':!![],'descriptionColumnHide':!![],'height':lHeight,'objectList':options['Items'],'fieldValueChange':options['FieldValueChange']},fnAfterDraw=function(){ctrlPropertySheet['ApplyDefaults']('ctrlFormDesigner-PropertySheet',propertySheetData);};TriSysApex['PropertySheet']['Draw']('ctrlFormDesigner-PropertySheet',propertySheetData,function(){setTimeout(fnAfterDraw(),0x64);});},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){return options['Apply']();},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);},'GetSelectedTab':function(){var sTabName=ctrlFormDesigner['GetSelectedTabName'](),tab=ctrlFormDesigner['Data']['TabFromName'](sTabName);return tab;},'GetSelectedTabName':function(){var sTabName=null,sUL='ctrlFormDesigner-tab-list';return $('#'+sUL)['find']('li')['each'](function(){var bActive=$(this)['hasClass']('active');if(bActive)sTabName=this['id']['replace']('ctrlFormDesigner-tab-list-item-','');}),sTabName;},'SaveTabLayoutToTabListInMemory':function(){if(ctrlFormDesigner['Data']['CurrentTab']){var sHTML=$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](),bNoHTML=!sHTML;if(bNoHTML)return;var bEnabled=!ctrlFormDesigner['isPreviewEnabled']();if(bEnabled)ctrlFormDesigner['DesignMode'](![]);sHTML=$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](),ctrlFormDesigner['Data']['CurrentTab']['HTML']=sHTML;}},'StripEditorsFromEditorCanvasForCurrentTab':function(sHTML){sHTML=sHTML['split']('<!--gm-editable-region-->')['join'](''),sHTML=sHTML['split']('<!--/gm-editable-region-->')['join'](''),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](sHTML),$('#gm-canvas')['contents']()['unwrap']();var fnRemove3rdPartyLeftovers=function(){var lstRemoveAttributes=['data-children-count','data-kwimpalastatus','data-kwimpalaid'];lstRemoveAttributes['forEach'](function(sAttribute){$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['find']('['+sAttribute+']')['each'](function(){$(this)['removeAttr'](sAttribute);});});};return fnRemove3rdPartyLeftovers(),ctrlFormDesigner['Settings']['TableDesigners']&&$('#'+ctrlFormDesigner['Settings']['EditorCanvasId']+'\x20table')['children']('tbody')['each'](function(){var tbody=$(this),table=tbody['parent']();table['css']({'border':''});}),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['find']('[id^=\x27'+ctrlFormDesigner['EditorObjectPrefix']+'\x27]')['each'](function(){var sID=this['id'];if(sID){var bRemoveThis=!![],field=ctrlFormDesigner['Data']['FieldFromId'](sID);if(field)$(this)['replaceWith'](field['HTML']),bRemoveThis=![];else{var title=null;if(title)$(this)['replaceWith'](title['HTML']),bRemoveThis=![];else{var label=ctrlFormDesigner['Data']['LabelFromId'](sID);if(label){var sPrefix='<strong>',sSuffix='</strong>';$(this)['replaceWith'](sPrefix+label['Text']+sSuffix),bRemoveThis=![];}}}if(bRemoveThis)$(this)['remove']();}}),fnRemove3rdPartyLeftovers(),sHTML=$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](),sHTML;},'ReadTabListFromMemoryToTabLayout':function(){if(ctrlFormDesigner['Data']['CurrentTab']){var sHTML=ctrlFormDesigner['Data']['CurrentTab']['HTML'];$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](sHTML);var bEnabled=!ctrlFormDesigner['isPreviewEnabled']();if(bEnabled)ctrlFormDesigner['DesignMode'](bEnabled);}},'InjectEditorsIntoEditorCanvasForCurrentTab':function(){ctrlFormDesigner['Settings']['TableDesigners']&&$('#'+ctrlFormDesigner['Settings']['EditorCanvasId']+'\x20table')['children']('tbody')['each'](function(){var tbody=$(this),table=tbody['parent']();table['css']({'border':'1px\x20solid\x20lightgray'});var iColumns=ctrlFormDesigner['CountTableColumns'](tbody),sTableTemplate=$('#ctrlFormDesigner-Edit-Table-template')['html']()['trim'](),sTable=sTableTemplate['replace'](/{{Edit-TableId}}/g,ctrlFormDesigner['EditorObjectPrefix']+TriSysSDK['Miscellaneous']['GUID']());sTable=sTable['replace'](/{{Edit-TableColumnCount}}/g,iColumns),$(this)['prepend'](sTable);}),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['find']('*[class^=\x27block-title\x27]')['each'](function(){var elemH2=$(this)['find']('h2'),sCaption=elemH2['html']();if(!sCaption){var elemH3=$(this)['find']('h3');sCaption=elemH3['html']();}var sTitleID=ctrlFormDesigner['EditorObjectPrefix']+TriSysSDK['Miscellaneous']['GUID'](),sTitleHTML=this['outerHTML'];ctrlFormDesigner['Data']['Titles']['push']({'ID':sTitleID,'HTML':sTitleHTML,'Caption':sCaption});var sTitleTemplate=$('#ctrlFormDesigner-Edit-Title-template')['html']()['trim'](),sTitle=sTitleTemplate['replace'](/{{Edit-TitleId}}/g,sTitleID);$(this)['prepend'](sTitle);}),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId']+'\x20strong')['each'](function(){var sLabel=ctrlFormDesigner['DesignTimeFieldLabelHTML'](this);$(this)['replaceWith'](sLabel);}),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['find']('[id*=\x27_\x27]')['each'](function(){var sID=this['id'],findFieldDescription={'TableName':sID['split']('_')[0x0],'TableFieldName':sID['split']('_')[0x1]},fieldDescription=null,fieldDescriptions=TriSysApex['Cache']['FieldDescriptions']();fieldDescriptions['forEach'](function(fd){if(findFieldDescription['TableName']==fd['TableName']&&findFieldDescription['TableFieldName']==fd['TableFieldName'])fieldDescription=fd;});if(fieldDescription){var sField=ctrlFormDesigner['DesignTimeFieldHTML'](fieldDescription,this['outerHTML']);$(this)['replaceWith'](sField);}}),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId']+'\x20div,\x20img')['each'](function(){var sID=this['id'],sClass=this['className'],bReallyWantTo=![],sTriSysWidgetType=null;if(sID){if(sID['indexOf']('Grid')>=0x0)bReallyWantTo=!![];sTriSysWidgetType=$(this)['attr']('trisys-widget-type');if(sTriSysWidgetType)bReallyWantTo=!![];}if(sID&&bReallyWantTo){var bEditWidgetIf=sID['indexOf'](ctrlFormDesigner['EditorObjectPrefix'])<0x0&&sClass!='tab-pane'&&(sID['indexOf']('_')<0x0||sTriSysWidgetType);if(bEditWidgetIf){var sFieldID=ctrlFormDesigner['EditorObjectPrefix']+TriSysSDK['Miscellaneous']['GUID']()+'_'+sID,sFieldHTML=this['outerHTML'];ctrlFormDesigner['Data']['Fields']['push']({'ID':sFieldID,'HTML':sFieldHTML});var sField=ctrlFormDesigner['InjectedDivEditorFieldHTML'](sID,sFieldID,sTriSysWidgetType);sField&&$(this)['replaceWith'](sField);}}});},'NewTabPane':function(sPanelID){var sTemplate=$('#ctrlFormDesigner-New-TabPane-template')['html']()['trim'](),sHTML=sTemplate['replace'](/{{New-TabPaneId}}/g,sPanelID);return sHTML;},'EditorObjectPrefix':'form-Designer-Edit-Object-','EditRow':function(sId){var sKnowledge='',rowElement=$('#'+sId)['parent'](),iColumnCount=0x0;rowElement['children']('*[class^=\x27col-\x27]')['each'](function(){iColumnCount+=0x1;var sClass=$(this)['attr']('class');if(sKnowledge['length']>0x0)sKnowledge+='<br/>';sKnowledge+='Col:\x20'+iColumnCount+':\x20'+sClass;}),sKnowledge='Found\x20'+iColumnCount+'\x20columns:<br/>'+sKnowledge,TriSysApex['UI']['ShowMessage']('Edit\x20Row:\x20'+sId+'\x20-\x20'+sKnowledge);},'EditColumn':function(sId){var sKnowledge='';TriSysApex['UI']['ShowMessage']('Edit\x20Column:\x20'+sId+'\x20-\x20'+sKnowledge);},'EditTitle':function(sId){var title=ctrlFormDesigner['Data']['TitleFromId'](sId);if(!title)return;var properties=[{'Name':'Caption','Description':['The\x20text\x20of\x20the\x20title\x20caption'],'Type':'TextBox','Default':title['Caption']}],options={'Title':'Title:\x20'+sId,'Image':'gi-pen','SubTitle':'Title\x20Properties','Items':properties,'FieldValueChange':function(sCategory,sName,objValue){if(!ctrlFormDesigner['Data']['EditedPropertiesList'])ctrlFormDesigner['Data']['EditedPropertiesList']=[];ctrlFormDesigner['Data']['EditedPropertiesList'][sName]=objValue;},'Apply':function(){if(ctrlFormDesigner['Data']['EditedPropertiesList']){var editedTitle=ctrlFormDesigner['Data']['EditedPropertiesList'];title['Caption']=editedTitle['Caption'];var editButton=$('#'+sId)['parent'](),elemH2=editButton['find']('h2');elemH2['html'](title['Caption']);var elemH3=editButton['find']('h3');return elemH3['html'](title['Caption']),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20title\x20properties.');}};ctrlFormDesigner['Data']['EditedPropertiesList']=null,ctrlFormDesigner['OpenPropertySheet'](options);},'EditLabel':function(sId){var label=ctrlFormDesigner['Data']['LabelFromId'](sId);if(!label)return;var properties=[{'Name':'Text','Description':['The\x20text\x20of\x20the\x20label'],'Type':'TextBox','Default':label['Text']}],options={'Title':'Label:\x20'+sId,'Image':'gi-pencil','SubTitle':'Label\x20Properties','Items':properties,'FieldValueChange':function(sCategory,sName,objValue){if(!ctrlFormDesigner['Data']['EditedPropertiesList'])ctrlFormDesigner['Data']['EditedPropertiesList']=[];ctrlFormDesigner['Data']['EditedPropertiesList'][sName]=objValue;},'Apply':function(){if(ctrlFormDesigner['Data']['EditedPropertiesList']){var editedLabel=ctrlFormDesigner['Data']['EditedPropertiesList'];return label['Text']=editedLabel['Text'],$('#'+sId+'-TextId')['html'](label['Text']),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20label\x20properties.');}};ctrlFormDesigner['Data']['EditedPropertiesList']=null,ctrlFormDesigner['OpenPropertySheet'](options);},'CutLabel':function(sId){var label=ctrlFormDesigner['Data']['LabelFromId'](sId);label&&(ctrlFormDesigner['CopyLabel'](sId),$('#'+label['ID'])['remove']());},'CopyLabel':function(sId){var label=ctrlFormDesigner['Data']['LabelFromId'](sId);if(label){var widget={'HTML':label['HTML'],'Text':label['Text']},copyLabelHTML=ctrlFormDesigner['DesignTimeFieldLabelHTML'](null,widget);ctrlFormDesigner['Settings']['Clipboard']['Add'](sId,copyLabelHTML,'Label'),TriSysApex['Toasters']['Warning']('Label:\x20'+sId+'\x20added\x20to\x20clipboard');}},'EditField':function(sId,sName){ctrlFormDesigner['EditFieldOperation'](sId,sName,'Edit\x20TriSys\x20Database\x20Field/Widget','<br\x20/>'+'This\x20could\x20be\x20both\x20a\x20point\x20and\x20click\x20and\x20raw\x20HTML\x20editor\x20for\x20super\x20granular\x20editing.');},'CutField':function(sId,sName){var field=ctrlFormDesigner['Data']['FieldFromId'](sId);field&&(ctrlFormDesigner['CopyField'](sId,sName),$('#'+field['ID'])['remove']());},'CopyField':function(sId,sName){var field=ctrlFormDesigner['Data']['FieldFromId'](sId);if(field){var sTableName,sTableFieldName,fieldDescription,parts=sId['replace'](ctrlFormDesigner['EditorObjectPrefix'],'')['split']('_');sTableName=parts[0x1];if(parts['length']>0x2)sTableFieldName=parts[0x2];sId=sTableName;if(sTableFieldName){sId+='_'+sTableFieldName,fieldDescription={'TableName':sTableName,'TableFieldName':sTableFieldName};var sField=ctrlFormDesigner['DesignTimeFieldHTML'](fieldDescription,field['HTML']);field['HTML']=sField;}ctrlFormDesigner['Settings']['Clipboard']['Add'](sId,field['HTML']),TriSysApex['Toasters']['Warning']('Field:\x20'+sId+'\x20added\x20to\x20clipboard');}},'PasteField':function(sId,sName){ctrlFormDesigner['EditFieldOperation'](sId,sName,'Paste\x20TriSys\x20Database\x20Field/Widget');},'EditFieldOperation':function(sId,sName,sOperation,sAdditionalInfo){var sKnowledge=sName,field=ctrlFormDesigner['Data']['FieldFromId'](sId);if(field)sKnowledge+=field['HTML'];if(sAdditionalInfo)sKnowledge+=sAdditionalInfo;TriSysApex['UI']['ShowMessage'](sId+'\x20-\x20'+sKnowledge,sOperation);},'EditTable':function(sId){var sKnowledge='',tbody=$('#'+sId)['parent'](),iRows=tbody['children']('tr')['length']-0x1,iColumns=ctrlFormDesigner['CountTableColumns'](tbody);sKnowledge=iRows+'\x20rows,\x20'+iColumns+'\x20columns?',TriSysApex['UI']['ShowMessage']('Edit\x20Table:\x20'+sId+'\x20-\x20'+sKnowledge);},'CountTableColumns':function(tbody){var iColumns=0x0,firstRow=tbody['find']('tr:nth-child(2)')['first']();return firstRow['children']()['each'](function(){var td=$(this);if(td['attr']('colspan'))iColumns+=parseInt(td['attr']('colspan'));else iColumns+=0x1;}),iColumns;},'LaunchRawHTMLEditor':function(){var sHTML=ctrlFormDesigner['ReadEntireEditedRawHTML']();ctrlFormDesigner['ReadTabListFromMemoryToTabLayout']();var fnAfterSave=function(sEditedHTML){ctrlFormDesigner['LoadHTML'](sEditedHTML);};TriSysSDK['Controls']['FileManager']['OpenHTMLEditorForEditOnly'](sHTML,ctrlFormDesigner['Data']['FileName'],fnAfterSave);},'EditableDivCollection':function(){var sDivCollection='';return $('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['find']('*')['each'](function(){var sID=this['id'];if(sID['length']>0x0){var bAddElement=sID['indexOf']('draggable-blocks-row-')>=0x0&&sID['indexOf']('-column-')<0x0;if(bAddElement){if(sDivCollection['length']>0x0)sDivCollection+=',\x20';sDivCollection+='#'+sID;}}}),sDivCollection;},'EditMode':function(bEnable){var sDivCollection=ctrlFormDesigner['EditableDivCollection']();if(bEnable)$(sDivCollection)['sortable']({'connectWith':'.row','items':'.block','opacity':0.75,'handle':'.block-title','placeholder':'draggable-placeholder','tolerance':'pointer','start':function(e,ui){ui['placeholder']['css']('height',ui['item']['outerHeight']());}}),$(sDivCollection)['sortable']('enable');else $(sDivCollection)['sortable']('disable');var bShow=bEnable;},'ReadEntireEditedRawHTML':function(){ctrlFormDesigner['SaveTabLayoutToTabListInMemory']();var sHTML=ctrlFormDesigner['Data']['TopPreFirstDivHTML']+'\x0a',topTab=ctrlFormDesigner['Data']['Tabs'][0x0];sHTML+=ctrlFormDesigner['StripEditorsFromEditorCanvasForCurrentTab'](topTab['HTML']),sHTML+='\x0a\x0a\x09<!--\x20Re-Generated\x20Form\x20Tabs\x20Start\x20-->\x0a'+ctrlFormDesigner['Data']['TabPanelButtonsPrefix'];var i,tab;for(i=0x1;i<ctrlFormDesigner['Data']['Tabs']['length'];i++){tab=ctrlFormDesigner['Data']['Tabs'][i];var sOuterHTML=tab['outerHTML'],sAttributes='';if(tab['Active'])sAttributes+='\x20class=\x22active\x22';if(tab['ID'])sAttributes+='\x20id=\x22'+tab['ID']+'\x22';if(!tab['Visible'])sAttributes+='\x20style=\x22display:\x20none;\x22';sOuterHTML=ctrlFormDesigner['ReplaceWithinTags'](sOuterHTML,'<li','>','<li'+sAttributes+'>'),sAttributes='',tab['HyperlinkID']&&(sOuterHTML=ctrlFormDesigner['RemoveAttributeBetweenTags'](sOuterHTML,'id','<a','>'),sAttributes='\x20id=\x22'+tab['HyperlinkID']+'\x22'),sOuterHTML=ctrlFormDesigner['ReplaceWithinTags'](sOuterHTML,'<a','href','<a'+sAttributes+'\x20href'),sHTML+='\x0a\x09\x09\x09\x09'+sOuterHTML;}sHTML+=ctrlFormDesigner['Data']['TabPanelButtonsSuffix']+'\x0a',sHTML+='\x0a\x09\x09<!--\x20Re-Generated\x20Tab\x20Content\x20Panels\x20Start\x20-->',sHTML+=ctrlFormDesigner['Data']['TabContentPrefix'];for(i=0x1;i<ctrlFormDesigner['Data']['Tabs']['length'];i++){tab=ctrlFormDesigner['Data']['Tabs'][i];var sTabHTML=ctrlFormDesigner['StripEditorsFromEditorCanvasForCurrentTab'](tab['HTML']);sTabHTML=sTabHTML['replace']('<div\x20style=\x22\x22','<div\x20style=\x22display:\x20none;\x22'),sHTML+='\x0a\x09\x09\x09'+sTabHTML;}return sHTML+=ctrlFormDesigner['Data']['TabContentSuffix'],sHTML+=ctrlFormDesigner['Data']['BottomPostLastDivHTML'],sHTML=sHTML['replace'](/style=""/g,''),sHTML;},'Save':function(sFile){var sHTML=ctrlFormDesigner['ReadEntireEditedRawHTML'](),fnSaved=function(){TriSysApex['Toasters']['Success']('Successfully\x20saved:\x20'+sFile),ctrlFormDesigner['ReadTabListFromMemoryToTabLayout']();};DeveloperStudio['WebAPI']['WriteFile'](sFile,sHTML,fnSaved);},'Data':{'TopMasterName':'TopMaster','TopMasterCaption':'Top/Master','WarningSignIcon':'gi\x20gi-warning_sign','FileName':null,'Tabs':[],'CurrentTab':null,'EditedPropertiesList':null,'Titles':[],'Labels':[],'Fields':[],'TabFromName':function(sTabName){var tab=null;return ctrlFormDesigner['Data']['Tabs']['forEach'](function(tabby){if(tabby['Name']==sTabName)tab=tabby;}),tab;},'TabIndexFromName':function(sTabName){for(var i=0x1;i<ctrlFormDesigner['Data']['Tabs']['length'];i++){var tab=ctrlFormDesigner['Data']['Tabs'][i];if(tab['Name']==sTabName)return i;}return-0x1;},'FileContents':null,'TopPreFirstDivHTML':'','BottomPostLastDivHTML':'','ParseOutTopAndBottomHTMLSegments':function(sHTML){if(!sHTML)return;var iTopIndex=sHTML['indexOf']('<div');if(iTopIndex>0x0){ctrlFormDesigner['Data']['TopPreFirstDivHTML']=sHTML['substring'](0x0,iTopIndex-0x1);var sTopSectionRow='<div\x20class=\x22row\x22';iTopIndex=sHTML['indexOf'](sTopSectionRow),ctrlFormDesigner['Data']['TopPreFirstDivHTML']=sHTML['substring'](0x0,iTopIndex-0x1);}var iLastEndDiv=sHTML['lastIndexOf']('</div>');if(iLastEndDiv>0x0)ctrlFormDesigner['Data']['BottomPostLastDivHTML']=sHTML['substring'](iLastEndDiv+0x6);},'TabPanelButtonsPrefix':'','TabPanelButtonsSuffix':'','TabContentPrefix':'\x0a\x09\x09<div\x20class=\x22tab-content\x22>','TabContentSuffix':'\x0a\x09\x09</div>\x20<!--\x20<div\x20class=\x22tab-content\x20TAB\x20CONTENT\x22>\x20-->\x0a\x09</div>\x20<!--\x20<div\x20class=\x22block\x20full\x22\x20TABS>\x20-->\x0a</div>\x20<!--\x20<div\x20class=\x22block\x20full\x22\x20FORM>\x20-->','TitleFromId':function(sId){var foundTitle=null;return ctrlFormDesigner['Data']['Titles']['forEach'](function(title){if(title['ID']==sId&&!foundTitle)foundTitle=title;}),foundTitle;},'LabelFromId':function(sId){var foundLabel=null;return ctrlFormDesigner['Data']['Labels']['forEach'](function(label){if(label['ID']==sId&&!foundLabel)foundLabel=label;}),foundLabel;},'FieldFromId':function(sId){var foundField=null;return ctrlFormDesigner['Data']['Fields']['forEach'](function(field){if(field['ID']==sId&&!foundField)foundField=field;}),foundField;}},'ReplaceWithinTags':function(sOriginal,sStartTag,sEndTag,sReplacement){if(sOriginal){var iStart=sOriginal['indexOf'](sStartTag);if(iStart>=0x0){var iEnd=sOriginal['indexOf'](sEndTag,iStart+sStartTag['length']);if(iEnd>iStart){var sPre=sOriginal['substring'](0x0,iStart),sPost=sOriginal['substring'](iEnd+sEndTag['length']);sOriginal=sPre+sReplacement+sPost;}}}return sOriginal;},'walkTheDOM':function(node,func){func(node),node=node['firstChild'];while(node){ctrlFormDesigner['walkTheDOM'](node,func),node=node['nextSibling'];}},'RemoveAttribute':function(sOriginal,sAttribute){if(sOriginal){sAttribute=sAttribute+'=\x22';var iStart=sOriginal['indexOf'](sAttribute);if(iStart>=0x0){var sEndTag='\x22',iEnd=sOriginal['indexOf'](sEndTag,iStart+sAttribute['length']+0x1);if(iEnd>iStart){var sPre=sOriginal['substring'](0x0,iStart),sPost=sOriginal['substring'](iEnd+sEndTag['length']);sOriginal=sPre+sPost;}}}return sOriginal;},'RemoveAttributeBetweenTags':function(sOriginal,sAttribute,sInnerStart){if(sOriginal){sAttribute=sAttribute+'=\x22';var iInnerStart=sOriginal['indexOf'](sInnerStart),iStart=sOriginal['indexOf'](sAttribute,iInnerStart);if(iStart>=0x0){var sEndTag='\x22',iEnd=sOriginal['indexOf'](sEndTag,iStart+sAttribute['length']+0x1);if(iEnd>iStart){var sPre=sOriginal['substring'](0x0,iStart),sPost=sOriginal['substring'](iEnd+sEndTag['length']);sOriginal=sPre+sPost;}}}return sOriginal;},'DesignMode':function(bEnable){if(bEnable){ctrlFormDesigner['InjectEditorsIntoEditorCanvasForCurrentTab']();var sEditorDiv=ctrlFormDesigner['Settings']['EditorCanvasId'];if(ctrlFormDesigner['Data']['CurrentTab']['Name']!=ctrlFormDesigner['Data']['TopMasterName'])sEditorDiv=ctrlFormDesigner['Data']['CurrentTab']['TabPaneID'];ctrlFormDesigner['TriSysGridManager']['Draw'](sEditorDiv);}else{var sHTML=ctrlFormDesigner['TriSysGridManager']['ReadHTML']();sHTML=$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](),sHTML=ctrlFormDesigner['StripEditorsFromEditorCanvasForCurrentTab'](sHTML),$('#'+ctrlFormDesigner['Settings']['EditorCanvasId'])['html'](sHTML);}},'DesignOrPreview':function(){var bDesignModeEnabled=!ctrlFormDesigner['isPreviewEnabled']();ctrlFormDesigner['DesignMode'](bDesignModeEnabled);},'InjectedDivEditorFieldHTML':function(sID,sFieldID,sTriSysWidgetType){var sHTML=null;switch(sTriSysWidgetType){case'grid':sHTML=ctrlFormDesigner['InjectedDivEditorFieldHTMLForFieldType'](sID,sFieldID,'Grid');break;case'thumbnail':sHTML=ctrlFormDesigner['InjectedDivEditorFieldHTMLForFieldType'](sID,sFieldID,'Thumbnail');break;default:sHTML=ctrlFormDesigner['InjectedDivEditorFieldHTMLForFieldType'](sID,sFieldID,'Div');}return sHTML;},'InjectedDivEditorFieldHTMLForFieldType':function(sID,sFieldID,sTriSysWidgetType){var sFieldTemplate=$('#ctrlFormDesigner-Edit-'+sTriSysWidgetType+'-template')['html']()['trim'](),sHTML=sFieldTemplate['split']('{{Edit-'+sTriSysWidgetType+'Id}}')['join'](sFieldID);return sHTML=sHTML['split']('{{Edit-'+sTriSysWidgetType+'Name}}')['join'](sID),sHTML=sHTML['split']('{{Edit-'+sTriSysWidgetType+'BackColour}}')['join'](ctrlFormDesigner['Settings']['DesignTimeWidgetBackColour']()),sHTML;},'DesignTimeFieldHTML':function(fieldDescription,sOuterHTML){var sID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],sFieldID=ctrlFormDesigner['EditorObjectPrefix']+TriSysSDK['Miscellaneous']['GUID']()+'_'+sID,sFieldHTML=sOuterHTML;ctrlFormDesigner['Data']['Fields']['push']({'ID':sFieldID,'HTML':sFieldHTML});var sFieldTemplate=$('#ctrlFormDesigner-Edit-Field-template')['html']()['trim'](),sField=sFieldTemplate['replace'](/{{Edit-FieldId}}/g,sFieldID);return sField=sField['replace'](/{{Edit-FieldName}}/g,sID),sField=sField['replace'](/{{Edit-FieldTableName}}/g,fieldDescription['TableName']),sField=sField['replace'](/{{Edit-FieldTableFieldName}}/g,fieldDescription['TableFieldName']),sField=sField['replace'](/{{Edit-FieldBackColour}}/g,ctrlFormDesigner['Settings']['DesignTimeWidgetBackColour']()),sField;},'DesignTimeFieldLabelHTML':function(lbl,widget){var sLabelID=ctrlFormDesigner['EditorObjectPrefix']+TriSysSDK['Miscellaneous']['GUID'](),sLabelHTML,sText;if(lbl)sLabelHTML=lbl['outerHTML'],sText=lbl['innerText']['trim']();else{if(Array['isArray'](widget['HTML']))sLabelHTML=widget['HTML']['join']('\x0a');else sLabelHTML=widget['HTML'];sText=widget['Text'];}ctrlFormDesigner['Data']['Labels']['push']({'ID':sLabelID,'HTML':sLabelHTML,'Text':sText});var sLabelTemplate=$('#ctrlFormDesigner-Edit-Label-template')['html']()['trim'](),sLabel=sLabelTemplate['replace'](/{{Edit-LabelId}}/g,sLabelID);sLabel=sLabel['replace'](/{{Edit-LabelText}}/g,sText),sLabel=sLabel['replace'](/{{Edit-LabelTextId}}/g,sLabelID+'-TextId');var sBackColour=TriSysProUI['GroupBorderColour']();return sLabel=sLabel['replace'](/{{Edit-LabelBackColour}}/g,sBackColour),sLabel;},'TriSysGridManager':{'_gm':null,'Draw':function(sCanvas){ctrlFormDesigner['TriSysGridManager']['_gm']=$('#'+sCanvas)['gridmanager']({'debug':0x0,'colSelectEnabled':0x0,'controlAppend':null,'resetThemeCallback':ctrlFormDesigner['TriSysGridManager']['ApplyTheme'],'addNewFieldCallback':ctrlFormDesigner['TriSysGridManager']['popupFieldSelection']})['data']('gridmanager'),ctrlFormDesigner['TriSysGridManager']['ApplyTheme']();},'ApplyTheme':function(){var sLineColour=TriSysProUI['BackColour'](0.25),object=$('#gm-canvas\x20.gm-editing');object['css']('border-top','solid\x201px\x20'+sLineColour),object['css']('border-left','solid\x201px\x20'+sLineColour),object['css']('border-right','solid\x201px\x20'+sLineColour),object['css']('border-bottom','solid\x201px\x20'+sLineColour),sLineColour=TriSysProUI['ThemedColour'](),object=$('#gm-canvas\x20.gm-tools\x20a'),object['css']('color',sLineColour),object=$('#gm-canvas\x20.gm-editable-region\x20.gm-controls-element\x20.gm-move'),object['css']('background-color',sLineColour),object=$('#gm-canvas\x20.gm-editable-region\x20.gm-controls-element\x20.gm-delete'),object['css']('background-color',sLineColour),object=$('#gm-canvas\x20.gm-editable-region'),object['css']('border-top','solid\x201px\x20'+sLineColour),object['css']('border-left','solid\x201px\x20'+sLineColour),object['css']('border-right','solid\x201px\x20'+sLineColour),object['css']('border-bottom','solid\x201px\x20'+sLineColour);var sBackColour=TriSysProUI['BackColour']();object=$('#gm-canvas\x20.gm-tools\x20.gm-removeRow:hover,\x20#gm-canvas\x20.gm-tools\x20.gm-removeCol:hover'),object['css']('background-color',sBackColour),object=$('#gm-canvas\x20.gm-tools\x20a:hover'),object['css']('background-color',sBackColour),$('#gm-canvas\x20.gm-tools\x20a')['hover'](function(){$(this)['css']('background-color',sBackColour),$(this)['css']('color','white');},function(){$(this)['css']('background-color',''),$(this)['css']('color',sLineColour);});},'ReadHTML':function(){var sHTML=ctrlFormDesigner['TriSysGridManager']['_gm']['ReadRawHTML']();return sHTML;},'AddNewRow':function(iColumns){if(!iColumns)iColumns=0x4;ctrlFormDesigner['TriSysGridManager']['_gm']['CreateNewRow'](iColumns);},'popupFieldSelection':function(fnCallback){var fnWidgetPickerCallback=function(fieldDescription,widget){var sField=null;if(fieldDescription){var sFieldName=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],sInputHTML='<input\x20type=\x22text\x22\x20class=\x22k-textbox\x22\x20id=\x22'+sFieldName+'\x22\x20required=\x22required\x22\x20style=\x22width:100%\x22>';sField=ctrlFormDesigner['DesignTimeFieldHTML'](fieldDescription,sInputHTML);}else{if(widget)switch(widget['Name']){case'Field-Label':sField=ctrlFormDesigner['DesignTimeFieldLabelHTML'](null,widget);break;default:if(Array['isArray'](widget['HTML']))sField=widget['HTML']['join']('');else sField=widget['HTML'];}}return fnCallback(sField),widget&&(widget['ForceReEditMode']&&(ctrlFormDesigner['DesignMode'](![]),ctrlFormDesigner['DesignMode'](!![]))),!![];};ctrlFormDesigner['WidgetPickerModal']['Show'](fnWidgetPickerCallback),setTimeout(ctrlFormDesigner['TriSysGridManager']['ApplyTheme'],0x5);}},'WidgetPickerModal':{'Show':function(fnWidgetPickedCallback){var fnLoadWidgetPicker=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Widget\x20Picker',parametersObject['Image']='gi-cogwheels',parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlWidgetPicker.html'),parametersObject['OnLoadCallback']=function(){ctrlWidgetPicker['Load'](fnWidgetPickedCallback);},parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlWidgetPicker.js',null,fnLoadWidgetPicker);}},'Settings':{'HiddenDOM':'ctrlFormDesigner-DOM','EditorCanvasId':'ctrlFormDesigner-EditorCanvas','TableDesigners':![],'DesignTimeWidgetBackColour':function(){var sBackColour=TriSysProUI['BackColour'](0.33);return sBackColour=TriSysProUI['GroupBorderColour'](),sBackColour;},'Clipboard':{'_List':[],'Add':function(sID,sHTML,sType){var clipboardItem=ctrlFormDesigner['Settings']['Clipboard']['_List']['filter'](item=>item['ID']===sID)['shift']();if(clipboardItem)clipboardItem['HTML']=sHTML;else ctrlFormDesigner['Settings']['Clipboard']['_List']['push']({'ID':sID,'HTML':sHTML,'Type':sType});}}}};