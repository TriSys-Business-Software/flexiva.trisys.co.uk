var ctrlApplyToVacancy={'JobReferenceID':'ctrlApplyToVacancy_JobReference','JobReferenceLabelID':'ctrlApplyToVacancy_JobReferenceLabel','JobTitleID':'ctrlApplyToVacancy_JobTitle','JobTitleFormBlockID':'ctrlApplyToVacancy_JobTitleBlock','CoveringLetterID':'ctrlApplyToVacancy_CoveringLetter','CookieName':'ctrlApplyToVacancy.Settings','Load':function(){var iCount=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId']['length'],sReference=iCount==0x1?TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['Reference']:iCount,sJobTitle=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['JobTitle'];iCount>0x1&&($('#'+ctrlApplyToVacancy['JobReferenceLabelID'])['html']('Vacancy\x20Count'),$('#'+ctrlApplyToVacancy['JobTitleFormBlockID'])['hide']());$('#'+ctrlApplyToVacancy['JobReferenceID'])['html'](sReference),$('#'+ctrlApplyToVacancy['JobTitleID'])['html'](sJobTitle);var settings=TriSysAPI['Persistence']['Read'](ctrlApplyToVacancy['CookieName']);settings&&$('#'+ctrlApplyToVacancy['CoveringLetterID'])['val'](settings['CoveringLetter']);},'Apply':function(){var settings={'CoveringLetter':$('#'+ctrlApplyToVacancy['CoveringLetterID'])['val']()},sError=null;if(!settings['CoveringLetter'])sError='Please\x20enter\x20a\x20short\x20covering\x20letter\x20to\x20help\x20us\x20progress\x20your\x20application';if(sError)return TriSysApex['UI']['ShowMessage'](sError,TriSysWebJobs['Constants']['ApplicationName']),![];var CVacancyApplyMultiple={'Shortlist':!![],'Comments':settings['CoveringLetter'],'RequirementIdCollection':TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId'],'WebJobsRequest':TriSysWebJobs['Agency']['WebJobsRequest']()},iCount=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId']['length'];return ctrlApplyToVacancy['ApplyToMultipleVacanciesViaServer'](CVacancyApplyMultiple,iCount),TriSysAPI['Persistence']['Write'](ctrlApplyToVacancy['CookieName'],settings),!![];},'ApplyToMultipleVacanciesViaServer':function(CVacancyApplyMultiple,iNumberOfJobs){var fnPostApply=function(){TriSysApex['UI']['HideWait']();var sMessage='Applied\x20to\x20'+iNumberOfJobs+'\x20vacanc'+(iNumberOfJobs==0x1?'y':'ies')+'<br\x20/>View\x20all\x20vacancy\x20applications?';TriSysApex['UI']['questionYesNo'](sMessage,TriSysWebJobs['Constants']['ApplicationName'],'Yes',function(){return TriSysApex['FormsManager']['OpenForm'](TriSysWebJobs['Constants']['CandidateVacancyApplications'],0x0,!![]),!![];},'No');},sWaitMessage='Applying\x20to\x20'+iNumberOfJobs+'\x20Vacanc'+(iNumberOfJobs>0x1?'ies':'y')+'...';TriSysApex['UI']['ShowWait'](null,sWaitMessage);var payloadObject={};payloadObject['URL']='Vacancy/ApplyToMultiple',payloadObject['OutboundDataPacket']=CVacancyApplyMultiple,payloadObject['InboundDataFunction']=function(CVacancyApplyResult){if(CVacancyApplyResult){TriSysApex['UI']['HideWait']();if(CVacancyApplyResult['Success'])fnPostApply();else TriSysApex['UI']['errorAlert'](CVacancyApplyResult['ErrorMessage'],TriSysWebJobs['Constants']['ApplicationName']);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlApplyToVacancy.ApplyToMultipleVacanciesViaServer:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};$(document)['ready'](function(){ctrlApplyToVacancy['Load']();});