var ctrlDocumentViewer={'CurrentDocumentURL':null,'Open':function(){var sURL=TriSysSDK['Controls']['FileManager']['DocumentPath'];if(sURL)sURL=sURL['replace']('///','/');if(ctrlDocumentViewer['OpenWordDocumentAfterConversion'](sURL))return;if(TriSysSDK['Controls']['FileManager']['isPDFFile'](sURL)){$('#trisys-document-viewer-control')['hide'](),ctrlDocumentViewer['DisplayPDFInViewer'](sURL);return;}var bNewCode=![];if(!bNewCode){$('#trisys-document-viewer-iframe')['show']();var iframe=document['getElementById']('trisys-document-viewer-iframe'),sAPIKey='S6tjlASFdOx8jaqGZ3BhDtZAsFT41iKd38KFmJQTMeoh-FM7NiWro28yFyk8upyI',sPrint='&printButton=No';iframe['src']='//api.accusoft.com/v1/viewer/?key='+sAPIKey+'&viewertype=html5&document='+sURL+'&viewerheight=600&viewerwidth=100%'+'&upperToolbarColor=dae8f2&lowerToolbarColor=dae8f2&bottomToolbarColor=dae8f2&backgroundColor=ffffff&fontColor=3498db&buttonColor=black'+'&hidden=selectText,panTool,print,download';}else{var viewerParams={'document':sURL,'key':'K5102014151403','viewertype':'html5','viewerheight':'600','viewerwidth':'100%','upperToolbarColor':'dae8f2','lowerToolbarColor':'dae8f2','bottomToolbarColor':'dae8f2','backgroundColor':'ffffff','fontColor':'3498db','buttonColor':'black','hidden':'selectText,panTool,thumbnails,print,download'};try{$('#trisys-document-viewer-control')['pccViewer'](viewerParams);}catch(err){TriSysApex['UI']['ShowError'](err,'Document\x20Viewer');}}setTimeout(TriSysProUI['kendoUI_Overrides'],0xfa);},'OpenWordDocumentAfterConversion':function(sURL){if(!TriSysSDK['Controls']['FileManager']['isWordFile'](sURL)&&!TriSysSDK['Controls']['FileManager']['isHTMLFile'](sURL))return![];var sDiv='trisys-document-viewer-converted-contents',documentObject=$('#'+sDiv),iHeight=ctrlDocumentViewer['DocumentViewerHeight']();documentObject['css']('height',iHeight),$('#'+sDiv)['show'](),setTimeout(TriSysProUI['kendoUI_Overrides'],0x32);var CFileReferenceInternalToExternalPathRequest={'FolderFilePath':sURL},payloadObject={};return payloadObject['URL']='Files/ConvertFileReferenceInternalToExternalPath',payloadObject['OutboundDataPacket']=CFileReferenceInternalToExternalPathRequest,payloadObject['InboundDataFunction']=function(data){if(data){if(data['Success']){ctrlDocumentViewer['CurrentDocumentURL']=data['URL'];try{$('#'+sDiv)['load'](ctrlDocumentViewer['CurrentDocumentURL'],function(response,status,xhr){if(status=='error'){var msg='Document\x20Conversion\x20Error:\x20';TriSysApex['UI']['ShowError'](null,msg+xhr['status']+'\x20'+xhr['statusText']);}});}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}}else TriSysApex['UI']['errorAlert'](data['ErrorMessage'],TriSysWeb['Constants']['ApplicationName']);}else TriSysApex['UI']['ShowMessage']('No\x20response\x20from\x20'+payloadObject['URL'],TriSysWeb['Constants']['ApplicationName']);return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ctrlDocumentViewer.OpenWordDocumentAfterConversion:\x20',request,status,error,![]);},TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];},'OpenFullScreen':function(sTitle){var sDocumentURL=ctrlDocumentViewer['CurrentDocumentURL'];TriSysSDK['Browser']['OpenURL'](sDocumentURL);},'DownloadAndOpenButtonClick':function(sTitle,sDocumentURL){if(!TriSysSDK['Controls']['FileManager']['isWordFile'](sDocumentURL)&&!TriSysSDK['Controls']['FileManager']['isHTMLFile'](sDocumentURL)){TriSysApex['ModalDialogue']['DocumentViewer']['DownloadAndOpen'](sTitle,sDocumentURL);return;}var fnCallback=function(sTitle,sURL,sName){TriSysApex['ModalDialogue']['DocumentViewer']['DownloadAndOpen'](sTitle,sURL);},sName=null;TriSysSDK['Controls']['FileManager']['GetOpenFileURLFromWebServiceWithCallback'](sTitle,sDocumentURL,sName,!![],fnCallback);},'DisplayPDFInViewer':function(sFileURL){$('#trisys-document-viewer-iframe')['show']();var iframe=document['getElementById']('trisys-document-viewer-iframe');iframe['src']=sFileURL;return;var pdfViewerObject=$('#ctrlDocumentViewer-pdf-viewer'),iWidth=$('#trisys-document-viewer-converted-contents')['parent']()['width'](),iHeight=window['innerHeight']-0x12c;pdfViewerObject['css']('width',iWidth),pdfViewerObject['css']('height',iHeight),pdfViewerObject['attr']('data',sFileURL),pdfViewerObject['show']();},'DocumentViewerHeight':function(){var iHeight=$(window)['height'](),iCaptionAndFooterHeight=0x44*0x2;if(TriSysApex['Device']['isPhone']())iHeight=iHeight-iCaptionAndFooterHeight;else iHeight=iHeight-iCaptionAndFooterHeight*0x2;return iHeight;}};$(document)['ready'](function(){ctrlDocumentViewer['Open']();});