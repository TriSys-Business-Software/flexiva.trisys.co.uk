var ContactsPhone={'SearchTextCookieName':'ContactsPhone-Text','Load':function(sText){debugger;!sText&&(sText=TriSysAPI['Cookies']['getCookie'](ContactsPhone['SearchTextCookieName'])),sText&&($('#contacts-form-lookup')['val'](sText),ContactsPhone['LookupButtonClick']()),$('#contacts-form-lookup')['keyup'](function(e){e['keyCode']==0xd&&ContactsPhone['LookupButtonClick']();}),$('#contacts-form-lookup-button')['click'](ContactsPhone['LookupButtonClick']);},'LookupButtonClick':function(){var sText=$('#contacts-form-lookup')['val']();TriSysAPI['Cookies']['setCookie'](ContactsPhone['SearchTextCookieName'],sText),$('#contacts-form-paged-list-container')['empty'](),ContactsPhone['ShowFigures'](),ContactsPhone['_CurrentPageNumber']=0x1,ContactsPhone['WebAPISearch'](sText,ContactsPhone['_CurrentPageNumber']);},'WebAPISearch':function(sWildcard,iPageNumber){var spinnerWait={'Div':'contacts-form-paged-list-container'},CContactSearchCriteria={'Wildcard':sWildcard,'PageNumber':iPageNumber,'RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'SortColumnName':'Surname','IncludeContactPhotoURL':!![]},payloadObject={};payloadObject['URL']='Contacts/Search',payloadObject['OutboundDataPacket']=CContactSearchCriteria,payloadObject['InboundDataFunction']=function(CContactSearchResults){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]);if(CContactSearchResults){ContactsPhone['ShowFigures'](CContactSearchResults);if(CContactSearchResults['Success'])ContactsPhone['AppendRecordsToDOM'](CContactSearchResults);else{}return;}TriSysApex['UI']['ShowError']('ContactsPhone.WebAPISearch\x20Error:\x20null\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]),TriSysApex['UI']['errorAlert']('ContactsPhone.WebAPISearch:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,!![]),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowFigures':function(CContactSearchResults){var figures=$('#contacts-form-lookup-figures');figures['html'](CContactSearchResults?'No\x20records\x20found':'Searching...'),$('#contacts-form-first-page-button')['hide'](),$('#contacts-form-next-page-button')['hide']();if(CContactSearchResults&&CContactSearchResults['Success']){figures['html']('Showing\x20rows\x201\x20to\x20'+CContactSearchResults['LastRowNumber']+'\x20of\x20'+CContactSearchResults['TotalRecordCount']+'\x20records');if(CContactSearchResults['LastRowNumber']>0x8)$('#contacts-form-first-page-button')['show']();ContactsPhone['_CurrentPageNumber']=CContactSearchResults['PageNumber'];if(CContactSearchResults['PageNumber']<CContactSearchResults['TotalPageCount']){$('#contacts-form-next-page-button')['show']();var iNextPage=parseInt(CContactSearchResults['PageNumber'])+0x1;$('#contacts-form-next-page-button-text')['html']('Next\x20Page\x20'+iNextPage+'\x20of\x20'+CContactSearchResults['TotalPageCount']);}}},'AppendRecordsToDOM':function(CContactSearchResults){if(CContactSearchResults['TotalRecordCount']>0x0&&CContactSearchResults['Contacts']){for(var i=0x0;i<CContactSearchResults['Contacts']['length'];i++){var contact=CContactSearchResults['Contacts'][i],sHTML=ContactsPhone['BuildRecordFromTemplate'](contact);$('#contacts-form-paged-list-container')['append'](sHTML);}TriSysApex['Device']['FixTextEllipsesHack']('.truncated-contacts-text');if(ContactsPhone['_CurrentPageNumber']>0x1)setTimeout(ContactsPhone['ScrollToBottom'],0xa);}},'BuildRecordFromTemplate':function(CContact){var sHTML=$('#contacts-form-template')['html']();sHTML=sHTML['replace']('#:ContactId#',CContact['ContactId']),sHTML=sHTML['replace']('#:FullName#',CContact['FullName']),sHTML=sHTML['replace']('#:JobTitle#',CContact['JobTitle']?CContact['JobTitle']:''),sHTML=sHTML['replace']('#:CompanyName#',CContact['CompanyName']?CContact['CompanyName']:'');if(!CContact['ContactPhotoURL'])CContact['ContactPhotoURL']=TriSysApex['Constants']['DefaultContactImage'];return sHTML=sHTML['replace']('#:ContactPhotoURL#',CContact['ContactPhotoURL']),sHTML;},'RowClick':function(thisRow){var lContactId=thisRow;TriSysApex['FormsManager']['OpenForm']('Contact',lContactId,!![]);},'New':function(){TriSysApex['Pages']['ContactForm']['NewRecord'](0x0);},'ScrollToTop':function(){$(document['body'])['scrollTop']($('#contacts-form-top')['offset']()['top']-0x78);},'ScrollToBottom':function(){$(document['body'])['scrollTop']($('#contacts-form-first-page-button')['offset']()['top']);},'_CurrentPageNumber':0x0,'NextPage':function(){var sText=$('#contacts-form-lookup')['val']();ContactsPhone['WebAPISearch'](sText,ContactsPhone['_CurrentPageNumber']+0x1);}};