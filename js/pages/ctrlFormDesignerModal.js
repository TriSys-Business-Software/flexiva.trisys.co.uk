var ctrlFormDesignerModal={'Load':function(sFile,sJSON){ctrlFormDesignerModal['Data']['FileName']=sFile,ctrlFormDesignerModal['Data']['LayoutJSON']=sJSON;var formSpecificationObject=JSON['parse'](sJSON);ctrlFormDesignerModal['Data']['FormProperties']=formSpecificationObject['FormProperties'],ctrlFormDesignerModal['Data']['Tabs']=formSpecificationObject['Tabs'],ctrlFormDesignerModal['PopulateFormProperties'](),ctrlFormDesignerModal['Components']['PopulateComponentToolbox'](),ctrlFormDesignerModal['Fields']['PopulateFieldToolbox'](),ctrlFormDesignerModal['PopulateTabs'](),ctrlFormDesignerModal['AddEventHandlers'](),ctrlFormDesignerModal['AddDynamicStyles'](),ctrlFormDesignerModal['SetWorkspaceHeight'](),ctrlFormDesignerModal['DetectNewForm']();},'DetectNewForm':function(){var bNewForm=!ctrlFormDesignerModal['Data']['FormProperties']['Type'];if(bNewForm)ctrlFormDesignerModal['EditFormProperties']();},'AddDynamicStyles':function(){var lBackColour=TriSysProUI['BackColour'](),taskColour=TriSysProUI['ThemedSidebarBackgroundLight'](0.65),sStyleHTML='.draggable-placeholder\x20{'+'border-color:\x20'+lBackColour+';'+'border-width:\x202px;'+'background-color:\x20'+taskColour+';'+'}';sStyleHTML+='.empty-design-block\x20{'+'height:\x20'+ctrlFormDesignerModal['Settings']['CellHeight']+';'+'}';var sNameStyle='form-designer-styles';$('#'+sNameStyle)['length']?$('#'+sNameStyle)['html'](sStyleHTML):$('head')['append']('<style\x20type=\x22text/css\x22\x20id=\x22'+sNameStyle+'\x22>'+sStyleHTML+ +'</style>');},'SetWorkspaceHeight':function(){var iHeightFactor=0x172,iHeight=$(window)['height']()-iHeightFactor,iToolsBlockHeight=iHeight+0x6b;$('#ctrlFormDesignerModal-ToolsBlock')['height'](iToolsBlockHeight),$('#ctrlFormDesignerModal-ToolsBlock')['css']('max-height',iToolsBlockHeight),$('#ctrlFormDesignerModal-ToolsBlock')['css']('min-height',iToolsBlockHeight);var iEditorCanvasHeight=iHeight+0x18,elemEditCanvas=$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId']);elemEditCanvas['height'](iEditorCanvasHeight),elemEditCanvas['css']('max-height',iEditorCanvasHeight),elemEditCanvas['css']('min-height',iEditorCanvasHeight);var iToolHeight=$(window)['height']()-0x1db,elemPropertiesList=$('#ctrlFormDesignerModal-properties-list'),iPropertiesHeight=iToolHeight-0x41;elemPropertiesList['height'](iPropertiesHeight),elemPropertiesList['css']('max-height',iPropertiesHeight),elemPropertiesList['css']('min-height',iPropertiesHeight),iToolHeight=iPropertiesHeight;var elemTabs=$('#ctrlFormDesignerModal-tab-list');elemTabs['height'](iToolHeight),elemTabs['css']('max-height',iToolHeight),elemTabs['css']('min-height',iToolHeight);var iComponentsListHeight=iToolHeight+0x4,elemComponents=$('#ctrlFormDesignerModal-components-list');elemComponents['height'](iComponentsListHeight),elemComponents['css']('max-height',iComponentsListHeight),elemComponents['css']('min-height',iComponentsListHeight);var iFieldsListHeight=iComponentsListHeight,elemFields=$('#ctrlFormDesignerModal-fields-list');elemFields['height'](iFieldsListHeight),elemFields['css']('max-height',iFieldsListHeight),elemFields['css']('min-height',iFieldsListHeight),$('#trisys-modal-dynamic-content')['css']('overflow-y','auto');},'PopulateFormProperties':function(){$('#ctrlFormDesignerModal-Tools-Property-Caption')['text'](ctrlFormDesignerModal['Data']['FormProperties']['Caption']),$('#ctrlFormDesignerModal-Tools-Property-Entity')['text'](ctrlFormDesignerModal['Data']['FormProperties']['EntityName']),$('#ctrlFormDesignerModal-Tools-Property-Type')['text'](ctrlFormDesignerModal['Data']['FormProperties']['Type']);var sIcon=ctrlFormDesignerModal['Data']['FormProperties']['Icon'];if(sIcon){if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;}else sIcon=ctrlFormDesignerModal['Data']['WarningSignIcon'];var sIcon='<i\x20class=\x22'+sIcon+'\x20themed-color\x20icon-push\x22></i>';$('#ctrlFormDesignerModal-Tools-Property-Icon')['html'](sIcon);var bFieldsToolVisible=ctrlFormDesignerModal['Data']['FormProperties']['Type']=='Entity\x20Form'&&ctrlFormDesignerModal['Data']['FormProperties']['EntityName'],elemFieldsTools=$('#ctrlFormDesignerModal-Tools-Fields-Panel');bFieldsToolVisible?elemFieldsTools['show']():elemFieldsTools['hide']();},'PopulateTabs':function(){if(ctrlFormDesignerModal['Data'])ctrlFormDesignerModal['PopulateListOfTabs'](ctrlFormDesignerModal['Data']['Tabs']);},'PopulateListOfTabs':function(tabs,sSelectedTabID){var sUL='ctrlFormDesignerModal-tab-list',sItemPrefix=sUL+'-item-',sItemTemplate=sItemPrefix+'template',sRowTemplateHTML=document['getElementById'](sItemTemplate)['outerHTML'];$('#'+sUL)['find']('li')['each'](function(){var sID=this['id'];if(sID!=sItemTemplate)$(this)['remove']();});for(var i=0x0;i<tabs['length'];i++){var tab=tabs[i];tab['Ordering']=i+0x1;var sRowItemHTML=sRowTemplateHTML,sItemID=sItemPrefix+tab['ID'];sRowItemHTML=sRowItemHTML['replace'](sItemTemplate,sItemID),sRowItemHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowItemHTML);var sOnClick='ctrlFormDesignerModal.SelectTab(\x27'+tab['ID']+'\x27)';sRowItemHTML=sRowItemHTML['replace']('##tab-click-event##',sOnClick);var sIcon=tab['Icon'];if(sIcon){if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;}else sIcon=ctrlFormDesignerModal['Data']['WarningSignIcon'];sRowItemHTML=sRowItemHTML['replace']('##tab-icon##',sIcon),sRowItemHTML=sRowItemHTML['replace']('##tab-name##',tab['ID']),sRowItemHTML=sRowItemHTML['replace']('##tab-caption##',tab['Caption']),$('#'+sUL)['append'](sRowItemHTML);var sHistorySelectedTabID=ctrlFormDesignerModal['Data']['SelectedTabID'];if(!sSelectedTabID&&!sHistorySelectedTabID){if(i==0x0)sSelectedTabID=tab['ID'];}if(sSelectedTabID==tab['ID']||tab['ID']==sHistorySelectedTabID)ctrlFormDesignerModal['SelectTab'](tab['ID']);}},'SelectTab':function(sTabID){var tab=ctrlFormDesignerModal['DataFunctions']['TabFromID'](sTabID);if(!tab)return;$('#ctrlFormDesignerModal-TabCaption')['html']('Tab\x20Layout:\x20'+tab['Caption']);var sUL='ctrlFormDesignerModal-tab-list';$('#'+sUL)['find']('li')['each'](function(){$(this)['removeClass']('active');});var sItemPrefix=sUL+'-item-',sItemID=sItemPrefix+sTabID;$('#'+sItemID)['addClass']('active'),ctrlFormDesignerModal['Data']['CurrentTab']=tab,ctrlFormDesignerModal['Data']['SelectedTabID']=sTabID,ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['ReadTabListFromMemoryToTabLayout']();},'TabAdd':function(){ctrlFormDesignerModal['OpenTabEditor'](null);},'TabEdit':function(){var tab=ctrlFormDesignerModal['GetSelectedTab']();if(tab)ctrlFormDesignerModal['OpenTabEditor'](tab);},'TabDelete':function(){var tab=ctrlFormDesignerModal['GetSelectedTab']();if(!tab)return;if(tab['ID']==ctrlFormDesignerModal['Data']['TopMasterName']||ctrlFormDesignerModal['Data']['Tabs']['length']<=0x2){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20delete\x20this\x20tab.');return;}var fnDeleteTab=function(){var iIndex=ctrlFormDesignerModal['DataFunctions']['TabIndexFromID'](tab['ID']);if(iIndex>0x0)ctrlFormDesignerModal['Data']['Tabs']['splice'](iIndex,0x1);return ctrlFormDesignerModal['PopulateListOfTabs'](ctrlFormDesignerModal['Data']['Tabs'],ctrlFormDesignerModal['Data']['TopMasterID']),!![];},sMessage='Are\x20you\x20sure\x20you\x20wish\x20to\x20delete\x20tab:\x20'+tab['Caption']+'?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Tab','Yes',fnDeleteTab,'No');},'TabMove':function(bUp){var tab=ctrlFormDesignerModal['GetSelectedTab']();if(!tab)return;var iIndex=ctrlFormDesignerModal['DataFunctions']['TabIndexFromID'](tab['ID']);if(iIndex<=0x0){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab.');return;}if(bUp){if(iIndex<=0x1){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab\x20upwards.');return;}var movedUpTab=ctrlFormDesignerModal['Data']['Tabs'][iIndex];ctrlFormDesignerModal['Data']['Tabs'][iIndex]=ctrlFormDesignerModal['Data']['Tabs'][iIndex-0x1],ctrlFormDesignerModal['Data']['Tabs'][iIndex-0x1]=movedUpTab;}else{if(iIndex==ctrlFormDesignerModal['Data']['Tabs']['length']-0x1){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20move\x20this\x20tab\x20downwards.');return;}var movedDownTab=ctrlFormDesignerModal['Data']['Tabs'][iIndex];ctrlFormDesignerModal['Data']['Tabs'][iIndex]=ctrlFormDesignerModal['Data']['Tabs'][iIndex+0x1],ctrlFormDesignerModal['Data']['Tabs'][iIndex+0x1]=movedDownTab;}ctrlFormDesignerModal['PopulateListOfTabs'](ctrlFormDesignerModal['Data']['Tabs'],tab['ID']);},'OpenTabEditor':function(tab){var bNewTab=![];if(!tab)tab={'Caption':'New\x20Tab','Icon':ctrlFormDesignerModal['Data']['WarningSignIcon'],'HTML':'','Visible':!![]},bNewTab=!![],ctrlFormDesignerModal['Data']['CurrentTab']=tab;else{if(tab['Caption']==ctrlFormDesignerModal['Data']['TopMasterCaption']){TriSysApex['UI']['ShowMessage'](ctrlFormDesignerModal['Data']['TopMasterCaption']+'\x20is\x20not\x20editable\x20as\x20it\x20fixed.');return;}}var sIcon=tab['Icon'];if(sIcon){if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;}else sIcon=ctrlFormDesignerModal['Data']['WarningSignIcon'];var properties=[{'Name':'Active','Description':['Whether\x20the\x20tab\x20is\x20active\x20when\x20form\x20opened'],'Type':'Boolean','Title':'Active','Default':tab['Active']},{'Name':'Caption','Description':['The\x20text\x20of\x20the\x20tab'],'Type':'TextBox','Default':tab['Caption']},{'Name':'Icon','Description':['The\x20icon\x20shown\x20with\x20the\x20caption'],'Type':'Icon','Title':'Icon','Default':sIcon},{'Name':'ID','Description':['The\x20JQuery\x20ID\x20of\x20the\x20tab\x20<li>\x20item'],'Type':'TextBox','Default':tab['ID']},{'Name':'Visible','Description':['Whether\x20the\x20tab\x20is\x20visible\x20or\x20not'],'Type':'Boolean','Title':'Visible','Default':tab['Visible']}],options={'Title':'Tab:\x20'+tab['Caption'],'Image':'gi-more','SubTitle':'Tab\x20Properties','Items':properties,'FieldValueChange':function(sCategory,sName,objValue){if(!ctrlFormDesignerModal['Data']['EditedPropertiesList'])ctrlFormDesignerModal['Data']['EditedPropertiesList']=ctrlFormDesignerModal['Data']['CurrentTab'];ctrlFormDesignerModal['Data']['EditedPropertiesList'][sName]=objValue;},'Apply':function(){if(ctrlFormDesignerModal['Data']['EditedPropertiesList']){var editedTab=ctrlFormDesignerModal['Data']['EditedPropertiesList'];if(!editedTab['ID'])editedTab['ID']=ctrlFormDesignerModal['TabIDFromCaption'](editedTab['Caption']);var bDuplicate=![];if(bNewTab)for(var i=0x0;i<ctrlFormDesignerModal['Data']['Tabs']['length'];i++){var tab=ctrlFormDesignerModal['Data']['Tabs'][i];if(tab['ID']==editedTab['ID'])bDuplicate=!![];}else for(var i=0x0;i<ctrlFormDesignerModal['Data']['Tabs']['length'];i++){var tab1=ctrlFormDesignerModal['Data']['Tabs'][i];for(var j=0x0;j<ctrlFormDesignerModal['Data']['Tabs']['length'];j++){var tab2=ctrlFormDesignerModal['Data']['Tabs'][j];if(tab1['ID']==tab2['ID']&&j!=i)bDuplicate=!![];}}if(bDuplicate)return TriSysApex['UI']['ShowMessage']('Tab\x20ID\x27s\x20must\x20be\x20unique.'),![];if(bNewTab)ctrlFormDesignerModal['Data']['Tabs']['push'](editedTab);else{var sIcon=editedTab['Icon'];editedTab['outerHTML']=TriSysSDK['Miscellaneous']['ReplaceWithinTags'](editedTab['outerHTML'],'<i\x20','</i>','<i\x20class=\x22'+sIcon+'\x22></i>'),editedTab['outerHTML']=TriSysSDK['Miscellaneous']['ReplaceWithinTags'](editedTab['outerHTML'],'</i>','</a>','</i>\x20'+editedTab['Caption']+'</a>'),ctrlFormDesignerModal['Data']['CurrentTab']=editedTab;}return editedTab['Active']&&ctrlFormDesignerModal['Data']['Tabs']['forEach'](function(existingTab){if(existingTab['ID']!=editedTab['ID']){if(existingTab['Active']){if(existingTab['outerHTML'])existingTab['outerHTML']=existingTab['outerHTML']['replace']('class=\x22active\x22','');existingTab['Active']=![];}}}),ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['PopulateListOfTabs'](ctrlFormDesignerModal['Data']['Tabs'],editedTab['ID']),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20new\x20tab\x20properties.');}};ctrlFormDesignerModal['Data']['EditedPropertiesList']=null,ctrlFormDesignerModal['OpenPropertySheet'](options);},'EditFormProperties':function(){var sIcon=ctrlFormDesignerModal['Data']['FormProperties']['Icon'];if(sIcon){if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;}else sIcon=ctrlFormDesignerModal['Data']['WarningSignIcon'];var entityTypes=TriSysApex['Cache']['EntityTypes'](),lstEntity=[''];entityTypes['forEach'](function(entityType){if(lstEntity['indexOf'](entityType['EntityName'])<0x0)lstEntity['push'](entityType['EntityName']);});var lstFormType=['Entity\x20Form','Modal\x20Form','Virtual\x20Form'],properties=[{'Name':'Caption','Description':['The\x20caption\x20text\x20of\x20the\x20form'],'Type':'TextBox','Default':ctrlFormDesignerModal['Data']['FormProperties']['Caption']},{'Name':'EntityName','Description':['The\x20entity\x20in\x20the\x20SQL\x20database'],'Type':'SingleSelectCombo','List':lstEntity,'SelectedText':ctrlFormDesignerModal['Data']['FormProperties']['EntityName']},{'Name':'Icon','Description':['The\x20icon\x20shown\x20with\x20the\x20caption'],'Type':'Icon','Title':'Icon','Default':sIcon},{'Name':'Type','Description':['What\x20type\x20of\x20form\x20this\x20is'],'Type':'SingleSelectCombo','List':lstFormType,'SelectedText':ctrlFormDesignerModal['Data']['FormProperties']['Type']}],sCurrentEntityName=ctrlFormDesignerModal['Data']['FormProperties']['EntityName'],options={'Title':'Form\x20Properties:\x20'+DeveloperStudio['DeveloperFileNameDisplay'](ctrlFormDesignerModal['Data']['FileName']),'Image':'gi-cog','SubTitle':'Form\x20Properties','Items':properties,'FieldValueChange':function(sCategory,sName,objValue){if(!ctrlFormDesignerModal['Data']['EditedPropertiesList'])ctrlFormDesignerModal['Data']['EditedPropertiesList']=ctrlFormDesignerModal['Data']['FormProperties'];ctrlFormDesignerModal['Data']['EditedPropertiesList'][sName]=objValue;},'Apply':function(){if(ctrlFormDesignerModal['Data']['EditedPropertiesList']){var bEntityNameChanged=sCurrentEntityName!=ctrlFormDesignerModal['Data']['EditedPropertiesList']['EntityName'];bEntityNameChanged&&setTimeout(function(){ctrlFormDesignerModal['DesignMode'](!![]);},0x64);ctrlFormDesignerModal['Data']['FormProperties']=ctrlFormDesignerModal['Data']['EditedPropertiesList'];var lstError=[];if(!ctrlFormDesignerModal['Data']['FormProperties']['Caption'])lstError['push']('Caption');if(!ctrlFormDesignerModal['Data']['FormProperties']['Type'])lstError['push']('Type');if(lstError['length']>0x0){var sError='';return lstError['forEach'](function(sField){if(sError['length']>0x0)sError+=',\x20';sError+=sField;}),sError='Please\x20complete\x20these\x20form\x20properties\x20fields:\x20'+sError,setTimeout(function(){TriSysApex['UI']['ShowMessage'](sError);},0xa),![];}return ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['PopulateFormProperties'](),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20form\x20properties.');}};ctrlFormDesignerModal['Data']['EditedPropertiesList']=null,ctrlFormDesignerModal['OpenPropertySheet'](options);},'OpenPropertySheet':function(options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=options['Title'],parametersObject['Image']=options['Image'];var lWidth=$(window)['width']()/0x2;parametersObject['Width']=lWidth,parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlFormDesignerPropertySheet.html',parametersObject['OnLoadCallback']=function(){var lHeight=$(window)['height']()*0.5,propertySheetData={'title':options['SubTitle'],'propertyColumnName':'Property','valueColumnName':'Setting','categoryColumnHide':!![],'descriptionColumnHide':!![],'height':lHeight,'objectList':options['Items'],'fieldValueChange':options['FieldValueChange']},fnAfterDraw=function(){ctrlPropertySheet['ApplyDefaults']('ctrlFormDesigner-PropertySheet',propertySheetData);};TriSysApex['PropertySheet']['Draw']('ctrlFormDesigner-PropertySheet',propertySheetData,function(){setTimeout(fnAfterDraw(),0xfa);});},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){return options['Apply']();},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);},'GetSelectedTab':function(){var sTabID=ctrlFormDesignerModal['GetSelectedTabID'](),tab=ctrlFormDesignerModal['DataFunctions']['TabFromID'](sTabID);return tab;},'GetSelectedTabID':function(){var sTabID=null,sUL='ctrlFormDesignerModal-tab-list';return $('#'+sUL)['find']('li')['each'](function(){var bActive=$(this)['hasClass']('active');if(bActive)sTabID=this['id']['replace']('ctrlFormDesignerModal-tab-list-item-','');}),sTabID;},'SaveTabLayoutToTabListInMemory':function(){if(ctrlFormDesignerModal['Data']['CurrentTab']){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];rows&&(ctrlFormDesignerModal['Persistence']['ReadCurrentTabLayoutIntoMemoryArray'](),ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']));}},'FindDOMObjectsInContainer':function(sColumnBlockID,sPrefix,bIgnoreLengthCheck){var lstDOMobjects=null,nodesArray=TriSysSDK['DocumentObjectModel']['GetAllNodesBeneathUniqueDivID'](sColumnBlockID);if(nodesArray)for(var i=0x0;i<nodesArray['length'];i++){var node=nodesArray[i];if(node['id']){var sID=node['id'];if(sID['indexOf'](sPrefix)==0x0){var sAttributeType=null,sObjectIDValue=null,sObjectGUID=null,bAddToDOMArray=![];if(bIgnoreLengthCheck)bAddToDOMArray=!![];else{var lstAttributes=['trisys-component-id','trisys-field-id'],iAttributeIndex=0x0;lstAttributes['forEach'](function(sAttribute){iAttributeIndex+=0x1;var s=$('#'+sID)['attr'](sAttribute);if(s){sObjectIDValue=s;switch(iAttributeIndex){case 0x1:sAttributeType='Component';break;case 0x2:sAttributeType='Field';break;}}}),sObjectIDValue&&(bAddToDOMArray=!![],lstAttributes=['trisys-component-guid','trisys-field-guid'],lstAttributes['forEach'](function(sAttribute){var s=$('#'+sID)['attr'](sAttribute);if(s)sObjectGUID=s;}));}if(bAddToDOMArray){if(!lstDOMobjects)lstDOMobjects=[];lstDOMobjects['push']({'DOMid':sID,'ObjectID':sObjectIDValue,'GUID':sObjectGUID,'Type':sAttributeType});}}}}return lstDOMobjects;},'ReadTabListFromMemoryToTabLayout':function(){ctrlFormDesignerModal['Data']['CurrentTab']&&(sHTML=$('#ctrlFormDesignerModal-tab-layout-html')['html'](),$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId'])['html'](sHTML),ctrlFormDesignerModal['DrawLayoutFramework'](),ctrlFormDesignerModal['DesignMode'](!![]),ctrlFormDesignerModal['TweakCellsBasedUponDimensions']());},'TweakCellsBasedUponDimensions':function(){var lstToolMenu=[{'prefix':'formdesigner-column-edit-tool-menu-','minWidth':0x64},{'prefix':'formdesigner-component-edit-tool-menu-','minWidth':0x6e},{'prefix':'formdesigner-field-edit-tool-menu-','minWidth':0x5a}];lstToolMenu['forEach'](function(menuCaptionVisible){$(document)['find']('[id^=\x27'+menuCaptionVisible['prefix']+'\x27]')['each'](function(){var parentCellElement=$(this)['parent']()['parent']()['parent']()['parent']()['parent'](),iWidth=parentCellElement['width'](),bShow=iWidth>=menuCaptionVisible['minWidth'];bShow?$(this)['show']:$(this)['hide']();});});var lstToolCaption=['field-tool-caption','component-tool-caption'];lstToolCaption['forEach'](function(sToolCaption){$(document)['find']('[class=\x27'+sToolCaption+'\x27]')['each'](function(){var iWidth=$(this)['parent']()['width']();iWidth>0x0&&($(this)['css']('text-overflow','ellipsis'),$(this)['css']('overflow','hidden'),$(this)['css']('white-space','nowrap'),$(this)['css']('width',iWidth+'px'));});});},'TabIDFromCaption':function(sCaption){sCaption=sCaption['trim']();var sTabID=sCaption['replace']('/','-')['replace'](/ /g,'-');return sTabID=sTabID['replace'](/[|&;$%@"<>()+,]/g,''),sTabID;},'AddEventHandlers':function(){$('#ctrlFormDesignerModal-configure-layout')['on']('click',function(){ctrlFormDesignerModal['ConfigureLayoutModal']['Show']();}),$('#ctrlFormDesignerModal-MinimizeTools')['on']('click',function(e){$('#ctrlFormDesignerModal-MinimizeTools')['hide'](),$('#ctrlFormDesignerModal-MaximizeTools')['show'](),$('#ctrlFormDesignerModal-LeftBlock-Title')['html'](''),ctrlFormDesignerModal['ResizeBlockColumns'](![]);}),$('#ctrlFormDesignerModal-MaximizeTools')['on']('click',function(e){$('#ctrlFormDesignerModal-MaximizeTools')['hide'](),$('#ctrlFormDesignerModal-MinimizeTools')['show'](),$('#ctrlFormDesignerModal-LeftBlock-Title')['html']('Tools'),ctrlFormDesignerModal['ResizeBlockColumns'](!![]);}),$('#ctrlFormDesignerModal-undo-layout')['on']('click',function(){ctrlFormDesignerModal['UndoRedo'](!![]);}),$('#ctrlFormDesignerModal-redo-layout')['on']('click',function(){ctrlFormDesignerModal['UndoRedo'](![]);});var txtComponentFilter=$('#ctrlFormDesignerModal-component-filter');txtComponentFilter['off']()['keyup'](function(e){e['keyCode']!=0xd&&(sFilter=txtComponentFilter['val'](),ctrlFormDesignerModal['Components']['FilterComponents'](sFilter));});var txtFieldFilter=$('#ctrlFormDesignerModal-field-filter');txtFieldFilter['off']()['keyup'](function(e){e['keyCode']!=0xd&&(sFilter=txtFieldFilter['val'](),ctrlFormDesignerModal['Fields']['FilterFields'](sFilter));});},'ResizeBlockColumns':function(bLeftOpen){var sLeft='ctrlFormDesignerModal-LeftBlock',sRight='ctrlFormDesignerModal-RightBlock',sLargerLeftClass='col-md-2\x20col-lg-2',sSmallerLeftClass='col-md-1\x20col-lg-1',sSmallerRightClass='col-md-10\x20col-lg-10',sLargerRightClass='col-md-12\x20col-lg-12';$('#'+sLeft)['removeClass']()['addClass'](bLeftOpen?sLargerLeftClass:sSmallerLeftClass),$('#'+sRight)['removeClass']()['addClass'](bLeftOpen?sSmallerRightClass:sLargerRightClass);var accordion=$('#ctrlFormDesignerModal-Tools-group-panel');bLeftOpen?accordion['show']():accordion['hide'](),bLeftOpen?$('#'+sLeft)['show']():$('#'+sLeft)['hide']();},'PreviewMode':function(sDeviceType){var elemEditCanvas=$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId']),elemPreviewCanvas=$('#ctrlFormDesignerModal-PreviewCanvas'),elemAddRow=$('#ctrlFormDesignerModal-add-row-button'),elemLayoutStyle=$('#ctrlFormDesignerModal-configure-layout'),elemUndoButton=$('#ctrlFormDesignerModal-undo-layout'),elemRedoButton=$('#ctrlFormDesignerModal-redo-layout'),elemEditModeButton=$('#ctrlFormDesignerModal-edit-menu'),elemPreviewModeButton=$('#ctrlFormDesignerModal-preview-menu'),elemTabCaption=$('#ctrlFormDesignerModal-TabCaption'),elemMinimizeToolsButton=$('#ctrlFormDesignerModal-MinimizeTools'),elemMaximizeToolsButton=$('#ctrlFormDesignerModal-MaximizeTools');if(!sDeviceType){elemPreviewCanvas['hide'](),elemEditCanvas['show'](),elemAddRow['attr']('disabled',![]),elemLayoutStyle['attr']('disabled',![]),elemUndoButton['attr']('disabled',!ctrlFormDesignerModal['Settings']['History']['CanGoBack']()),elemRedoButton['attr']('disabled',!ctrlFormDesignerModal['Settings']['History']['CanGoForward']()),elemPreviewModeButton['show'](),elemEditModeButton['hide'](),elemMinimizeToolsButton['hide'](),elemMaximizeToolsButton['show'](),elemMaximizeToolsButton['trigger']('click'),elemMaximizeToolsButton['attr']('disabled',![]);var selectedTab=ctrlFormDesignerModal['DataFunctions']['TabFromID'](ctrlFormDesignerModal['Data']['SelectedTabID']);elemTabCaption['text']('Tab\x20Layout:\x20'+selectedTab['Caption']);}else{elemEditCanvas['hide'](),elemPreviewCanvas['show'](),elemAddRow['attr']('disabled',!![]),elemLayoutStyle['attr']('disabled',!![]),elemUndoButton['attr']('disabled',!![]),elemRedoButton['attr']('disabled',!![]),elemEditModeButton['show'](),elemTabCaption['text']('Preview\x20Mode:\x20'+sDeviceType),elemMinimizeToolsButton['show'](),elemMaximizeToolsButton['hide'](),elemMinimizeToolsButton['trigger']('click'),elemMaximizeToolsButton['attr']('disabled',!![]);var data=ctrlFormDesignerModal['Data'];ctrlFormDesignerModal['FormRenderer']['RenderFormInPreview'](data,sDeviceType,elemPreviewCanvas);}},'DesignMode':function(bEnable){if(!ctrlFormDesignerModal['Data']['CurrentTab'])return;var layout=ctrlFormDesignerModal['Data']['CurrentTab']['Layout'];if(!layout)return;var sDivCollection='',sDraggableBlockRowColPrefix='#formdesigner-block-row-';for(var i=0x0;i<layout['Rows']['length'];i++){var row=layout['Rows'][i];for(var col=0x0;col<row['Columns']['length'];col++){if(sDivCollection['length']>0x0)sDivCollection+=',\x20';sDivCollection+=sDraggableBlockRowColPrefix+(i+0x1)+'-column-'+(col+0x1);}}ctrlFormDesignerModal['Components']['PopulateComponentToolbox'](),ctrlFormDesignerModal['Fields']['PopulateFieldToolbox']();var sComponentsDivCollection=ctrlFormDesignerModal['Components']['GetComponentToolboxItemsAsIDString'](),sFieldsDivCollection=ctrlFormDesignerModal['Fields']['GetFieldToolboxItemsAsIDString']();if(sDivCollection['length']>0x0&&sComponentsDivCollection)sDivCollection+=',\x20';sDivCollection+=sComponentsDivCollection;if(sDivCollection['length']>0x0&&sFieldsDivCollection)sDivCollection+=',\x20';sDivCollection+=sFieldsDivCollection;if(bEnable)$(sDivCollection)['sortable']({'connectWith':'.column','items':'.block','opacity':0.75,'handle':'.block-title','placeholder':'draggable-placeholder','tolerance':'pointer','start':function(e,ui){ui['placeholder']['css']('height',ui['item']['outerHeight']());},'receive':function(ev,ui){},'activate':function(ev,ui){},'change':function(ev,ui){try{var sDestination=ev['target']['id'],sSource=ui['item'][0x0]['parentElement']['id'];console['log']('change:\x20src='+sSource+',\x20dest='+sDestination);if(sDestination!=sSource){var sClass='block\x20empty-design-block';$('#'+sDestination)['children']('*[class^=\x27'+sClass+'\x27]')['each'](function(){$(this)['remove']();});}ctrlFormDesignerModal['KludgeToReplaceRemovedEmptyBlocksAfterDragDropOperation'](sDestination);}catch(e){}},'out':function(ev,ui){var sID=ui['item'][0x0]['id'],sSource=ev['target']['id'],sDestination=ui['item'][0x0]['parentElement']['id'];},'over':function(ev,ui){var sID=ui['item'][0x0]['id'],sSource=ev['target']['id'],sDestination=ui['item'][0x0]['parentElement']['id'];},'stop':function(ev,ui){var sID=ui['item'][0x0]['id'],sSource=ev['target']['id'],sDestination=ui['item'][0x0]['parentElement']['id'];console['log']('stop:\x20src='+sSource+',\x20dest='+sDestination);var bSourceAndDestinationSameLocation=sSource==sDestination,elemSource=$('#'+sSource),elemDestination=$('#'+sDestination),bRefreshDesignMode=![],bExistingFieldOrComponentInDestinationBlock=![],iFieldOrComponentCount=0x0;elemDestination['find']('[id^=\x27component-name-\x27]')['each'](function(){iFieldOrComponentCount++,bExistingFieldOrComponentInDestinationBlock=iFieldOrComponentCount>0x1;}),elemDestination['find']('[id^=\x27field-name-\x27]')['each'](function(){iFieldOrComponentCount++,bExistingFieldOrComponentInDestinationBlock=iFieldOrComponentCount>0x1;});if(bExistingFieldOrComponentInDestinationBlock||bSourceAndDestinationSameLocation)elemDestination['sortable']('cancel'),elemSource['sortable']('cancel');else{elemDestination['find']('[id^=\x27formdesigner-block-empty-\x27]')['each'](function(){$('#'+this['id'])['remove']();});var bComponentToolbox=sSource['indexOf']('formdesigner-component-tool')==0x0,bFieldToolbox=sSource['indexOf']('formdesigner-field-tool')==0x0,bDesignBlock=sSource['indexOf']('formdesigner-block-row-')==0x0,sGUID=null;if(bDesignBlock){var sEmptyHTML=$('#ctrlFormDesignerModal-empty-block-html')['html']();sGUID=TriSysSDK['Miscellaneous']['GUID'](),sEmptyHTML=sEmptyHTML['replace']('{{GUID}}',sGUID),elemSource['append'](sEmptyHTML);}else{if(bComponentToolbox||bFieldToolbox){var sType=bComponentToolbox?'component':'field',sItemID=elemSource['attr']('trisys-'+sType+'-id');sGUID=elemSource['attr']('trisys-'+sType+'-guid');var sConfigureBlockID='formdesigner-'+sType+'-edit-tool-'+sItemID+'-'+sGUID,elemConfigureBlock=$('#'+sConfigureBlockID);elemConfigureBlock['show'](),elemDestination['children']()['css']('height',ctrlFormDesignerModal['Settings']['CellHeight']),elemDestination['children']()['css']('margin-bottom','20px');if(bComponentToolbox){if(!ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components'])ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']=[];var draggedDroppedComponent=null;ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']['forEach'](function(component){if(component['GUID']==sGUID)draggedDroppedComponent=component;});if(!draggedDroppedComponent){var component=ctrlFormDesignerModal['Components']['GetComponentByID'](sItemID),componentProperties=component['Properties'];if(!componentProperties)componentProperties={'Visible':!![]};draggedDroppedComponent={'ID':sItemID,'GUID':sGUID,'Location':sDestination,'Properties':componentProperties},ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']['push'](draggedDroppedComponent);}}else{if(bFieldToolbox){if(!ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields'])ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']=[];var draggedDroppedField=null;ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']['forEach'](function(field){if(field['GUID']==sGUID)draggedDroppedField=field;});if(!draggedDroppedField){var field=ctrlFormDesignerModal['Fields']['GetFieldByID'](sItemID);draggedDroppedField={'ID':sItemID,'GUID':sGUID,'Location':sDestination,'Properties':{'Visible':!![]}},ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']['push'](draggedDroppedField);}}}bFieldToolbox?elemSource['parent']()['remove']():bRefreshDesignMode=!![];}}}ctrlFormDesignerModal['KludgeToReplaceRemovedEmptyBlocksAfterDragDropOperation']();!bExistingFieldOrComponentInDestinationBlock&&ctrlFormDesignerModal['SaveTabLayoutToTabListInMemory']();if(bRefreshDesignMode){var fnRefresh=function(){ctrlFormDesignerModal['DesignMode'](!![]);};setTimeout(fnRefresh,0xa);}},'update':function(ev,ui){}}),$(sDivCollection)['sortable']('enable');else $(sDivCollection)['sortable']('disable');var bShow=bEnable;},'ListOfDesignBlockIds':function(){var lstID=[];return $('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId'])['find']('[id^=\x27formdesigner-block-row-\x27]')['each'](function(){if(this['id']!=='formdesigner-block-row-template')lstID['push'](this['id']);}),lstID;},'KludgeToReplaceRemovedEmptyBlocksAfterDragDropOperation':function(sExceptionBlockID){if(ctrlFormDesignerModal['Data']['CurrentTab']['Layout']){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(rows){var lstID=ctrlFormDesignerModal['ListOfDesignBlockIds']();lstID['forEach'](function(sID){if(sID!=sExceptionBlockID){var bFieldOrComponentFound=![];$('#'+sID)['find']('[id^=\x27component-name-\x27]')['each'](function(){bFieldOrComponentFound=!![];}),$('#'+sID)['find']('[id^=\x27field-name-\x27]')['each'](function(){bFieldOrComponentFound=!![];});var bEmptyBlockFound=![];$('#'+sID)['find']('[id^=\x27formdesigner-block-empty-\x27]')['each'](function(){bEmptyBlockFound=!![];});if(!bFieldOrComponentFound&&!bEmptyBlockFound){var sEmptyHTML=$('#ctrlFormDesignerModal-empty-block-html')['html'](),sGUID=TriSysSDK['Miscellaneous']['GUID']();sEmptyHTML=sEmptyHTML['replace']('{{GUID}}',sGUID),$('#'+sID)['append'](sEmptyHTML);}}});}var elemCanvas=$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId']);elemCanvas['find']('[id^=\x27formdesigner-block-empty-\x27]')['each'](function(){var parentColumn=$(this)['parent'](),bRowChildren=![];parentColumn['find']('[class=\x27row\x27]')['each'](function(){bRowChildren=!![];});if(bRowChildren)$(this)['remove']();});}},'DrawLayoutFramework':function(){ctrlFormDesignerModal['DeleteExistingRowsAndColumnLayout']();if(!ctrlFormDesignerModal['Data']['CurrentTab']['Layout']){ctrlFormDesignerModal['Data']['CurrentTab']['Layout']={'Rows':[]};var bAddBlankRowsAndColumnsToEmptyTabs=!![];bAddBlankRowsAndColumnsToEmptyTabs&&(ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows']=[{'Columns':[{'Width':0x4},{'Width':0x4},{'Width':0x4}]},{'Columns':[{'Width':0xa,'Rows':[{'Columns':[{'Width':0xa,'Rows':[{'Columns':[{'Width':0x7},{'Width':0x5}]},{'Columns':[{'Width':0x4},{'Width':0x4},{'Width':0x4}]},{'Columns':[{'Width':0x5},{'Width':0x7}]}]},{'Width':0x2}]}]},{'Width':0x2}]},{'Columns':[{'Width':0xc}]}]);}if(ctrlFormDesignerModal['Data']['CurrentTab']['Layout']){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(rows)for(var iRow=0x0;iRow<rows['length'];iRow++){var row=rows[iRow];ctrlFormDesignerModal['DrawRowLayout'](iRow+0x1,row);}ctrlFormDesignerModal['DrawLayoutFrameworkComponents'](),ctrlFormDesignerModal['DrawLayoutFrameworkFields']();}},'DrawLayoutFrameworkComponents':function(){var components=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components'];if(components)for(var i=0x0;i<components['length'];i++){var component=components[i],sHTML=ctrlFormDesignerModal['Components']['GetComponentToolboxItemHTML'](component),elem=$('#'+component['Location']);elem['prepend'](sHTML);var sComponentDOMid='component-name-'+component['ID']+'-'+component['GUID'],elemComponent=$('#'+sComponentDOMid);elemComponent['css']('height',ctrlFormDesignerModal['Settings']['CellHeight']),elemComponent['css']('margin-bottom','20px'),elemComponent['unwrap'](),elemComponent['unwrap']();var sComponentConfigureDOMid='formdesigner-component-edit-tool-'+component['ID']+'-'+component['GUID'];$('#'+sComponentConfigureDOMid)['show'](),elem['find']('[id^=\x27formdesigner-block-empty-\x27]')['each'](function(){$('#'+this['id'])['remove']();});}},'DrawLayoutFrameworkFields':function(){var fields=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields'];if(fields)for(var i=0x0;i<fields['length'];i++){var field=fields[i],sHTML=ctrlFormDesignerModal['Fields']['GetFieldToolboxItemHTML'](field),elem=$('#'+field['Location']);elem['prepend'](sHTML);var sFieldDOMid='field-name-'+field['ID']+'-'+field['GUID'],elemField=$('#'+sFieldDOMid);elemField['css']('height',ctrlFormDesignerModal['Settings']['CellHeight']),elemField['css']('margin-bottom','20px'),elemField['unwrap'](),elemField['unwrap']();var sFieldConfigureDOMid='formdesigner-field-edit-tool-'+field['ID']+'-'+field['GUID'];$('#'+sFieldConfigureDOMid)['show'](),elem['find']('[id^=\x27formdesigner-block-empty-\x27]')['each'](function(){$('#'+this['id'])['remove']();});}},'DeleteExistingRowsAndColumnLayout':function(){var iMaxRows=0x20;for(var iRow=0x1;iRow<=iMaxRows;iRow++){var sRowTemplateID='draggable-blocks-row-',rowID=sRowTemplateID+iRow;$('#'+rowID)['empty'](),$('#'+rowID)['remove']();}},'DrawRowLayout':function(iRowNumber,row,sParentColumnID){var sRowTemplateID='draggable-blocks-row-',elem=document['getElementById'](sRowTemplateID);if(!elem)return;var sRowTemplateHTML=elem['outerHTML'],sColumnTemplateID='formdesigner-block-row-template';elem=document['getElementById'](sColumnTemplateID);if(!elem)return;var sColumnTemplateHTML=elem['outerHTML'],rowID=sRowTemplateID+iRowNumber;if(sParentColumnID)rowID+='-'+sParentColumnID;var sRowHTML=sRowTemplateHTML;sRowHTML=sRowHTML['replace'](sRowTemplateID,rowID),sRowHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowHTML);var elemRowParent=$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId']);sParentColumnID&&(elemRowParent=$('#'+sParentColumnID));elemRowParent['append'](sRowHTML);var sColumnsHTML='';for(var iColumn=0x1;iColumn<=row['Columns']['length'];iColumn++){var column=row['Columns'][iColumn-0x1],sColumnHTML=sColumnTemplateHTML,sColumnID='formdesigner-block-row-';sParentColumnID&&(sColumnID=sParentColumnID+'-row-');sColumnID+=iRowNumber+'-column-'+iColumn,sColumnHTML=sColumnHTML['replace'](sColumnTemplateID,sColumnID),sColumnHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sColumnHTML),sColumnHTML=sColumnHTML['replace']('{{ColWidth}}',column['Width']);var sEmptyHTML=$('#ctrlFormDesignerModal-empty-block-html')['html'](),sGUID=TriSysSDK['Miscellaneous']['GUID']();sEmptyHTML=sEmptyHTML['replace']('{{GUID}}',sGUID);if(column['Rows'])sEmptyHTML='';sColumnHTML=sColumnHTML['replace']('{{EmptyBlockPlaceholder}}',sEmptyHTML),$('#'+rowID)['append'](sColumnHTML);if(column['Rows'])for(var iRow=0x0;iRow<column['Rows']['length'];iRow++){var columnRow=column['Rows'][iRow];ctrlFormDesignerModal['DrawRowLayout'](iRow+0x1,columnRow,sColumnID);}}},'Data':{'FileName':null,'LayoutJSON':null,'FormProperties':{'Caption':'Undefined','Icon':'gi-warning_sign','EntityName':null,'Type':null},'TopMasterID':'TopMaster','TopMasterCaption':'Top/Master','WarningSignIcon':'gi\x20gi-warning_sign','Tabs':[],'CurrentTab':null,'SelectedTabID':null,'EditedPropertiesList':null},'DataFunctions':{'TabFromID':function(sTabID){var tab=null;return ctrlFormDesignerModal['Data']['Tabs']['forEach'](function(tabby){if(tabby['ID']==sTabID)tab=tabby;}),tab;},'TabIndexFromID':function(sTabID){for(var i=0x1;i<ctrlFormDesignerModal['Data']['Tabs']['length'];i++){var tab=ctrlFormDesignerModal['Data']['Tabs'][i];if(tab['ID']==sTabID)return i;}return-0x1;}},'ConfigureLayoutModal':{'Show':function(){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(!rows)return;var fnLoadModal=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Configure\x20Form\x20Tab\x20Layout',parametersObject['Image']='gi-adjust_alt',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlFormLayout.html',parametersObject['OnLoadCallback']=function(){ctrlFormLayout['Load'](rows);},parametersObject['ButtonCentreText']='Apply',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){var rows=ctrlFormLayout['Apply']();return rows&&(ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows']=rows,ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['ReadTabListFromMemoryToTabLayout']()),rows?!![]:![];},parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlFormLayout.js',null,fnLoadModal);}},'RelocateExistingComponentsAndFieldsAfterDeleteRowOperation':function(rowColMatrix){var sDeletedBlockID=ctrlFormDesignerModal['MatrixToBlockID'](rowColMatrix),lstObjectLists=[ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components'],ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']];lstObjectLists['forEach'](function(lstObject){if(lstObject){for(var i=lstObject['length']-0x1;i>=0x0;i--){var object=lstObject[i],objectRowColMatrix=ctrlFormDesignerModal['ParseBlockID'](object['Location']),bSameRow=ctrlFormDesignerModal['isMatrixRelationshipSibling'](rowColMatrix,objectRowColMatrix);bSameRow&&lstObject['splice'](i,0x1);}lstObject['forEach'](function(object){var objectRowColMatrix=ctrlFormDesignerModal['ParseBlockID'](object['Location']),bRowInSameColumn=ctrlFormDesignerModal['isMatrixRelationshipChildRow'](rowColMatrix,objectRowColMatrix);bRowInSameColumn&&(objectRowColMatrix[rowColMatrix['length']-0x1]['Row']-=0x1,object['Location']=ctrlFormDesignerModal['MatrixToBlockID'](objectRowColMatrix));});}});},'RelocateExistingComponentsAndFieldsAfterMovingRowUpOperation':function(lstFromToMatrix){var lstObjectLists=[ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components'],ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']];lstObjectLists['forEach'](function(lstObject){lstObject&&lstObject['forEach'](function(object){for(var i=lstFromToMatrix['length']-0x1;i>=0x0;i--){var fromToMatrix=lstFromToMatrix[i],sLocation=ctrlFormDesignerModal['MatrixToBlockID'](fromToMatrix['from']);if(sLocation==object['Location']){object['Location']=ctrlFormDesignerModal['MatrixToBlockID'](fromToMatrix['to']),lstFromToMatrix['splice'](i,0x1);break;}}});});},'RelocateExistingComponentsAndFieldsAfterAddingNewRowOperation':function(iAfterRowIndex){ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']&&ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']['forEach'](function(component){var componentRowCol=ctrlFormDesignerModal['ParseBlockID'](component['Location']);if(componentRowCol['row']>iAfterRowIndex){if(componentRowCol['row']>iAfterRowIndex)component['Location']='formdesigner-block-row-'+(componentRowCol['row']+0x1)+'-column-'+componentRowCol['column'];}}),ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']&&ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']['forEach'](function(field){var fieldRowCol=ctrlFormDesignerModal['ParseBlockID'](field['Location']);if(fieldRowCol['row']>iAfterRowIndex){if(fieldRowCol['row']>iAfterRowIndex)field['Location']='formdesigner-block-row-'+(fieldRowCol['row']+0x1)+'-column-'+fieldRowCol['column'];}});},'ConfigureObject':function(sGUID){var field=ctrlFormDesignerModal['Persistence']['GetFieldOnCurrentTabByGUID'](sGUID),component=ctrlFormDesignerModal['Persistence']['GetComponentOnCurrentTabByGUID'](sGUID),objectProperties=null,objectName=null,bField=field?!![]:![],bComponent=!bField,sWhat=bField?'field':'component',sIcon=bField?'gi-wrench':'gi-magic',sValueType='TextBox',objectValue=null,sObjectType=null;if(component){if(!component['Properties'])component['Properties']={};objectProperties=JSON['parse'](JSON['stringify'](component['Properties'])),objectName=component['ID'];var componentObject=ctrlFormDesignerModal['Components']['GetComponentByID'](component['ID']);if(componentObject){objectName=componentObject['Name'],sIcon=componentObject['Icon'],sObjectType=componentObject['ID'];if(componentObject['Properties']&&componentObject['Properties']['TriSysField'])sObjectType=componentObject['Properties']['TriSysField']['Type'];}}else{if(field){if(!field['Properties'])field['Properties']={};objectProperties=JSON['parse'](JSON['stringify'](field['Properties'])),objectName=field['ID'];var fieldDescription=ctrlFormDesignerModal['Fields']['GetFieldByID'](field['ID']);fieldDescription&&(sObjectType=TriSysSDK['CShowForm']['TriSysFieldTypeIdToString'](fieldDescription));}}objectValue=objectProperties['Value'];var additionalStuff=ctrlFormDesignerModal['GetAdditionalObjectEditProperties'](sObjectType,objectValue,sValueType,objectProperties,bComponent),lstAdditionalProperties=additionalStuff['AdditionalProperties'];sValueType=additionalStuff['Type'],objectValue=additionalStuff['Value'];var sheetProperties=[{'Name':'Value','Description':['The\x20default\x20value\x20of\x20the\x20'+sWhat],'Type':sValueType,'Default':objectValue},{'Name':'Visible','Description':['Whether\x20the\x20'+sWhat+'\x20is\x20visible\x20or\x20not'],'Type':'Boolean','Title':'','Default':objectProperties['Visible']}];lstAdditionalProperties['forEach'](function(property){sheetProperties['push'](property);});var options={'Title':TriSysSDK['Miscellaneous']['CamelCase'](sWhat,!![])+':\x20'+objectName,'Image':sIcon,'SubTitle':'Properties','Items':sheetProperties,'FieldValueChange':function(sCategory,sName,objValue){objectProperties[sName]=objValue;},'Apply':function(){if(objectProperties){if(component)component['Properties']=objectProperties;else field['Properties']=objectProperties;return ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),!![];}else TriSysApex['UI']['ShowMessage']('Please\x20edit\x20'+sWhat+'\x20properties.');}};ctrlFormDesignerModal['OpenPropertySheet'](options);},'GetAdditionalObjectEditProperties':function(sObjectType,objectValue,sValueType,objectProperties,bComponent){var lstAdditionalProperties=[];if(sObjectType)switch(sObjectType){case'contact':sValueType='Contact',lstAdditionalProperties['push']({'Name':'Pick','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20pick\x20a\x20contact'],'Type':'Boolean','Caption':'Picker','Default':objectProperties['Pick']}),lstAdditionalProperties['push']({'Name':'Open','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20open\x20a\x20contact'],'Type':'Boolean','Caption':'Open','Default':objectProperties['Open']}),lstAdditionalProperties['push']({'Name':'Delete','Description':['Whether\x20the\x20contact\x20can\x20be\x20removed\x20from\x20the\x20picker'],'Type':'Boolean','Caption':'Delete','Default':objectProperties['Delete']});break;case'company':sValueType='Company',lstAdditionalProperties['push']({'Name':'Pick','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20pick\x20a\x20company'],'Type':'Boolean','Caption':'Picker','Default':objectProperties['Pick']}),lstAdditionalProperties['push']({'Name':'Open','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20open\x20a\x20company'],'Type':'Boolean','Caption':'Open','Default':objectProperties['Open']}),lstAdditionalProperties['push']({'Name':'Delete','Description':['Whether\x20the\x20company\x20can\x20be\x20removed\x20from\x20the\x20picker'],'Type':'Boolean','Caption':'Delete','Default':objectProperties['Delete']});break;case'currencyamount':sValueType='CurrencyAmount';break;case'currencyamountperiod':sValueType='CurrencyAmountPeriod';break;case'date':sValueType='Date';break;case'datetime':sValueType='DateTime';break;case'file':sValueType='File',lstAdditionalProperties['push']({'Name':'Upload','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20upload\x20a\x20file'],'Type':'Boolean','Caption':'Upload','Default':objectProperties['Upload']}),lstAdditionalProperties['push']({'Name':'Open','Description':['Whether\x20the\x20control\x20can\x20be\x20used\x20to\x20open\x20the\x20uploaded\x20file'],'Type':'Boolean','Caption':'Open','Default':objectProperties['Open']}),lstAdditionalProperties['push']({'Name':'Delete','Description':['Whether\x20the\x20file\x20can\x20be\x20removed'],'Type':'Boolean','Caption':'Delete','Default':objectProperties['Delete']});break;case'internet':sValueType='WebPage';break;case'label':lstAdditionalProperties['push']({'Name':'Bold','Description':['Whether\x20the\x20label\x20text\x20is\x20bold'],'Type':'Boolean','Title':'','Default':objectProperties['Bold']});break;case'numeric':sValueType='Float',lstAdditionalProperties['push']({'Name':'Integer','Description':['An\x20integer\x20will\x20capture\x20whole\x20numbers\x20only'],'Type':'Boolean','Title':'','Default':objectProperties['Integer']}),lstAdditionalProperties['push']({'Name':'MaximumValue','Caption':'Maximum\x20Value','Description':['The\x20highest\x20number\x20which\x20can\x20be\x20entered'],'Type':'Float','Default':objectProperties['MaximumValue']}),lstAdditionalProperties['push']({'Name':'MinimumValue','Caption':'Minimum\x20Value','Description':['The\x20lowest\x20number\x20which\x20can\x20be\x20entered'],'Type':'Float','Default':objectProperties['MinimumValue']}),lstAdditionalProperties['push']({'Name':'SpinIncrement','Caption':'Spin\x20Increment','Description':['When\x20using\x20the\x20up/down\x20arrows,\x20this\x20is\x20the\x20amount\x20by\x20which\x20the\x20number\x20increases\x20or\x20decreases'],'Type':'Float','Default':objectProperties['SpinIncrement']});break;case'telephone':sValueType='TelNo';break;case'textbox':case'textboxmultiline':var bMultiLineProperties=sObjectType=='textboxmultiline'||bComponent;bMultiLineProperties&&(lstAdditionalProperties['push']({'Name':'MultiLine','Description':['Whether\x20the\x20text\x20box\x20can\x20accept\x20multiple\x20lines\x20of\x20input'],'Type':'Boolean','Caption':'Multi\x20Line','Default':objectProperties['MultiLine']}),lstAdditionalProperties['push']({'Name':'Rows','Description':['Number\x20of\x20rows\x20in\x20the\x20multi-line\x20text\x20box'],'Type':'Integer','Default':objectProperties['Rows']}));break;case'usercombo':sValueType='User';break;case'yesno','checkbox':sValueType='Boolean',objectValue=TriSysAPI['Operators']['stringToBoolean'](objectValue,![]);break;case'button':lstAdditionalProperties['push']({'Name':'Icon','Description':['The\x20icon\x20shown\x20to\x20the\x20left\x20of\x20the\x20button\x20caption'],'Type':'Icon','Title':'Icon','Default':objectProperties['Icon']});break;}return{'AdditionalProperties':lstAdditionalProperties,'Value':objectValue,'Type':sValueType};},'ConfigureBlock':function(sFunction,thisObject){var sEmptyBlockID=$(thisObject)['parent']()['parent']()['parent']()['parent']()['parent']()['attr']('id'),cellBlock=$('#'+sEmptyBlockID)['parent'](),sCellBlockID=cellBlock['attr']('id'),rowColMatrix=ctrlFormDesignerModal['ParseBlockID'](sCellBlockID);if(!rowColMatrix)return;var sSummary='<br>'+'Matrix:\x20'+rowColMatrix['length']+'\x20blocks\x20deep:';rowColMatrix['forEach'](function(block){sSummary+='<br>\x20Row:'+block['Row']+',\x20Col:'+block['Col'];});switch(sFunction){case'Configure\x20Component':case'Configure\x20Field':var sType=sFunction=='Configure\x20Component'?'component':'field',sObjectID=cellBlock['children']()['attr']('trisys-'+sType+'-id'),sGUID=cellBlock['children']()['attr']('trisys-'+sType+'-guid');console['log'](sFunction+':\x20'+sType+':\x20'+sObjectID+'\x20['+sGUID+']\x20at\x20'+sCellBlockID+sSummary),ctrlFormDesignerModal['ConfigureObject'](sGUID);return;case'Add\x20Component':TriSysApex['UI']['ShowMessage'](sFunction+':\x20'+sCellBlockID+sSummary);break;case'Add\x20Field':TriSysApex['UI']['ShowMessage'](sFunction+':\x20'+sCellBlockID+sSummary);break;case'Decrease\x20Width':ctrlFormDesignerModal['ChangeColumnWidth'](![],rowColMatrix);break;case'Increase\x20Width':ctrlFormDesignerModal['ChangeColumnWidth'](!![],rowColMatrix);break;case'Add\x20Column':ctrlFormDesignerModal['AddColumnToMatrix'](rowColMatrix);break;case'Delete\x20Column':ctrlFormDesignerModal['DeleteColumnFromMatrix'](rowColMatrix);break;case'Add\x20Column\x20Row':ctrlFormDesignerModal['AddColumnRows'](rowColMatrix,0x2);break;case'Duplicate\x20Row':ctrlFormDesignerModal['DuplicateCurrentRow'](rowColMatrix);break;case'Delete\x20Row':ctrlFormDesignerModal['DeleteRow'](rowColMatrix);break;case'Move\x20Row\x20Up':var lastPosition=rowColMatrix[rowColMatrix['length']-0x1];if(lastPosition['Row']==0x1){TriSysApex['UI']['ShowMessage']('Row\x20is\x20already\x20at\x20the\x20top\x20of\x20the\x20column\x20block.');return;}var rowsInSameColumn=ctrlFormDesignerModal['GetRowsInSameColumn'](rowColMatrix),lstInterchangeRow=[];for(var i=0x1;i<=rowsInSameColumn['length'];i++){var row=rowsInSameColumn[i-0x1];if(i==lastPosition['Row']-0x1){var tmpRow=rowsInSameColumn[i-0x1];rowsInSameColumn[i-0x1]=rowsInSameColumn[i],rowsInSameColumn[i]=tmpRow,lstInterchangeRow['push'](rowsInSameColumn[i]),lstInterchangeRow['push'](rowsInSameColumn[i-0x1]),i++;}}var lstFromToMatrix=[];for(var i=0x1;i<=0xc;i++){var itemFrom=JSON['parse'](JSON['stringify'](rowColMatrix));itemFrom[rowColMatrix['length']-0x1]['Col']=i;var itemTo=JSON['parse'](JSON['stringify'](rowColMatrix));itemTo[rowColMatrix['length']-0x1]['Row']-=0x1,itemTo[rowColMatrix['length']-0x1]['Col']=i,lstFromToMatrix['push']({'from':itemFrom,'to':itemTo});var itemFromBefore=JSON['parse'](JSON['stringify'](rowColMatrix));itemFromBefore[rowColMatrix['length']-0x1]['Row']-=0x1,itemFromBefore[rowColMatrix['length']-0x1]['Col']=i;var itemToBefore=JSON['parse'](JSON['stringify'](rowColMatrix));itemToBefore[rowColMatrix['length']-0x1]['Col']=i,lstFromToMatrix['push']({'from':itemFromBefore,'to':itemToBefore});}ctrlFormDesignerModal['RelocateExistingComponentsAndFieldsAfterMovingRowUpOperation'](lstFromToMatrix);break;}ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['ReadTabListFromMemoryToTabLayout']();},'AddColumnRows':function(rowColMatrix,iNumberOfColumns){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(!rows)return;if(rowColMatrix['length']>=ctrlFormDesignerModal['Settings']['MaximumRowDepth']-0x1){var sMessage='Maximum\x20nested\x20inner\x20rows\x20is\x20'+ctrlFormDesignerModal['Settings']['MaximumRowDepth']+'.'+'<br>'+'If\x20you\x20require\x20greater\x20granularity,\x20use\x20a\x20multi-column\x20component.';TriSysApex['UI']['ShowMessage'](sMessage);return;}var row=rows[rowColMatrix[0x0]['Row']-0x1],col=row['Columns'][rowColMatrix[0x0]['Col']-0x1];for(var i=0x1;i<rowColMatrix['length'];i++){row=col['Rows'][rowColMatrix[i]['Row']-0x1],col=row['Columns'][rowColMatrix[i]['Col']-0x1];}var newRow={'Columns':[{'Width':0x6},{'Width':0x6}]};col['Rows']=[newRow];},'DuplicateCurrentRow':function(rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(!rows)return;var iRowIndex1Based=rowColMatrix[0x0]['Row'],row=rows[iRowIndex1Based-0x1],col=row['Columns'][rowColMatrix[0x0]['Col']-0x1],parentCol=null,parentOfRow=null;for(var i=0x1;i<rowColMatrix['length'];i++){parentOfRow=row,parentCol=col,iRowIndex1Based=rowColMatrix[i]['Row'],row=col['Rows'][iRowIndex1Based-0x1],col=row['Columns'][rowColMatrix[i]['Col']-0x1];}var duplicateRow=JSON['parse'](JSON['stringify'](row));if(!parentOfRow){parentOfRow=rows;var iCurrentRowIndex=rowColMatrix[0x0]['Row']-0x1;parentOfRow['splice'](iCurrentRowIndex,0x0,duplicateRow);}else{if(!parentCol['Rows'])parentCol['Rows']=[];parentCol['Rows']['splice'](iRowIndex1Based,0x0,duplicateRow);}},'ChangeColumnWidth':function(bIncrease,rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'],iRowIndex1Based=rowColMatrix[0x0]['Row'],iColIndex1Based=rowColMatrix[0x0]['Col'],row=rows[iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];for(var i=0x1;i<rowColMatrix['length'];i++){iRowIndex1Based=rowColMatrix[i]['Row'],iColIndex1Based=rowColMatrix[i]['Col'],row=col['Rows'][iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];}if(bIncrease){var bSomeOtherColumnsGreaterThanOne=![];for(var i=0x1;i<=row['Columns']['length'];i++){if(i!=iColIndex1Based){var column=row['Columns'][i-0x1];if(column['Width']>0x1)bSomeOtherColumnsGreaterThanOne=!![];}}if(col['Width']==0xc||row['Columns']['length']==0xc||!bSomeOtherColumnsGreaterThanOne)return;col['Width']+=0x1;var bShrunkAnother=![];for(var i=iColIndex1Based+0x1;i<=row['Columns']['length'];i++){var column=row['Columns'][i-0x1];if(column['Width']>0x1){column['Width']-=0x1,bShrunkAnother=!![];break;}}if(!bShrunkAnother)for(var i=iColIndex1Based-0x1;i>=0x1;i--){var column=row['Columns'][i-0x1];if(column['Width']>0x1){column['Width']-=0x1;break;}}}else{if(col['Width']==0x1||row['Columns']['length']==0x1)return;col['Width']-=0x1;var bGrownAnother=![];for(var i=iColIndex1Based+0x1;i<=row['Columns']['length'];i++){var column=row['Columns'][i-0x1];column['Width']+=0x1,bGrownAnother=!![];break;}if(!bGrownAnother)for(var i=iColIndex1Based-0x1;i>=0x1;i--){var column=row['Columns'][i-0x1];column['Width']+=0x1;break;}}},'AddColumnToMatrix':function(rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'],iRowIndex1Based=rowColMatrix[0x0]['Row'],iColIndex1Based=rowColMatrix[0x0]['Col'],row=rows[iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];for(var i=0x1;i<rowColMatrix['length'];i++){iRowIndex1Based=rowColMatrix[i]['Row'],iColIndex1Based=rowColMatrix[i]['Col'],row=col['Rows'][iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];}if(row['Columns']['length']==0xc)return;var newCol={'Width':0x1};row['Columns']['splice'](iColIndex1Based,0x0,newCol);for(var i=iColIndex1Based;i>=0x1;i--){var column=row['Columns'][i-0x1];if(column['Width']>0x1){column['Width']-=0x1;break;}}},'DeleteColumnFromMatrix':function(rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'],iRowIndex1Based=rowColMatrix[0x0]['Row'],iColIndex1Based=rowColMatrix[0x0]['Col'],row=rows[iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];for(var i=0x1;i<rowColMatrix['length'];i++){iRowIndex1Based=rowColMatrix[i]['Row'],iColIndex1Based=rowColMatrix[i]['Col'],row=col['Rows'][iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];}if(row['Columns']['length']==0xc)return;if(iColIndex1Based==row['Columns']['length']){if(iColIndex1Based==0x1){ctrlFormDesignerModal['DeleteRow'](rowColMatrix);return;}}iColIndex1Based==0x1?row['Columns'][iColIndex1Based]['Width']+=col['Width']:row['Columns'][iColIndex1Based-0x2]['Width']+=col['Width'],row['Columns']['splice'](iColIndex1Based-0x1,0x1);},'DeleteRow':function(rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'],iRowIndex1Based=rowColMatrix[0x0]['Row'],iColIndex1Based=rowColMatrix[0x0]['Col'],row=rows[iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1],parentCol=null;for(var i=0x1;i<rowColMatrix['length'];i++){parentCol=col,iRowIndex1Based=rowColMatrix[i]['Row'],iColIndex1Based=rowColMatrix[i]['Col'],row=col['Rows'][iRowIndex1Based-0x1],col=row['Columns'][iColIndex1Based-0x1];}var bRemovingEntireColumn=![];if(parentCol){parentCol['Rows']['splice'](iRowIndex1Based-0x1,0x1);if(parentCol['Rows']['length']==0x0)bRemovingEntireColumn=!![];}else rows['splice'](iRowIndex1Based-0x1,0x1);ctrlFormDesignerModal['RelocateExistingComponentsAndFieldsAfterDeleteRowOperation'](rowColMatrix),bRemovingEntireColumn&&(rowColMatrix['splice'](rowColMatrix['length']-0x1,0x1),ctrlFormDesignerModal['DeleteColumnFromMatrix'](rowColMatrix));},'AddNewRow':function(iColumnCount,iAfterRowIndex){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];if(!rows)return;if(!iAfterRowIndex)iAfterRowIndex=rows['length'];var columns=[],lstColumnWidth=[];switch(iColumnCount){case 0x1:lstColumnWidth=[0xc];break;case 0x2:lstColumnWidth=[0x6,0x6];break;case 0x3:lstColumnWidth=[0x4,0x4,0x4];break;case 0x4:lstColumnWidth=[0x3,0x3,0x3,0x3];break;case 0x5:lstColumnWidth=[0x3,0x2,0x2,0x2,0x3];break;case 0x6:lstColumnWidth=[0x2,0x2,0x2,0x2,0x2,0x2];break;case 0x7:lstColumnWidth=[0x2,0x2,0x1,0x1,0x2,0x2,0x2];break;case 0x8:lstColumnWidth=[0x2,0x2,0x1,0x1,0x1,0x1,0x2,0x2];break;case 0x9:lstColumnWidth=[0x2,0x2,0x1,0x1,0x1,0x1,0x1,0x1,0x2];break;case 0xa:lstColumnWidth=[0x2,0x2,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1];break;case 0xb:lstColumnWidth=[0x2,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1];break;case 0xc:lstColumnWidth=[0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1,0x1];break;}lstColumnWidth['forEach'](function(iWidth){columns['push']({'Width':iWidth});});var newRow={'Columns':columns};rows['splice'](iAfterRowIndex,0x0,newRow),ctrlFormDesignerModal['RelocateExistingComponentsAndFieldsAfterAddingNewRowOperation'](iAfterRowIndex),ctrlFormDesignerModal['Settings']['History']['Push'](ctrlFormDesignerModal['Data']),ctrlFormDesignerModal['ReadTabListFromMemoryToTabLayout']();},'ParseBlockID':function(sID){var parts=sID['split']('-row-'),iMatrixSize=parts['length'],blockMatrix=[];return parts['splice'](0x0,0x1),parts['forEach'](function(sPart){var matrixParts=sPart['split']('-column-'),block={'Row':parseInt(matrixParts[0x0]),'Col':parseInt(matrixParts[0x1])};blockMatrix['push'](block);}),blockMatrix;},'MatrixToBlockID':function(rowColMatrix){var sRoot=null;if(rowColMatrix){var iRowIndex1Based=rowColMatrix[0x0]['Row'],iColIndex1Based=rowColMatrix[0x0]['Col'];sRoot='formdesigner-block-row-'+iRowIndex1Based+'-column-'+iColIndex1Based;for(var i=0x1;i<rowColMatrix['length'];i++){iRowIndex1Based=rowColMatrix[i]['Row'],iColIndex1Based=rowColMatrix[i]['Col'],sRoot+='-row-'+iRowIndex1Based+'-column-'+iColIndex1Based;}}return sRoot;},'GetRowsInSameColumn':function(rowColMatrix){var rows=ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Rows'];for(var i=0x0;i<rowColMatrix['length'];i++){var rowColPosition=rowColMatrix[i],row=rows[rowColPosition['Row']-0x1],col=row['Columns'][rowColPosition['Col']-0x1];if(col['Rows'])rows=col['Rows'];}return rows;},'isMatrixRelationshipSibling':function(parentRowColMatrix,childRowColMatrix){var bInSameRow=![];if(childRowColMatrix['length']>=parentRowColMatrix['length'])for(var i=0x0;i<parentRowColMatrix['length'];i++){var parentRowCol=parentRowColMatrix[i],childRowCol=childRowColMatrix[i];if(i<parentRowColMatrix['length']-0x1){if(childRowCol['Row']!=parentRowCol['Row']||childRowCol['Col']!=parentRowCol['Col'])return![];}else{if(childRowCol['Row']==parentRowCol['Row'])bInSameRow=!![];}}return bInSameRow;},'isMatrixRelationshipChildRow':function(parentRowColMatrix,childRowColMatrix){var bInGreaterRowOfSameColumn=![];if(childRowColMatrix['length']>=parentRowColMatrix['length'])for(var i=0x0;i<parentRowColMatrix['length'];i++){var parentRowCol=parentRowColMatrix[i],childRowCol=childRowColMatrix[i];if(i<parentRowColMatrix['length']-0x1){if(childRowCol['Row']!=parentRowCol['Row']||childRowCol['Col']!=parentRowCol['Col'])return![];}else{if(childRowCol['Row']>parentRowCol['Row'])bInGreaterRowOfSameColumn=!![];}}return bInGreaterRowOfSameColumn;},'isMatrixRelationshipInSameColumn':function(rowColMatrixOfColumn,rowColMatrix){var bInSameColumn=![];if(rowColMatrix['length']>=rowColMatrixOfColumn['length'])for(var i=0x0;i<rowColMatrixOfColumn['length'];i++){var rowColumn1=rowColMatrixOfColumn[i],rowColumn2=rowColMatrix[i];if(i<rowColMatrixOfColumn['length']-0x1){if(rowColumn1['Row']!=rowColumn2['Row']||rowColumn1['Col']!=rowColumn2['Col'])return![];}else{if(rowColumn1['Col']==rowColumn2['Col'])bInSameColumn=!![];}}return bInSameColumn;},'UndoRedo':function(bUndo){ctrlFormDesignerModal['Settings']['History']['_PoppingOrPeeking']=!![];var data=null;bUndo?data=ctrlFormDesignerModal['Settings']['History']['Pop']():data=ctrlFormDesignerModal['Settings']['History']['Peek'](),data&&(ctrlFormDesignerModal['Data']=data,ctrlFormDesignerModal['PopulateTabs']()),ctrlFormDesignerModal['Settings']['History']['_PoppingOrPeeking']=![];},'UndoRedoButtons':function(){$('#ctrlFormDesignerModal-undo-layout')['attr']('disabled',!ctrlFormDesignerModal['Settings']['History']['CanGoBack']()),$('#ctrlFormDesignerModal-redo-layout')['attr']('disabled',!ctrlFormDesignerModal['Settings']['History']['CanGoForward']());},'Persistence':{'Save':function(sFile){ctrlFormDesignerModal['Data']['FormProperties']['Updated']=moment()['format']('DDDD\x20DD\x20MMMM\x20YYYY\x20HH:mm'),ctrlFormDesignerModal['Data']['FormProperties']['Author']=TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['ForenameAndSurname']+',\x20'+TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['CompanyName'];var data={'FileName':ctrlFormDesignerModal['Data']['FileName'],'FormProperties':ctrlFormDesignerModal['Data']['FormProperties'],'Tabs':ctrlFormDesignerModal['Data']['Tabs']},sJSON=JSON['stringify'](data),fnSaved=function(){TriSysApex['Toasters']['Success']('Successfully\x20saved:\x20'+TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFile));};DeveloperStudio['WebAPI']['WriteFile'](sFile,sJSON,fnSaved,![]);},'ReadCurrentTabLayoutIntoMemoryArray':function(){var lstComponents=[],lstFields=[],elemCanvas=$('#'+ctrlFormDesignerModal['Settings']['EditorCanvasId']);elemCanvas['find']('[id^=\x27component-name-\x27]')['each'](function(){var sGUID=$(this)['attr']('trisys-component-guid'),component=ctrlFormDesignerModal['Persistence']['GetComponentOnCurrentTabByGUID'](sGUID);if(component){var sColumnBlockID=$(this)['parent']()['attr']('id');component['Location']=sColumnBlockID,lstComponents['push'](component);}}),elemCanvas['find']('[id^=\x27field-name-\x27]')['each'](function(){var sGUID=$(this)['attr']('trisys-field-guid'),field=ctrlFormDesignerModal['Persistence']['GetFieldOnCurrentTabByGUID'](sGUID);if(field){var sColumnBlockID=$(this)['parent']()['attr']('id');field['Location']=sColumnBlockID,lstFields['push'](field);}}),ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Components']=lstComponents,ctrlFormDesignerModal['Data']['CurrentTab']['Layout']['Fields']=lstFields;},'GetComponentOnCurrentTabByGUID':function(sGUID){var layout=ctrlFormDesignerModal['Data']['CurrentTab']['Layout'];if(layout){var components=layout['Components'];if(components)for(var i=0x0;i<components['length'];i++){var component=components[i];if(component['GUID']==sGUID)return component;}}},'GetFieldOnCurrentTabByGUID':function(sGUID){var layout=ctrlFormDesignerModal['Data']['CurrentTab']['Layout'];if(layout){var fields=layout['Fields'];if(fields)for(var i=0x0;i<fields['length'];i++){var field=fields[i];if(field['GUID']==sGUID)return field;}}}},'Components':{'GetComponentsFromFile':function(){var json=TriSysApex['Forms']['Configuration']['JsonFileData'](ctrlFormDesignerModal['Settings']['ComponentConfigurationFile']);if(!json)return[];var components=json['Components'];return components['sort'](function(a,b){var s1=a['ID'],s2=b['ID'];return s1['localeCompare'](s2);}),components;},'GetComponentByID':function(sID){var foundComponent=null;return ctrlFormDesignerModal['Components']['GetComponentsFromFile']()['forEach'](function(component){if(component['ID']==sID)foundComponent=component;}),foundComponent;},'PopulateComponentToolbox':function(){var lstComponents=ctrlFormDesignerModal['Components']['GetComponentsFromFile'](),sHTML='';lstComponents['forEach'](function(component){sHTML+=ctrlFormDesignerModal['Components']['GetComponentToolboxItemHTML'](component);});var elemItemList=$('#ctrlFormDesignerModal-component-list-items');elemItemList['html'](sHTML);},'GetComponentToolboxItemHTML':function(designComponent){var component=ctrlFormDesignerModal['Components']['GetComponentByID'](designComponent['ID']);if(!component)return'<span\x20style=\x22color:\x20red;\x22>ERROR:\x20Component\x20not\x20found:\x20'+designComponent['ID']+'</span>';var sComponentHTML=$('#ctrlFormDesignerModal-toolbox-component-html')['html']();return designComponent['GUID']=TriSysSDK['Miscellaneous']['GUID'](),sComponentHTML=sComponentHTML['replace'](/{{ComponentID}}/g,component['ID']),sComponentHTML=sComponentHTML['replace'](/{{GUID}}/g,designComponent['GUID']),sComponentHTML=sComponentHTML['replace'](/{{ComponentDescription}}/g,component['Description']),sComponentHTML=sComponentHTML['replace'](/{{ComponentIcon}}/g,component['Icon']),sComponentHTML=sComponentHTML['replace'](/{{ComponentName}}/g,component['Name']),sComponentHTML;},'GetComponentToolboxItemsAsIDString':function(component){var sList='',elemItemList=$('#ctrlFormDesignerModal-component-list-items');return elemItemList['find']('[id^=\x27formdesigner-component-tool-\x27]')['each'](function(){var sID=this['id'];if(sList['length']>0x0)sList+=',\x20';sList+='#'+sID;}),sList;},'FilterComponents':function(sFilter){if(sFilter)sFilter=sFilter['toLowerCase']();var elemItemList=$('#ctrlFormDesignerModal-component-list-items');elemItemList['find']('[id^=\x27formdesigner-component-tool-\x27]')['each'](function(){var sID=this['id'],elemBlock=$('#'+sID)['parent'](),sComponentName=$(this)['find']('.component-tool-caption')['text'](),bShowRow=sFilter?![]:!![];if(sComponentName['toLowerCase']()['indexOf'](sFilter)>=0x0)bShowRow=!![];bShowRow?elemBlock['show']():elemBlock['hide']();});}},'Fields':{'PopulateFieldToolbox':function(){var sEntityName=ctrlFormDesignerModal['Data']['FormProperties']['EntityName'],fieldDescriptions=TriSysSDK['CShowForm']['fieldDescriptions'](sEntityName);if(!fieldDescriptions)return;var lstFields=[];fieldDescriptions['forEach'](function(fieldDescription){var bAddToToolbox=!ctrlFormDesignerModal['Fields']['isFieldOnThisFormAlready'](fieldDescription);if(bAddToToolbox){var field={'ID':fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],'Name':fieldDescription['FieldLabel']?fieldDescription['FieldLabel']:fieldDescription['TableFieldName'],'Description':fieldDescription['Description']?fieldDescription['Description']:'','Icon':'fa\x20fa-wrench'};lstFields['push'](field);}});var sHTML='';lstFields['forEach'](function(field){sHTML+=ctrlFormDesignerModal['Fields']['GetFieldToolboxItemHTML'](field);});var elemItemList=$('#ctrlFormDesignerModal-field-list-items');elemItemList['html'](sHTML);},'isFieldOnThisFormAlready':function(fieldDescription){var bFoundField=![];return ctrlFormDesignerModal['Data']['Tabs']['forEach'](function(tab){tab['Layout']&&tab['Layout']['Fields']&&tab['Layout']['Fields']['forEach'](function(field){if(field['ID']==fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'])bFoundField=!![];});}),bFoundField;},'GetFieldByID':function(sID){var foundField=null,sEntityName=ctrlFormDesignerModal['Data']['FormProperties']['EntityName'],fieldDescriptions=TriSysSDK['CShowForm']['fieldDescriptions'](sEntityName);if(!fieldDescriptions)return;return fieldDescriptions['forEach'](function(fieldDescription){if(fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']==sID)foundField=fieldDescription;}),foundField;},'GetFieldToolboxItemHTML':function(designField){var field=ctrlFormDesignerModal['Fields']['GetFieldByID'](designField['ID']);if(!field)return'<span\x20style=\x22color:\x20red;\x22>ERROR:\x20Field\x20not\x20found:\x20'+designField['ID']+'</span>';var sFieldHTML=$('#ctrlFormDesignerModal-toolbox-field-html')['html']();designField['GUID']=TriSysSDK['Miscellaneous']['GUID']();var sFieldIcon='gi\x20gi-wrench';return field['ID']=designField['ID'],sFieldHTML=sFieldHTML['replace'](/{{FieldID}}/g,field['ID']),sFieldHTML=sFieldHTML['replace'](/{{GUID}}/g,designField['GUID']),sFieldHTML=sFieldHTML['replace'](/{{FieldDescription}}/g,field['Description']?field['Description']:''),sFieldHTML=sFieldHTML['replace'](/{{FieldIcon}}/g,sFieldIcon),sFieldHTML=sFieldHTML['replace'](/{{FieldName}}/g,field['FieldLabel']?field['FieldLabel']:field['TableFieldName']),sFieldHTML;},'GetFieldToolboxItemsAsIDString':function(field){var sList='',elemItemList=$('#ctrlFormDesignerModal-field-list-items');return elemItemList['find']('[id^=\x27formdesigner-field-tool-\x27]')['each'](function(){var sID=this['id'];if(sList['length']>0x0)sList+=',\x20';sList+='#'+sID;}),sList;},'FilterFields':function(sFilter){if(sFilter)sFilter=sFilter['toLowerCase']();var elemItemList=$('#ctrlFormDesignerModal-field-list-items');elemItemList['find']('[id^=\x27formdesigner-field-tool-\x27]')['each'](function(){var sID=this['id'],elemBlock=$('#'+sID)['parent'](),sFieldName=$(this)['find']('.field-tool-caption')['text'](),bShowRow=sFilter?![]:!![];if(sFieldName['toLowerCase']()['indexOf'](sFilter)>=0x0)bShowRow=!![];bShowRow?elemBlock['show']():elemBlock['hide']();});}},'FormRenderer':{'RenderFormInPreview':function(data,sDeviceType,elemPreviewCanvas){var sImage='https://apex.trisys.co.uk/images/devices/',rendererDimensions=null;switch(sDeviceType){case'Desktop':sImage+='desktop-computer.png',rendererDimensions={'image':{'height':0x4ad,'width':0x640},'padding':{'top':0x21,'left':0x21,'right':0x22},'height':0x1c0,'zoomPercentage':0x4b};break;case'Laptop':sImage+='laptop.png',rendererDimensions={'image':{'height':0x259,'width':0x400},'padding':{'top':0x2c,'left':0x6e,'right':0x70},'height':0x1e2,'zoomPercentage':0x5a};break;case'Tablet':sImage+='iPad.png',rendererDimensions={'image':{'height':0x424,'width':0x2fd},'padding':{'top':0x3a,'left':0x1c,'right':0x1c},'height':0x1f7,'zoomPercentage':0x3c};break;case'Phone':sImage+='iPhone.png',rendererDimensions={'image':{'height':0x2c0,'width':0x164},'padding':{'top':0x49,'left':0x14,'right':0x15},'height':0x1d9,'zoomPercentage':0x28};break;case'Live\x20Data':ctrlFormDesignerModal['FormRenderer']['RenderPreview'](data,elemPreviewCanvas);return;}var iHeightFactor=0x15e,iHeight=$(window)['height']()-iHeightFactor,fSizeMultiplier=iHeight/rendererDimensions['image']['height'],fImageHeight=rendererDimensions['image']['height']*fSizeMultiplier,fImageWidth=rendererDimensions['image']['width']*fSizeMultiplier,sHTML=$('#ctrlFormDesignerModal-preview-device-html')['html']();sHTML=sHTML['replace']('{{BackgroundImageURL}}',sImage),sHTML=sHTML['replace']('{{DivWidth}}',fImageWidth),sHTML=sHTML['replace'](/{{DivHeight}}/g,fImageHeight),sHTML=sHTML['replace']('{{BackgroundWidth}}',fImageWidth),sHTML=sHTML['replace']('{{BackgroundHeight}}',fImageHeight),sHTML=sHTML['replace']('{{RendererHeight}}',rendererDimensions['height']),sHTML=sHTML['replace']('{{PaddingTop}}',rendererDimensions['padding']['top']),sHTML=sHTML['replace']('{{PaddingLeft}}',rendererDimensions['padding']['left']),sHTML=sHTML['replace']('{{PaddingRight}}',rendererDimensions['padding']['right']),elemPreviewCanvas['html'](sHTML),sHTML=ctrlFormDesignerModal['FormRenderer']['RenderFormHTML'](data,sDeviceType,rendererDimensions);var elemDeviceRenderer=$('#ctrlFormDesignerModal-preview-device-renderer');elemDeviceRenderer['html'](sHTML),ctrlFormDesignerModal['FormRenderer']['InjectComponentsAndFieldsIntoDOM'](data),TriSysSDK['CShowForm']['HTMLFieldsCodeInjection']();var sBlockRowPattern='_formrenderer-block-row-';elemDeviceRenderer['find']('[id*=\x27'+sBlockRowPattern+'\x27]')['each'](function(){var parentRow=$(this)['parent']();parentRow['css']('pointer-events','none');});},'RenderPreview':function(data,elemPreviewCanvas){var sHTML=ctrlFormDesignerModal['FormRenderer']['RenderFormHTML'](data,null,{'zoomPercentage':null});elemPreviewCanvas['html'](sHTML),ctrlFormDesignerModal['FormRenderer']['InjectComponentsAndFieldsIntoDOM'](data),TriSysSDK['CShowForm']['HTMLFieldsCodeInjection']();if(data['FormProperties']['EntityName']&&data['FormProperties']['Type']=='Entity\x20Form'){var fnSelected=function(sEntityName,lRecordId,sName){var fnOpenRecord=function(){TriSysApex['Forms']['EntityForm']['LoadRecord'](sEntityName,lRecordId);};return setTimeout(fnOpenRecord,0xa),!![];};TriSysApex['ModalDialogue']['EntityRecord']['Select'](data['FormProperties']['EntityName'],fnSelected);}},'InjectComponentsAndFieldsIntoDOM':function(data){data&&data['Tabs']&&data['Tabs']['forEach'](function(tab){var sBlockPrefix=ctrlFormDesignerModal['FormRenderer']['UniquePrefix'](data['FileName'],tab['ID']);tab['Layout']&&tab['Layout']['Components']&&tab['Layout']['Components']['forEach'](function(component){var componentDefinition=ctrlFormDesignerModal['Components']['GetComponentByID'](component['ID']);componentDefinition&&ctrlFormDesignerModal['FormRenderer']['RenderComponent'](component,componentDefinition,sBlockPrefix);}),tab['Layout']&&tab['Layout']['Fields']&&tab['Layout']['Fields']['forEach'](function(field){var fieldDescription=ctrlFormDesignerModal['Fields']['GetFieldByID'](field['ID']);fieldDescription&&ctrlFormDesignerModal['FormRenderer']['RenderField'](field,fieldDescription,sBlockPrefix);});});},'RenderComponent':function(designedComponent,baseComponent,sBlockPrefix){var sHTML=null;if(baseComponent['Properties']){if(baseComponent['Properties']['TriSysField']&&baseComponent['Properties']['TriSysField']['Type']){var sGUID=TriSysSDK['Miscellaneous']['GUID'](),field={'ID':'formrenderer-field-'+baseComponent['ID']+'-'+sGUID,'Type':baseComponent['Properties']['TriSysField']['Type'],'Value':designedComponent['Properties']['Value']};if(baseComponent['Properties']['TriSysField']['Type']=='textbox'&&designedComponent['Properties']['MultiLine']){field['Type']='textboxmultiline';if(designedComponent['Properties']['Rows'])field['Rows']=designedComponent['Properties']['Rows'];}sHTML=DeveloperStudio['FormDesigner']['FieldHTML'](field);}else switch(baseComponent['ID']){case'label':sHTML='<p>'+designedComponent['Properties']['Value']+'<p>';break;case'button':var sIcon=designedComponent['Properties']['Icon']?'\x20<i\x20class=\x22'+designedComponent['Properties']['Icon']+'\x22></i>\x20&nbsp;\x20':'';sHTML='<button\x20type=\x22button\x22\x20class=\x22btn\x20btn-sm\x20btn-primary\x22>'+sIcon+designedComponent['Properties']['Value']+'</button>';break;}}if(sHTML&&designedComponent['Location']){var sLocation=designedComponent['Location']['replace']('formdesigner-',sBlockPrefix+'formrenderer-');sHTML=ctrlFormDesignerModal['FormRenderer']['RenderBlockHTML'](sHTML,designedComponent['Properties']),$('#'+sLocation)['html'](sHTML);}},'RenderField':function(field,fieldDescription,sBlockPrefix){var sFieldName=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],sHTML=TriSysSDK['CShowForm']['TriSysFieldPickerToHTML'](sFieldName,fieldDescription);if(sHTML&&field['Location']){var sLocation=field['Location']['replace']('formdesigner-',sBlockPrefix+'formrenderer-');sHTML=ctrlFormDesignerModal['FormRenderer']['RenderBlockHTML'](sHTML,field['Properties']),$('#'+sLocation)['html'](sHTML);}},'RenderBlockHTML':function(sHTML,properties){var sProperties='\x20style=\x22border:\x200;\x20padding:\x200;\x22';return sHTML='<div\x20class=\x22block\x22'+sProperties+'>'+sHTML+'</div>',sHTML;},'RenderFormHTML':function(data,sDeviceType,rendererDimensions){var sHTML=$('#ctrlFormDesignerModal-renderer-form-html')['html']();sHTML=sHTML['replace']('{{FormIcon}}',data['FormProperties']['Icon']),sHTML=sHTML['replace']('{{FormCaption}}',data['FormProperties']['Caption']),sHTML=sHTML['replace']('{{FormButtons}}',''),sHTML=sHTML['replace']('{{ZoomFactor}}',rendererDimensions['zoomPercentage']?'\x20zoom:\x20'+rendererDimensions['zoomPercentage']+'%;':'');var sTopMasterHTML='';if(data['Tabs']['length']>0x0){var topTab=data['Tabs'][0x0],rows=topTab['Layout']['Rows'];sTopMasterHTML=ctrlFormDesignerModal['FormRenderer']['GetBlockOfRowsAndColumns'](rows,data['FileName'],topTab['ID']);}sHTML=sHTML['replace']('{{FormTopMaster}}',sTopMasterHTML);var sFormTabTemplateHTML=$('#ctrlFormDesignerModal-renderer-form-tab-html')['html'](),sFormTabPaneTemplateHTML=$('#ctrlFormDesignerModal-renderer-form-tab-pane-html')['html'](),sFormTabs='',sFormTabsContent='';for(var i=0x1;i<data['Tabs']['length'];i++){var tab=data['Tabs'][i],sFormTab=sFormTabTemplateHTML;sFormTab=sFormTab['replace']('{{ActiveTab}}',tab['Active']?'class=\x22active\x22':''),sFormTab=sFormTab['replace']('{{TabID}}',tab['ID']),sFormTab=sFormTab['replace']('{{TabCaption}}',tab['Caption']),sFormTab=sFormTab['replace']('{{TabIcon}}',tab['Icon']),sFormTab=sFormTab['replace']('{{TabVisibility}}',tab['Visible']?'':'\x20style=\x22display:\x20none;\x22'),sFormTabs+=sFormTab;var sFormTabContent=sFormTabPaneTemplateHTML;sFormTabContent=sFormTabContent['replace']('{{TabID}}',tab['ID']),sFormTabContent=sFormTabContent['replace']('{{TabActive}}',tab['Active']?'\x20active':''),sFormTabContent=sFormTabContent['replace']('{{TabPaneStyle}}','style'+(tab['Active']?'':'=\x22display:\x20none;\x22'));var sTabLayoutHTML='';if(tab['Layout']){var rows=tab['Layout']['Rows'];sTabLayoutHTML=ctrlFormDesignerModal['FormRenderer']['GetBlockOfRowsAndColumns'](rows,data['FileName'],tab['ID']);}sFormTabContent=sFormTabContent['replace']('{{TabPaneContent}}',sTabLayoutHTML),sFormTabsContent+=sFormTabContent;}sHTML=sHTML['replace']('{{FormTabs}}',sFormTabs),sHTML=sHTML['replace']('{{FormTabsContent}}',sFormTabsContent);var sFormID=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](data['FileName'])['split']('.')[0x0];return sHTML=sHTML['replace'](/{{FormID}}/g,sFormID),sHTML;},'GetBlockOfRowsAndColumns':function(rows,sFileName,sTabID){var sHTML='';if(rows){for(var iRow1=0x1;iRow1<=rows['length'];iRow1++){var row1=rows[iRow1-0x1];sHTML+='<div\x20class=\x22row\x22>';for(var iCol1=0x1;iCol1<=row1['Columns']['length'];iCol1++){var col1=row1['Columns'][iCol1-0x1],sID1=ctrlFormDesignerModal['FormRenderer']['UniquePrefix'](sFileName,sTabID)+'formrenderer-block-row-'+iRow1+'-column-'+iCol1;sHTML+='<div\x20class=\x22col-sm-'+col1['Width']+'\x20column\x22'+'\x20id=\x22'+sID1+'\x22>';if(col1['Rows'])for(var iRow2=0x1;iRow2<=col1['Rows']['length'];iRow2++){var row2=col1['Rows'][iRow2-0x1];sHTML+='<div\x20class=\x22row\x22>';for(var iCol2=0x1;iCol2<=row2['Columns']['length'];iCol2++){var col2=row2['Columns'][iCol2-0x1],sID2=sID1+'-row-'+iRow2+'-column-'+iCol2;sHTML+='<div\x20class=\x22col-sm-'+col2['Width']+'\x20column\x22'+'\x20id=\x22'+sID2+'\x22>';if(col2['Rows'])for(var iRow3=0x1;iRow3<=col2['Rows']['length'];iRow3++){var row3=col2['Rows'][iRow3-0x1];sHTML+='<div\x20class=\x22row\x22>';for(var iCol3=0x1;iCol3<=row3['Columns']['length'];iCol3++){var col3=row3['Columns'][iCol3-0x1],sID3=sID2+'-row-'+iRow3+'-column-'+iCol3;sHTML+='<div\x20class=\x22col-sm-'+col3['Width']+'\x20column\x22'+'\x20id=\x22'+sID3+'\x22>';if(col3['Rows'])for(var iRow4=0x1;iRow4<=col3['Rows']['length'];iRow4++){var row4=col3['Rows'][iRow4-0x1];sHTML+='<div\x20class=\x22row\x22>';for(var iCol4=0x1;iCol4<=row4['Columns']['length'];iCol4++){var col4=row4['Columns'][iCol4-0x1],sID4=sID3+'-row-'+iRow4+'-column-'+iCol4;sHTML+='<div\x20class=\x22col-sm-'+col4['Width']+'\x20column\x22'+'\x20id=\x22'+sID4+'\x22>',sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}sHTML+='</div>';}return sHTML;}return sHTML;},'UniquePrefix':function(sFileName,sTabID){sFileName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFileName);var sPrefix=sFileName['replace'](/\./g,'-');return sPrefix+='_'+sTabID['replace'](/\./g,''),sPrefix+='_',sPrefix;},'SampleHTML':function(data){var sHTML='<h1>'+sDeviceType+'</h1>'+'<h2>This\x20is\x20a\x20preview\x20of\x20\x27The\x20Renderer\x27\x20showing\x20how\x20this\x20form\x20will\x20look\x20on\x20this\x20device.</h2>';for(var i=0x0;i<data['Tabs']['length'];i++){var tab=data['Tabs'][i];sHTML+='<h3>Tab\x20'+(i+0x1)+':\x20'+tab['Caption']+'</h3>';if(tab['Layout']&&tab['Layout']['Rows'])sHTML+='<p>Rows:\x20'+tab['Layout']['Rows']['length']+'</p>';}return sHTML;}},'Settings':{'EditorCanvasId':'ctrlFormDesignerModal-EditorCanvas','ComponentConfigurationFile':'components.json','CellHeight':'75px','MaximumRowDepth':0x4,'Clipboard':{'_List':[],'Add':function(sID,sHTML,sType){var clipboardItem=ctrlFormDesignerModal['Settings']['Clipboard']['_List']['filter'](function(item){return item['ID']===sID;})['shift']();if(clipboardItem)clipboardItem['HTML']=sHTML;else ctrlFormDesignerModal['Settings']['Clipboard']['_List']['push']({'ID':sID,'HTML':sHTML,'Type':sType});}},'History':{'_List':[],'_Position':0x0,'_PoppingOrPeeking':![],'Push':function(data){if(ctrlFormDesignerModal['Settings']['History']['_PoppingOrPeeking'])return;var dataCopy=JSON['parse'](JSON['stringify'](data));ctrlFormDesignerModal['Settings']['History']['_List']['push'](dataCopy),ctrlFormDesignerModal['Settings']['History']['_Position']=ctrlFormDesignerModal['Settings']['History']['_List']['length']-0x1,ctrlFormDesignerModal['UndoRedoButtons']();},'CanGoBack':function(){return ctrlFormDesignerModal['Settings']['History']['_List']['length']>0x0&&ctrlFormDesignerModal['Settings']['History']['_Position']>0x0;},'CanGoForward':function(){return ctrlFormDesignerModal['Settings']['History']['_List']['length']>0x0&&ctrlFormDesignerModal['Settings']['History']['_Position']<ctrlFormDesignerModal['Settings']['History']['_List']['length']-0x1&&ctrlFormDesignerModal['Settings']['History']['_Position']>=0x0;},'Pop':function(){if(ctrlFormDesignerModal['Settings']['History']['_List']['length']>0x0&&ctrlFormDesignerModal['Settings']['History']['_Position']>=0x0){if(ctrlFormDesignerModal['Settings']['History']['_Position']>0x0)ctrlFormDesignerModal['Settings']['History']['_Position']-=0x1;ctrlFormDesignerModal['UndoRedoButtons']();var data=ctrlFormDesignerModal['Settings']['History']['_List'][ctrlFormDesignerModal['Settings']['History']['_Position']];return data;}},'Peek':function(){if(ctrlFormDesignerModal['Settings']['History']['_List']['length']>0x0){if(ctrlFormDesignerModal['Settings']['History']['_Position']<0x0)ctrlFormDesignerModal['Settings']['History']['_Position']=0x0;if(ctrlFormDesignerModal['Settings']['History']['_Position']<ctrlFormDesignerModal['Settings']['History']['_List']['length']){ctrlFormDesignerModal['Settings']['History']['_Position']+=0x1,ctrlFormDesignerModal['UndoRedoButtons']();var data=ctrlFormDesignerModal['Settings']['History']['_List'][ctrlFormDesignerModal['Settings']['History']['_Position']];return data;}}}}}};