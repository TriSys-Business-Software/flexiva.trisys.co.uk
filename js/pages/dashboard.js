var ctrlDashboard={'Initialise':function(){ctrlDashboard['PopulateViewMenu'](),ctrlDashboard['PopulateConfigureButtons']();},'PopulateViewMenu':function(){TriSysSDK['FormMenus']['DrawUniqueDropDownMenuFromTemplate']('dashboardViewMenu',ctrlDashboard['ViewMenuFile'],ctrlDashboard['AddDynamicViewsToMenu']),setTimeout(function(){TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null),ctrlDashboard['ViewMenuVisibility']();},0x1f4);},'PopulateConfigureButtons':function(){$('#dashboard-configure-layout')['on']('click',function(){ctrlDashboard['ConfigureButtonClick']('configure-layout');}),$('#dashboard-save-view')['on']('click',function(){ctrlDashboard['ConfigureButtonClick']('save-view');}),$('#dashboard-cancel')['on']('click',function(){ctrlDashboard['ConfigureButtonClick']('cancel');}),$('#dashboard-add-tile')['on']('click',function(){ctrlDashboard['ConfigureButtonClick']('add-tile');});},'ViewMenuFile':'dashboard/ctrlDashboardViewMenu.html','ViewMenuItemPrefix':'dashboard-view-menu-','ViewConfigurationFile':'dashboardviews.json','ViewConfiguration':null,'TileConfigurationFile':'dashboardtiles.json','DashboardViewFile':'ctrlDashboardView.html','AddDynamicViewsToMenu':function(){!ctrlDashboard['ViewConfiguration']?ctrlDashboard['CallWebServiceToLoadViewConfiguration']():ctrlDashboard['PostLoadServerResponse']();},'CallWebServiceToLoadViewConfiguration':function(){var payloadObject={};payloadObject['URL']='Dashboard/Read',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CDashboardReadResponse=data;if(CDashboardReadResponse){if(CDashboardReadResponse['Success']){ctrlDashboard['ViewConfiguration']=CDashboardReadResponse['ViewConfiguration'];var views=ctrlDashboard['ViewConfiguration']['Views'];for(var iView=0x0;iView<views['length'];iView++){var view=ctrlDashboard['ViewConfiguration']['Views'][iView],sLayout=view['Layout'];view['Layout']=JSON['parse'](sLayout);}}else TriSysApex['Logging']['LogMessage'](CDashboardReadResponse['ErrorMessage']);}ctrlDashboard['PostLoadServerResponse']();},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlDashboard.CallWebServiceToLoadViewConfiguration:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']),ctrlDashboard['PostLoadServerResponse']();},TriSysApex['UI']['ShowWait'](null,'Reading\x20Dashboard\x20Configuration...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PostLoadServerResponse':function(){!ctrlDashboard['ViewConfiguration']&&(ctrlDashboard['ViewConfiguration']=ctrlDashboard['ReadViewConfigurationFromJSONFiles']());if(!ctrlDashboard['ViewConfiguration'])return;ctrlDashboard['PopulateDynamicViewMenuItems'](),TriSysApex['Device']['isPhone']()&&($('#dashboard-caption-text')['html'](''),setTimeout(function(){$('#dashboard-view-menu-News')['hide'](),$('#dashboard-view-menu-TwitterFeeds')['hide'](),$('#dashboard-view-menu-WebPages')['hide'](),$('#dashboard-view-menu-WorldWeather')['hide']();},0x3e8));},'ReadViewConfigurationFromJSONFiles':function(){var viewConfiguration=TriSysApex['Forms']['Configuration']['JsonFileData'](ctrlDashboard['ViewConfigurationFile']),tiles=TriSysApex['Forms']['Configuration']['JsonFileData'](ctrlDashboard['TileConfigurationFile']);if(viewConfiguration&&tiles){var views=viewConfiguration['Views'];if(views)for(var iView=0x0;iView<views['length'];iView++){var view=views[iView];if(view['Control']==ctrlDashboard['DashboardViewFile']&&view['Layout']&&view['Layout']['Tiles']){var tilesArray=[];for(var iLayoutTile=0x0;iLayoutTile<view['Layout']['Tiles']['length'];iLayoutTile++){var layoutTile=view['Layout']['Tiles'][iLayoutTile];for(var iTile=0x0;iTile<tiles['length'];iTile++){var tile=tiles[iTile];if(tile['Name']==layoutTile['Name']){var tileCopy=JSON['parse'](JSON['stringify'](tile));tileCopy['Location']=layoutTile['Location'],tileCopy['GUID']=TriSysSDK['Miscellaneous']['GUID'](),tileCopy['HideCaption']=layoutTile['HideCaption'];var bAddToArray=!![];if(tileCopy['Hidden'])bAddToArray=![];bAddToArray&&tilesArray['push'](tileCopy);}}}view['Layout']['Tiles']=tilesArray;}}return viewConfiguration;}},'PopulateDynamicViewMenuItems':function(){var fnMakeMenuItemHTML=function(dashboardView){var sID=ctrlDashboard['ViewMenuItemPrefix']+dashboardView['Name'],sIcon='<i\x20class=\x22'+dashboardView['Icon']['substring'](0x0,0x2)+'\x20'+dashboardView['Icon']+'\x20pull-right\x22></i>',sDisplayStyle=dashboardView['Visible']?'':'\x20style=\x22display:\x20none;\x22',sHTML='<a\x20href=\x22javascript:void(0)\x22\x20id=\x22'+sID+'\x22'+sDisplayStyle+'>'+sIcon+dashboardView['Caption']+'</a>';return sHTML;};ctrlDashboard['RemoveEventHandlers']();var sUL='dashboard-view-menu-items';$('#'+sUL)['find']('a')['each'](function(){$(this)['remove']();});for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i],sLI=fnMakeMenuItemHTML(dashboardView);$('#'+sUL)['append'](sLI);}var elemList=$('#dashboard-view-menu-items'),iHeight=window['innerHeight']-0x113;elemList['css']('max-height',iHeight),ctrlDashboard['AddEventHandlers']();var sDefaultView=ctrlDashboard['ViewConfiguration']['Default'],view=ctrlDashboard['GetView'](sDefaultView);if(view)ctrlDashboard['LoadDashboardView'](view);},'AddEventHandlers':function(){TriSysSDK['FormMenus']['AddEventHandlersToMenuItems']('dashboard-view-menu-items-container',ctrlDashboard['ViewMenuItemSelection']);},'RemoveEventHandlers':function(){TriSysSDK['FormMenus']['DeleteEventHandlersOnMenuItems']('dashboard-view-menu-items-container');},'ViewMenuItemSelection':function(sMenuID){var sID=sMenuID['substring'](ctrlDashboard['ViewMenuItemPrefix']['length']);switch(sID){case'configure':if(ctrlDashboard['CanViewLayoutBeConfigured']())ctrlDashboard['EnableViewLayoutEditMode'](!![]);else TriSysApex['UI']['ShowMessage']('This\x20dashboard\x20view\x20cannot\x20be\x20configured.\x20Use\x20the\x20View\x20Manager\x20to\x20assign\x20visibility\x20and\x20security\x20permissions.');break;case'manager':ctrlDashboard['ViewManagerModal']['Show']();break;case'close':TriSysApex['FormsManager']['CloseCurrentForm']();break;default:var view=ctrlDashboard['GetView'](sID);if(view)ctrlDashboard['LoadDashboardView'](view);ctrlDashboard['HidePopupViewMenu']();}},'GetView':function(sName){for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i];if(dashboardView['Name']==sName)return dashboardView;}},'LoadDashboardView':function(view){ctrlDashboard['CurrentView']=view;var sDashboardControlFolder='dashboard/',sDashboardControlPath=sDashboardControlFolder+view['Control'],fnCallbackOnLoad=function(){ctrlDashboard['LoadCustomisedDashboardViewLayoutAndTiles'](view);};TriSysApex['FormsManager']['loadControlIntoDiv'](ctrlDashboard['DashboardContentID'],sDashboardControlPath,fnCallbackOnLoad),$('#dashboard-view-name')['html'](view['Caption']);},'LoadCustomisedDashboardViewLayoutAndTiles':function(view){if(view['Control']!=ctrlDashboard['DashboardViewFile'])return null;ctrlDashboard['DrawLayoutFramework']();var bShow=![];ctrlDashboard['ShowOrHideBlocksWithNoTile'](bShow),ctrlDashboard['ShowOrHideTileConfigurator'](bShow);},'DrawLayoutFramework':function(){ctrlDashboard['DeleteExistingRowsAndColumnLayout']();if(ctrlDashboard['CurrentView']['Layout']){var rows=ctrlDashboard['CurrentView']['Layout']['Rows'];if(rows)for(var iRow=0x0;iRow<rows['length'];iRow++){var row=rows[iRow];ctrlDashboard['DrawRowLayout'](iRow+0x1,row);}var tiles=ctrlDashboard['CurrentView']['Layout']['Tiles'];if(tiles)for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];ctrlDashboard['LoadTile'](tile);}}},'DeleteExistingRowsAndColumnLayout':function(){var iMaxRows=0x20;for(var iRow=0x1;iRow<=iMaxRows;iRow++){var sRowTemplateID='draggable-blocks-row-',rowID=sRowTemplateID+iRow;$('#'+rowID)['empty'](),$('#'+rowID)['remove']();}},'DrawRowLayout':function(iRowNumber,row){var sRowTemplateID='draggable-blocks-row-',elem=document['getElementById'](sRowTemplateID);if(!elem)return;var sRowTemplateHTML=elem['outerHTML'],sColumnTemplateID='dashboard-block-row-1-column-';elem=document['getElementById'](sColumnTemplateID);if(!elem)return;var sColumnTemplateHTML=elem['outerHTML'],rowID=sRowTemplateID+iRowNumber,sRowHTML=sRowTemplateHTML;sRowHTML=sRowHTML['replace'](sRowTemplateID,rowID),sRowHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowHTML),$('#'+ctrlDashboard['DashboardContentID'])['append'](sRowHTML);var iEachColumnWidth=0xc/row['Columns'],sColumnsHTML='';for(var iColumn=0x1;iColumn<=row['Columns'];iColumn++){var sColumnHTML=sColumnTemplateHTML;sColumnHTML=sColumnHTML['replace'](sColumnTemplateID,'dashboard-block-row-'+iRowNumber+'-column-'+iColumn),sColumnHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sColumnHTML),sColumnHTML=sColumnHTML['replace']('col-sm-4','col-sm-'+iEachColumnWidth);var sBlockPlaceholder='dashboard-block-empty-',sGUID=TriSysSDK['Miscellaneous']['GUID'](),sBlockID=sBlockPlaceholder+sGUID;sColumnHTML=sColumnHTML['replace'](sBlockPlaceholder,sBlockID),sColumnsHTML+=sColumnHTML+'\x0a';}$('#'+rowID)['append'](sColumnsHTML);},'DashboardContentID':'divDashboardContent','CurrentView':null,'SaveEditedTileLayoutLocationsToMemory':function(){var rows=ctrlDashboard['CurrentView']['Layout']['Rows'];if(rows){for(var iRow=0x0;iRow<rows['length'];iRow++){var row=rows[iRow];for(var iColumn=0x1;iColumn<=row['Columns'];iColumn++){var sColumnBlockID='dashboard-block-row-'+(iRow+0x1)+'-column-'+iColumn,tileNameAndGUIDArray=ctrlDashboard['GetTileNamesAndGUIDInRowColumnBlock'](sColumnBlockID);if(tileNameAndGUIDArray)for(var i=0x0;i<tileNameAndGUIDArray['length'];i++){var tileNameAndGUID=tileNameAndGUIDArray[i],sTileName=tileNameAndGUID['TileName'];ctrlDashboard['AssignTileToColumnBlock'](sTileName,sColumnBlockID);}}}ctrlDashboard['Persistence']['ReadCurrentViewLayoutIntoMemoryArray']();}},'AssignTileToColumnBlock':function(sTileName,sColumnBlockID){var tiles=ctrlDashboard['CurrentView']['Layout']['Tiles'];if(tiles)for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];if(tile['Name']==sTileName){tile['Location']=sColumnBlockID;return;}}var tile=ctrlDashboard['GetTileByNameFromJSONFile'](sTileName);if(tile){tiles=ctrlDashboard['CurrentView']['Layout']['Tiles'];if(!tiles)tiles=[];tiles['push'](tile),tile['Location']=sColumnBlockID;}},'GetTileNamesAndGUIDInRowColumnBlock':function(sColumnBlockID){var tileNameAndGUIDArray=null,sTileNamePrefix='tile-name-',DOMobjectIDs=ctrlDashboard['FindDOMObjectsInContainer'](sColumnBlockID,sTileNamePrefix);if(DOMobjectIDs)for(var i=0x0;i<DOMobjectIDs['length'];i++){var sID=DOMobjectIDs[i],parts=sID['split'](sTileNamePrefix);parts=parts[0x1]['split']('-GUID-');var sTileName=parts[0x0],sGUID=parts[0x1]['substring'](0x0,0x24);if(!tileNameAndGUIDArray)tileNameAndGUIDArray=[];var item={'TileName':sTileName,'GUID':sGUID};tileNameAndGUIDArray['push'](item);}return tileNameAndGUIDArray;},'FindDOMObjectsInContainer':function(sColumnBlockID,sPrefix,bIgnoreLengthCheck){var DOMobjectIDs=null,nodesArray=TriSysSDK['DocumentObjectModel']['GetAllNodesBeneathUniqueDivID'](sColumnBlockID);if(nodesArray)for(var i=0x0;i<nodesArray['length'];i++){var node=nodesArray[i];if(node['id']){var sID=node['id'];if(sID['indexOf'](sPrefix)==0x0){var bAddToDOMArray=![];if(bIgnoreLengthCheck)bAddToDOMArray=!![];else{var iGUIDindex=sID['indexOf']('-GUID-'),iIDLength=sID['length'];if(iIDLength-iGUIDindex==0x2a)bAddToDOMArray=!![];}if(bAddToDOMArray){if(!DOMobjectIDs)DOMobjectIDs=[];DOMobjectIDs['push'](sID);}}}}return DOMobjectIDs;},'GetTileByNameFromJSONFile':function(sName){var tiles=TriSysApex['Forms']['Configuration']['JsonFileData'](ctrlDashboard['TileConfigurationFile']);if(!tiles)return null;for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];if(tile['Name']==sName)return tile;}},'GetTileByGUID':function(sGUID){var currentViewLayout=ctrlDashboard['CurrentView']['Layout'];if(currentViewLayout){var tiles=currentViewLayout['Tiles'];if(tiles)for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];if(tile['GUID']==sGUID)return tile;}}},'GetTileByID':function(sTileID){var parsedTile=ctrlDashboard['ParseTileID'](sTileID),tile=ctrlDashboard['GetTileByGUID'](parsedTile['GUID']);return tile;},'LoadTile':function(tile){var sGUID=tile['GUID'];!sGUID&&(sGUID=TriSysSDK['Miscellaneous']['GUID'](),tile['GUID']=sGUID);var sTileID=ctrlDashboard['CreateTileID'](tile['Name'],sGUID),sTileContentID='tile-content-'+sGUID,sDashboardTilesFolder='dashboard/tiles/',sTileFolder=TriSysApex['Constants']['UserControlFolder']+sDashboardTilesFolder,sTileTemplate=sTileFolder+'ctrlDashboardTile.html',sTemplateHTML=TriSysApex['NavigationBar']['TemplateFile'](sTileTemplate);sTemplateHTML=sTemplateHTML['replace']('##TileID##',sTileID),sTemplateHTML=sTemplateHTML['replace']('##TileTitle##',tile['Caption']),sTemplateHTML=sTemplateHTML['replace']('##TileContentID##',sTileContentID);var sCaptionIDPlaceholder='dashboard-tile-caption',sSuffix='-'+tile['Name']+'-GUID-'+sGUID,sCaptionID=sCaptionIDPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sCaptionIDPlaceholder,sCaptionID);var sColour='';if(tile['CaptionBackColour']||tile['CaptionForeColour']||tile['HideCaption']){sColour='\x20style=\x22';if(tile['CaptionBackColour']&&tile['CaptionBackColour']!=-0x1)sColour+='background-color:'+tile['CaptionBackColour']+';';if(tile['CaptionForeColour']&&tile['CaptionForeColour']!=-0x1)sColour+='color:'+tile['CaptionForeColour']+';';if(tile['HideCaption'])sColour+='display:none;';sColour+='\x22';}sTemplateHTML=sTemplateHTML['replace']('##title-colour##',sColour);var sTitlePlaceholder='dashboard-tile-title',sTitleID=sTitlePlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sTitlePlaceholder,sTitleID);var sConfigureID='dashboard-tile-configure-menu-button',sButtonID=sConfigureID+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sConfigureID,sButtonID);var sMenuContainer='dashboard-tile-configure-menu-items-container',sMenuContainerID=sMenuContainer+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sMenuContainer,sMenuContainerID);var sDeleteItemPlaceholder='dashboard-tile-configure-menu-items-delete',sDeleteItemID=sDeleteItemPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sDeleteItemPlaceholder,sDeleteItemID);var sDeleteClick='onclick=\x22ctrlDashboard.DeleteTileMenuClick(\x27'+sTileID+'\x27);\x22';sTemplateHTML=sTemplateHTML['replace']('##delete-tile##',sDeleteClick);var sSetCaptionPlaceholder='dashboard-tile-configure-menu-items-set-caption',sSetCaptionID=sSetCaptionPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sSetCaptionPlaceholder,sSetCaptionID);var sSetCaptionClick='onclick=\x22ctrlDashboard.SetCaption(\x27'+sTileID+'\x27);\x22';sTemplateHTML=sTemplateHTML['replace']('##set-caption##',sSetCaptionClick);var sSetColoursPlaceholder='dashboard-tile-configure-menu-items-set-colours',sSetColoursID=sSetColoursPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sSetColoursPlaceholder,sSetColoursID);var sSetColoursClick='onclick=\x22ctrlDashboard.SetColours(\x27'+sTileID+'\x27);\x22';sTemplateHTML=sTemplateHTML['replace']('##set-colours##',sSetColoursClick);var sOptionsPlaceholderPrefix='dashboard-tile-configure-menu-items-',sOptionsGroupDivider='##options-group-divider##',sOptionsGroupDividerTagValue='style=\x22display:\x20none;\x22',sChartOptions='chart-options',sChartOptionsPlaceholder=sOptionsPlaceholderPrefix+sChartOptions,bShowChartOptions=tile['MenuConfigurationItems']&&tile['MenuConfigurationItems']['indexOf'](sChartOptions)>=0x0,sChartOptionsID=sChartOptionsPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sChartOptionsPlaceholder,sChartOptionsID);var sChartOptionsClick=bShowChartOptions?'onclick=\x22ctrlDashboard.ChartOptionsModal.Show(\x27'+sTileID+'\x27);\x22':'style=\x22display:\x20none;\x22';sTemplateHTML=sTemplateHTML['replace']('##chart-options##',sChartOptionsClick);if(bShowChartOptions)sOptionsGroupDividerTagValue='';var sWebPageOptions='webpage-options',sWebPageOptionsPlaceholder=sOptionsPlaceholderPrefix+sWebPageOptions,bShowWebPageOptions=tile['MenuConfigurationItems']&&tile['MenuConfigurationItems']['indexOf'](sWebPageOptions)>=0x0,sWebPageOptionsID=sWebPageOptionsPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sWebPageOptionsPlaceholder,sWebPageOptionsID);var sWebPageOptionsClick=bShowWebPageOptions?'onclick=\x22ctrlDashboard.WebPageOptionsModal.Show(\x27'+sTileID+'\x27);\x22':'style=\x22display:\x20none;\x22';sTemplateHTML=sTemplateHTML['replace']('##webpage-options##',sWebPageOptionsClick);if(bShowWebPageOptions)sOptionsGroupDividerTagValue='';var sOptionsGroupDividerID='dashboard-tile-configure-menu-items-options-group-divider';sTemplateHTML=sTemplateHTML['replace'](sOptionsGroupDividerID,sOptionsGroupDividerID+sSuffix),sTemplateHTML=sTemplateHTML['replace'](sOptionsGroupDivider,sOptionsGroupDividerTagValue);var sMenuContainerPlaceholder='dashboard-tile-configure-menu-container',sMenuContainerID=sMenuContainerPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sMenuContainerPlaceholder,sMenuContainerID);var sCustomGroupPlaceholder='dashboard-tile-configure-menu-items-custom-group',sCustomGroupID=sCustomGroupPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sCustomGroupPlaceholder,sCustomGroupID);var sCustomGroupDividerPlaceholder='dashboard-tile-configure-menu-items-custom-group-divider',sCustomGroupDividerID=sCustomGroupDividerPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sCustomGroupDividerPlaceholder,sCustomGroupDividerID);var sCustomMenuItemPlaceholder='dashboard-tile-configure-menu-items-custom-item',sCustomMenuItemID=sCustomMenuItemPlaceholder+sSuffix;sTemplateHTML=sTemplateHTML['replace'](sCustomMenuItemPlaceholder,sCustomMenuItemID);var bCustomMenusVisible=![];if(tile['MenuVisible']){if(tile['MenuItems']&&tile['MenuCallback'])bCustomMenusVisible=!![];}try{$('#'+tile['Location'])['prepend'](sTemplateHTML);}catch(e){TriSysApex['UI']['ShowError'](e,'LoadTile:\x20'+tile['Name']);}if(!tile['MenuVisible'])$('#'+sMenuContainerID)['remove']();else{if(!bCustomMenusVisible)$('#'+sCustomGroupID)['remove'](),$('#'+sCustomGroupDividerID)['remove']();else{if(bCustomMenusVisible&&sCustomMenuItemID){var element=document['getElementById'](sCustomMenuItemID);if(element){var sCustomeMenuItemHTML=element['outerHTML'],menuItems=tile['MenuItems'];for(var i=0x0;i<menuItems['length'];i++){var menuItem=menuItems[i],sMenuItemID=sCustomMenuItemPlaceholder+'-'+menuItem['ID'],sMenuItem=sCustomeMenuItemHTML;sMenuItem=sMenuItem['replace'](sCustomMenuItemID,sMenuItemID),sMenuItem=sMenuItem['replace']('custom-menu-caption',menuItem['Caption']);var sIcon=menuItem['Icon'];if(sIcon)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;sMenuItem=sMenuItem['replace']('custom-menu-icon',sIcon);var sOnClick='TriSysApex.DynamicClasses.CallFunction(\x27'+tile['MenuCallback']+'\x27,\x20\x27'+menuItem['ID']+'\x27,\x20\x27'+sTileID+'\x27)';sMenuItem=sMenuItem['replace']('custom-menu-onclick',sOnClick),$('#'+sCustomGroupID)['append'](sMenuItem);var bUseClosures=![];if(bUseClosures){var fnInvokeCustomMenuItemClosure=function(sCustomMenuItemID){return function(){TriSysApex['DynamicClasses']['CallFunction'](tile['MenuCallback'],sCustomMenuItemID,sTileID);};};$('#'+sMenuItemID)['unbind'](),$('#'+sMenuItemID)['click'](fnInvokeCustomMenuItemClosure(menuItem['ID']));}}}}sCustomMenuItemID&&$('#'+sCustomMenuItemID)['remove']();}}var fnAfterLoad=function(){TriSysSDK['Controls']['General']['RenameElementIdsWithParentIdPrefixOrSuffix'](sTileContentID,sTileID,!![]),ctrlDashboard['Persistence']['ApplyPersistedTileSettings'](tile,sTileID),ctrlDashboard['CallTileLoadedCallback'](sTileID,tile['PersistedSettings']);},sControl=sDashboardTilesFolder+tile['Control'];TriSysApex['FormsManager']['loadControlIntoDiv'](sTileContentID,sControl,fnAfterLoad);},'DeleteTileMenuClick':function(sTileID){$('#'+sTileID)['remove']();var tileToDelete=ctrlDashboard['GetTileByID'](sTileID),tiles=ctrlDashboard['CurrentView']['Layout']['Tiles'];if(tiles)for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];if(tile['GUID']==tileToDelete['GUID']){tiles['splice'](i,0x1);break;}}},'SetCaption':function(sTileID){ctrlDashboard['SetCaptionModal']['Show'](sTileID);},'SetColours':function(sTileID){ctrlDashboard['SetColoursModal']['Show'](sTileID);},'InitialiseDragDrop':function(bEnable){if(!ctrlDashboard['CurrentView']['Layout'])return;var sDivCollection='',sDraggableBlockRow='#draggable-blocks-row-';for(var i=0x0;i<ctrlDashboard['CurrentView']['Layout']['Rows']['length'];i++){if(sDivCollection['length']>0x0)sDivCollection+=',\x20';sDivCollection+=sDraggableBlockRow+(i+0x1);}if(bEnable)$(sDivCollection)['sortable']({'connectWith':'.row','items':'.block','opacity':0.75,'handle':'.block-title','placeholder':'draggable-placeholder','tolerance':'pointer','start':function(e,ui){ui['placeholder']['css']('height',ui['item']['outerHeight']());}}),$(sDivCollection)['sortable']('enable');else $(sDivCollection)['sortable']('disable');var bShow=bEnable;ctrlDashboard['ShowOrHideBlocksWithNoTile'](bShow),ctrlDashboard['ShowOrHideTileConfigurator'](bShow);},'EnableViewLayoutEditMode':function(bEnable){ctrlDashboard['InitialiseDragDrop'](bEnable);if(bEnable)$('#dashboard-view-menu-button')['attr']('disabled',!![]);else $('#dashboard-view-menu-button')['removeAttr']('disabled');var buttons=['dashboard-configure-layout','dashboard-save-view','dashboard-cancel','dashboard-add-tile'];for(var i=0x0;i<buttons['length'];i++){var button=buttons[i];if(bEnable)$('#'+button)['show']();else $('#'+button)['hide']();}},'ViewMenuVisibility':function(){var sValue=TriSysApex['Cache']['SystemSettingManager']['GetValue'](TriSysApex['Constants']['DashboardHideViewMenu']),bVisible=!TriSysAPI['Operators']['stringToBoolean'](sValue,![]),elem=$('#dashboard-view-menu-button');if(bVisible)elem['show']();else elem['hide']();},'HidePopupViewMenu':function(){var block=$('#dashboard-view-menu-btn-group');block['removeClass']('open'),block['removeClass']('show-on-hover');return;var menuItems=$('#dashboard-view-menu-items-container');menuItems['hide'](),setTimeout(function(){menuItems['css']('display','');},0x1388);},'ShowOrHideBlocksWithNoTile':function(bShow){var rows=ctrlDashboard['CurrentView']['Layout']['Rows'];if(rows)for(var iRow=0x0;iRow<rows['length'];iRow++){var row=rows[iRow];for(var iColumn=0x1;iColumn<=row['Columns'];iColumn++){var sColumnBlockID='dashboard-block-row-'+(iRow+0x1)+'-column-'+iColumn,tileNames=ctrlDashboard['GetTileNamesAndGUIDInRowColumnBlock'](sColumnBlockID);if(!tileNames){if(bShow)$('#'+sColumnBlockID)['show']();else $('#'+sColumnBlockID)['hide']();}else{var sBlockPlaceholder='dashboard-block-empty-',DOMobjectIDs=ctrlDashboard['FindDOMObjectsInContainer'](sColumnBlockID,sBlockPlaceholder,!![]);if(DOMobjectIDs)for(var i=0x0;i<DOMobjectIDs['length'];i++){var sID=DOMobjectIDs[i];if(bShow)$('#'+sID)['show']();else $('#'+sID)['hide']();}}}}},'ShowOrHideTileConfigurator':function(bShow){var sConfigureID='dashboard-tile-configure-menu-button';$('#'+ctrlDashboard['DashboardContentID'])['find']('[id^='+sConfigureID+']')['each'](function(){if(bShow)$(this)['show']();else $(this)['hide']();});},'CreateTileID':function(sTileName,sGUID){var sTileID='tile-name-'+sTileName+'-GUID-'+sGUID;return sTileID;},'ParseTileID':function(sTileID){var parts=sTileID['split']('tile-name-');parts=parts[0x1]['split']('-GUID-');var sTileName=parts[0x0],sGUID=parts[0x1],parsedTile={'TileName':sTileName,'GUID':sGUID};return parsedTile;},'ConfigureButtonClick':function(sItem){switch(sItem){case'configure-layout':var rows=ctrlDashboard['CurrentView']['Layout']['Rows'];ctrlDashboard['ConfigureLayoutModal']['Show'](rows);break;case'save-view':ctrlDashboard['SaveEditedTileLayoutLocationsToMemory'](),ctrlDashboard['ViewManagerModal']['ApplyChangesAsynchronouslyAndSilentlyToServer'](),ctrlDashboard['EnableViewLayoutEditMode'](![]);break;case'cancel':ctrlDashboard['EnableViewLayoutEditMode'](![]),ctrlDashboard['LoadDashboardView'](ctrlDashboard['CurrentView']);break;case'add-tile':ctrlDashboard['TilePickerModal']['Show']();break;}},'CanViewLayoutBeConfigured':function(){if(ctrlDashboard['CurrentView']['Layout']){if(ctrlDashboard['CurrentView']['Control']==ctrlDashboard['DashboardViewFile'])return!![];}return![];},'ConfigureLayoutModal':{'Context':{'Rows':[{'Columns':0x1}]},'Show':function(rows){var context=ctrlDashboard['ConfigureLayoutModal']['Context'];context['Rows']=rows;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Layout',parametersObject['Image']='gi-adjust_alt',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlDashboardLayout.html',parametersObject['ButtonCentreText']='Apply',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=ctrlDashboard['ConfigureLayoutModal']['ApplyLayout'],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Draw':function(){var context=ctrlDashboard['ConfigureLayoutModal']['Context'],rows=context['Rows'],sRowsSpinner='dashboardLayout-Rows',fieldDescription={'MinValue':0x1,'MaxValue':0x20,'SpinIncrement':0x1};TriSysSDK['Controls']['NumericSpinner']['Initialise'](sRowsSpinner,fieldDescription),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest'](sRowsSpinner,ctrlDashboard['ConfigureLayoutModal']['ChangeRowCount']),TriSysSDK['Controls']['NumericSpinner']['SetValue'](sRowsSpinner,rows['length']),TriSysSDK['Controls']['NumericSpinner']['DecimalPlaces'](sRowsSpinner,0x0),ctrlDashboard['ConfigureLayoutModal']['DrawTable']();},'ChangeRowCount':function(sFieldID,fValue){var context=ctrlDashboard['ConfigureLayoutModal']['Context'],rows=context['Rows'],sRowsSpinner='dashboardLayout-Rows',iRows=TriSysSDK['Controls']['NumericSpinner']['GetValue'](sRowsSpinner);iRows=parseInt(iRows),console['log']('\x20ChangeRowCount:\x20iRows='+iRows);if(iRows<rows['length'])rows['splice'](iRows-0x1,0x20);else{if(iRows>rows['length'])rows['push']({'Columns':0x2});}ctrlDashboard['ConfigureLayoutModal']['DrawTable']();},'ChangeColumnCount':function(sFieldID,fValue){var sRowColumnsSpinnerPrefix='dashboardLayout-Row-',sRowColumnSpinnerSuffix='-Columns',parts=sFieldID['split'](sRowColumnsSpinnerPrefix);parts=parts[0x1]['split'](sRowColumnSpinnerSuffix);var iRow=parseInt(parts[0x0]),context=ctrlDashboard['ConfigureLayoutModal']['Context'],rows=context['Rows'],iColumns=parseInt(Math['floor'](fValue,0x0)),row=rows[iRow-0x1];row['Columns']=iColumns,ctrlDashboard['ConfigureLayoutModal']['ChangeRowCount']();},'DrawTable':function(sFieldID,fValue){var context=ctrlDashboard['ConfigureLayoutModal']['Context'],rows=context['Rows'],tableBody=$('#dashboard-layout-table\x20>\x20tbody'),rowSpecifierTemplateName='dashboard-layout-table-row-specifier',rowVisualTemplateName='dashboard-layout-table-row-visual',sRowSpecifier=document['getElementById'](rowSpecifierTemplateName)['outerHTML'],sRowVisual=document['getElementById'](rowVisualTemplateName)['outerHTML'],visualTableBody=$('#dashboard-layout-table-dynamicLayout\x20>\x20tbody'),iMaxRows=0x20;for(var i=0x0;i<=iMaxRows;i++){var sRowSpecifierInstanceName=rowSpecifierTemplateName+'-'+(i+0x1),sRowColumnsSpinner='dashboardLayout-Row-'+(i+0x1)+'-Columns';TriSysSDK['Controls']['NumericSpinner']['RemoveEventHandlers'](sRowColumnsSpinner),$('#'+sRowSpecifierInstanceName)['remove']();var sVisualRowInstanceName=rowVisualTemplateName+'-'+(i+0x1);$('#'+sVisualRowInstanceName)['remove']();}for(var i=0x0;i<rows['length'];i++){var row=rows[i],iRow=i+0x1,sRowSpecifierInstanceName=rowSpecifierTemplateName+'-'+iRow,sRowColumnsSpinner='dashboardLayout-Row-'+iRow+'-Columns',sTableRowHTML=sRowSpecifier;sTableRowHTML=sTableRowHTML['replace'](rowSpecifierTemplateName,sRowSpecifierInstanceName),sTableRowHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sTableRowHTML),sTableRowHTML=sTableRowHTML['replace']('##Row##','Row\x20'+iRow),sTableRowHTML=sTableRowHTML['replace']('##ColumnSpinner##',sRowColumnsSpinner),tableBody['append'](sTableRowHTML);var fieldDescription={'MinValue':0x1,'MaxValue':0xc,'SpinIncrement':0x1};TriSysSDK['Controls']['NumericSpinner']['Initialise'](sRowColumnsSpinner,fieldDescription),TriSysSDK['Controls']['NumericSpinner']['SetValue'](sRowColumnsSpinner,row['Columns']),TriSysSDK['Controls']['NumericSpinner']['DecimalPlaces'](sRowColumnsSpinner,0x0),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest'](sRowColumnsSpinner,ctrlDashboard['ConfigureLayoutModal']['ChangeColumnCount']);var sVisualTableRowInstance=rowVisualTemplateName+'-'+iRow,sVisualTableRowHTML=sRowVisual;sVisualTableRowHTML=sVisualTableRowHTML['replace'](rowVisualTemplateName,sVisualTableRowInstance),sVisualTableRowHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sVisualTableRowHTML);var sVisualColumns='',fPercentageWidth=0x64/row['Columns'];for(var iColumn=0x0;iColumn<row['Columns'];iColumn++){var sBorder='';if(iColumn>0x0)sBorder='border-left:\x201px\x20dotted\x20gray;';var sDivText=iColumn+0x1;sDivText='<table\x20id=\x22dashboard-layout-table-small-panel\x22><tr><td>'+iRow+'.'+(iColumn+0x1)+'</td></tr></table>',sDivText='<trisys-field\x20id=\x22test-numeric-'+iRow+'-'+(iColumn+0x1)+'\x22\x20type=\x22numeric\x22\x0a\x09\x09\x09\x09\x09\x09\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20minimum=\x221\x22\x20maximum=\x2212\x22\x20increment=\x221\x22\x20\x0a\x09\x09\x09\x09\x09\x09\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20integer=\x22false\x22\x20value=\x221\x22\x20style=\x22height:\x2028px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</trisys-field>';var iBootstrapWidth='1';if(row['Columns']==0xb)iBootstrapWidth=iColumn==0x0?'2':'1';else{if(row['Columns']==0xa)iBootstrapWidth=iColumn==0x0?'3':'1';else{if(row['Columns']==0x9)iBootstrapWidth=iColumn==0x0||iColumn==0x1?'2':'1';else{if(row['Columns']==0x5)iBootstrapWidth=iColumn==0x0?'4':'2';else{if(row['Columns']==0x4)iBootstrapWidth='3';else{if(row['Columns']==0x3)iBootstrapWidth='4';else{if(row['Columns']==0x2)iBootstrapWidth='6';else{if(row['Columns']==0x1)iBootstrapWidth='12';}}}}}}}sDivText='<trisys-field\x20id=\x22test-combo-'+iRow+'-'+(iColumn+0x1)+'\x22\x20type=\x22combo\x22\x0a\x09\x09\x09\x09\x09\x09\x09\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20lookups=\x221,2,3,4,5,6,7,8,9,10,11,12\x22\x20value=\x22'+iBootstrapWidth+'\x22\x22\x20style=\x22height:\x2025px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</trisys-field>';var sVisualColumn='<div\x20style=\x22float:\x20left;\x20text-align:\x20center;\x20width:'+fPercentageWidth+'%;'+sBorder+'\x22>'+sDivText+'</div>';sVisualColumns+=sVisualColumn;}sVisualTableRowHTML=sVisualTableRowHTML['replace']('##RowColumnLayout##',sVisualColumns),visualTableBody['append'](sVisualTableRowHTML);}var sFormName='dashboardLayoutModal';TriSysSDK['CShowForm']['InitialiseFields'](sFormName);},'ApplyLayout':function(){var context=ctrlDashboard['ConfigureLayoutModal']['Context'],rows=context['Rows'];return ctrlDashboard['CurrentView']['Layout']['Rows']=rows,ctrlDashboard['SaveEditedTileLayoutLocationsToMemory'](),ctrlDashboard['InitialiseDragDrop'](![]),ctrlDashboard['DrawLayoutFramework'](),ctrlDashboard['InitialiseDragDrop'](!![]),!![];}},'TilePickerModal':{'Show':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Live-Tile\x20Picker',parametersObject['Image']='gi-charts',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlDashboardTilePicker.html',parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'LoadTilePicker':function(){var liPrefix='dashboard-tile-picker-category-',liArray=['all','contacts','companies','requirements','placements','timesheets','tasks','actions','financial','consultant','social','system'];for(var i=0x0;i<liArray['length'];i++){var sCategory=liArray[i],liID=liPrefix+sCategory,li=$('#'+liID);li['find']('a')['each'](function(){$(this)['click'](function(e){e['preventDefault']();var li=$(this)['parent'](),liID=li['attr']('id'),parts=liID['split'](liPrefix),sSelectedCategory=parts[0x1];ctrlDashboard['TilePickerModal']['TilePickerCategorySelection'](sSelectedCategory);});});}ctrlDashboard['TilePickerModal']['PopulateListOfTilesForCategory']('all');},'TilePickerCategorySelection':function(sCategory){var sUL='dashboard-tile-picker-categories-list';$('#'+sUL)['find']('li')['each'](function(){$(this)['removeClass']('active');});var liPrefix='dashboard-tile-picker-category-',liID=liPrefix+sCategory;$('#'+liID)['addClass']('active');var sDisplayCategory=sCategory['substring'](0x0,0x1)['toUpperCase']()+sCategory['substring'](0x1);$('#dashboard-tile-picker-category')['html'](sDisplayCategory),ctrlDashboard['TilePickerModal']['PopulateListOfTilesForCategory'](sCategory);},'PopulateListOfTilesForCategory':function(sCategory){ctrlDashboard['TilePickerModal']['RemoveAllTilesFromList']();var tiles=TriSysApex['Forms']['Configuration']['JsonFileData'](ctrlDashboard['TileConfigurationFile']);if(!tiles)return null;var iAddedCounter=0x0;for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i],bAddTile=sCategory=='all';if(!bAddTile)bAddTile=tile['Category']['toLowerCase']()==sCategory['toLowerCase']();if(tile['Hidden'])bAddTile=![];bAddTile&&(iAddedCounter+=0x1,ctrlDashboard['TilePickerModal']['AddTileToList'](tile,iAddedCounter));}},'RemoveAllTilesFromList':function(){var sTableID='dashboard-tile-picker-category-tiles-table';$('#'+sTableID+'\x20tr')['each'](function(i,row){var sDisplay=$(row)['css']('display');if(sDisplay){if(sDisplay['indexOf']('none')<0x0)$(row)['remove']();}});},'AddTileToList':function(tile,iRow){var sTableRowTemplateID='dashboard-tile-picker-category-tiles-table-row',sTableRowTemplateHTML=document['getElementById'](sTableRowTemplateID)['outerHTML'],sTableRowDividerTemplateID='dashboard-tile-picker-category-tiles-table-row-divider',sTableRowDividerTemplateHTML=document['getElementById'](sTableRowDividerTemplateID)['outerHTML'],sTableRowID=sTableRowTemplateID+'-'+iRow,sTableRow=sTableRowTemplateHTML;sTableRow=sTableRow['replace'](sTableRowTemplateID,sTableRowID),sTableRow=sTableRow['replace']('display:none;',''),sTableRow=sTableRow['replace']('display:\x20none;','');var sThumbnailImage=tile['Thumbnail'],sImageFolder='images/trisys/dashboard-tiles/';if(sThumbnailImage)sThumbnailImage=sImageFolder+sThumbnailImage;else sThumbnailImage=sImageFolder+'missing.png';var sTileCaption=tile['Caption'],sImageViewer='';if(sThumbnailImage)sImageViewer='onclick=\x22TriSysSDK.Controls.FileManager.OpenDocumentViewer(\x27'+sTileCaption+'\x27,\x20\x27'+sThumbnailImage+'\x27);\x22';sTableRow=sTableRow['replace']('##image-viewer##',sImageViewer),sTableRow=sTableRow['replace']('##ImagePath##',sThumbnailImage),sTableRow=sTableRow['replace']('##Caption##',sTileCaption),sTableRow=sTableRow['replace']('##Description##',tile['Description']);var bInstalledInView=![],sInstallHandler='onclick=\x22ctrlDashboard.TilePickerModal.InstallButtonClicked(\x27'+tile['Name']+'\x27,\x20this);\x22',sEnabled=bInstalledInView?'disabled':'',sInstall=bInstalledInView?'':sInstallHandler;sTableRow=sTableRow['replace']('##install-enabled##',sEnabled),sTableRow=sTableRow['replace']('##install-click##',sInstall);var sTableID='dashboard-tile-picker-category-tiles-table';if(iRow>0x1){var sRowDivider=sTableRowDividerTemplateHTML;sRowDivider=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowDivider),$('#'+sTableID)['append'](sRowDivider);}$('#'+sTableID)['append'](sTableRow);},'InstallButtonClicked':function(sTileName,btn){var tile=ctrlDashboard['GetTileByNameFromJSONFile'](sTileName);if(tile){var sLocation='dashboard-block-row-1-column-1';tile['Location']=sLocation,ctrlDashboard['LoadTile'](tile),ctrlDashboard['CurrentView']['Layout']['Tiles']['push'](tile),TriSysApex['Toasters']['Success']('Installed\x20Tile:\x20'+tile['Caption']);var bMultipleInstancesAllowed=!![];if(bMultipleInstancesAllowed){if(!ctrlDashboard['TilePickerModal']['InstructedUserOnMultipleInstances']){var sMessage='You\x20can\x20add\x20multiple\x20versions\x20to\x20your\x20view\x20and\x20configure\x20each\x20one\x20with\x20different\x20parameters.';TriSysApex['Toasters']['Info'](sMessage),ctrlDashboard['TilePickerModal']['InstructedUserOnMultipleInstances']=!![];}}else $(btn)['addClass']('disabled');}},'InstructedUserOnMultipleInstances':![]},'SetCaptionModal':{'TileID':null,'Show':function(sTileID){ctrlDashboard['SetCaptionModal']['TileID']=sTileID;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Tile\x20Caption',parametersObject['Image']='gi-subtitles',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlSetCaption.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['SetCaptionModal']['SaveTileCaption'](sTileID);return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'GetCaptionFieldID':function(sTileID){var parsedTile=ctrlDashboard['ParseTileID'](sTileID),sSuffix='-'+parsedTile['TileName']+'-GUID-'+parsedTile['GUID'],sCaptionID='dashboard-tile-caption'+sSuffix;return sCaptionID;},'Load':function(){var sTileID=ctrlDashboard['SetCaptionModal']['TileID'],sCaptionID=ctrlDashboard['SetCaptionModal']['GetCaptionFieldID'](sTileID),sCaption=$('#'+sCaptionID)['html'](),sCaptionField='dashboard-set-caption';$('#'+sCaptionField)['val'](sCaption);},'SaveTileCaption':function(sTileID){var sCaptionField='dashboard-set-caption',sCaption=$('#'+sCaptionField)['val']();if(!sCaption)return TriSysApex['UI']['ShowMessage']('Please\x20enter\x20some\x20text\x20for\x20the\x20caption.'),![];var sCaptionID=ctrlDashboard['SetCaptionModal']['GetCaptionFieldID'](sTileID);$('#'+sCaptionID)['html'](sCaption);var persistedSetting={'Setting':'Caption','Value':sCaption};return ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,persistedSetting),!![];},'SetTileCaption':function(sTileID,sCaption){var sCaptionID=ctrlDashboard['SetCaptionModal']['GetCaptionFieldID'](sTileID);$('#'+sCaptionID)['html'](sCaption);if(sCaption=='\x20')$('#'+sCaptionID)['hide']();else $('#'+sCaptionID)['show']();}},'SetColoursModal':{'TileID':null,'BackColour':null,'ForeColour':null,'Show':function(sTileID){ctrlDashboard['SetColoursModal']['TileID']=sTileID;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Tile\x20Colours',parametersObject['Image']='fa-paint-brush',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlSetColours.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['SetColoursModal']['SaveTileColours'](sTileID);return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreText']='Reset',parametersObject['ButtonCentreFunction']=function(){var bReset=!![],bSaved=ctrlDashboard['SetColoursModal']['SaveTileColours'](sTileID,bReset);return bSaved;},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'GetTileTitleBlockID':function(sTileID){var parsedTile=ctrlDashboard['ParseTileID'](sTileID),sSuffix='-'+parsedTile['TileName']+'-GUID-'+parsedTile['GUID'],sBlockID='dashboard-tile-title'+sSuffix;return sBlockID;},'Load':function(){var sTileID=ctrlDashboard['SetColoursModal']['TileID'],sTileTitle=ctrlDashboard['SetColoursModal']['GetTileTitleBlockID'](sTileID),lForeColour=$('#'+sTileTitle)['css']('color'),lBackColour=$('#'+sTileTitle)['css']('background-color');try{var fore=$('#dashboard-tile-set-colour-foreground-picker')['kendoColorPicker']()['data']('kendoColorPicker'),back=$('#dashboard-tile-set-colour-background-picker')['kendoColorPicker']()['data']('kendoColorPicker');fore['value'](lForeColour),back['value'](lBackColour);var callback={'select':function(e){var sElement=this['element']['attr']('id'),lColour=e['value'];ctrlDashboard['SetColoursModal']['ColourChangeEvent'](sElement,lColour);},'change':function(e){var sElement=this['element']['attr']('id'),lColour=e['value'];ctrlDashboard['SetColoursModal']['ColourChangeEvent'](sElement,lColour);}};fore['bind'](callback),back['bind'](callback),ctrlDashboard['SetColoursModal']['ForeColour']=lForeColour,ctrlDashboard['SetColoursModal']['BackColour']=lBackColour;}catch(ex){}},'ColourChangeEvent':function(sElement,lColour){var sID='dashboard-tile-set-colour-colours';switch(sElement){case'dashboard-tile-set-colour-foreground-picker':$('#'+sID)['css']('color',lColour),ctrlDashboard['SetColoursModal']['ForeColour']=lColour;break;case'dashboard-tile-set-colour-background-picker':$('#'+sID)['css']('background-color',lColour),ctrlDashboard['SetColoursModal']['BackColour']=lColour;break;}},'SaveTileColours':function(sTileID,bReset){bReset&&(ctrlDashboard['SetColoursModal']['ForeColour']=-0x1,ctrlDashboard['SetColoursModal']['BackColour']=-0x1);var colours={'Foreground':ctrlDashboard['SetColoursModal']['ForeColour'],'Background':ctrlDashboard['SetColoursModal']['BackColour']},persistedSetting={'Setting':'Colours','Value':colours};return ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,persistedSetting),ctrlDashboard['SetColoursModal']['SetTileColours'](sTileID,colours),!![];},'SetTileColours':function(sTileID,colourPair){var lBackColour=colourPair['Background'],lForeColour=colourPair['Foreground'],sTitleBlockID=ctrlDashboard['SetColoursModal']['GetTileTitleBlockID'](sTileID);lBackColour==-0x1&&lForeColour==-0x1?$('#'+sTitleBlockID)['removeAttr']('style'):($('#'+sTitleBlockID)['css']('color',lForeColour),$('#'+sTitleBlockID)['css']('background-color',lBackColour));}},'ChartOptionsModal':{'Setting':'ChartOptions','TileID':null,'Show':function(sTileID){ctrlDashboard['ChartOptionsModal']['TileID']=sTileID;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Tile\x20Chart\x20Options',parametersObject['Image']='gi-charts',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlChartOptions.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['ChartOptionsModal']['SaveChartOptions'](sTileID);return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreText']='Reset',parametersObject['ButtonCentreFunction']=function(){var bReset=!![],bSaved=ctrlDashboard['ChartOptionsModal']['SaveChartOptions'](sTileID,bReset);return bSaved;},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Load':function(){var sTileID=ctrlDashboard['ChartOptionsModal']['TileID'],tile=ctrlDashboard['GetTileByID'](sTileID);if(!tile)return;if(!tile['PersistedSettings']){var persistedSetting={'Setting':ctrlDashboard['ChartOptionsModal']['Setting'],'Value':ctrlDashboard['ChartOptionsModal']['DefaultChartOptions']};tile['PersistedSettings']=[persistedSetting];}if(tile['PersistedSettings']){var persistedSettings=tile['PersistedSettings'],chartOptions=ctrlDashboard['Persistence']['GetSettingValue'](persistedSettings,ctrlDashboard['ChartOptionsModal']['Setting'],null),sFormFieldPrefix='dashboard-tile-chart-options-',sLegendVisibleID=sFormFieldPrefix+'legend-visible',sLegendPositionID=sFormFieldPrefix+'legend-position',sLabelsVisibleID=sFormFieldPrefix+'labels-visible',sLabelsPositionID=sFormFieldPrefix+'labels-position',sHeightID=sFormFieldPrefix+'height',sSQLID=sFormFieldPrefix+'sql',sAPIFunctionID=sFormFieldPrefix+'api-function';TriSysSDK['CShowForm']['SetCheckBoxValue'](sLegendVisibleID,TriSysAPI['Operators']['stringToBoolean'](chartOptions['LegendVisible'],![]));var legendPositions=[{'value':'top','text':'Top'},{'value':'bottom','text':'Bottom'},{'value':'left','text':'Left'},{'value':'right','text':'Right'}];TriSysSDK['CShowForm']['populateComboFromDataSource'](sLegendPositionID,legendPositions,0x0),TriSysSDK['CShowForm']['SetValueInCombo'](sLegendPositionID,chartOptions['LegendPosition']),TriSysSDK['CShowForm']['SetCheckBoxValue'](sLabelsVisibleID,TriSysAPI['Operators']['stringToBoolean'](chartOptions['LabelsVisible'],![]));var labelPositions=[{'value':'center','text':'Centre'},{'value':'insideEnd','text':'Inside\x20End'},{'value':'insideBase','text':'Inside\x20Base'},{'value':'outsideEnd','text':'Outside\x20End'}];TriSysSDK['CShowForm']['populateComboFromDataSource'](sLabelsPositionID,labelPositions,0x0),TriSysSDK['CShowForm']['SetValueInCombo'](sLabelsPositionID,chartOptions['LabelsPosition']);var fieldDescription={'MinValue':0x1,'MaxValue':0x400,'SpinIncrement':0xa};TriSysSDK['Controls']['NumericSpinner']['Initialise'](sHeightID,fieldDescription),TriSysSDK['Controls']['NumericSpinner']['DecimalPlaces'](sHeightID,0x0);if(chartOptions['Height']>0x0)TriSysSDK['Controls']['NumericSpinner']['SetValue'](sHeightID,chartOptions['Height']);$('#'+sSQLID)['val'](chartOptions['SQL']);var apiFunctions=ctrlDashboard['ChartOptionsModal']['Data']['APIFunctions']();TriSysSDK['CShowForm']['populateComboFromDataSource'](sAPIFunctionID,apiFunctions,0x0),TriSysSDK['CShowForm']['SetValueInCombo'](sAPIFunctionID,chartOptions['APIFunction']);}},'Data':{'APIFunctions':function(){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('chart-api.json');if(jsonData){var functions=jsonData['API'];if(functions){var displayFunctions=[];for(var i=0x0;i<functions['length'];i++){var func=functions[i],item={'value':func['Function'],'text':func['Function']};displayFunctions['push'](item);}return displayFunctions;}}return null;}},'DefaultChartOptions':{'LabelsVisible':![],'LegendVisible':![],'Height':0x12c,'APIFunction':'DashboardMetric/PieChartDefault'},'SaveChartOptions':function(sTileID,bReset){var chartOptions=null;if(bReset)chartOptions=ctrlDashboard['ChartOptionsModal']['DefaultChartOptions'];else{var sFormFieldPrefix='dashboard-tile-chart-options-',sLegendVisibleID=sFormFieldPrefix+'legend-visible',sLegendPositionID=sFormFieldPrefix+'legend-position',sLabelsVisibleID=sFormFieldPrefix+'labels-visible',sLabelsPositionID=sFormFieldPrefix+'labels-position',sHeightID=sFormFieldPrefix+'height',sSQLID=sFormFieldPrefix+'sql',sAPIFunctionID=sFormFieldPrefix+'api-function';chartOptions={'LabelsVisible':TriSysSDK['CShowForm']['GetCheckBoxValue'](sLabelsVisibleID),'LabelsPosition':TriSysSDK['CShowForm']['GetValueFromCombo'](sLabelsPositionID),'LegendVisible':TriSysSDK['CShowForm']['GetCheckBoxValue'](sLegendVisibleID),'LegendPosition':TriSysSDK['CShowForm']['GetValueFromCombo'](sLegendPositionID),'Height':TriSysSDK['Controls']['NumericSpinner']['GetValue'](sHeightID),'APIFunction':TriSysSDK['CShowForm']['GetValueFromCombo'](sAPIFunctionID)};}var persistedSetting={'Setting':ctrlDashboard['ChartOptionsModal']['Setting'],'Value':chartOptions};ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,persistedSetting);var persistedSettings=[persistedSetting];return ctrlDashboard['ChartOptionsModal']['SetChartOptions'](sTileID,persistedSettings),!![];},'SetChartOptions':function(sTileID,persistedSettings){ctrlDashboard['CallTileLoadedCallback'](sTileID,persistedSettings);}},'WebPageOptionsModal':{'Setting':'WebPageOptions','TileID':null,'Show':function(sTileID){ctrlDashboard['WebPageOptionsModal']['TileID']=sTileID;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20Tile\x20Web\x20Page\x20Options',parametersObject['Image']='gi-globe',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlWebPageOptions.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['WebPageOptionsModal']['SaveWebPageOptions'](sTileID);return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreText']='Reset',parametersObject['ButtonCentreFunction']=function(){var bReset=!![],bSaved=ctrlDashboard['WebPageOptionsModal']['SaveWebPageOptions'](sTileID,bReset);return bSaved;},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Load':function(){var sTileID=ctrlDashboard['WebPageOptionsModal']['TileID'],tile=ctrlDashboard['GetTileByID'](sTileID);if(!tile)return;if(!tile['PersistedSettings']){var persistedSetting={'Setting':ctrlDashboard['WebPageOptionsModal']['Setting'],'Value':ctrlDashboard['WebPageOptionsModal']['DefaultWebPageOptions']};tile['PersistedSettings']=[persistedSetting];}if(tile['PersistedSettings']){var persistedSettings=tile['PersistedSettings'],WebPageOptions=ctrlDashboard['Persistence']['GetSettingValue'](persistedSettings,ctrlDashboard['WebPageOptionsModal']['Setting'],null),sFormFieldPrefix='dashboard-tile-webpage-options-',sHeightID=sFormFieldPrefix+'height',sURLID=sFormFieldPrefix+'url',fieldDescription={'MinValue':0x32,'MaxValue':0x2710,'SpinIncrement':0xa};TriSysSDK['Controls']['NumericSpinner']['Initialise'](sHeightID,fieldDescription),TriSysSDK['Controls']['NumericSpinner']['DecimalPlaces'](sHeightID,0x0);if(WebPageOptions['Height']>0x0)TriSysSDK['Controls']['NumericSpinner']['SetValue'](sHeightID,WebPageOptions['Height']);$('#'+sURLID)['val'](WebPageOptions['URL']);}},'DefaultWebPageOptions':{'Height':0x12c,'URL':null},'SaveWebPageOptions':function(sTileID,bReset){var WebPageOptions=null;if(bReset)WebPageOptions=ctrlDashboard['WebPageOptionsModal']['DefaultWebPageOptions'];else{var sFormFieldPrefix='dashboard-tile-webpage-options-',sHeightID=sFormFieldPrefix+'height',sURLID=sFormFieldPrefix+'url';WebPageOptions={'Height':TriSysSDK['Controls']['NumericSpinner']['GetValue'](sHeightID),'URL':$('#'+sURLID)['val']()};}var persistedSetting={'Setting':ctrlDashboard['WebPageOptionsModal']['Setting'],'Value':WebPageOptions};ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,persistedSetting);var persistedSettings=[persistedSetting];return ctrlDashboard['WebPageOptionsModal']['SetWebPageOptions'](sTileID,persistedSettings),!![];},'SetWebPageOptions':function(sTileID,persistedSettings){ctrlDashboard['CallTileLoadedCallback'](sTileID,persistedSettings);}},'CallTileLoadedCallback':function(sTileID,persistedSettings){var tile=ctrlDashboard['GetTileByID'](sTileID);if(!tile)return;if(!persistedSettings)persistedSettings=tile['PersistedSettings'];var sLoadedCallbackFunction=null;try{if(tile['LoadedCallback'])sLoadedCallbackFunction=tile['LoadedCallback'];}catch(e){}if(sLoadedCallbackFunction)try{TriSysApex['DynamicClasses']['CallFunction'](sLoadedCallbackFunction,sTileID,persistedSettings);}catch(e){TriSysApex['Logging']['LogMessage']('Callback\x20Function:\x20'+tile['LoadedCallback']+'.\x20'+TriSysApex['Logging']['CatchVariableToText'](e));}},'ViewManagerModal':{'SelectedViewName':null,'Show':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Dashboard\x20View\x20Manager',parametersObject['Image']='fa-cubes',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlDashboardViewManager.html',parametersObject['ButtonLeftText']='Apply\x20View',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['ViewManagerModal']['Apply']();return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreText']='Manage',parametersObject['ButtonCentreFunction']=function(){var bReset=ctrlDashboard['ViewManagerModal']['Manage']();return bReset;},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Load':function(){ctrlDashboard['ViewManagerModal']['PopulateListOfViews'](),$('#dashboard-view-manager-caption')['on']('change\x20keyup\x20paste\x20click',ctrlDashboard['ViewManagerModal']['CaptionChangeEvent']),$('#dashboard-view-manager-description')['on']('change\x20keyup\x20paste\x20click',ctrlDashboard['ViewManagerModal']['DescriptionChangeEvent']),$('#dashboard-view-manager-default')['on']('click',ctrlDashboard['ViewManagerModal']['DefaultClick']),$('#dashboard-view-manager-visible')['on']('click',ctrlDashboard['ViewManagerModal']['VisibleClickEvent']),$('#dashboard-view-manager-icon')['on']('click',ctrlDashboard['ViewManagerModal']['IconClickEvent']),$('#dashboard-view-manager-move-up')['on']('click',function(){var bUp=!![];ctrlDashboard['ViewManagerModal']['Move'](bUp);}),$('#dashboard-view-manager-move-down')['on']('click',function(){var bUp=![];ctrlDashboard['ViewManagerModal']['Move'](bUp);}),$('#dashboard-view-manager-copy')['on']('click',ctrlDashboard['ViewManagerModal']['CopyView']),$('#dashboard-view-manager-delete')['on']('click',ctrlDashboard['ViewManagerModal']['DeleteView']);},'PopulateListOfViews':function(sSelectedViewName){var sItemPrefix='dashboard-view-manager-list-item-',sItemTemplate=sItemPrefix+'template',sRowTemplateHTML=document['getElementById'](sItemTemplate)['outerHTML'],sUL='dashboard-view-manager-list';$('#'+sUL)['find']('li')['each'](function(){var sID=this['id'];if(sID!=sItemTemplate)$(this)['remove']();});for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i];dashboardView['Ordering']=i+0x1;var sRowItemHTML=sRowTemplateHTML,sItemID=sItemPrefix+dashboardView['Name'];sRowItemHTML=sRowItemHTML['replace'](sItemTemplate,sItemID),sRowItemHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowItemHTML);var sOnClick='ctrlDashboard.ViewManagerModal.SelectView(\x27'+dashboardView['Name']+'\x27)';sRowItemHTML=sRowItemHTML['replace']('##view-click-event##',sOnClick);var sIcon=dashboardView['Icon']['substring'](0x0,0x2)+'\x20'+dashboardView['Icon'];sRowItemHTML=sRowItemHTML['replace']('##view-icon##',sIcon),sRowItemHTML=sRowItemHTML['replace']('##view-name##',dashboardView['Name']),sRowItemHTML=sRowItemHTML['replace']('##view-caption##',dashboardView['Caption']),$('#'+sUL)['append'](sRowItemHTML);if(!sSelectedViewName){if(i==0x0)sSelectedViewName=dashboardView['Name'];}if(sSelectedViewName==dashboardView['Name'])ctrlDashboard['ViewManagerModal']['SelectView'](dashboardView['Name']);}},'SelectView':function(sViewName){var sUL='dashboard-view-manager-list';$('#'+sUL)['find']('li')['each'](function(){$(this)['removeClass']('active');});var sItemPrefix='dashboard-view-manager-list-item-',sItemID=sItemPrefix+sViewName;$('#'+sItemID)['addClass']('active');var sDefaultViewName=ctrlDashboard['ViewConfiguration']['Default'],dashboardView=ctrlDashboard['ViewManagerModal']['GetView'](sViewName);if(dashboardView){$('#dashboard-view-manager-name')['val'](dashboardView['Name']),$('#dashboard-view-manager-caption')['val'](dashboardView['Caption']),$('#dashboard-view-manager-description')['val'](dashboardView['Description']);var sClass=dashboardView['Icon'];sClass&&(sClass=sClass['substring'](0x0,0x2)+'\x20'+sClass,ctrlDashboard['ViewManagerModal']['ShowIcon'](sClass));var sCheckBoxID='dashboard-view-manager-default',bDefault=dashboardView['Name']==sDefaultViewName;TriSysSDK['CShowForm']['SetCheckBoxValue'](sCheckBoxID,bDefault);if(bDefault)$('#'+sCheckBoxID)['attr']('disabled',!![]);else $('#'+sCheckBoxID)['removeAttr']('disabled');$('#dashboard-view-manager-selected-view-name')['html']('View:\x20'+dashboardView['Name']);var sExtra=JSON['stringify'](dashboardView['Layout']);$('#dashboard-view-manager-extra')['val'](sExtra);var sVisibleID='dashboard-view-manager-visible';TriSysSDK['CShowForm']['SetCheckBoxValue'](sVisibleID,dashboardView['Visible']);}ctrlDashboard['ViewManagerModal']['SelectedViewName']=sViewName;},'DefaultClick':function(){var sCheckBoxID='dashboard-view-manager-default',bDefault=TriSysSDK['CShowForm']['GetCheckBoxValue'](sCheckBoxID);ctrlDashboard['ViewConfiguration']['Default']=ctrlDashboard['ViewManagerModal']['SelectedViewName'];},'GetCurrentView':function(){return ctrlDashboard['ViewManagerModal']['GetView'](ctrlDashboard['ViewManagerModal']['SelectedViewName']);},'GetView':function(sName){for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i];if(dashboardView['Name']==sName)return dashboardView;}},'GetViewByCaption':function(sCaption){for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i];if(dashboardView['Caption']==sCaption)return dashboardView;}},'CaptionChangeEvent':function(){var dashboardView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();dashboardView['Caption']=$('#dashboard-view-manager-caption')['val']();},'DescriptionChangeEvent':function(){var dashboardView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();dashboardView['Description']=$('#dashboard-view-manager-description')['val']();},'VisibleClickEvent':function(){var dashboardView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();dashboardView['Visible']=TriSysSDK['CShowForm']['GetCheckBoxValue']('dashboard-view-manager-visible');},'IconClickEvent':function(){var fnPicked=function(sIcon){var dashboardView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();dashboardView['Icon']=sIcon['substring'](0x3),ctrlDashboard['ViewManagerModal']['ShowIcon'](sIcon);};TriSysApex['ModalDialogue']['IconPicker']['Show'](fnPicked);},'ShowIcon':function(sIcon){var elem=$('#dashboard-view-manager-icon'),sClass=sIcon+'\x20fa-2x';elem['removeClass']()['addClass'](sClass),elem['css']('color',TriSysProUI['BackColour']());},'Move':function(bUp){var iViewCount=ctrlDashboard['ViewConfiguration']['Views']['length'],selectedView=ctrlDashboard['ViewManagerModal']['GetCurrentView'](),bDown=!bUp;if(bUp&&selectedView['Ordering']==0x1)return;if(bDown&&selectedView['Ordering']==iViewCount)return;selectedView['Ordering']=bUp?selectedView['Ordering']-0x1:selectedView['Ordering']+0x1;var newList=[];for(var i=0x1;i<=ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i-0x1];if(i==selectedView['Ordering'])bUp?(newList['push'](selectedView),dashboardView['Ordering']+=0x1,newList['push'](dashboardView)):(dashboardView['Ordering']-=0x1,newList['push'](dashboardView),newList['push'](selectedView));else{if(dashboardView['Name']!=selectedView['Name'])newList['push'](dashboardView);}}ctrlDashboard['ViewConfiguration']['Views']=newList,ctrlDashboard['ViewManagerModal']['PopulateListOfViews'](ctrlDashboard['ViewManagerModal']['SelectedViewName']);},'CopyView':function(){var selectedView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();if(!selectedView)return;ctrlDashboard['CopyViewModal']['Show']();},'DeleteView':function(){var selectedView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();if(!selectedView)return;if(ctrlDashboard['ViewConfiguration']['Views']['length']<=0x1){TriSysApex['UI']['ShowMessage']('You\x20are\x20not\x20permitted\x20to\x20delete\x20all\x20views.');return;}var bDeletedDefault=selectedView['Name']==ctrlDashboard['ViewConfiguration']['Default'];for(var i=0x0;i<ctrlDashboard['ViewConfiguration']['Views']['length'];i++){var dashboardView=ctrlDashboard['ViewConfiguration']['Views'][i];if(dashboardView['Name']==selectedView['Name']){ctrlDashboard['ViewConfiguration']['Views']['splice'](i,0x1);break;}}if(bDeletedDefault){var defaultView=ctrlDashboard['ViewConfiguration']['Views'][0x0];ctrlDashboard['ViewConfiguration']['Default']=defaultView['Name'];}ctrlDashboard['ViewManagerModal']['PopulateListOfViews'](ctrlDashboard['ViewConfiguration']['Default']);},'Apply':function(){return ctrlDashboard['PopulateDynamicViewMenuItems'](),ctrlDashboard['ViewManagerModal']['ApplyChangesAsynchronouslyAndSilentlyToServer'](),!![];},'Reset':function(){return ctrlDashboard['ViewConfiguration']=ctrlDashboard['ReadViewConfigurationFromJSONFiles'](),ctrlDashboard['ViewManagerModal']['PopulateListOfViews'](ctrlDashboard['ViewConfiguration']['Default']),![];},'Manage':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Manage\x20Dashboards',parametersObject['Image']='gi-more_windows',parametersObject['FullScreen']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlManageCollections.html',parametersObject['ButtonLeftText']='Select\x20New\x20Default',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlManageCollections['SelectCurrent']();};var bInDev=TriSysApex['Pages']['Controller']['isDeveloper']();if(bInDev){}return parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject),![];},'ApplyChangesAsynchronouslyAndSilentlyToServer':function(){var viewConfigurationCopy=JSON['parse'](JSON['stringify'](ctrlDashboard['ViewConfiguration'])),views=viewConfigurationCopy['Views'];for(var iView=0x0;iView<views['length'];iView++){var view=views[iView],sLayout=JSON['stringify'](view['Layout']);view['Layout']=sLayout;}var CDashboardWriteRequest={'ViewConfiguration':viewConfigurationCopy},payloadObject={};payloadObject['URL']='Dashboard/Write',payloadObject['OutboundDataPacket']=CDashboardWriteRequest,payloadObject['InboundDataFunction']=function(data){var CDashboardWriteResponse=data;if(CDashboardWriteResponse){if(CDashboardWriteResponse['Success']){}else TriSysApex['Logging']['LogMessage'](CDashboardWriteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('ctrlDashboard.ViewManagerModal.ApplyChangesAsynchronouslyAndSilentlyToServer:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'CopyViewModal':{'Show':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Copy\x20Dashboard\x20View',parametersObject['Image']='fa-plus-square-o',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlCopyDashboardView.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlDashboard['CopyViewModal']['Apply']();return bSaved;},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Load':function(){var selectedView=ctrlDashboard['ViewManagerModal']['GetCurrentView']();$('#dashboard-copy-view-name')['val']('Copy-of-'+selectedView['Name']),$('#dashboard-copy-view-caption')['val']('Copy\x20of\x20'+selectedView['Caption']);},'Apply':function(){var sName=$('#dashboard-copy-view-name')['val'](),sCaption=$('#dashboard-copy-view-caption')['val']();if(!sName||!sCaption)return TriSysApex['Toasters']['Error']('Views\x20must\x20have\x20a\x20name\x20and\x20a\x20caption.'),![];sName=sName['replace'](/ /g,''),sName=sName['replace'](/-/g,''),sName=sName['replace'](/"/g,''),sName=sName['replace'](/\'/g,'');var duplicateView=ctrlDashboard['ViewManagerModal']['GetView'](sName);if(duplicateView)return TriSysApex['Toasters']['Error']('Views\x20must\x20have\x20unique\x20names.'),![];duplicateView=ctrlDashboard['ViewManagerModal']['GetViewByCaption'](sCaption);if(duplicateView)return TriSysApex['Toasters']['Error']('Views\x20must\x20have\x20unique\x20menu\x20captions.'),![];var selectedView=ctrlDashboard['ViewManagerModal']['GetCurrentView'](),newView=JSON['parse'](JSON['stringify'](selectedView));newView['Name']=sName,newView['Caption']=sCaption;if(newView['Layout']){var tiles=newView['Layout']['Tiles'];for(var i=0x0;i<tiles['length'];i++){var tile=tiles[i];tile['GUID']=TriSysSDK['Miscellaneous']['GUID']();}}return ctrlDashboard['ViewConfiguration']['Views']['push'](newView),ctrlDashboard['ViewManagerModal']['PopulateListOfViews'](sName),!![];}},'Persistence':{'Layouts':[],'GetLayoutForView':function(view){for(var i=0x0;i<ctrlDashboard['Persistence']['Layouts']['length'];i++){var savedLayout=ctrlDashboard['Persistence']['Layouts'][i];if(savedLayout['View']['Name']==view['Name'])return savedLayout;}return null;},'ReadCurrentViewLayoutIntoMemoryArray':function(){var rows=ctrlDashboard['CurrentView']['Layout']['Rows'];for(var iRow=0x0;iRow<rows['length'];iRow++){var row=rows[iRow];for(var iColumn=0x1;iColumn<=row['Columns'];iColumn++){var sColumnBlockID='dashboard-block-row-'+(iRow+0x1)+'-column-'+iColumn,tileNameAndGUIDArray=ctrlDashboard['GetTileNamesAndGUIDInRowColumnBlock'](sColumnBlockID);if(tileNameAndGUIDArray)for(var i=0x0;i<tileNameAndGUIDArray['length'];i++){var tileItem=tileNameAndGUIDArray[i],sTileName=tileItem['TileName'],sGUID=tileItem['GUID'],liveTile=ctrlDashboard['GetTileByGUID'](sGUID);if(liveTile){liveTile['Location']=sColumnBlockID;break;}}}}},'SaveTileSetting':function(sTileID,persistedSetting){var currentViewLayout=ctrlDashboard['CurrentView']['Layout'],parsedTile=ctrlDashboard['ParseTileID'](sTileID);if(parsedTile){ctrlDashboard['Persistence']['ReadCurrentViewLayoutIntoMemoryArray']();var liveTile=ctrlDashboard['GetTileByGUID'](parsedTile['GUID']);if(liveTile){if(liveTile['PersistedSettings'])for(var iSetting=0x0;iSetting<liveTile['PersistedSettings']['length'];iSetting++){var existingPersistedSetting=liveTile['PersistedSettings'][iSetting];if(existingPersistedSetting['Setting']==persistedSetting['Setting'])liveTile['PersistedSettings']['splice'](iSetting,0x1);}else liveTile['PersistedSettings']=[];liveTile['PersistedSettings']['push'](persistedSetting);}}},'SaveTileSettings':function(sTileID,persistedSettings){persistedSettings&&persistedSettings['forEach'](function(setting){ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,setting);});},'ApplyPersistedTileSettings':function(tile,sTileID){if(tile['PersistedSettings'])for(var iSetting=0x0;iSetting<tile['PersistedSettings']['length'];iSetting++){var persistedSetting=tile['PersistedSettings'][iSetting];switch(persistedSetting['Setting']){case'Caption':ctrlDashboard['SetCaptionModal']['SetTileCaption'](sTileID,persistedSetting['Value']);break;case'Colours':ctrlDashboard['SetColoursModal']['SetTileColours'](sTileID,persistedSetting['Value']);break;case ctrlDashboard['ChartOptionsModal']['Setting']:ctrlDashboard['CallTileLoadedCallback'](sTileID,tile['PersistedSettings']);break;}}},'GetSettingValue':function(persistedSettings,sSetting,sDefault){if(persistedSettings)for(var i=0x0;i<persistedSettings['length'];i++){var persistedSetting=persistedSettings[i];if(persistedSetting['Setting']==sSetting)return persistedSetting['Value'];}return sDefault;}},'PieChartMetric':{'Load':function(sChart,sAPIFunction,sTileID,chartOptions,fnCallbackBeforeChartDisplay){if(!sAPIFunction){$('#'+sChart)['empty'](),$('#'+sChart)['html']('Unspecified\x20API\x20method');return;}var fnPopulationByFunction={'API':sAPIFunction,'DataTableFunction':function(response){if(response['List']){var figures=[],dt=response['List'];for(var i=0x0;i<dt['length'];i++){var dr=dt[i],sMetric=dr['Metric'],iPercentage=dr['Percentage'],figure={'Metric':sMetric,'Percentage':iPercentage};figures['push'](figure);}if(fnCallbackBeforeChartDisplay)fnCallbackBeforeChartDisplay(figures);ctrlDashboard['PieChartMetric']['DrawChart'](sChart,figures,sTileID,chartOptions);}else $('#'+sChart)['empty'](),$('#'+sChart)['html'](response['ErrorMessage']);}};TriSysSDK['Database']['GetDataSetFromFunction'](fnPopulationByFunction);},'DrawChart':function(sChart,figures,sTileID,chartOptions){var colors=[TriSysProUI['NavBarInverseColour'](),TriSysProUI['BackColour'](),TriSysProUI['ThemedSidebarBackgroundLight'](0.25),TriSysProUI['LightenColour'](TriSysProUI['BackColour'](),0.25),TriSysProUI['LightenColour'](TriSysProUI['NavBarInverseColour'](),0.15)],otherColor=TriSysProUI['LightenColour'](TriSysProUI['ThemedSidebarBackgroundLight'](0.25),0.25);!chartOptions&&(chartOptions={'LabelsVisible':![],'LabelsPosition':'center','LegendVisible':!![],'LegendPosition':'bottom'});var seriesData=[],seriesColors=[],iTotalPercentage=0x0;for(var i=0x0;i<figures['length'];i++){var figure=figures[i];iTotalPercentage+=figure['Percentage'],figure['Colour']=colors[i];}var iOther=0x64-iTotalPercentage;if(iOther>=0.1){colors['push'](otherColor);var figureOther={'Metric':'Other','Percentage':iOther,'Colour':colors[0x5]};figures['push'](figureOther);}for(var i=0x0;i<figures['length'];i++){var figure=figures[i];seriesColors['push'](figure['Colour']);var data={'category':figure['Metric'],'value':figure['Percentage']};seriesData['push'](data);}var lHeight=0x1f4;if(chartOptions['Height']>0x0)lHeight=chartOptions['Height'];$('#'+sChart)['empty'](),$('#'+sChart)['kendoChart']({'legend':{'position':chartOptions['LegendPosition'],'labels':{'font':TriSysSDK['KendoUICharts']['Font']},'visible':chartOptions['LegendVisible']},'chartArea':{'height':lHeight},'seriesDefaults':{'labels':{'template':'#=\x20category\x20#\x20-\x20#=\x20kendo.format(\x27{0:P}\x27,\x20percentage)#','position':chartOptions['LabelsPosition'],'visible':chartOptions['LabelsVisible'],'background':'transparent','font':TriSysSDK['KendoUICharts']['Font']}},'seriesColors':seriesColors,'series':[{'type':'pie','data':seriesData}],'tooltip':{'visible':!![],'template':'<span\x20style=\x22color:white;\x22>#=\x20category\x20#\x20-\x20#=\x20kendo.format(\x22{0:P}\x22,\x20percentage)\x20#</span>'}});}}},Consultant12MonthActivity={'GetUserDataFromWebAPI':function(fnCallback,sPrefix,bCurrentYear){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),lUserId=userCredentials['LoggedInUser']['UserId'],CDashboardMetricConsultant12MonthActivityRequest={'UserId':lUserId};if(bCurrentYear){var startDate=moment(new Date())['format']('YYYY')+'/01/01',endDate=moment(new Date())['format']('YYYY')+'/12/31';CDashboardMetricConsultant12MonthActivityRequest['StartDate']=startDate,CDashboardMetricConsultant12MonthActivityRequest['EndDate']=endDate;}var payloadObject={};payloadObject['URL']='DashboardMetric/Consultant12MonthActivity',payloadObject['OutboundDataPacket']=CDashboardMetricConsultant12MonthActivityRequest,payloadObject['InboundDataFunction']=function(CDashboardMetricsConsultant12MonthActivityResponse){TriSysApex['UI']['HideWait']();if(CDashboardMetricsConsultant12MonthActivityResponse){if(CDashboardMetricsConsultant12MonthActivityResponse['Success'])fnCallback(CDashboardMetricsConsultant12MonthActivityResponse,lUserId,sPrefix);else TriSysApex['Logging']['LogMessage'](CDashboardMetricsConsultant12MonthActivityResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('Consultant12MonthActivity.GetUserDataFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Preparing\x20Data...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'RandomActivity':function(){var activities=[];for(var i=0x0;i<0xc;i++){var activity=Consultant12MonthActivity['RandomDataActivity'](i+0x1);activities['push'](activity);}var dt=new Date(),iLastYear=''+(dt['getFullYear']()-0x1),dtDec01LastYear=new Date(iLastYear+'/12/01'),december=Consultant12MonthActivity['RandomDataActivity'](0xc,dtDec01LastYear),CDashboardMetricsConsultant12MonthActivityResponse={'Activity':activities,'LastDecemberActivity':december};return CDashboardMetricsConsultant12MonthActivityResponse;},'RandomDataActivity':function(iMonth,dtStartDate){var activity={};activity['NumTasks']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['NumRequirements']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0xc7),activity['NumPlacements']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x37),activity['CandidateCount']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['ClientSalesCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x5a),activity['ClientServiceCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x3e7),activity['CandidateNetworkCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['CandidateUpdateCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x3e7),activity['CandidateVacancyCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x63),activity['HeadhuntCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['MiscellaneousCalls']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x5a),activity['CVsSent']=TriSysSDK['Miscellaneous']['RandomNumber'](0x64,0x3e7),activity['FaceToFaceInterviews']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['PermPlacementBackOuts']=TriSysSDK['Miscellaneous']['RandomNumber'](0x1,0x9),activity['ContractPlacementBackOuts']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x63),activity['ClientMeetings']=TriSysSDK['Miscellaneous']['RandomNumber'](0x0,0x64),activity['UserActivities']=TriSysSDK['Miscellaneous']['RandomNumber'](0x3e8,0x270f),activity['TargetPermPlacementFees']=iMonth>0x9?0x9c4:0x7d0,activity['TargetContractPlacementMargin']=iMonth>0x8?0x5dc:0x3e8;;activity['TotalPermanentFees']=TriSysSDK['Miscellaneous']['RandomNumber'](0x3e8,0x3e8*iMonth),activity['TotalContractMargin']=TriSysSDK['Miscellaneous']['RandomNumber'](0x3e8,0x3e8*iMonth),activity['TotalProfit']=activity['TotalPermanentFees']+activity['TotalContractMargin'],activity['NumberOfPlacements']=TriSysSDK['Miscellaneous']['RandomNumber'](0x1,0x31),activity['AveragePlacementValue']=TriSysSDK['Miscellaneous']['RandomNumber'](0x64,0x270f),activity['TimeToPlacementPerm']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x63),activity['TimeToPlacementContract']=TriSysSDK['Miscellaneous']['RandomNumber'](0xa,0x63),activity['TimeToPlacementTemp']=TriSysSDK['Miscellaneous']['RandomNumber'](0x1,0x63);if(!dtStartDate)dtStartDate=new Date();return activity['StartDate']=dtStartDate,activity['StartDate']=new Date(moment(activity['StartDate'])['format']('YYYY')+'/'+iMonth+'/01'),activity;}};