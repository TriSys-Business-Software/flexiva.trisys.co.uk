var FileManager={'FolderTreeID':'fileManager-Folders','GridID':'fileManager-Files','RootPathForTreeView':'TriSys:\x5c','PersistedPathCookie':'FileManager-PersistedPath','Load':function(){var iFudgeFactor=0xb4,lHeight=$(window)['height']()-iFudgeFactor;$('#fileManager-Splitter-vertical')['height'](lHeight)['css']('border-radius','8px'),iFudgeFactor=0x6e,lHeight=lHeight-iFudgeFactor,$('#fileManager-Folders-Container')['height'](lHeight),$('#folder-pane')['height'](lHeight),FileManager['CalculateFilesPerPage'](lHeight),$('#fileManager-Splitter-vertical')['kendoSplitter']({'orientation':'vertical','panes':[{'collapsible':![]}]}),$('#fileManager-Splitter-horizontal')['kendoSplitter']({'panes':[{'collapsible':![],'size':'350px'},{'collapsible':![]}]}),FileManager['LoadFolders'](),TriSysSDK['FormMenus']['DrawGridMenu']('FileManagerGridMenu',FileManager['GridID']);},'LoadFolders':function(){FileManager['_FolderPopulatedCallbacks']['push'](FileManager['AfterInitialTreePopulation']),FileManager['TriSysWebAPIPopulation'](FileManager['FolderTreeID']);},'AfterInitialTreePopulation':function(sFolder){var sPersistedPath=TriSysAPI['Cookies']['getCookie'](FileManager['PersistedPathCookie']);if(!sPersistedPath)return;var sDisplayRelativePath=FileManager['RelativePathFromUNCPath'](sPersistedPath),sRootPath=FileManager['RootPathFromUNCPath'](sPersistedPath),parts=sDisplayRelativePath['split']('\x5c');FileManager['_InitialTreePopulationPathParts']=[];var sFullFolderPath='';parts['forEach'](function(sFolderPart){if(sFullFolderPath['length']==0x0)sFullFolderPath=sRootPath;else sFullFolderPath+='\x5c';sFullFolderPath+=sFolderPart,FileManager['_InitialTreePopulationPathParts']['push'](sFullFolderPath);});if(FileManager['_InitialTreePopulationPathParts']['length']>0x0){var sFirstFolder=FileManager['_InitialTreePopulationPathParts'][0x0],fnAfterPopulation=function(sThisFolder,bFirstFolder){var sFolderRelativePath=FileManager['RelativePathFromUNCPath'](sThisFolder),iNumberOfFolders=sFolderRelativePath['split']('\x5c')['length'];if(iNumberOfFolders==FileManager['_InitialTreePopulationPathParts']['length']){if(bFirstFolder)FileManager['SelectTreeNodeWithFolderPath'](sThisFolder,!![]);else FileManager['FolderSelected'](sThisFolder);}else{if(!bFirstFolder)sThisFolder=FileManager['_InitialTreePopulationPathParts'][iNumberOfFolders];setTimeout(function(){FileManager['_FolderPopulatedCallbacks']['push'](fnAfterPopulation),FileManager['SelectTreeNodeWithFolderPath'](sThisFolder,!![]);},0xa);}};setTimeout(function(){fnAfterPopulation(sFirstFolder,!![]);},0xa);}},'_InitialTreePopulationPathParts':[],'TriSysWebAPIPopulation':function(sTreeID){var homogeneous=new kendo['data']['HierarchicalDataSource']({'transport':{'read':function(options){var sFolder=options['data']['FullPath'];if(!sFolder){var gDriveFolders=[{'Name':FileManager['RootPathForTreeView'],'FullPath':FileManager['RootPathForTreeView'],'SubFolders':['to\x20be\x20dynamically\x20loaded'],'spriteCssClass':'rootfolder'}];options['success'](gDriveFolders);var fnForceExpansion=function(){var treeView=$('#'+sTreeID)['data']('kendoTreeView');treeView['select']('.k-first'),treeView['expand']('.k-item');};setTimeout(fnForceExpansion,0x64);return;}else{if(sFolder==FileManager['RootPathForTreeView'])sFolder=null;}var bRecursive=!![],dataPacket={'RootFolder':sFolder,'Recursion':bRecursive,'RecursionDepth':0x1},payloadObject={};payloadObject['URL']='Folders/SubFolders',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(CFolders){if(CFolders){if(CFolders['Success']){var sGDrive=CFolders['RootDriveLetter'];if(sGDrive)FileManager['SetRootText'](sGDrive);CFolders['Folders']&&CFolders['Folders']['forEach'](function(folder){folder['spriteCssClass']='folder';}),options['success'](CFolders['Folders']),FileManager['FolderPopulated'](sFolder);}}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){options['error'](status);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'schema':{'model':{'id':'FullPath','hasChildren':function(folder){var bFolders=folder['SubFolders'];return bFolders;}}}}),fnSelectFolderFromDataItem=function(dataItem){var sFullPath=dataItem['FullPath'],sDisplayPath=sFullPath==FileManager['RootPathForTreeView']?'':sFullPath;FileManager['FolderSelected'](sDisplayPath);},fnSelectFolder=function(e){var dataItem=this['dataItem'](e['node']);if(!dataItem)return;fnSelectFolderFromDataItem(dataItem);},fnExpandFolder=function(e){var expandedNode=e['node'];this['select'](expandedNode);var dataItem=this['dataItem'](expandedNode);if(!dataItem)return;fnSelectFolderFromDataItem(dataItem);};$('#'+sTreeID)['kendoTreeView']({'loadOnDemand':!![],'dataSource':homogeneous,'dataTextField':'Name','select':fnSelectFolder,'expand':fnExpandFolder});},'RootPathFromUNCPath':function(sUNCPath){var parts=sUNCPath['split']('\x5c'),sRootPath='\x5c\x5c'+parts[0x2]+'\x5c'+parts[0x3]+'\x5c';return sRootPath;},'RelativePathFromUNCPath':function(sUNCPath){var parts=sUNCPath['split']('\x5c'),sDisplayRelativePath='';for(var i=0x4;i<parts['length'];i++){if(sDisplayRelativePath['length']>0x0)sDisplayRelativePath+='\x5c';sDisplayRelativePath+=parts[i];}return sDisplayRelativePath;},'FolderSelected':function(sDisplayPath){var sDisplayRelativePath=FileManager['RelativePathFromUNCPath'](sDisplayPath);$('#fileManager-Path')['text'](sDisplayRelativePath);if(sDisplayPath)TriSysAPI['Cookies']['setCookie'](FileManager['PersistedPathCookie'],sDisplayPath);FileManager['RefreshFiles']();},'FolderPopulated':function(sFolder){FileManager['_FolderPopulatedCallbacks']['forEach'](function(fnCallback){fnCallback(sFolder);}),FileManager['_FolderPopulatedCallbacks']=[];},'_FolderPopulatedCallbacks':[],'GetRootText':function(){var treeView=$('#'+FileManager['FolderTreeID'])['data']('kendoTreeView'),sText=treeView['text']('.k-item:first');return sText;},'SetRootText':function(sText){$('#fileManager-Root')['text'](sText);var treeView=$('#'+FileManager['FolderTreeID'])['data']('kendoTreeView');treeView['text']('.k-item:first',sText);},'CurrentFolder':function(){var sFullPath=$('#fileManager-Path')['text']();return sFullPath;},'GetCurrentFullPath':function(){var sDrive=$('#fileManager-Root')['text'](),sThisFolder=FileManager['CurrentFolder']();return sDrive+sThisFolder;},'RefreshCurrentFolder':function(bParent){var sThisFolder=FileManager['CurrentFolder']();try{var treeView=$('#'+FileManager['FolderTreeID'])['data']('kendoTreeView'),selectedNode=treeView['select'](),nodeItem=null;bParent&&(selectedNode['length']>0x0&&(nodeItem=selectedNode[0x0],selectedNode=nodeItem['parentNode']));var selectedDataItem=treeView['dataItem'](selectedNode);treeView['collapse'](selectedNode),selectedDataItem['loaded'](![]),selectedDataItem['load'](),setTimeout(function(){treeView['expand'](selectedNode);},0x1f4);}catch(ex){}},'AddFolder':function(){var sThisFolder=FileManager['CurrentFolder'](),fnAddFolder=function(bYes,sReasonIfNo){var sMessage=null;if(!bYes)sMessage='You\x20are\x20unable\x20to\x20add\x20a\x20folder\x20to\x20'+sThisFolder+'\x20because\x20'+sReasonIfNo,TriSysApex['UI']['ShowMessage'](sMessage,'Add\x20Folder');else{var fnAddNewFolder=function(sNewName){return setTimeout(function(){FileManager['AddFolderConfirmation'](sThisFolder,sNewName);},0x32),!![];};sMessage='Add\x20Folder';var options={'Label':'New\x20Folder\x20Name','Value':'','Instructions':'Parent\x20Folder:\x20'+sThisFolder};TriSysApex['ModalDialogue']['New']['Popup'](sMessage,'gi-plus',fnAddNewFolder,options);}};FileManager['DetermineIfFolderCanBeAdded'](sThisFolder,fnAddFolder);},'AddFolderConfirmation':function(sFolder,sNewName){if(!sNewName){TriSysApex['UI']['ShowMessage']('Please\x20provide\x20a\x20new\x20name\x20for\x20this\x20folder.');return;}var fnConfirm=function(){var fnAddFolderCallback=function(bSuccess,sError){if(bSuccess){var treeView=$('#'+FileManager['FolderTreeID'])['data']('kendoTreeView'),selectedNode=treeView['select'](),selectedDataItem=treeView['dataItem'](selectedNode);selectedDataItem['hasChildren']=!![],FileManager['RefreshCurrentFolder'](![]);}else TriSysApex['UI']['errorAlert'](sError,'Add\x20Folder\x20Error:\x20'+sError);};return setTimeout(function(){FileManager['AddFolderViaWebAPI'](sFolder,sNewName,![],fnAddFolderCallback);},0x32),!![];},sDisplayFolder=FileManager['GetCurrentFullPath']()+'\x5c'+sNewName,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20add\x20the\x20following\x20folder?\x20<br\x20/>'+sDisplayFolder;TriSysApex['UI']['questionYesNo'](sMessage,'Add\x20Folder','Yes',fnConfirm,'No');},'RenameFolder':function(){var sThisFolder=FileManager['CurrentFolder'](),sMessage=null;if(sThisFolder['length']==0x0){sMessage='You\x20cannot\x20rename\x20the\x20root\x20folder.',TriSysApex['UI']['ShowMessage'](sMessage,'Rename\x20Folder');return;}var fnRenameFolder=function(bYes,sReasonIfNo){if(!bYes)sMessage='You\x20are\x20unable\x20to\x20rename\x20'+sThisFolder+'\x20because\x20'+sReasonIfNo,TriSysApex['UI']['ShowMessage'](sMessage,'Rename\x20Folder');else{var fnRenameThisFolder=function(sNewName){return setTimeout(function(){FileManager['RenameFolderConfirmation'](sThisFolder,sNewName);},0x32),!![];};sMessage='Rename\x20Folder';var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sThisFolder),options={'Label':'New\x20Folder\x20Name','Value':sName,'Instructions':'Rename:\x20'+sThisFolder};TriSysApex['ModalDialogue']['New']['Popup'](sMessage,'gi-font',fnRenameThisFolder,options);}};FileManager['DetermineIfFolderCanBeRenamed'](sThisFolder,fnRenameFolder);},'RenameFolderConfirmation':function(sFolder,sNewName){if(!sNewName){TriSysApex['UI']['ShowMessage']('Please\x20provide\x20a\x20new\x20name\x20for\x20this\x20folder.');return;}var fnConfirm=function(){var fnRenameFolderCallback=function(bSuccess,sError){if(bSuccess)FileManager['RefreshCurrentFolder'](!![]);else TriSysApex['UI']['errorAlert'](sError,'Rename\x20Folder\x20Error:\x20'+sError);};return setTimeout(function(){FileManager['RenameFolderViaWebAPI'](sFolder,sNewName,![],fnRenameFolderCallback);},0x32),!![];},sDisplayFolder=FileManager['GetRootText']()+sFolder,sFullPath=TriSysSDK['Controls']['FileManager']['GetFolderPathFromFile'](sDisplayFolder,'\x5c')+sNewName,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20rename\x20the\x20following?\x20<br\x20/>'+sDisplayFolder+'<br\x20/>to<br\x20/>'+sFullPath;TriSysApex['UI']['questionYesNo'](sMessage,'Rename\x20Folder','Yes',fnConfirm,'No');},'DeleteFolder':function(){var sThisFolder=FileManager['CurrentFolder'](),fnDeleteFolder=function(bYes,sReasonIfNo){if(!bYes){var sMessage='You\x20are\x20unable\x20to\x20delete\x20'+sThisFolder+'\x20because\x20'+sReasonIfNo;TriSysApex['UI']['ShowMessage'](sMessage,'Delete\x20Folder');}else return setTimeout(function(){FileManager['DeleteFolderConfirmation'](sThisFolder);},0x32),!![];};FileManager['DetermineIfFolderCanBeDeleted'](sThisFolder,fnDeleteFolder);},'SelectTreeNodeWithFolderPath':function(sFolderPath,bExpand){var treeView=$('#'+FileManager['FolderTreeID'])['data']('kendoTreeView'),dataitem=treeView['dataSource']['get'](sFolderPath);if(dataitem){var node=treeView['findByUid'](dataitem['uid']);if(node){treeView['select'](node),FileManager['FolderSelected'](sFolderPath);if(bExpand){var selectedNode=treeView['select']();treeView['expand'](selectedNode);}return!![];}}return![];},'DeleteFolderConfirmation':function(sFolder){if(!sFolder)return;var fnConfirm=function(){var fnDeleteFolderCallback=function(bSuccess,sError){if(bSuccess){var sParentFolderPath=TriSysSDK['Controls']['FileManager']['GetFolderPathFromFile'](sFolder,'\x5c');if(sParentFolderPath){if(sParentFolderPath['lastIndexOf']('\x5c')==sParentFolderPath['length']-0x1)sParentFolderPath=sParentFolderPath['substring'](0x0,sParentFolderPath['length']-0x1);var fnFocusOnParentNode=function(sFolderPath){FileManager['SelectTreeNodeWithFolderPath'](sParentFolderPath);};FileManager['_FolderPopulatedCallbacks']['push'](fnFocusOnParentNode);}FileManager['RefreshCurrentFolder'](!![]);}else TriSysApex['UI']['errorAlert'](sError,'Delete\x20Folder\x20Error:\x20'+sError);};return setTimeout(function(){FileManager['DeleteFolderViaWebAPI'](sFolder,![],fnDeleteFolderCallback);},0x32),!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20following\x20folder?\x20<br\x20/>'+FileManager['GetCurrentFullPath']()+'<br\x20/><br\x20/>WARNING:\x20All\x20folders\x20and\x20files\x20beneath\x20this\x20folder\x20will\x20also\x20be\x20deleted\x20and\x20can\x20not\x20be\x20retrieved.';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Folder','Yes',fnConfirm,'No');},'RefreshFiles':function(){var sFullPath=FileManager['CurrentFolder']();TriSysApex['Pages']['FileManagerForm']['startFolderFilesPopulation'](sFullPath,FileManager['GridID']),setTimeout(function(){FileManager['DragAndDropFileHandler']();},0x3e8);},'EditFile':function(){var lst=FileManager['SelectedFilePaths']();if(lst['length']==0x0||lst['length']>0x1){TriSysApex['UI']['ShowMessage']('Please\x20select\x20only\x20one\x20file\x20to\x20edit\x20at\x20a\x20time.');return;}var sFilePath=lst[0x0];TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](FileManager['GetRootText']()+sFilePath);},'CopyFile':function(){var lst=FileManager['SelectedFilePaths']();if(lst['length']==0x0||lst['length']>0x1){TriSysApex['UI']['ShowMessage']('Please\x20select\x20only\x20one\x20file\x20to\x20copy.');return;}var sFilePath=lst[0x0],fnCopyFile=function(bYes,sReasonIfNo){var sMessage=null;if(!bYes)sMessage='You\x20are\x20unable\x20to\x20copy\x20'+sFilePath+'\x20because\x20'+sReasonIfNo,TriSysApex['UI']['ShowMessage'](sMessage,'Copy\x20File');else{sMessage='Copy\x20File';var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath),sSuffix='.'+TriSysApex['Pages']['FileManagerForm']['FileSuffix'](sName);sName=sName['replace'](sSuffix,'');var fnCopyThisFile=function(sNewName){return sNewName&&(sNewName=sNewName['replace'](sSuffix,'')+sSuffix,setTimeout(function(){FileManager['CopyFileConfirmation'](sFilePath,sNewName);},0x32)),!![];},options={'Label':'Copy\x20File','Value':sName,'Instructions':'Copy:\x20'+sFilePath};TriSysApex['ModalDialogue']['New']['Popup'](sMessage,'gi-font',fnCopyThisFile,options);}};FileManager['DetermineIfFileCanBeCopied'](sFilePath,fnCopyFile);},'AddFile':function(){TriSysSDK['Controls']['FileManager']['FindFileUpload']('Add\x20File',FileManager['UploadFile']);},'UploadFile':function(sFilePath){return setTimeout(function(){var sCopyToFolder=FileManager['CurrentFolder'](),fnUploadAfterConfirmation=function(){FileManager['MoveUploadedFileReferenceDocument'](sFilePath,sCopyToFolder);};FileManager['OverwriteMultipleFileCheck']([sFilePath],sCopyToFolder,fnUploadAfterConfirmation);},0x32),!![];},'RenameFile':function(){var lst=FileManager['SelectedFilePaths']();if(lst['length']==0x0||lst['length']>0x1){TriSysApex['UI']['ShowMessage']('Please\x20select\x20only\x20one\x20file\x20to\x20rename.');return;}var sFilePath=lst[0x0],fnRenameFile=function(bYes,sReasonIfNo){var sMessage=null;if(!bYes)sMessage='You\x20are\x20unable\x20to\x20rename\x20'+sFilePath+'\x20because\x20'+sReasonIfNo,TriSysApex['UI']['ShowMessage'](sMessage,'Rename\x20File');else{sMessage='Rename\x20File';var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath),sSuffix='.'+TriSysApex['Pages']['FileManagerForm']['FileSuffix'](sName);sName=sName['replace'](sSuffix,'');var fnRenameThisFile=function(sNewName){return sNewName&&(sNewName=sNewName['replace'](sSuffix,'')+sSuffix,setTimeout(function(){FileManager['RenameFileConfirmation'](sFilePath,sNewName);},0x32)),!![];},options={'Label':'New\x20File\x20Name','Value':sName,'Instructions':'Rename:\x20'+sFilePath};TriSysApex['ModalDialogue']['New']['Popup'](sMessage,'gi-font',fnRenameThisFile,options);}};FileManager['DetermineIfFileCanBeRenamed'](sFilePath,fnRenameFile);},'DeleteFile':function(){var lst=FileManager['SelectedFilePaths']();if(lst['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20files\x20to\x20delete.');return;}var sFiles='';lst['forEach'](function(sFilePath){if(sFiles['length']>0x1)sFiles+=',\x20';sFiles+=sFilePath;});var fnDeleteFiles=function(bYes,sReasonIfNo){if(!bYes){var sMessage='You\x20are\x20unable\x20to\x20delete\x20'+sFiles+'\x20because\x20'+sReasonIfNo;TriSysApex['UI']['ShowMessage'](sMessage,'Delete\x20File(s)');}else return setTimeout(function(){FileManager['DeleteFilesConfirmation'](lst,sFiles);},0x32),!![];};FileManager['DetermineIfFilesCanBeDeleted'](lst,fnDeleteFiles);},'SelectedFilePaths':function(){var sGridID='fileManager-Files',lst=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGridID,'FullPath');if(!lst)lst=[];return lst;},'CalculateFilesPerPage':function(iGridBlockHeight){var iLineHeight=0x26;FileManager['_FilesPerPage']=iGridBlockHeight/ iLineHeight;},'FilesPerPage':function(){return FileManager['_FilesPerPage'];},'_FilesPerPage':0xa,'DetermineIfFolderCanBeRenamed':function(sFolderPath,fnRenameFolderCallback){var bDeterminationOnly=!![];FileManager['RenameFolderViaWebAPI'](sFolderPath,null,bDeterminationOnly,fnRenameFolderCallback);},'RenameFolderViaWebAPI':function(sFolderPath,sNewName,bDeterminationOnly,fnRenameFolderCallback){var CRenameFolderRequest={'FullPath':sFolderPath,'NewName':sNewName,'DeterminationOnly':bDeterminationOnly},payloadObject={};payloadObject['URL']='Folders/RenameFolder',payloadObject['OutboundDataPacket']=CRenameFolderRequest,payloadObject['InboundDataFunction']=function(CRenameFolderResponse){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();if(CRenameFolderResponse)fnRenameFolderCallback(CRenameFolderResponse['Success'],CRenameFolderResponse['ErrorMessage']);else TriSysApex['UI']['errorAlert']('FileManagerForm.RenameFolderViaWebAPI:\x20no\x20response.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('FileManagerForm.RenameFolderViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(!bDeterminationOnly)TriSysApex['UI']['ShowWait'](null,'Renaming\x20Folder...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DetermineIfFolderCanBeDeleted':function(sFolderPath,fnDeleteFolderCallback){var bDeterminationOnly=!![];FileManager['DeleteFolderViaWebAPI'](sFolderPath,bDeterminationOnly,fnDeleteFolderCallback);},'DeleteFolderViaWebAPI':function(sFolderPath,bDeterminationOnly,fnDeleteFolderCallback){var CDeleteFolderRequest={'FullPath':sFolderPath,'DeterminationOnly':bDeterminationOnly},payloadObject={};payloadObject['URL']='Folders/DeleteFolder',payloadObject['OutboundDataPacket']=CDeleteFolderRequest,payloadObject['InboundDataFunction']=function(CDeleteFolderResponse){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();if(CDeleteFolderResponse)fnDeleteFolderCallback(CDeleteFolderResponse['Success'],CDeleteFolderResponse['ErrorMessage']);else TriSysApex['UI']['errorAlert']('FileManagerForm.DeleteFolderViaWebAPI:\x20no\x20response.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('FileManagerForm.DeleteFolderViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(!bDeterminationOnly)TriSysApex['UI']['ShowWait'](null,'Deleting\x20Folder...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DetermineIfFolderCanBeAdded':function(sFolderPath,fnAddFolderCallback){var bDeterminationOnly=!![];FileManager['AddFolderViaWebAPI'](sFolderPath,null,bDeterminationOnly,fnAddFolderCallback);},'AddFolderViaWebAPI':function(sFolderPath,sNewName,bDeterminationOnly,fnAddFolderCallback){var CAddFolderRequest={'FullPath':sFolderPath,'NewName':sNewName,'DeterminationOnly':bDeterminationOnly},payloadObject={};payloadObject['URL']='Folders/AddFolder',payloadObject['OutboundDataPacket']=CAddFolderRequest,payloadObject['InboundDataFunction']=function(CAddFolderResponse){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();if(CAddFolderResponse)fnAddFolderCallback(CAddFolderResponse['Success'],CAddFolderResponse['ErrorMessage']);else TriSysApex['UI']['errorAlert']('FileManagerForm.AddFolderViaWebAPI:\x20no\x20response.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(!bDeterminationOnly)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('FileManagerForm.AddFolderViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(!bDeterminationOnly)TriSysApex['UI']['ShowWait'](null,'Adding\x20Folder...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OverwriteMultipleFileCheck':function(lstFiles,sCopyToFolder,fnUploadAfterConfirmation){var payloadObject={};payloadObject['URL']='Files/Existence';var CFileExistenceRequest={'UploadedFileList':lstFiles,'DestinationFolder':sCopyToFolder};payloadObject['OutboundDataPacket']=CFileExistenceRequest,payloadObject['InboundDataFunction']=function(CFileExistenceResponse){TriSysApex['UI']['HideWait']();if(CFileExistenceResponse){if(CFileExistenceResponse['Success']){if(CFileExistenceResponse['FilesExist']){var sFileList='';CFileExistenceResponse['FilesExist']['forEach'](function(sFilePath){sFileList+='\x20&nbsp;\x20&nbsp;\x20'+sFilePath+'<br/>';});var iCount=CFileExistenceResponse['FilesExist']['length'],sMessage='The\x20following\x20'+(iCount==0x1?'':iCount)+'\x20file'+(iCount==0x1?'':'s')+'\x20already\x20exist'+(iCount==0x1?'s':'')+'\x20in\x20this\x20folder:'+'<br/><br/>'+sFileList+'<br/>'+'Do\x20you\x20wish\x20to\x20overwrite?',fnYes=function(){return fnUploadAfterConfirmation(),!![];},sTitle='Upload\x20File\x20Duplicate'+(iCount==0x1?'':'s');TriSysApex['UI']['questionYesNo'](sMessage,sTitle,'Yes',fnYes,'No',function(){return!![];});}else fnUploadAfterConfirmation();}else TriSysApex['UI']['errorAlert'](CFileExistenceResponse['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManager.OverwriteMultipleFileCheck:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Validating\x20Files...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'MoveUploadedFileReferenceDocument':function(sFilePath,sSubFolder,fnCallbackOnUpload){var payloadObject={};payloadObject['URL']='Files/MoveUploadedFileReferenceDocument';var CFileReferenceDocumentUpload={'UploadedFilePath':sFilePath,'SubFolder':sSubFolder};payloadObject['OutboundDataPacket']=CFileReferenceDocumentUpload,payloadObject['InboundDataFunction']=function(CFileReferenceDocumentUploadReference){TriSysApex['UI']['HideWait']();if(CFileReferenceDocumentUploadReference){if(CFileReferenceDocumentUploadReference['Success']){if(fnCallbackOnUpload)fnCallbackOnUpload();else FileManager['RefreshFiles']();}else TriSysApex['UI']['errorAlert'](CFileReferenceDocumentUploadReference['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManager.MoveUploadedFileReferenceDocument:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Uploading\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DetermineIfFilesCanBeDeleted':function(lstFiles,fnDeleteFilesCallback){var bDeterminationOnly=!![];FileManager['DeleteFileViaWebAPI'](lstFiles,null,bDeterminationOnly,fnDeleteFilesCallback);},'DeleteFilesConfirmation':function(lstFiles,sFiles){var s=lstFiles['length']==0x1?'':'s',fnConfirm=function(){var iDeletedCount=0x0,lstErrors=[],fnDeleteFileCallback=function(bSuccess,sError){iDeletedCount+=0x1;var bCompleted=iDeletedCount==lstFiles['length'];if(bSuccess){if(bCompleted)FileManager['RefreshFiles']();}else lstErrors['push'](sError);if(bCompleted){TriSysApex['UI']['HideWait']();if(lstErrors['length']>0x0){var sError='One\x20or\x20more\x20errors\x20occurred:<br>\x20&nbsp;\x20<i>'+sError+'</i>';TriSysApex['UI']['ShowMessage'](sError);}}};return setTimeout(function(){TriSysApex['UI']['ShowWait'](null,'Deleting\x20'+lstFiles['length']+'\x20File'+s+'...');for(var i=0x0;i<lstFiles['length'];i++){var sFilePath=lstFiles[i];FileManager['DeleteFileViaWebAPI'](null,sFilePath,![],fnDeleteFileCallback);}},0x32),!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20'+lstFiles['length']+'\x20file'+s+'?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20File'+s,'Yes',fnConfirm,'No');},'DeleteFileViaWebAPI':function(lstFiles,sFilePath,bDeterminationOnly,fnDeleteFileCallback){var payloadObject={};payloadObject['URL']='Files/DeleteFile';var CDeleteFileRequest={'FileList':lstFiles,'FilePath':sFilePath,'DeterminationOnly':bDeterminationOnly};payloadObject['OutboundDataPacket']=CDeleteFileRequest,payloadObject['InboundDataFunction']=function(data){var CDeleteFileResponse=data;if(CDeleteFileResponse)fnDeleteFileCallback(CDeleteFileResponse['Success'],CDeleteFileResponse['ErrorMessage']);else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('FileManager.DeleteFileViaWebAPI:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DetermineIfFileCanBeCopied':function(sFilePath,fnCopyFileCallback){var bDeterminationOnly=!![];FileManager['CopyFileViaWebAPI'](sFilePath,null,bDeterminationOnly,fnCopyFileCallback);},'CopyFileConfirmation':function(sFilePath,sNewName){if(!sNewName){TriSysApex['UI']['ShowMessage']('Please\x20provide\x20a\x20new\x20name\x20for\x20the\x20copy\x20of\x20this\x20file.');return;}var fnConfirm=function(){var fnCopyFileCallback=function(bSuccess,sError){if(bSuccess)FileManager['RefreshFiles']();else TriSysApex['UI']['errorAlert'](sError,'Copy\x20File\x20Error:\x20'+sError);};return setTimeout(function(){FileManager['CopyFileViaWebAPI'](sFilePath,sNewName,![],fnCopyFileCallback);},0x32),!![];},sFullPath=TriSysSDK['Controls']['FileManager']['GetFolderPathFromFile'](sFilePath,'\x5c')+sNewName,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20copy\x20the\x20following?\x20<br\x20/>'+sFilePath+'<br\x20/>to<br\x20/>'+sFullPath;TriSysApex['UI']['questionYesNo'](sMessage,'Copy\x20File','Yes',fnConfirm,'No');},'DetermineIfFileCanBeRenamed':function(sFilePath,fnRenameFileCallback){var bDeterminationOnly=!![];FileManager['RenameFileViaWebAPI'](sFilePath,null,bDeterminationOnly,fnRenameFileCallback);},'RenameFileConfirmation':function(sFilePath,sNewName){if(!sNewName){TriSysApex['UI']['ShowMessage']('Please\x20provide\x20a\x20new\x20name\x20for\x20this\x20file.');return;}var fnConfirm=function(){var fnRenameFileCallback=function(bSuccess,sError){if(bSuccess)FileManager['RefreshFiles']();else TriSysApex['UI']['errorAlert'](sError,'Rename\x20File\x20Error:\x20'+sError);};return setTimeout(function(){FileManager['RenameFileViaWebAPI'](sFilePath,sNewName,![],fnRenameFileCallback);},0x32),!![];},sFullPath=TriSysSDK['Controls']['FileManager']['GetFolderPathFromFile'](sFilePath,'\x5c')+sNewName,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20rename\x20the\x20following?\x20<br\x20/>'+sFilePath+'<br\x20/>to<br\x20/>'+sFullPath;TriSysApex['UI']['questionYesNo'](sMessage,'Rename\x20File','Yes',fnConfirm,'No');},'RenameFileViaWebAPI':function(sFilePath,sNewName,bDeterminationOnly,fnRenameFileCallback){var payloadObject={};payloadObject['URL']='Files/RenameFile';var CFileRenameRequest={'FullPath':sFilePath,'NewName':sNewName,'DeterminationOnly':bDeterminationOnly};payloadObject['OutboundDataPacket']=CFileRenameRequest,payloadObject['InboundDataFunction']=function(CFileRenameResponse){TriSysApex['UI']['HideWait']();if(CFileRenameResponse)fnRenameFileCallback(CFileRenameResponse['Success'],CFileRenameResponse['ErrorMessage']);else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManager.RenameFileViaWebAPI:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Renaming\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'CopyFileViaWebAPI':function(sFilePath,sNewName,bDeterminationOnly,fnCopyFileCallback){var payloadObject={};payloadObject['URL']='Files/CopyFile';var CFileCopyRequest={'FullPath':sFilePath,'NewName':sNewName,'DeterminationOnly':bDeterminationOnly};payloadObject['OutboundDataPacket']=CFileCopyRequest,payloadObject['InboundDataFunction']=function(CFileCopyResponse){TriSysApex['UI']['HideWait']();if(CFileCopyResponse)fnCopyFileCallback(CFileCopyResponse['Success'],CFileCopyResponse['ErrorMessage']);else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManager.CopyFileViaWebAPI:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Copying\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DragAndDropFileHandler':function(){var obj=$('#'+FileManager['GridID']);obj['on']('dragenter',function(e){e['stopPropagation'](),e['preventDefault']();}),obj['on']('dragover',function(e){e['stopPropagation'](),e['preventDefault']();}),obj['on']('drop',function(e){e['preventDefault']();var fileCollection=e['originalEvent']['dataTransfer']['files'],lstFiles=[];for(var i=0x0;i<fileCollection['length'];i++){var sFilePath=fileCollection[i];lstFiles['push'](sFilePath);}FileManager['PopDraggedFilesOffStackAndUpload'](lstFiles);});},'PopDraggedFilesOffStackAndUpload':function(lstFiles){if(!lstFiles)return;if(lstFiles['length']==0x0)return;var sCopyToFolder=FileManager['CurrentFolder'](),fnConfirmUpload=function(){var iFileUploadedCount=0x0,fnAfterUpload=function(){iFileUploadedCount+=0x1;if(iFileUploadedCount==lstFiles['length'])FileManager['RefreshFiles']();},fnSendFileToServer=function(sFilePath){var fnCallbackToMoveUploadedFile=function(myUploadedFile){FileManager['MoveUploadedFileReferenceDocument'](myUploadedFile,sCopyToFolder,fnAfterUpload);};TriSysSDK['Controls']['FileManager']['UploadFile'](sFilePath,fnCallbackToMoveUploadedFile);};lstFiles['forEach'](function(file){fnSendFileToServer(file);});},lstFileNames=[];lstFiles['forEach'](function(file){lstFileNames['push'](file['name']);}),FileManager['OverwriteMultipleFileCheck'](lstFileNames,sCopyToFolder,fnConfirmUpload);},'FileUpdated':function(sFilePath){var parts=sFilePath['split']('\x5c'),sFileOnly=parts[parts['length']-0x1]['toLowerCase'](),gridData=TriSysSDK['Grid']['ReadGridContents'](FileManager['GridID']);if(!gridData)return;var gridRows=gridData['rows'];for(var iRow=0x0;iRow<gridRows['length'];iRow++){var row=gridRows[iRow],sName=row['Name']['toLowerCase']();if(sName==sFileOnly){FileManager['RefreshFiles']();return;}}}};$(document)['ready'](function(){FileManager['Load']();});