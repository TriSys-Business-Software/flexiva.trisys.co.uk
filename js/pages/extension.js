var TriSysExtension={'Version':'2023.02.23.1430','CVPreviewID':'cv-preview-control','Load':function(options){var fnOnConnectionCallback=null;options&&options['OfficeAddIn']&&($('#trisys-extension-popup-toolbar')['css']('border-radius','0px'),$('#trisys-extension-popup-toolbar-logo')['remove'](),$('#trisys-extension-popup-toolbar-advertising')['remove'](),$('#trisys-extension-popup-toolbar-menu')['removeClass']()['addClass']('col-xs-12'),fnOnConnectionCallback=options['OnConnectionCallback'],TriSysExtension['_OfficeAddInCallbackFunctionForAfterWeLogin']=fnOnConnectionCallback);var spinnerImage=TriSysExtension['ParseCommandLineForSpinnerImage']();TriSysExtension['ShowRandomLookingUpImage']('trisys-extension-popup-spinner-image',spinnerImage),TriSysExtension['ShowRandomLookingUpImage']('looking-up-profile-in-trisys-spinner-image',spinnerImage);var personalDetails=TriSysExtension['ParseCommandLineForPersonalDetails'](),fnPlatformixLoaded=function(){TriSysAPI['Constants']['APIKey']='20131222-ba09-4e4c-8bcb-apex.web.app',TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysAPI['Constants']['APIKey']);if(!fnOnConnectionCallback)TriSysExtension['HideLaunchSpinnerAndShowPublicProfile']();var options={'Subscriber':!![]};Platformix['Framework']['Initialise'](function(){TriSysExtension['FrameworkLoaded'](personalDetails,spinnerImage,fnOnConnectionCallback);},options);};PlatformixLoader['WaitUntilLoaded'](fnPlatformixLoaded);},'ParseCommandLineForSpinnerImage':function(){var sURL=window['location']['href'],sSpinnerImage=URL['Parser'](sURL)['getParam']('spinnerImage');return sSpinnerImage&&(sSpinnerImage=sSpinnerImage['replace'](/TriSys/g,'='),sSpinnerImage=Base64Unicode['Decode'](sSpinnerImage)),sSpinnerImage;},'ParseCommandLineForPersonalDetails':function(){TriSysExtension['Cache']['SetContactDetails']({'Contact':{'ContactId':0x0}}),TriSysExtension['Cache']['SetSecondaryContactDetails']({});var sURL=window['location']['href'],sPersonalDetailsJSON=URL['Parser'](sURL)['getParam']('personalDetails'),personalDetails=null;if(sPersonalDetailsJSON){sPersonalDetailsJSON=sPersonalDetailsJSON['replace'](/TriSys/g,'='),sPersonalDetailsJSON=Base64Unicode['Decode'](sPersonalDetailsJSON);if(sPersonalDetailsJSON)try{personalDetails=JSON['parse'](sPersonalDetailsJSON);}catch(e){personalDetails=null;}}if(personalDetails)TriSysExtension['DisplayContactDetails'](personalDetails,'parsed-'),TriSysExtension['Cache']['SetContactDetails']({'Contact':{'ContactId':0x0}});else{}return personalDetails;},'LoadAccordion':function(){if(!TriSysExtension['isRecruitmentDatabase']()){var lstRecruitment=['cvpreview-li','requirements-li','placements-li'];lstRecruitment['forEach'](function(sPanel){var sID='accordion-panelbar-'+sPanel;$('#'+sID)['hide']();});var sContactDetailsSize='373px',sTaskListSize='381px',lstResize=[{'id':'contact-details-div','minHeight':sContactDetailsSize,'maxHeight':sContactDetailsSize},{'id':'contact-details-table','height':sContactDetailsSize,'maxHeight':sContactDetailsSize},{'id':'noteshistory-div','maxHeight':sTaskListSize},{'id':'noteshistory-table','minHeight':'360px'},{'id':'scheduledtasks-div','maxHeight':sTaskListSize},{'id':'scheduledtasks-table','minHeight':'360px'}];lstResize['forEach'](function(item){var sID='accordion-panelbar-'+item['id'],elem=$('#'+sID);if(item['minHeight'])elem['css']('min-height',item['minHeight']);if(item['maxHeight'])elem['css']('max-height',item['maxHeight']);if(item['height'])elem['css']('height',item['height']);});}$('#accordion-panelbar')['kendoPanelBar']({'expandMode':'single'});},'isRecruitmentDatabase':function(){var bRecruitmentDatabase=![],cache=TriSysApex['LoginCredentials']['Cache']['Read']();if(cache){if(cache['DatabaseType'])bRecruitmentDatabase=cache['DatabaseType']['Recruitment'];}return bRecruitmentDatabase;},'LoadToolbarMenu':function(){var fnRefresh=function(){TriSysExtension['Refresh'](!![]);},sImageRoot='https://apex.trisys.co.uk/',separatorItem={'text':'<div\x20class=\x22k-separator\x20k-item\x20k-state-default\x22\x20role=\x22menuitem\x22\x20style=\x22width:\x20100%;\x22>&nbsp;</div>','encoded':![],'enabled':![]},addMenuItems=[{'text':'Add\x20New\x20Contact','select':TriSysExtension['AddNewContact']},{'text':'Assign\x20to\x20Existing\x20Contact','select':TriSysExtension['AssignToExistingContact']}],actionsMenuItems=[];if(TriSysExtension['isRecruitmentDatabase']())actionsMenuItems['push']({'text':'Add\x20to\x20Shortlist','select':TriSysExtension['AddToShortlist']});actionsMenuItems['push']({'text':'Call','select':TriSysExtension['Actions']['Call']}),actionsMenuItems['push']({'text':'E-Mail','select':TriSysExtension['Actions']['EMail']}),actionsMenuItems['push']({'text':'Mail\x20Merge','select':TriSysExtension['Actions']['MailMerge']}),actionsMenuItems['push']({'text':'Meeting','select':TriSysExtension['Actions']['Meeting']}),actionsMenuItems['push']({'text':'Note','select':TriSysExtension['Actions']['Note']}),actionsMenuItems['push']({'text':'Note/History','select':TriSysExtension['AddNewNote']}),actionsMenuItems['push']({'text':'Scheduled\x20Task','select':TriSysExtension['AddScheduledTask']}),actionsMenuItems['push']({'text':'Send\x20SMS\x20Text','select':TriSysExtension['Actions']['SMSText']}),actionsMenuItems['push']({'text':'ToDo','select':TriSysExtension['Actions']['ToDo']});var fnApplyChanges=function(){TriSysExtension['ApplyChanges']({'title':'Update\x20TriSys'});},settingsMenuItems=[];!TriSysExtension['isOfficeAddInWebServerComponent']()&&(settingsMenuItems['push']({'text':'Close\x20Popup','select':TriSysExtension['ClosePopupWindow']}),settingsMenuItems['push'](separatorItem)),settingsMenuItems['push']({'text':'Logoff','select':TriSysExtension['LogOff']}),settingsMenuItems['push'](separatorItem),settingsMenuItems['push']({'text':'Help','select':TriSysExtension['Help']}),settingsMenuItems['push'](separatorItem),settingsMenuItems['push']({'text':'About','select':TriSysExtension['AboutPopupWindow']}),$('#toolbar-menu')['kendoMenu']({'dataSource':[{'text':'CRM','imageUrl':sImageRoot+'images/trisys/24x24/folder-open-2.png','items':[{'text':'Open\x20Contact','select':TriSysExtension['OpenContactForm']},{'text':'Open\x20Company','select':TriSysExtension['OpenCompanyForm']},separatorItem,{'text':'Update\x20TriSys','select':fnApplyChanges},separatorItem,{'text':'Refresh\x20Profile','select':fnRefresh}]},{'text':'Add','imageUrl':sImageRoot+'images/trisys/24x24/add-2.png','attr':{'data-item-key':'add'},'items':addMenuItems},{'text':'Actions','imageUrl':sImageRoot+'images/trisys/24x24/wand-2.png','items':actionsMenuItems},{'text':'','imageUrl':sImageRoot+'images/trisys/24x24/cogs-3.png','items':settingsMenuItems}]});},'ToolbarMenuVisibility':function(options){if(!options)return;var fnToolbarMenuNth=function(index){return'#toolbar-menu\x20>\x20li:nth-child('+index+')';};$(fnToolbarMenuNth(0x4))['show']();options['OpenAddMenu']&&($(fnToolbarMenuNth(0x2))['show'](),$(fnToolbarMenuNth(0x2))['trigger']('mouseover'));options['HideAddToAndAssign']?($(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(1)')['hide'](),$(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(2)')['hide'](),$(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(3)')['hide']()):($(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(1)')['show'](),$(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(2)')['show'](),$(fnToolbarMenuNth(0x2)+'\x20>\x20ul\x20>\x20li:nth-child(3)')['show']());options['NoContactMatch']&&($(fnToolbarMenuNth(0x1))['hide'](),$(fnToolbarMenuNth(0x3))['hide']());options['ContactMatched']&&($(fnToolbarMenuNth(0x1))['show'](),$(fnToolbarMenuNth(0x2))['hide'](),$(fnToolbarMenuNth(0x3))['show']());if(options['HideAll']){for(var i=0x1;i<=0x4;i++)$(fnToolbarMenuNth(i))['hide']();}},'LoadStyles':function(){var sKendoUIHTML='.k-flatcolorpicker.k-group,\x20.k-group,\x20.k-menu,\x20.k-menu\x20.k-group,\x20.k-popup.k-widget.k-context-menu\x20{'+'\x20\x20\x20\x20color:\x20#ffffff;'+'\x20\x20\x20\x20background-color:\x20#4c5572;'+'}'+''+'.k-menu\x20.k-item,\x20.k-menu-scroll-wrapper\x20.k-item,\x20.k-menu-scroll-wrapper.horizontal\x20>\x20.k-item,\x20.k-popups-wrapper\x20.k-item,\x20.k-popups-wrapper.horizontal\x20>\x20.k-item,\x20.k-widget.k-menu-horizontal\x20>\x20.k-item\x20{'+'\x20\x20\x20\x20padding-right:\x204px;'+'\x20\x20\x20\x20margin-right:\x204px;'+'\x20\x20\x20\x20border-radius:\x204px;'+'}'+''+'.k-menu\x20.k-item\x20>\x20.k-link,\x20.k-menu-scroll-wrapper\x20.k-item\x20>\x20.k-link,\x20.k-popups-wrapper\x20.k-item\x20>\x20.k-link\x20{'+'\x20\x20\x20\x20padding:\x204px;'+'}'+''+'.k-flatcolorpicker.k-group,\x20.k-group,\x20.k-menu,\x20.k-menu\x20.k-group,\x20.k-popup.k-widget.k-context-menu\x20{'+'\x20\x20\x20\x20color:\x20#ffffff;'+'\x20\x20\x20\x20background-color:\x20#4c5572;'+'}'+''+'.k-split-button.k-state-border-down\x20>\x20.k-button,\x20.k-split-button.k-state-border-up\x20>\x20.k-button\x20{'+'\x20\x20\x20\x20color:\x20#ffffff;'+'\x20\x20\x20\x20background-color:\x20#4c5572;'+'\x20\x20\x20\x20border-color:\x20#4c5572;'+'}'+''+'.k-menu\x20.k-state-active,\x20.k-popup.k-context-menu.k-group\x20.k-state-hover\x20{'+'\x09background-color:\x20#4c5572;'+'}'+''+'.k-sprite\x20{'+'\x09text-indent:\x200;'+'\x09font-size:\x201em;'+'}'+''+'.k-menu\x20.k-animation-container\x20.k-menu-group\x20{'+'\x09padding:\x204px;'+'}'+''+'.k-context-menu.k-menu-vertical\x20>\x20.k-item\x20>\x20.k-link,\x20.k-menu\x20.k-menu-group\x20.k-item\x20>\x20.k-link\x20{'+'\x09padding:\x200.5em\x201em\x200.5em\x200.5em;'+'}'+'.k-panel\x20>\x20.k-item\x20>\x20.k-link,\x20.k-panelbar\x20>\x20.k-item\x20>\x20.k-link\x20{'+'\x09line-height:\x203.0em;'+'}'+'.k-panelbar\x20.k-group\x20.k-item>.k-state-selected,\x20.k-panelbar>.k-item>.k-state-selected,\x20.k-state-selected>.k-link\x20{'+'\x09color:\x20#4c5572;'+'}'+'a.trisys-extension-brand\x20a:hover,\x20a:focus,\x20a:link,\x20a:active,\x20a:visited\x20{'+'\x09color:\x20white;'+'\x09text-decoration:\x20none;'+'}'+'a.trisys-extension-text\x20a:hover,\x20a:focus,\x20a:link,\x20a:active,\x20a:visited\x20{'+'\x09color:\x20#4c5572;'+'\x09text-decoration:\x20none;'+'}'+'.switch-primary\x20input:checked\x20+\x20span\x20{'+'\x09background-color:\x20#4c5572;'+'}'+'.k-menu.k-menu-horizontal:not(.k-context-menu)\x20{\x20padding:\x200px;\x20}'+'.k-menu:not(.k-context-menu)\x20{\x20border-color:\x20transparent;\x20color:\x20white;\x20background-color:\x20transparent;\x20}'+'.k-menu-link\x20{\x20color:\x20white;\x20font-size:\x2012px;\x20}'+'.k-menu-group\x20.k-menu-item\x20{\x20font-size:\x2012px;\x20}'+'.k-menu:not(.k-context-menu)\x20>\x20.k-item\x20>\x20.k-state-active\x20{\x20color:\x20white;\x20}'+'.k-menu:not(.k-context-menu)\x20>\x20.k-item:hover,\x20.k-menu:not(.k-context-menu)\x20>\x20.k-item.k-state-hover\x20{\x20color:\x20white;\x20}'+'.k-context-menu.k-menu-vertical\x20>\x20.k-item\x20>\x20.k-link,\x20.k-menu\x20.k-menu-group\x20.k-item\x20>\x20.k-link\x20{\x20padding:\x204px;\x20}'+'.k-menu-group\x20.k-separator\x20{\x20border-color:\x20#a3acc3;\x20margin-top:\x200px;\x20margin-bottom:\x206px;\x20}'+'.k-panel\x20>\x20.k-item\x20>\x20.k-link,\x20.k-panelbar\x20>\x20.k-item\x20>\x20.k-link\x20{\x20line-height:\x201.0em;\x20padding-left:\x208px;\x20height:\x2037px;\x20}'+'.k-panelbar\x20>\x20.k-item\x20>\x20.k-link.k-state-selected\x20{\x20border-color:\x20#264FA2;\x20color:\x20#fff;\x20background-color:\x20#264FA2;\x20}'+'.k-panelbar\x20>\x20.k-item\x20>\x20.k-link\x20{\x20font-size:\x2014px;\x20\x20}'+'.k-panelbar\x20>\x20.k-item\x20>\x20.k-link.k-state-focused.k-state-selected\x20{\x20box-shadow:\x20inset\x200\x200\x200\x201px\x20#264FA2;\x20}'+'.ui-widget-header\x20{\x20background-color:\x20#264FA2;\x20border-color:\x20#264FA2;\x20}'+'.k-textbox\x20{\x20height:\x2024px;\x20padding-left:\x204px;\x20}'+'.k-dropdown\x20.k-dropdown-wrap\x20.k-input,\x20.k-dropdowntree\x20.k-dropdown-wrap\x20.k-input\x20{\x20padding:\x200\x20.75rem;\x20font-size:\x2012px;\x20height:\x2024px;\x20}'+'.k-dropdown\x20.k-dropdown-wrap,\x20.k-dropdowntree\x20.k-dropdown-wrap\x20{\x20height:\x2024px;\x20}'+'';$('head')['append']('<style\x20type=\x22text/css\x22\x20id=\x22trisys-menu-k-styles\x22>'+sKendoUIHTML+ +'</style>');},'LoadAdvertising':function(){if(TriSysExtension['isOfficeAddInWebServerComponent']())return;var sLinkedInShare='<script\x20type=\x22IN/Share\x22\x20data-url=\x22https://www.trisys.co.uk\x22></script>',sLinkedInFollow='<script\x20type=\x22IN/FollowCompany\x22\x20data-id=\x22688057\x22\x20data-counter=\x22right\x22></script>',linkedInShare={'HTML':sLinkedInShare,'script':'https://platform.linkedin.com/in.js','paddingTop':'6px'},linkedInFollow={'HTML':sLinkedInFollow,'script':'https://platform.linkedin.com/in.js'},iIndex=Math['floor'](Math['random']()*0xa+0x1)-0x1,lstAdverts=[linkedInShare,null,null,null,linkedInShare,linkedInFollow,null,linkedInFollow,null,linkedInFollow],advert=lstAdverts[iIndex];if(advert){var fnLoadAdvert=function(){var advertElement=$('#trisys-extension-popup-toolbar-advertising');if(advert['paddingTop'])advertElement['css']('padding-top',advert['paddingTop']);advertElement['html'](advert['HTML']);};if(advert['script']){var scripts=[advert['script']];LazyLoad['js'](scripts,function(){fnLoadAdvert();});}else fnLoadAdvert();}},'LoadContactTypeWidgets':function(sContactType){TriSysSDK['CShowForm']['entityTypeCombo']('Contact','extension-apply-changes-source-contact-type',sContactType);},'HideLaunchSpinnerAndShowPublicProfile':function(bShowSpinner){var spinner=$('#trisys-extension-popup-spinner');bShowSpinner?spinner['show']():spinner['hide']();var parsedHeaderRow=$('#trisys-extension-parsed-header'),parsedPanel=$('#trisys-extension-parsed-panel'),informationRow=$('#trisys-extension-popup-information');informationRow['hide'](),bShowSpinner?parsedHeaderRow['hide']():parsedHeaderRow['show']();var duplicatesRow=$('#trisys-extension-popup-duplicate-contacts');duplicatesRow['hide'](),bShowSpinner?parsedPanel['hide']():parsedPanel['show']();if(bShowSpinner){TriSysExtension['ToolbarMenuVisibility']({'HideAll':!![]});var panelPopupHeader=$('#trisys-extension-popup-header');panelPopupHeader['hide']();var panelAccordionGroupPanel=$('#trisys-extension-accordion-panel');panelAccordionGroupPanel['hide']();}},'FrameworkLoaded':function(personalDetails,spinnerImage,fnOnConnectionCallback){var sAppName='TriSys\x20Add-In';TriSysWebJobs['Constants']['ApplicationName']=sAppName,Platformix['Copyright']['ShortProductName']=sAppName;if(spinnerImage)TriSysApex['UI']['WaitImageURL']=spinnerImage;if(!fnOnConnectionCallback)TriSysExtension['HideLaunchSpinnerAndShowPublicProfile']();TriSysExtension['LoadToolbarMenu'](),TriSysExtension['LoadAccordion'](),TriSysExtension['LoadStyles'](),TriSysExtension['LoadAdvertising']();var options={'AfterConnectionCallback':function(){TriSysExtension['InitialiseTriSysOnlyMessageCommunicationChannels']();if(fnOnConnectionCallback)fnOnConnectionCallback();}};if(!personalDetails)options['OfficeAddIn']=!![];TriSysExtension['ShowProfileAfterCheckingConnectionStatus'](personalDetails,options);},'_PersonalDetailsCopyForRefreshAfterCreateContact':null,'_OfficeAddInCallbackFunctionForAfterWeLogin':null,'ShowProfileAfterCheckingConnectionStatus':function(personalDetails,options){TriSysExtension['_PersonalDetailsCopyForRefreshAfterCreateContact']=personalDetails,TriSysExtension['Cache']['SetContactDetails']({'Contact':{'ContactId':0x0}}),TriSysExtension['Cache']['SetSecondaryContactDetails']({});var fnIfConnected=function(){if(personalDetails){var sContactType=TriSysSDK['CShowForm']['GetTextFromCombo']('extension-apply-changes-source-contact-type'),bGMail=![];if(personalDetails&&personalDetails['Mode'])bGMail=personalDetails['Mode']['GMail']||personalDetails['Mode']['Outlook'];var contactDetails={'URL':personalDetails['Profile'],'FullName':personalDetails['FullName'],'JobTitle':personalDetails['JobTitle'],'Company':personalDetails['CompanyName'],'Photo':personalDetails['ContactPhoto'],'ContactPhoto':personalDetails['ContactPhoto'],'LinkedInProfile':personalDetails['Profile'],'CompanyLogo':personalDetails['CompanyLogo'],'Twitter':personalDetails['Twitter'],'WebSite':personalDetails['WebSite'],'WorkTelNo':personalDetails['WorkTelNo'],'MobileTelNo':personalDetails['MobileTelNo'],'HomeTelNo':personalDetails['HomeTelNo'],'Address':personalDetails['Address'],'Location':personalDetails['Location'],'WorkEMail':personalDetails['WorkEMail'],'ContactType':sContactType};bGMail&&(contactDetails['GMail']={'EMail':personalDetails['SenderEMail'],'FullName':personalDetails['SenderName'],'Photo':personalDetails['SenderPhoto'],'Attachments':personalDetails['Attachments']});TriSysExtension['Cache']['SetContactDetails'](contactDetails);var bOutlook=![];if(personalDetails['Mode'])bOutlook=personalDetails['Mode']['Outlook'];TriSysExtension['CallTriSysWebAPIToReadContactPrimaryDetails'](contactDetails,bOutlook);}else{var parsedHeader=$('#trisys-extension-parsed-header'),parsedPanel=$('#trisys-extension-parsed-panel'),noProfilePanel=$('#trisys-extension-no-parsed-profile');parsedHeader['hide'](),parsedPanel['hide']();}if(options&&options['AfterConnectionCallback'])options['AfterConnectionCallback']();};TriSysExtension['CheckConnectionStatus'](fnIfConnected);},'CheckConnectionStatus':function(fnCallback){console['log']('TriSysExtension.CheckConnectionStatus...');var bConnected=TriSysExtension['isConnectedAndLoggedInAsASubscriber']();if(!bConnected){var bPreConnectionAttempt=!![];TriSysExtension['ShowContactProfileWidgets'](null);}else{console['log']('TriSysExtension.isConnectedAndLoggedInAsASubscriber()=true');if(fnCallback)try{fnCallback();}catch(e){console['log']('TriSysExtension.CheckConnectionStatus\x20ERROR'),console['log'](e);}}},'ShowContactProfileWidgets':function(sURL){var bShow=sURL?![]:!![];if(sURL)bShow=TriSysExtension['isURLaSupportedSocialNetwork'](sURL);var bConnected=TriSysExtension['isConnectedAndLoggedInAsASubscriber']();bShow=bConnected,console['log']('We\x20are\x20in\x20popup\x20window\x20and\x20bShow='+bShow+',\x20URL='+sURL);var toolbar=$('#trisys-extension-popup-toolbar'),toolbarButtons=$('#trisys-extension-popup-toolbar-buttons'),parsedHeaderRow=$('#trisys-extension-parsed-header'),parsedPanel=$('#trisys-extension-parsed-panel'),informationRow=$('#trisys-extension-popup-information'),panelPopupHeader=$('#trisys-extension-popup-header'),panelAccordionGroupPanel=$('#trisys-extension-accordion-panel');if(bShow)toolbar['show'](),toolbarButtons['show'](),parsedHeaderRow['hide'](),parsedPanel['hide'](),informationRow['hide'](),panelPopupHeader['show'](),panelAccordionGroupPanel['show']();else{toolbar['show'](),toolbarButtons['hide'](),parsedHeaderRow['hide'](),parsedPanel['hide'](),panelPopupHeader['hide'](),panelAccordionGroupPanel['hide'](),informationRow['show']();var spinner=$('#trisys-extension-popup-spinner');spinner['hide']();}},'InitialiseTriSysOnlyMessageCommunicationChannels':function(){TriSysApex['InterprocessCommunication']['InstantiateCommunicationChannels']();},'isURLaSupportedSocialNetwork':function(sURL){if(sURL['indexOf']('linkedin.')>=0x0||sURL['indexOf']('google.')>=0x0||TriSysExtension['isOfficeAddInWebServerComponent']())return!![];else return![];},'isOfficeAddInWebServerComponent':function(){var sURL=window['location']['href'];if(sURL['indexOf']('/office/')>=0x0)return!![];else return![];},'isConnectedAndLoggedInAsASubscriber':function(){var user=TriSysApex['LoginCredentials']['Cache']['ReadLoggedInUserSubscriber']();if(user)return!![];return![];},'CallTriSysWebAPIToReadContactPrimaryDetails':function(contactDetails,multipleCallMode){if(TriSysExtension['isOfficeAddInWebServerComponent']())TriSysExtension['HideLaunchSpinnerAndShowPublicProfile'](!![]);var bConnected=TriSysExtension['isConnectedAndLoggedInAsASubscriber']();if(!bConnected)return;debugger;var fnAsyncCall=function(){var CSocialNetworkProfileReadContactRequest={'ProfileID':contactDetails['ProfileID'],'URL':contactDetails['URL'],'ContactId':contactDetails['ContactId'],'GMail':contactDetails['GMail'],'WorkEMail':contactDetails['WorkEMail'],'MobileTelNo':contactDetails['MobileTelNo']},payloadObject={};payloadObject['URL']='SocialNetwork/ReadContact',payloadObject['OutboundDataPacket']=CSocialNetworkProfileReadContactRequest,payloadObject['InboundDataFunction']=function(CSocialNetworkProfileReadContactResponse){if(TriSysExtension['isOfficeAddInWebServerComponent']())TriSysExtension['HideLaunchSpinnerAndShowPublicProfile'](![]);if(!CSocialNetworkProfileReadContactResponse)CSocialNetworkProfileReadContactResponse={'Success':![]};if(CSocialNetworkProfileReadContactResponse){console['log']('CSocialNetworkProfileReadContactResponse='+CSocialNetworkProfileReadContactResponse['Success']);if(CSocialNetworkProfileReadContactResponse['Success']){contactDetails['Contact']=CSocialNetworkProfileReadContactResponse['Contact'],contactDetails['Profiles']=CSocialNetworkProfileReadContactResponse['Profiles'],contactDetails['LastContactedDate']=CSocialNetworkProfileReadContactResponse['LastContactedDate'],contactDetails['NextContactDate']=CSocialNetworkProfileReadContactResponse['NextContactDate'];if(CSocialNetworkProfileReadContactResponse['FoundSingleMatchOnEMailAddress']||CSocialNetworkProfileReadContactResponse['FoundSingleMatchOnMobileTelNo']){TriSysExtension['AssignToExistingContact'](contactDetails['Contact']['ContactId'],contactDetails['Contact']['FullName']);return;}TriSysExtension['Cache']['SetContactDetails'](contactDetails),TriSysExtension['ToolbarMenuVisibility']({'HideAddToAndAssign':!![]});if(contactDetails['GMail'])TriSysExtension['ShowAttachments'](contactDetails['GMail']['Attachments'],!![]);}else{contactDetails['Contact']={'ContactId':0x0,'FullName':contactDetails['FullName']},contactDetails['Profiles']=null,TriSysExtension['Cache']['SetContactDetails'](contactDetails);var toolbarButtons=$('#trisys-extension-popup-toolbar-buttons'),waitingSpinner=$('#looking-up-profile-in-trisys-spinner'),noProfileMatch=$('#looking-up-profile-nothing-found');toolbarButtons['show'](),waitingSpinner['hide'](),noProfileMatch['show'](),TriSysExtension['ToolbarMenuVisibility']({'NoContactMatch':!![]}),TriSysExtension['ToolbarMenuVisibility']({'OpenAddMenu':!![]});if(multipleCallMode){var popupHeader=$('#trisys-extension-popup-header');popupHeader['hide']();var parsedHeader=$('#trisys-extension-parsed-header');parsedHeader['show']();var accordionPanel=$('#trisys-extension-accordion-panel');accordionPanel['hide'](),$('#parsed-contact-name')['text'](contactDetails['GMail']['FullName']),contactDetails['Mode']={'Outlook':!![]},contactDetails['SenderEMail']=contactDetails['GMail']['EMail'],contactDetails['SenderName']=contactDetails['GMail']['FullName'],contactDetails['WorkEMail']=contactDetails['SenderEMail'],contactDetails['PersonalEMail']=contactDetails['SenderEMail'],TriSysExtension['DisplayContactDetails'](contactDetails,'parsed-',!![],{'AssignContactDetails':!![]}),TriSysExtension['ShowAttachments'](contactDetails['GMail']['Attachments'],![]);}return;}TriSysExtension['LoadPrimaryContactDetailsInPopupWindow'](),contactDetails['Contact']&&(TriSysExtension['ToolbarMenuVisibility']({'ContactMatched':!![]}),TriSysExtension['CallTriSysWebAPIToReadContactSecondaryDetails'](contactDetails));}},payloadObject['ErrorHandlerFunction']=function(request,status,error){var sError='TriSysExtension.CallTriSysWebAPIToReadContactPrimaryDetails:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'];TriSysApex['UI']['errorAlert'](sError);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);};fnAsyncCall();},'ShowRandomLookingUpImage':function(sId,sImageURL){if(!sImageURL){var iIndex=Math['floor'](Math['random']()*0xa+0x1)-0x1;sImageURL=TriSysExtension['SpinnerImageFromIndexedList'](iIndex);}$('#'+sId)['attr']('src',sImageURL);},'SpinnerImageFromIndexedList':function(iIndex){var lstImages=TriSysExtension['SpinnerList'],sImage=lstImages[iIndex];return sImage='https://apex.trisys.co.uk/images/trisys/128x128/'+sImage+'.gif',sImage;},'SpinnerList':['Wheel-2.5s-128px','Pacman-1s-128px','DNA-2s-128px','Clock-8s-128px','Coffee-2s-128px','Sunny-2s-128px','Progress-5s-128px','Spinner-1s-128px','Double\x20Ring-2s-128px','Camera-1s-128px'],'CallTriSysWebAPIToReadContactSecondaryDetails':function(contactDetails){var CReadContactSummaryForExtensionRequest={'ContactId':contactDetails['Contact']['ContactId']},payloadObject={};payloadObject['URL']='Contacts/ReadContactSummaryForExtension',payloadObject['OutboundDataPacket']=CReadContactSummaryForExtensionRequest,payloadObject['InboundDataFunction']=function(CReadContactSummaryForExtensionResponse){if(CReadContactSummaryForExtensionResponse){var contactDetails={};CReadContactSummaryForExtensionResponse['Success']&&(contactDetails=CReadContactSummaryForExtensionResponse),TriSysExtension['Cache']['SetSecondaryContactDetails'](contactDetails),TriSysSDK['Controls']['General']['LoadControlFromTemplateIntoDiv'](TriSysExtension['CVPreviewID'],'ctrlCVPreview-html',function(){TriSysExtension['LoadSecondaryContactDetailsInPopupWindow']();});}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysExtension.CallTriSysWebAPIToReadContactSecondaryDetails:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'_iFieldDisplayCount':0x0,'DisplayContactDetails':function(contactDetails,sPrefix,bShowTotals,options){TriSysExtension['_iFieldDisplayCount']=0x0,$('#popup-contact-buffer-tr')['show']();if(!contactDetails)return;var contact=contactDetails['Contact'],profiles=contactDetails['Profiles'];if(!contact||options&&options['AssignContactDetails'])contact=contactDetails;var iMinimumWidth=0x1f4,bTweakDom=$(window)['width']()<iMinimumWidth&&TriSysExtension['isOfficeAddInWebServerComponent']()&&!TriSysExtension['_TweakedDOMforSmallWidth'];bTweakDom&&(TriSysExtension['_TweakedDOMforSmallWidth']=!![],TriSysExtension['TweakDimensionsOfOutlookAddIn']());if(contact){$('#'+sPrefix+'contact-work-email-tr')['show'](),$('#'+sPrefix+'contact-personal-email-tr')['show']();if(sPrefix=='parsed-'&&(contact['Mode']&&(contact['Mode']['GMail']||contact['Mode']['Outlook']))){$('#'+sPrefix+'public-profile-text')['text'](contactDetails['Mode']['GMail']?'Gmail':'Outlook'+'\x20Details'),$('#'+sPrefix+'public-profile-image')['removeClass']()['addClass'](contactDetails['Mode']['GMail']?'fa\x20fa-google':'fa\x20fa-windows');var trPrefix='parsed-contact-',lstHide=['linkedin','website','work-telno','personal-mobile','work-mobile','location','address','home-telno','twitter','skype'];lstHide['forEach'](function(sId){sId='#'+trPrefix+sId+'-tr',$(sId)['hide']();}),$('#'+sPrefix+'contact-personal-email')['text'](contactDetails['SenderEMail']),$('#'+sPrefix+'contact-work-email')['text'](contactDetails['SenderEMail']),$('#'+sPrefix+'contact-work-email-text')['text']('E-Mail'),$('#'+sPrefix+'contact-sender-name')['html']('\x20<strong>'+contactDetails['SenderName']+'</strong>');var sSenderPhoto=contactDetails['SenderPhoto'];if(sSenderPhoto)$('#'+sPrefix+'contact-photo')['attr']('src',sSenderPhoto);return;}$('#'+sPrefix+'contact-name')['html'](contact['FullName']),$('#'+sPrefix+'contact-jobtitle')['html'](contact['JobTitle']),$('#'+sPrefix+'company-name')['html'](contact['CompanyName']);if(contact['ContactId']>0x0){var sAdditionalInformation=TriSysSDK['Numbers']['Pad'](contact['ContactId'],0x6)+'\x20\x20\x20\x20:\x20\x20\x20\x20'+contact['ContactType'];$('#popup-contact-details-id')['text'](sAdditionalInformation);}$('#'+sPrefix+'contact-profile-url')['html'](contact['Profile']);var sContactPhoto=contact['ContactPhoto'];!sContactPhoto&&(sContactPhoto='https://apex.trisys.co.uk/images/profile-grey.png');$('#'+sPrefix+'contact-photo')['attr']('src',sContactPhoto);var sFieldRowId='#'+sPrefix+'contact-work-email-tr';if(contact['WorkEMail'])$('#'+sPrefix+'contact-work-email')['html'](contact['WorkEMail']),$('#'+sPrefix+'contact-work-email-hyperlink')['attr']('href','mailto:'+contact['WorkEMail']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-personal-email-tr';if(contact['PersonalEMail'])$('#'+sPrefix+'contact-personal-email')['html'](contact['PersonalEMail']),$('#'+sPrefix+'contact-personal-email-hyperlink')['attr']('href','mailto:'+contact['PersonalEMail']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-website-tr';if(contact['WebSite'])$('#'+sPrefix+'contact-website')['text'](contact['WebSite']),$('#'+sPrefix+'contact-website-hyperlink')['attr']('href',contact['WebSite']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-address-tr';if(contact['Address'])$('#'+sPrefix+'contact-address')['html'](contact['Address']),$('#'+sPrefix+'contact-address-hyperlink')['attr']('href','https://www.google.com/maps/search/?api=1&query='+contact['Address']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-twitter-tr';if(contact['Twitter'])$('#'+sPrefix+'contact-twitter')['html'](contact['Twitter']),$('#'+sPrefix+'contact-twitter-hyperlink')['attr']('href','https://twitter.com/'+contact['Twitter']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-work-phone-tr';if(contact['WorkTelNo'])$('#'+sPrefix+'contact-work-telno')['html'](contact['WorkTelNo']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-personal-mobile-tr';if(contact['MobileTelNo'])$('#'+sPrefix+'contact-personal-mobile-telno')['html'](contact['MobileTelNo']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-work-mobile-tr';if(contact['WorkMobileTelNo'])$('#'+sPrefix+'contact-work-mobile-telno')['html'](contact['WorkMobileTelNo']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();var sHomeTelNo=null;if(contact['HomeAddressTelNo'])sHomeTelNo=contact['HomeAddressTelNo'];if(contact['HomeTelNo'])sHomeTelNo=contact['HomeTelNo'];if(sHomeTelNo)$('#'+sPrefix+'contact-home-telno')['html'](sHomeTelNo);else $('#'+sPrefix+'contact-home-phone-tr')['hide']();var fnAddressSummary=function(sStreet,sCity,sCounty,sPostCode,sCountry){sStreet&&(sStreet=sStreet['replace'](/\n\r/g,',\x20'),sStreet=sStreet['replace'](/\n/g,',\x20'),sStreet=sStreet['replace'](/\r/g,',\x20'));var sAddressSummary=sStreet;return sAddressSummary+=sAddressSummary&&sCity?',\x20'+sCity:'',sAddressSummary+=sAddressSummary&&sCounty?',\x20'+sCounty:'',sAddressSummary+=sAddressSummary&&sPostCode?',\x20'+sPostCode:'',sAddressSummary+=sAddressSummary&&sCountry?',\x20'+sCountry:'',sAddressSummary;},sAddressSummary='';if(contact['ContactType']=='Candidate')sAddressSummary=fnAddressSummary(contact['HomeAddressStreet'],contact['HomeAddressCity'],contact['HomeAddressCounty'],contact['HomeAddressPostCode'],contact['HomeAddressCountry']);else{if(contact['ContactType'])sAddressSummary=fnAddressSummary(contact['CompanyAddressStreet'],contact['CompanyAddressCity'],contact['CompanyAddressCounty'],contact['CompanyAddressPostCode'],contact['CompanyAddressCountry']);}if(contact['Address'])sAddressSummary=contact['Address'],$('#'+sPrefix+'contact-location-tr')['hide']();else contact['Location']&&(sAddressSummary=contact['Location'],$('#'+sPrefix+'contact-address-tr')['hide']());$('#'+sPrefix+'contact-address-summary')['html'](sAddressSummary);!sAddressSummary||sAddressSummary['length']==0x0||sAddressSummary=='null'?($('#'+sPrefix+'contact-address-tr')['hide'](),$('#'+sPrefix+'contact-location-tr')['hide']()):($('#'+sPrefix+'contact-address-tr')['show'](),$('#'+sPrefix+'contact-location-tr')['show'](),TriSysExtension['_iFieldDisplayCount']+=0x1);sFieldRowId='#'+sPrefix+'contact-skype-tr';if(contact['SkypeNumber'])$('#'+sPrefix+'contact-skype')['text'](contact['SkypeNumber']),TriSysExtension['_iFieldDisplayCount']+=0x1,$(sFieldRowId)['show']();else $(sFieldRowId)['hide']();sFieldRowId='#'+sPrefix+'contact-buffer-tr';if(TriSysExtension['_iFieldDisplayCount']>0x8)$(sFieldRowId)['hide']();else $(sFieldRowId)['show']();if(contactDetails['LastContactedDate']){var dtNow=new Date(),sLastContacted=new Date(contactDetails['LastContactedDate'])<dtNow?moment(contactDetails['LastContactedDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'):'';if(sLastContacted['indexOf']('0001')>0x0)sLastContacted='';var sNextContact=new Date(contactDetails['NextContactDate'])>dtNow?moment(contactDetails['NextContactDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'):'';$('#contact-last-contacted-date')['html'](sLastContacted),$('#contact-next-contact-date')['html'](sNextContact);}$('#'+sPrefix+'contact-linkedin-profile-hyperlink')['hide'](),$('#'+sPrefix+'contact-facebook-hyperlink')['hide'](),$('#'+sPrefix+'contact-twitter-hyperlink')['hide']();if(profiles){var SocialNetworkProfileEnum_LinkedIn=0x1,SocialNetworkProfileEnum_Facebook=0x2,SocialNetworkProfileEnum_Twitter=0x3;for(var i=0x0;i<profiles['length'];i++){var socialProfile=profiles[i],sURL=socialProfile['URL'],sURL_Hyperlink=socialProfile['URL'];if(sURL){sURL=sURL['replace']('https://',''),sURL=sURL['replace']('http://','');if(sURL_Hyperlink['indexOf']('http')<0x0)sURL_Hyperlink='http://'+sURL_Hyperlink;}switch(socialProfile['ProfileNumber']){case SocialNetworkProfileEnum_LinkedIn:$('#'+sPrefix+'contact-linkedin-profile-url')['html'](sURL),$('#'+sPrefix+'contact-linkedin-profile-hyperlink')['attr']('href',sURL_Hyperlink);if(sURL_Hyperlink)$('#'+sPrefix+'contact-linkedin-profile-hyperlink')['show']();break;case SocialNetworkProfileEnum_Facebook:$('#'+sPrefix+'contact-facebook-url')['html'](sURL),$('#'+sPrefix+'contact-facebook-hyperlink')['attr']('href',sURL_Hyperlink);if(sURL_Hyperlink)$('#'+sPrefix+'contact-facebook-hyperlink')['show']();break;case SocialNetworkProfileEnum_Twitter:$('#'+sPrefix+'contact-twitter-handle')['html'](sURL),$('#'+sPrefix+'contact-twitter-hyperlink')['attr']('href',sURL_Hyperlink);if(sURL_Hyperlink)$('#'+sPrefix+'contact-twitter-hyperlink')['show']();break;}}}if(bShowTotals){var lstCounters=[{'id':'requirements-id','number':contact['RequirementCount']},{'id':'placements-id','number':contact['PlacementCount']},{'id':'notes-history-id','number':contact['NoteHistoryCount']},{'id':'scheduled-tasks-id','number':contact['ScheduledTaskCount']}];lstCounters['forEach'](function(counter){var elem=$('#popup-'+counter['id']);if(counter['number']>0x0)elem['text'](TriSysSDK['Numbers']['ThousandsSeparator'](counter['number'])),elem['show']();else elem['hide']();});}}},'DisplaySecondaryContactDetails':function(contactDetails){ctrlCVPreview['Open'](contactDetails['CVurl']),ctrlCVPreview['Zoom'](0.75,0x320),TriSysExtension['DisplayRequirements'](contactDetails['Requirements']),TriSysExtension['DisplayPlacements'](contactDetails['Placements']),TriSysExtension['DisplayTasks'](contactDetails['NotesHistory'],contactDetails['TotalNotesHistoryRecords'],'trisys-noteshistory-tbody','trisys-noteshistory-more'),TriSysExtension['DisplayTasks'](contactDetails['ScheduledTasks'],contactDetails['TotalScheduledTaskRecords'],'trisys-scheduledtasks-tbody','trisys-scheduledtasks-more');if(contactDetails['Website']){$('#popup-contact-website')['text'](contactDetails['Website']),$('#popup-contact-website-hyperlink')['attr']('href',contactDetails['Website']),$('#popup-contact-website-tr')['show'](),TriSysExtension['_iFieldDisplayCount']+=0x1;if(TriSysExtension['_iFieldDisplayCount']>0x8)$('#popup-contact-buffer-tr')['hide']();}},'DisplayRequirements':function(requirements){var tbody=$('.trisys-requirements-tbody');if(!requirements||requirements['length']==0x0){tbody['hide']();return;}var requirementsData=[];for(var i=0x0;i<requirements['length'];i++){var requirement=requirements[i],requirementObject=JSON['parse'](JSON['stringify'](requirement));requirementObject['EarliestStartDate']=moment(requirement['EarliestStartDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'),requirementsData['push'](requirementObject);}var directives={'hyperlink':{'onclick':function(params){return'TriSysExtension.OpenRequirementForm('+this['RequirementId']+')';}}};tbody['render'](requirementsData,directives),tbody['show'](),$('#accordion-panelbar-requirements-table\x20tr:last')['after']('<tr><td\x20colspan=\x222\x22></td></tr>');},'DisplayPlacements':function(placements){var tbody=$('.trisys-placements-tbody');if(!placements||placements['length']==0x0){tbody['hide']();return;}var placementsData=[];for(var i=0x0;i<placements['length'];i++){var placement=placements[i],placementObject=JSON['parse'](JSON['stringify'](placement));placementObject['StartDate']=moment(placement['StartDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'),placementsData['push'](placementObject);}var directives={'hyperlink':{'onclick':function(params){return'TriSysExtension.OpenPlacementForm('+this['PlacementId']+')';}}};tbody['render'](placementsData,directives),tbody['show'](),$('#accordion-panelbar-placements-table\x20tr:last')['after']('<tr><td\x20colspan=\x222\x22></td></tr>');},'DisplayTasks':function(tasks,iTotalTasks,sTableID,sMoreIDPrefix){try{if(!tasks||tasks['length']==0x0){$('.'+sTableID)['hide']();return;}var taskData=[];for(var i=0x0;i<tasks['length'];i++){var task=tasks[i],taskObject=JSON['parse'](JSON['stringify'](task));taskObject['StartDate']=moment(task['StartDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'),taskObject['TaskTypeText']=task['TaskType'],taskData['push'](taskObject);}var directives={'hyperlink':{'onclick':function(params){return'TriSysExtension.OpenTaskForm('+this['TaskId']+')';}},'TaskType':{'src':function(params){return'https://apex.trisys.co.uk/images/trisys/16x16/tasktype/'+this['TaskType']+'.png';}}};$('.'+sTableID)['render'](taskData,directives),$('.'+sTableID)['show'](),$('.'+sTableID+'\x20tr:last')['after']('<tr><td\x20colspan=\x222\x22></td></tr>');var iTotalRemaining=iTotalTasks-taskData['length'],sHyperLink=sMoreIDPrefix+'-hyperlink',sCountText=sMoreIDPrefix+'-text';iTotalRemaining>0x0?($('#'+sCountText)['html']('Click\x20to\x20view\x20'+iTotalRemaining+'\x20additional\x20tasks'),$('#'+sHyperLink)['show']()):$('#'+sHyperLink)['hide']();}catch(e){}},'OpenContactForm':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails&&contactDetails['Contact']){if(contactDetails['Contact']['ContactId']>0x0){TriSysExtension['OpenContactFormAndFocusOnTab'](contactDetails['Contact']['ContactId']),TriSysApex['Toasters']['Information']('This\x20contact\x20record\x20has\x20been\x20opened\x20in\x20TriSys');return;}}TriSysExtension['ShowMessage']('Contact\x20does\x20not\x20exist\x20in\x20your\x20CRM\x20database.');},'OpenContactFormAndFocusOnTab':function(lContactId,bPrompt){if(lContactId<=0x0)return;var fnOpenContact=function(){TriSysApex['InterprocessCommunication']['ClientOpenForm']('Contact',lContactId),TriSysExtension['FocusOnApexBrowserTab']();};bPrompt=![];if(bPrompt)TriSysApex['UI']['questionYesNo']('Open\x20Contact\x20record\x20in\x20TriSys?',TriSysWebJobs['Constants']['ApplicationName'],'Yes',function(){return fnOpenContact(),!![];},'No',function(){return!![];});else fnOpenContact();},'OpenCompanyForm':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails&&contactDetails['Contact']){if(contactDetails['Contact']['CompanyId']>0x0){TriSysApex['InterprocessCommunication']['ClientOpenForm']('Company',contactDetails['Contact']['CompanyId']),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('This\x20company\x20record\x20has\x20been\x20opened\x20in\x20TriSys');return;}}TriSysExtension['ShowMessage']('Company\x20does\x20not\x20exist\x20in\x20your\x20CRM\x20database.');},'ApplyChanges':function(options){var sTitle=options['title'],sPrefix='parsed-contact-',sLinkedInProfile=$('#'+sPrefix+'profile-url')['text'](),sPhoto=$('#'+sPrefix+'photo')['attr']('src'),sFullName=$('#'+sPrefix+'name')['text'](),sJobTitle=$('#'+sPrefix+'jobtitle')['text'](),sCompanyName=$('#parsed-company-name')['text'](),sWorkEMail=$('#popup-contact-work-email')['text']();if(!sWorkEMail)sWorkEMail=$('#'+sPrefix+'work-email')['text']();var sPersonalEMail=$('#popup-contact-personal-email')['text']();if(!sPersonalEMail)sPersonalEMail=$('#'+sPrefix+'personal-email')['text']();var sWebSite=$('#'+sPrefix+'website')['text'](),sAddress=$('#'+sPrefix+'address-summary')['text'](),sTwitter=$('#'+sPrefix+'twitter')['text'](),sSkype=$('#'+sPrefix+'skype')['text'](),sWorkPhone=$('#'+sPrefix+'work-telno')['text']();debugger;var sPersonalMobile=$('#popup-contact-personal-mobile-telno')['text']();if(!sPersonalMobile)sPersonalMobile=$('#'+sPrefix+'personal-mobile-telno')['text']();var sWorkMobile=$('#'+sPrefix+'work-mobile-telno')['text'](),sHomePhone=$('#'+sPrefix+'home-telno')['text'](),sContactType=TriSysExtension['Cache']['GetDefaultContactType'](),sExistingContactType=$('#extension-apply-changes-trisys-contact-type')['text']();if(sExistingContactType)sContactType=sExistingContactType['trim']();var sMessage=$('#extension-apply-changes-template')['html'](),sFieldPrefix='extension-apply-changes-',sCopyPrefix='extension-apply-changes-copy-',fnField=function(sName){return'{{'+sName+'}}';},fnTriSysFieldValue=function(sValue){return sValue?sValue:'';},primaryContactDetails=TriSysExtension['Cache']['GetContactDetails'](),lstHideRows=[],lstShowRows=[],lstSetCopyCheckBox=[],bGMail=primaryContactDetails['GMail'];if(bGMail&&!primaryContactDetails['GMail']['EMail'])bGMail=![];if(bGMail){sFullName=primaryContactDetails['GMail']['FullName'],lstHideRows['push']('#extension-apply-changes-source-linkedin');if(TriSysExtension['isOfficeAddInWebServerComponent']())lstShowRows['push']('#extension-apply-changes-source-outlook');else lstShowRows['push']('#extension-apply-changes-source-gmail');}else TriSysExtension['isOfficeAddInWebServerComponent']()&&(lstHideRows['push']('#extension-apply-changes-source-linkedin'),lstShowRows['push']('#extension-apply-changes-source-outlook'));if(!bGMail)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-public-profile-url'),'g'),sLinkedInProfile),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-public-profile-url'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['LinkedIn'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'public-profile-url','sourceValue':sLinkedInProfile,'trisysField':'URL'});else lstHideRows['push']('#'+sFieldPrefix+'profile-url-row');if(sFullName||bGMail){sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-full-name'),'g'),sFullName);var sTriSysFullName=options['newContact']?'':primaryContactDetails['Contact']['FullName'];sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-full-name'),'g'),fnTriSysFieldValue(sTriSysFullName)),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'full-name','sourceValue':sFullName,'trisysField':'FullName'});}else lstHideRows['push']('#'+sFieldPrefix+'full-name-row');if(sPhoto){sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-photo'),'g'),sPhoto);var sTriSysPhoto=primaryContactDetails['Contact']['ContactPhoto']?primaryContactDetails['Contact']['ContactPhoto']:'https://apex.trisys.co.uk/images/profile-grey.png';sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-photo'),'g'),sTriSysPhoto),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'photo','sourceValue':sPhoto,'trisysField':'Photo'});}else lstHideRows['push']('#'+sFieldPrefix+'photo-row');sContactType&&(sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-contact-type'),'g'),sContactType),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-contact-type'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['ContactType'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'contact-type','sourceValue':sContactType,'trisysField':'ContactType'}));if(sJobTitle)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-job-title'),'g'),sJobTitle),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-job-title'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['JobTitle'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'job-title','sourceValue':sJobTitle,'trisysField':'JobTitle'});else lstHideRows['push']('#'+sFieldPrefix+'job-title-row');if(sCompanyName)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-company-name'),'g'),sCompanyName),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-company-name'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['CompanyName'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'company-name','sourceValue':sCompanyName,'trisysField':'Company'});else lstHideRows['push']('#'+sFieldPrefix+'company-name-row');if(sWorkEMail)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-work-email'),'g'),sWorkEMail),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-work-email'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['WorkEMail'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'work-email','sourceValue':sWorkEMail,'trisysField':'WorkEMail'});else lstHideRows['push']('#'+sFieldPrefix+'work-email-row');if(sWorkPhone)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-work-phone'),'g'),sWorkPhone),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-work-phone'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['WorkTelNo'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'work-phone','sourceValue':sWorkPhone,'trisysField':'WorkTelNo'});else lstHideRows['push']('#'+sFieldPrefix+'work-phone-row');if(sWorkMobile)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-work-mobile'),'g'),sWorkMobile),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-work-mobile'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['WorkMobileTelNo'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'work-mobile','sourceValue':sCompanyName,'trisysField':'WorkMobileTelNo'}),lstSetCopyCheckBox['push'](sCopyPrefix+'work-mobile');else lstHideRows['push']('#'+sFieldPrefix+'work-mobile-row');if(sPersonalEMail)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-personal-email'),'g'),sPersonalEMail),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-personal-email'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['PersonalEMail'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'personal-email','sourceValue':sPersonalEMail,'trisysField':'PersonalEMail'});else lstHideRows['push']('#'+sFieldPrefix+'personal-email-row');if(sPersonalMobile)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-personal-mobile'),'g'),sPersonalMobile),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-personal-mobile'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['MobileTelNo'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'personal-mobile','sourceValue':sPersonalMobile,'trisysField':'MobileTelNo'});else lstHideRows['push']('#'+sFieldPrefix+'personal-mobile-row');if(sHomePhone)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-home-phone'),'g'),sHomePhone),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-home-phone'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['HomeAddressTelNo'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'home-phone','sourceValue':sHomePhone,'trisysField':'HomeTelNo'});else lstHideRows['push']('#'+sFieldPrefix+'home-phone-row');if(sAddress){var fnLocation=function(sStreet,sCity,sCounty,sPostCode,sCountry){var s=sStreet?sStreet:'';return s+=s['length']>0x0&&sCity?',\x20'+sCity:'',s+=s['length']>0x0&&sCounty?',\x20'+sCounty:'',s+=s['length']>0x0&&sPostCode?',\x20'+sPostCode:'',s+=s['length']>0x0&&sCountry?',\x20'+sCountry:'',s;},sLocation=fnLocation(primaryContactDetails['Contact']['CompanyAddressStreet'],primaryContactDetails['Contact']['CompanyAddressCity'],primaryContactDetails['Contact']['CompanyAddressCounty'],primaryContactDetails['Contact']['CompanyAddressPostCode'],primaryContactDetails['Contact']['CompanyAddressCountry']);primaryContactDetails['Contact']['ContactType']=='Candidate'&&(sLocation=fnLocation(primaryContactDetails['Contact']['HomeAddressStreet'],primaryContactDetails['Contact']['HomeAddressCity'],primaryContactDetails['Contact']['HomeAddressCounty'],primaryContactDetails['Contact']['HomeAddressPostCode'],primaryContactDetails['Contact']['HomeAddressCountry'])),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-location'),'g'),fnTriSysFieldValue(sAddress)),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-location'),'g'),fnTriSysFieldValue(sLocation)),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'location','sourceValue':sAddress,'trisysField':'Location'});}else lstHideRows['push']('#'+sFieldPrefix+'location-row');if(sTwitter){var sTriSysTwitter=$('#popup-contact-twitter-hyperlink')['attr']('href');sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-twitter'),'g'),sTwitter),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-twitter'),'g'),fnTriSysFieldValue(sTriSysTwitter)),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'twitter','sourceValue':sTwitter,'trisysField':'Twitter'});}else lstHideRows['push']('#'+sFieldPrefix+'twitter-row');if(sSkype)sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-skype'),'g'),sSkype),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-skype'),'g'),fnTriSysFieldValue(primaryContactDetails['Contact']['SkypeNumber'])),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'skype','sourceValue':sSkype,'trisysField':'Skype'});else lstHideRows['push']('#'+sFieldPrefix+'skype-row');if(sWebSite){var sTriSysWebsite=$('#popup-contact-website-hyperlink')['attr']('href');sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'source-website'),'g'),sWebSite),sMessage=sMessage['replace'](new RegExp(fnField(sFieldPrefix+'trisys-website'),'g'),fnTriSysFieldValue(sTriSysWebsite)),lstSetCopyCheckBox['push']({'checkBoxId':sCopyPrefix+'website','sourceValue':sWebSite,'trisysField':'WebSite'});}else lstHideRows['push']('#'+sFieldPrefix+'website-row');var fnApply=function(){var copyFields={},iFieldCount=0x0;lstSetCopyCheckBox['forEach'](function(item){var bCopy=TriSysSDK['CShowForm']['GetCheckBoxValue'](item['checkBoxId']);if(bCopy){iFieldCount+=0x1;var sValue=item['sourceValue'],sId=item['checkBoxId']['replace']('-copy-','-source-'),txt=$('#'+sId);if(txt['attr']('type')=='text')sValue=txt['val']();sId=='extension-apply-changes-source-contact-type'&&(sValue=TriSysSDK['CShowForm']['GetTextFromCombo'](sId),TriSysExtension['Cache']['SetDefaultContactType'](sValue)),copyFields[item['trisysField']]=sValue;}});if(iFieldCount>0x0)return TriSysExtension['SubmitApplyChanges'](copyFields,options['newContact'],options['callback']);else TriSysApex['UI']['ShowMessage']('Please\x20select\x20at\x20least\x20one\x20field\x20to\x20copy.');},fnCancel=function(){return!![];};Platformix['Modals']['QuickShow']({'Title':sTitle,'Buttons':[{'Caption':'Update\x20TriSys','Callback':fnApply},{'Caption':'Cancel','Callback':fnCancel}],'HTML':sMessage,'Width':0x1ea,'OpenedCallback':function(){lstHideRows['forEach'](function(sId){$(sId)['hide']();}),lstShowRows['forEach'](function(sId){$(sId)['show']();}),lstSetCopyCheckBox['forEach'](function(item){TriSysSDK['CShowForm']['SetCheckBoxValue'](item['checkBoxId'],!![]);}),options['disabledElements']&&options['disabledElements']['forEach'](function(sId){$('#'+sId)['attr']('disabled','disabled');}),TriSysExtension['LoadContactTypeWidgets'](sContactType);}});},'SubmitApplyChanges':function(CSocialNetworkProfileUpdateContactRequest,bNewContact,fnCreateNewContact){var lContactId=0x0,contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails&&contactDetails['Contact'])lContactId=contactDetails['Contact']['ContactId'];if(lContactId<=0x0&&!bNewContact)return TriSysApex['UI']['ShowMessage']('You\x20must\x20first\x20create\x20a\x20new\x20contact\x20from\x20this\x20profile.'),![];if(bNewContact)return TriSysApex['UI']['ShowWait'](null,'Creating\x20Contact...'),fnCreateNewContact(CSocialNetworkProfileUpdateContactRequest),!![];CSocialNetworkProfileUpdateContactRequest['ContactId']=lContactId,TriSysApex['UI']['ShowWait'](null,'Updating\x20Contact...');var payloadObject={};return payloadObject['URL']='SocialNetwork/UpdateContact',payloadObject['OutboundDataPacket']=CSocialNetworkProfileUpdateContactRequest,payloadObject['InboundDataFunction']=function(CSocialNetworkProfileUpdateContactResponse){TriSysApex['UI']['HideWait']();if(CSocialNetworkProfileUpdateContactResponse){if(CSocialNetworkProfileUpdateContactResponse['Success']){TriSysExtension['OpenContactFormAndFocusOnTab'](lContactId,!![]),TriSysApex['Toasters']['Information']('Updated\x20Contact\x20Record'),TriSysExtension['Refresh']();return;}}else TriSysExtension['ShowMessage']('Error');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysExtension['ShowMessage']('TriSysExtension.SubmitApplyChanges:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];},'Refresh':function(bShowWait){var fnRefresh=function(){var personalDetails=null;TriSysExtension['isOfficeAddInWebServerComponent']()?personalDetails=TriSysExtension['_PersonalDetailsCopyForRefreshAfterCreateContact']:($('#trisys-extension-popup-header')['hide'](),personalDetails=TriSysExtension['ParseCommandLineForPersonalDetails']()),TriSysExtension['ShowProfileAfterCheckingConnectionStatus'](personalDetails);};if(bShowWait){var iSeconds=0x1;TriSysApex['UI']['ShowWait'](null,'Refreshing...'),setTimeout(function(){TriSysApex['UI']['HideWait']();},iSeconds*0x3e8),setTimeout(fnRefresh,0xa);}else fnRefresh();},'OpenRequirementForm':function(lRequirementId){lRequirementId>0x0&&(TriSysApex['InterprocessCommunication']['ClientOpenForm']('Requirement',lRequirementId),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('Requirement:\x20'+lRequirementId+'\x20has\x20been\x20opened\x20in\x20TriSys'));},'OpenPlacementForm':function(lPlacementId){lPlacementId>0x0&&(TriSysApex['InterprocessCommunication']['ClientOpenForm']('Placement',lPlacementId),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('Placement:\x20'+lPlacementId+'\x20has\x20been\x20opened\x20in\x20TriSys'));},'OpenTaskForm':function(lTaskId){if(lTaskId>0x0){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();contactDetails&&contactDetails['Contact']&&(contactDetails['Contact']['ContactId']>0x0&&(TriSysApex['InterprocessCommunication']['ClientTaskAutomation'](lTaskId,contactDetails['Contact'],![]),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('Task\x20['+lTaskId+']\x20has\x20been\x20opened\x20in\x20TriSys')));}},'ViewNoteHistoryTasks':function(){TriSysExtension['ViewTasks'](![]);},'ViewScheduledTasks':function(){TriSysExtension['ViewTasks'](!![]);},'ViewTasks':function(bScheduled){TriSysExtension['OpenContactForm']();},'ClosePopupWindow':function(){var extensionObject={'Type':TriSysApex['InterprocessCommunication']['MessageType_TriSysToBrowser'],'Instruction':TriSysApex['InterprocessCommunication']['CloseBrowserPopupWindow']};parent['postMessage'](extensionObject,'*');},'Login':function(){var options={'Title':'Login','ForgottenPassword':TriSysExtension['ForgottenPassword'],'Register':TriSysExtension['SignUp'],'PostLoginCallback':function(){var informationRow=$('#trisys-extension-popup-information');informationRow['hide'](),TriSysExtension['_OfficeAddInCallbackFunctionForAfterWeLogin']?(TriSysExtension['_OfficeAddInCallbackFunctionForAfterWeLogin'](),TriSysExtension['_OfficeAddInCallbackFunctionForAfterWeLogin']=null):TriSysExtension['Refresh'](![],!![]);},'RememberMe':{'Visible':![],'Default':!![]},'SubscriberLogin':!![]};TriSysApex['LoginCredentials']['Login'](options);},'LogOff':function(){TriSysApex['LoginCredentials']['Logoff'](function(){TriSysApex['UI']['ShowMessage']('You\x20have\x20been\x20logged\x20off.',null,function(){return TriSysExtension['ShowContactProfileWidgets'](),!![];},'OK',!![]);},![],!![]);},'RequestPassword':function(){var sURL='https://support.trisys.co.uk/?ForgottenPassword';window['open'](sURL,'_blank');},'ContactSupport':function(){var sURL='https://support.trisys.co.uk/?SupportServices';window['open'](sURL,'_blank');},'ForgottenPassword':function(){var sURL='https://support.trisys.co.uk/?ForgottenPassword';window['open'](sURL,'_blank');},'FreeTrial':function(){var sURL='https://apex.trisys.co.uk/#freetrial';window['open'](sURL,'_blank');},'SignUp':function(){var bOutlookAddIn=TriSysExtension['isOfficeAddInWebServerComponent'](),sURL='https://www.trisys.co.uk/'+(bOutlookAddIn?'outlook-add-in':'browser-extension');window['open'](sURL,'_blank');},'AuthenticateAgainstCRM':function(sCompany,sEMail,sPassword,fnCallback){var CBrowserExtensionCredentialsRequest={'CompanyName':sCompany,'EMail':sEMail,'Password':sPassword},payloadObject={};payloadObject['URL']='Customer/BrowserExtensionCredentials',payloadObject['OutboundDataPacket']=CBrowserExtensionCredentialsRequest,payloadObject['InboundDataFunction']=function(CBrowserExtensionCredentialsResponse){TriSysExtension['SettingsMessage'](''),CBrowserExtensionCredentialsResponse&&(CBrowserExtensionCredentialsResponse['Success']?TriSysExtension['AuthenticateAgainstWebAPI'](CBrowserExtensionCredentialsResponse,sEMail,sPassword,fnCallback):TriSysExtension['SettingsMessage'](CBrowserExtensionCredentialsResponse['ErrorMessage']));},payloadObject['ErrorHandlerFunction']=function(request,status,error){var sError='TriSysExtension.AuthenticateAgainstCRM:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'];TriSysExtension['SettingsMessage'](sError);},TriSysExtension['SettingsMessage']('Authenticating...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AuthenticateAgainstWebAPI':function(CBrowserExtensionCredentialsResponse,sEMail,sPassword,fnCallback){if(CBrowserExtensionCredentialsResponse['WebAPIEndPoint'])TriSysAPI['Constants']['SecureURL']=CBrowserExtensionCredentialsResponse['WebAPIEndPoint'];if(CBrowserExtensionCredentialsResponse['SiteKey'])TriSysAPI['Session']['SetDeveloperSiteKey'](CBrowserExtensionCredentialsResponse['SiteKey']);var CSecurityControllerAuthenticateTriSysCRMCredentials={'FullName':sEMail,'Password':sPassword},fnCallbackOnAuth=function(sDataServicesKey){fnCallback(CBrowserExtensionCredentialsResponse,sDataServicesKey);},fnIncorrectCredentials=function(sMessage){TriSysExtension['SettingsMessage'](sMessage);};TriSysAPI['Authentication']['Login'](CSecurityControllerAuthenticateTriSysCRMCredentials,function(bAuthenticated,sDataServicesKey){if(bAuthenticated)fnCallbackOnAuth(sDataServicesKey);else fnIncorrectCredentials('Incorrect\x20login\x20credentials');});},'SettingsMessage':function(sMessage){$('#trisys-extension-save-settings-error')['html'](sMessage),$('#trisys-extension-save-settings-error-buttons')['show']();},'AboutPopupWindow':function(){var fnAsyncCall=function(){var loggedInUserSubscriberContact=TriSysApex['LoginCredentials']['Cache']['ReadLoggedInUserSubscriber'](),sFullName='',sCompany='';loggedInUserSubscriberContact&&(sFullName=loggedInUserSubscriberContact['FullName'],sCompany=loggedInUserSubscriberContact['CompanyName']);var sMessage=''+'<table\x20style=\x22width:\x20100%;\x20margin:\x200px;\x20font-size:\x2012px;\x20line-height:\x201.75;\x22>'+'\x09<tbody>'+'\x09\x09<tr>'+'\x09\x09\x09<td\x20style=\x22width:\x2080px;\x22>'+'\x09\x09\x09\x09<strong>Version</strong>'+'\x09\x09\x09</td>'+'\x09\x09\x09<td>'+TriSysExtension['Version']+'\x09\x09\x09</td>'+'\x09\x09</tr>'+'\x09\x09<tr>'+'\x09\x09\x09<td\x20style=\x22width:\x2080px;\x22>'+'\x09\x09\x09\x09<strong>Name</strong>'+'\x09\x09\x09</td>'+'\x09\x09\x09<td>'+sFullName+'\x09\x09\x09</td>'+'\x09\x09</tr>'+'\x09\x09<tr>'+'\x09\x09\x09<td\x20style=\x22width:\x2080px;\x22>'+'\x09\x09\x09\x09<strong>Company</strong>'+'\x09\x09\x09</td>'+'\x09\x09\x09<td>'+sCompany+'\x09\x09\x09</td>'+'\x09\x09</tr>'+'\x09</tbody>'+'</table>';TriSysExtension['ShowMessage'](sMessage);};fnAsyncCall();},'Help':function(){var bOutlookAddIn=TriSysExtension['isOfficeAddInWebServerComponent'](),sURL=bOutlookAddIn?'https://www.trisys.co.uk/outlook-add-in':'https://www.trisys.co.uk/browser-extension';window['open'](sURL,'_blank');},'ShowMessage':function(sMessage){try{TriSysApex['UI']['ShowMessage'](sMessage);}catch(e){}},'TweakModalPopup':function(iWait,fnExtra){var fnTweak=function(){$('.modal-content')['height'](0x15e),$('#trisys-modal-dialogue')['width'](0x13b),$('#trisys-modal-dialogue')['css']('top','100px'),$('.modal-content')['width'](0x13b),$('.modal-footer')['css']('bottom','295px'),$('#trisys-modal-dynamic-content')['width'](0x13b),$('#trisys-modal-dynamic-content')['css']('padding-top','20px'),$('#trisys-modal-dynamic-content')['css']('padding-left','10px'),$('#trisys-modal-dynamic-content')['css']('padding-right','10px');if(fnExtra)fnExtra();};if(!iWait)iWait=0x19;setTimeout(fnTweak,iWait);},'FocusOnApexBrowserTab':function(){var sDefaultURL='https://apex.trisys.co.uk/*',payloadObject={};payloadObject['URL']='OfficeAutomation/ActiveTabURL',payloadObject['InboundDataFunction']=function(CActiveTabURLResponse){if(CActiveTabURLResponse){if(CActiveTabURLResponse['Success'])sDefaultURL=CActiveTabURLResponse['URL'];}var extensionObject={'Type':TriSysApex['InterprocessCommunication']['MessageType_TriSysToBrowser'],'Instruction':TriSysApex['InterprocessCommunication']['ActivateApexTab'],'URL':sDefaultURL};parent['postMessage'](extensionObject,'*');},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'LoadPrimaryContactDetailsInPopupWindow':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();contactDetails&&(TriSysExtension['DisplayContactDetails'](contactDetails,'popup-',!![]),TriSysExtension['ShowContactProfileWidgets'](null));},'LoadSecondaryContactDetailsInPopupWindow':function(){var contactDetails=TriSysExtension['Cache']['GetSecondaryContactDetails']();contactDetails&&TriSysExtension['DisplaySecondaryContactDetails'](contactDetails);},'AddNewContact':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails&&contactDetails['Contact']){if(contactDetails['Contact']['ContactId']>0x0){TriSysExtension['ShowMessage']('Contact\x20already\x20exists\x20in\x20your\x20CRM\x20database.');return;}var fnAsyncCall=function(CSocialNetworkProfileCreateContactRequest){var payloadObject={};payloadObject['URL']='SocialNetwork/CreateContact',payloadObject['OutboundDataPacket']=CSocialNetworkProfileCreateContactRequest,payloadObject['InboundDataFunction']=function(CSocialNetworkProfileCreateContactResponse){TriSysApex['UI']['HideWait']();if(CSocialNetworkProfileCreateContactResponse){if(CSocialNetworkProfileCreateContactResponse['Success']){TriSysApex['Toasters']['Information']('Added\x20new\x20contact\x20to\x20TriSys'),TriSysExtension['OpenContactFormAndFocusOnTab'](CSocialNetworkProfileCreateContactResponse['ContactId'],!![]),TriSysExtension['Refresh']();return;}else TriSysExtension['ShowMessage'](CSocialNetworkProfileCreateContactResponse['ErrorMessage']);}else TriSysExtension['ShowMessage']('Error');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysExtension['ShowMessage']('TriSysExtension.AddNewContact:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},fnUploadPhotoBeforeCommencingContactRecordCreation=function(){contactDetails['Photo']=contactDetails['ContactPhoto'],TriSysExtension['Cache']['SetContactDetails'](contactDetails),TriSysApex['UI']['HideWait'](),TriSysExtension['ApplyChanges']({'newContact':!![],'title':'Add\x20New\x20Contact','callback':fnAsyncCall});};TriSysApex['UI']['ShowWait'](null,'Adding\x20New\x20Contact...'),TriSysExtension['CheckConnectionStatus'](fnUploadPhotoBeforeCommencingContactRecordCreation);}},'AssignToExistingContact':function(lContactId,sFullName){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails){if(contactDetails['Contact']&&contactDetails['Contact']['ContactId']>0x0){TriSysExtension['ShowMessage']('Contact\x20already\x20exists\x20in\x20your\x20CRM\x20database.');return;}TriSysExtension['DisplayMatchingContacts']([]);var sName=contactDetails['FullName'];if(contactDetails['GMail'])sName=contactDetails['GMail']['FullName'];if(sName)sName=sName['replace'](/\s+/g,'\x20')['trim']();var fnLookupName=function(sFullName,lContactId){if(!sFullName)return;contactDetails['FullName']=sFullName;var fnAsyncCall=function(){TriSysApex['UI']['ShowWait'](null,'Looking\x20Up\x20Contacts...');var CSocialNetworkProfileContactMatchRequest=contactDetails,payloadObject={};payloadObject['URL']='SocialNetwork/MatchingContacts',payloadObject['OutboundDataPacket']=CSocialNetworkProfileContactMatchRequest,payloadObject['InboundDataFunction']=function(CSocialNetworkProfileContactMatchResponse){TriSysApex['UI']['HideWait']();if(CSocialNetworkProfileContactMatchResponse){if(CSocialNetworkProfileContactMatchResponse['Success']){var parsedAccordionRow=$('#trisys-extension-parsed-panel'),accordionRow=$('#trisys-extension-accordion-panel'),duplicatesRow=$('#trisys-extension-popup-duplicate-contacts');parsedAccordionRow['hide'](),accordionRow['hide'](),duplicatesRow['show'](),TriSysExtension['DisplayMatchingContacts'](CSocialNetworkProfileContactMatchResponse['Contacts'],sFullName);return;}}else TriSysExtension['ShowMessage']('Error');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysExtension['ShowMessage']('TriSysExtension.AssignToExistingContact:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);};return TriSysExtension['CheckConnectionStatus'](fnAsyncCall),!![];};if(lContactId>0x0)contactDetails['ContactId']=lContactId,fnLookupName(sFullName,lContactId);else{var options={'Label':'Name','Value':sName,'ButtonLabel':'Search','Instructions':'Lookup\x20all\x20contact\x20records\x20in\x20TriSys\x20which\x20match\x20this\x20name:'};TriSysApex['ModalDialogue']['New']['Popup']('Lookup\x20Contact','gi-search',fnLookupName,options);}}},'DisplayMatchingContacts':function(contacts,sName){var counterElement=$('#matching-contacts-count');if((!contacts||contacts['length']==0x0)&&sName){counterElement['text']('No'),TriSysExtension['ShowMessage']('No\x20matching\x20contacts\x20for:\x20'+sName);return;}contacts&&(counterElement['text'](TriSysSDK['Numbers']['ThousandsSeparator'](contacts['length'])),contacts['forEach'](function(contact){contact['ContactTypeAndIdLabel']=contact['ContactType']+'\x20:\x20'+contact['ContactId'];}));var directives={'hyperlink':{'onclick':function(params){return'TriSysExtension.AssignProfileToContact('+this['ContactId']+')';}},'openContactRecord':{'onclick':function(params){return'TriSysExtension.OpenContactFormAndFocusOnTab('+this['ContactId']+')';}},'Photo':{'src':function(params){var sPhoto=this['ContactPhoto'];if(!sPhoto)sPhoto=TriSysApex['Constants']['DefaultContactImage'];return sPhoto;}}};$('.trisys-duplicate-contacts-tbody')['render'](contacts,directives);},'AssignProfileToContact':function(lContactId){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails){var duplicatesRow=$('#trisys-extension-popup-duplicate-contacts');duplicatesRow['hide'](),TriSysApex['UI']['ShowWait'](null,'Reading\x20Contact...');var fnAsyncCall=function(){var CSocialNetworkProfileReadContactRequest={'ContactId':lContactId},payloadObject={};payloadObject['URL']='SocialNetwork/ReadContact',payloadObject['OutboundDataPacket']=CSocialNetworkProfileReadContactRequest,payloadObject['InboundDataFunction']=function(CSocialNetworkProfileReadContactResponse){TriSysApex['UI']['HideWait']();if(CSocialNetworkProfileReadContactResponse){if(CSocialNetworkProfileReadContactResponse['Success']){TriSysExtension['Cache']['SetContactDetails'](CSocialNetworkProfileReadContactResponse),TriSysExtension['ApplyChanges']({'title':'Assign\x20to\x20Existing\x20Contact','disabledElements':['extension-apply-changes-copy-public-profile-url']});return;}}TriSysApex['UI']['errorAlert']('Expected\x20to\x20identify\x20a\x20contact,\x20but\x20this\x20failed.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait']();var sError='TriSysExtension.AssignProfileToContact:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'];TriSysApex['UI']['errorAlert'](sError);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);};TriSysExtension['CheckConnectionStatus'](fnAsyncCall);}},'AddNewNote':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails){if(contactDetails['Contact']['ContactId']>0x0)TriSysApex['InterprocessCommunication']['ClientTaskAutomation'](0x0,contactDetails['Contact'],![]),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('A\x20new\x20note\x20has\x20been\x20opened\x20in\x20TriSys');else TriSysExtension['ShowMessage']('Contact\x20does\x20not\x20exist\x20in\x20your\x20CRM\x20database.');}},'AddScheduledTask':function(){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails){if(contactDetails['Contact']['ContactId']>0x0)TriSysApex['InterprocessCommunication']['ClientTaskAutomation'](0x0,contactDetails['Contact'],!![]),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('A\x20new\x20scheduled\x20task\x20has\x20been\x20opened\x20in\x20TriSys');else TriSysExtension['ShowMessage']('Contact\x20does\x20not\x20exist\x20in\x20your\x20CRM\x20database.');}},'AddToShortlist':function(){TriSysExtension['Actions']['RunAction']('AddContactToShortlist');},'Actions':{'RunAction':function(sActionID){var contactDetails=TriSysExtension['Cache']['GetContactDetails']();if(contactDetails){if(contactDetails['Contact']['ContactId']>0x0){var lContactId=contactDetails['Contact']['ContactId'];TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['InterprocessCommunication']['ContactActionAutomation'](lContactId,sActionID),TriSysApex['Toasters']['Information']('The\x20['+sActionID+']\x20action\x20has\x20been\x20invoked\x20in\x20TriSys');}else TriSysExtension['ShowMessage']('Contact\x20does\x20not\x20exist\x20in\x20your\x20CRM\x20database.');}},'Call':function(){TriSysExtension['Actions']['RunAction']('Call');},'EMail':function(){TriSysExtension['Actions']['RunAction']('EMail');},'MailMerge':function(){TriSysExtension['Actions']['RunAction']('MailMerge');},'Meeting':function(){TriSysExtension['Actions']['RunAction']('Meeting');},'Note':function(){TriSysExtension['Actions']['RunAction']('Note');},'SMSText':function(){TriSysExtension['Actions']['RunAction']('SendSMSText');},'ToDo':function(){TriSysExtension['Actions']['RunAction']('ToDo');}},'Cache':{'_Data':[{'id':0x0,'json':null},{'id':0x1,'json':null}],'GetContactDetails':function(){var sJSON=TriSysExtension['Cache']['_Data'][0x0]['json'],details=JSON['parse'](sJSON);if(details){if(!details['Photo'])details['Photo']=details['ContactPhoto'];}return details;},'SetContactDetails':function(details){var sJSON=JSON['stringify'](details);TriSysExtension['Cache']['_Data'][0x0]['json']=sJSON;},'GetSecondaryContactDetails':function(){var sJSON=TriSysExtension['Cache']['_Data'][0x1]['json'],details=JSON['parse'](sJSON);return details;},'SetSecondaryContactDetails':function(details){var sJSON=JSON['stringify'](details);TriSysExtension['Cache']['_Data'][0x1]['json']=sJSON;},'GetDefaultContactType':function(){var sContactType=TriSysAPI['Persistence']['Read']('DefaultContactType');if(!sContactType)sContactType='Client';return sContactType;},'SetDefaultContactType':function(sContactType){TriSysAPI['Persistence']['Write']('DefaultContactType',sContactType);}},'OpenProfilePicture':function(sImageId,sNameId){var sURL=$('#'+sImageId)['attr']('src');if(sURL){var sName=$('#'+sNameId)['text']();TriSysApex['Pages']['FileManagerForm']['OpenDocumentViewer'](sURL,sName,'image');}},'LookupCompany':function(){var companyNameElement=$('#extension-apply-changes-source-company-name'),sCompanyName=companyNameElement['val'](),fnDisplayCompany=function(companyRow){if(companyRow){var sCompany=companyRow['Company_Name'];return companyNameElement['val'](sCompany),!![];}};TriSysApex['ModalDialogue']['Companies']['Select'](sCompanyName,fnDisplayCompany);},'LookupJobTitle':function(){var jobTitleElement=$('#extension-apply-changes-source-job-title'),sJobTitle=jobTitleElement['val'](),fnDisplayJobTitle=function(jobTitleRow){if(jobTitleRow){var sJobTitle=jobTitleRow['JobTitle'];return jobTitleElement['val'](sJobTitle),!![];}};TriSysApex['ModalDialogue']['JobTitle']['SelectMultiple'](sJobTitle,fnDisplayJobTitle,{'singleSelect':!![]});},'LookupLocation':function(){var companyNameElement=$('#extension-apply-changes-source-company-name'),locationElement=$('#extension-apply-changes-source-location'),sCompanyName=companyNameElement['val'](),fnDisplayCompanyAddress=function(companyAddressRow){if(companyAddressRow){var sAddress=companyAddressRow['FullAddress'];return locationElement['val'](sAddress),!![];}};TriSysApex['ModalDialogue']['CompanyAddress']['Select'](sCompanyName,fnDisplayCompanyAddress);},'ShowAttachments':function(attachments,bContactFound){$('#popup-attachments-id')['text'](''),$('#popup-attachments-id')['hide']();var sRowId=bContactFound?'#accordion-panelbar-attachments-li':'#parsed-contact-attachments-tr',sTableID=bContactFound?'trisys-attachments-tbody':'parsed-attachments-tbody';if(!attachments)attachments=[];attachments['length']==0x0?$(sRowId)['hide']():$(sRowId)['show']();if(attachments['length']>0x0){$('#popup-attachments-id')['text'](attachments['length']),$('#popup-attachments-id')['show']();try{var attachmentData=[];for(var i=0x0;i<attachments['length'];i++){var attachment=attachments[i],attachmentObject=JSON['parse'](JSON['stringify'](attachment));attachmentObject['FileName']=attachment['Name'];var sFileType=TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImageFromFilePath'](attachmentObject['FileName']);attachmentObject['FileIcon']=TriSysApex['Pages']['FileManagerForm']['ImagePathForFileType'](sFileType);var lstAllowed=['word','acrobat'],bAddToList=lstAllowed['indexOf'](sFileType)>=0x0;if(bAddToList)attachmentData['push'](attachmentObject);}$('#popup-attachments-id')['text'](attachmentData['length']);var directives={'parse-cv-button':{'onclick':function(params){var sFileName=this['FileName'];return sFileName=sFileName['replace'](/'/g,'\x5c\x27'),sFileName=sFileName['replace'](/"/g,'\x5c\x22'),'TriSysExtension.OpenCVAutoRecognitionForm(\x27'+sFileName+'\x27)';}},'FileIcon':{'src':function(params){return this['FileIcon'];}}};$('.'+sTableID)['render'](attachmentData,directives),$('.'+sTableID)['show']();}catch(e){}if(!bContactFound){var parsedPanel=$('#trisys-extension-parsed-panel');parsedPanel['show'](),$('#parsed-contact-personal-email-tr')['hide'](),$('#parsed-contact-details')['show']();}}},'OpenCVAutoRecognitionForm':function(sFileName){var fnStartCVAR=function(sFolderFilePath){TriSysApex['InterprocessCommunication']['CVAutoRecognitionAutomation'](sFolderFilePath,sFileName),TriSysExtension['FocusOnApexBrowserTab'](),TriSysApex['Toasters']['Information']('The\x20CV\x20'+sFileName+'\x20is\x20now\x20being\x20parsed\x20in\x20TriSys');},fnFileUploadedCallback=function(sUploadedPath){TriSysExtension['UploadCV'](sUploadedPath,fnStartCVAR);},fnCallback=function(sBase64){TriSysExtension['UploadAttachment'](sBase64,sFileName,fnFileUploadedCallback);};TriSysExtension['DownloadOutlookAttachment'](sFileName,fnCallback);},'UploadCV':function(sFilePath,fnCallback){var payloadObject={};payloadObject['URL']='Files/MoveUploadedFileReferenceDocument',payloadObject['OutboundDataPacket']={'UploadedFilePath':sFilePath,'SubFolder':'Incoming\x20CVs'},payloadObject['InboundDataFunction']=function(JSONdataset){TriSysApex['UI']['HideWait']();if(JSONdataset){if(JSONdataset['Success']){var sFilePath=JSONdataset['FolderFilePath'];fnCallback(sFilePath);}else TriSysApex['UI']['errorAlert'](JSONdataset['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('TriSysExtension.UploadCV:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFilePath);TriSysApex['UI']['ShowWait'](null,'Copying\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'UploadAttachment':function(sBase64,sFileName,fnCallback){var CFileStreamWriteRequest={'Base64Text':sBase64,'FileName':sFileName,'RetainFileName':!![]},payloadObject={};payloadObject['URL']='Files/UploadBase64Stream',payloadObject['OutboundDataPacket']=CFileStreamWriteRequest,payloadObject['InboundDataFunction']=function(CFileStreamWriteResponse){TriSysApex['UI']['HideWait']();if(CFileStreamWriteResponse){if(CFileStreamWriteResponse['Success']){fnCallback(CFileStreamWriteResponse['FilePath']);return;}else TriSysApex['UI']['ShowMessage'](CFileStreamWriteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysExtension.UploadAttachment:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Uploading\x20'+sFileName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DownloadOutlookAttachment':function(sFileName,fnCallback){var item=Office['context']['mailbox']['item'];item&&(item['attachments']['length']>0x0&&item['attachments']['forEach'](function(attachment){if(attachment['name']==sFileName){var options={'asyncContext':{'type':attachment['attachmentType']}};item['getAttachmentContentAsync'](attachment['id'],options,function(result){if(result['status']==Office['AsyncResultStatus']['Succeeded']){var AttachmentContent=result['value'];if(AttachmentContent['format']==Office['MailboxEnums']['AttachmentContentFormat']['Base64'])fnCallback(AttachmentContent['content']);else{if(result['format']==Office['MailboxEnums']['AttachmentContentFormat']['Eml']){}else{}}}else{var err=result['error'];TriSysApex['Toasters']['Error']('Download\x20failed:\x20'+err['name']+':\x20'+err['message']);}});}}));},'TweakDimensionsOfOutlookAddIn':function(){var sHeight=$(window)['height']()-0x1e+'px';$('#parsed-contact-details')['css']('height',sHeight);var iContactDetailsHeightFactor=TriSysExtension['isRecruitmentDatabase']()?0x16d:0xdc;sHeight=$(window)['height']()-iContactDetailsHeightFactor+'px',$('#accordion-panelbar-contact-details-div')['css']('min-height',sHeight),$('#accordion-panelbar-contact-details-div')['css']('max-height',sHeight),$('#accordion-panelbar-contact-details-table')['css']('min-height',sHeight),$('#accordion-panelbar-contact-details-table')['css']('max-height',sHeight);var iCVPreviewHeightFactor=TriSysExtension['isRecruitmentDatabase']()?0x166:0xc8;sHeight=$(window)['height']()-iCVPreviewHeightFactor+'px',$('#cv-preview')['css']('max-height',sHeight),$('#requirements')['css']('max-height',sHeight),$('#accordion-panelbar-requirements-table')['css']('min-height',sHeight),$('#placements')['css']('max-height',sHeight),$('#accordion-panelbar-placements-table')['css']('min-height',sHeight),$('#accordion-panelbar-noteshistory-div')['css']('max-height',sHeight),$('#accordion-panelbar-scheduledtasks-div')['css']('max-height',sHeight),$('#accordion-panelbar-attachments-div')['css']('max-height',sHeight);var lstTables=[{'id':'accordion-panelbar-contact-details-table'},{'id':'parsed-contact-details-table','ignoreTRList':['parsed-contact-attachments-tr','looking-up-profile-in-trisys-spinner','looking-up-profile-nothing-found']}];lstTables['forEach'](function(tableSpecification){$('#'+tableSpecification['id']+'\x20tr')['each'](function(){var tr=$(this);if(tableSpecification['ignoreTRList']){if(tableSpecification['ignoreTRList']['indexOf'](this['id'])>=0x0)return;}var lstTD=[];tr['find']('td')['each'](function(){var td=$(this);lstTD['push'](td);}),tr['prepend']('<td><table>'),tr['append']('</table></td>'),tr['find']('table')['each'](function(){var table=$(this);lstTD['forEach'](function(td){td['appendTo'](table),td['wrap']('<tr></tr>'),td['attr']('style','padding-left:\x200px\x20!important;\x20padding-bottom:\x202px;');});});});});}};$(document)['ready'](function(){if(TriSysExtension['isOfficeAddInWebServerComponent']())return;TriSysExtension['Load']();});