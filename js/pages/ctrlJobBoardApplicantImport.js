var ctrlJobBoardApplicantImport={'Load':function(requirement,applicant,potentialDuplicateCandidates,sCVServerPath){$('#ctrlJobBoardApplicantImport-Requirement')['html'](requirement['Reference']),$('#ctrlJobBoardApplicantImport-JobTitle')['html'](requirement['JobTitle']),$('#ctrlJobBoardApplicantImport-JobBroadcaster')['html'](requirement['JobBroadcaster']),$('#ctrlJobBoardApplicantImport-Applicant')['html'](applicant['Name']),$('#ctrlJobBoardApplicantImport-Channel')['html'](applicant['ChannelName']);var sImage='<img\x20src=\x22images/trisys/72x72/flag-'+applicant['Flag']+'.png?ts=201803221020\x22\x20style=\x22width:\x2024px;\x20height:\x2024px;\x22\x20alt=\x22#=\x20Flag\x20#\x22>';$('#ctrlJobBoardApplicantImport-Rank')['html'](sImage),ctrlJobBoardApplicantImport['LoadFieldWidgets'](),setTimeout(TriSysProUI['kendoUI_Overrides'],0xfa),ctrlJobBoardApplicantImport['Data']['Set'](requirement,applicant,potentialDuplicateCandidates,sCVServerPath),ctrlJobBoardApplicantImport['PopulatePotentialDuplicateGrid'](potentialDuplicateCandidates),ctrlJobBoardApplicantImport['DisplayApplicantDetails'](applicant,sCVServerPath);},'LoadFieldWidgets':function(){var sFieldPrefix='ctrlJobBoardApplicantImport-form-',suffixes=['','applicant-','duplicate-'];for(var i=0x0;i<suffixes['length'];i++){var suffix=suffixes[i];TriSysSDK['CShowForm']['contactTitleFieldEditableProperties'](sFieldPrefix+suffix+'Title','Mr'),TriSysSDK['CShowForm']['PopulateGenderCombo'](sFieldPrefix+suffix+'Gender'),TriSysSDK['CShowForm']['skillCombo'](sFieldPrefix+suffix+'ContactSource','ContactSource','TBC'),TriSysSDK['CShowForm']['entityTypeMultiSelectCombo']('Requirement',sFieldPrefix+suffix+'TypeOfWorkRequired'),TriSysWebJobs['CandidateRegistration']['LoadCountryLookup'](sFieldPrefix+suffix+'Country');}ctrlJobBoardApplicantImport['InitialiseZoomSlider']('',ctrlJobBoardApplicantImport['ZoomCVViewer']);},'DisplayApplicantDetails':function(applicant,sCVServerPath){if(applicant){if(applicant['FileName'])$('#ctrlJobBoardApplicantImport-FileName')['html'](applicant['FileName']),sCVServerPath&&ctrlJobBoardApplicantImport['DisplayApplicantCV'](sCVServerPath),ctrlJobBoardApplicantImport['CommenceCVParsing'](applicant['FileName'],applicant['Doc_Text']);else{var cvBlock=$('#ctrlJobBoardApplicantImport-CVBlock');cvBlock['hide']();var applicantBlock=$('#ctrlJobBoardApplicantImport-ApplicantBlock'),duplicatesBlock=$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock'),bDuplicatesBlockHidden=duplicatesBlock['css']('display')=='none';if(bDuplicatesBlockHidden)applicantBlock['removeClass']()['addClass']('col-md-12\x20col-lg-12');}var sFieldPrefix='ctrlJobBoardApplicantImport-form-applicant-';ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Title',applicant['Title'],TriSysSDK['Controls']['FieldTypes']['SkillCombo']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Forenames',applicant['FirstName'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Surname',applicant['Surname'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('MobileTelNo',applicant['MobileTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('WorkTelNo',applicant['WorkTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('HomeTelNo',applicant['HomeTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('PersonalEMail',applicant['Email'],TriSysSDK['Controls']['FieldTypes']['Text']);}},'DisplayApplicantFieldOnlyIfBlank':function(sField,objValue,fieldType){var sFieldPrefix='ctrlJobBoardApplicantImport-form-applicant-',sValue=null;switch(fieldType){case TriSysSDK['Controls']['FieldTypes']['Text']:sValue=$('#'+sFieldPrefix+sField)['val']();if(!sValue)$('#'+sFieldPrefix+sField)['val'](objValue);break;case TriSysSDK['Controls']['FieldTypes']['SkillCombo']:sValue=TriSysSDK['CShowForm']['GetTextFromCombo'](sFieldPrefix+sField);if(!objValue)TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+sField,objValue);break;case TriSysSDK['Controls']['FieldTypes']['Date']:var dt=moment(objValue)['format']('DD\x20MMM\x20YYYY');if(dt['indexOf']('0001')<0x0)$('#'+sFieldPrefix+sField)['val'](dt);break;}},'DisplayApplicantCV':function(sCVServerPath){var sDiv='ctrlJobBoardApplicantImport-document-viewer-converted-contents';ctrlJobBoardApplicantImport['WaitingProgressSpinner'](!![]);var bUsePDFconverter=![],bConvert=TriSysSDK['Controls']['FileManager']['isWordFile'](sCVServerPath)||bUsePDFconverter&&TriSysSDK['Controls']['FileManager']['isPDFFile'](sCVServerPath);if(!bConvert)return ctrlJobBoardApplicantImport['DisplayNonWordDocumentInViewer'](sCVServerPath),![];var CFileReferenceInternalToExternalPathRequest={'FolderFilePath':sCVServerPath},payloadObject={};payloadObject['URL']='Files/ConvertFileReferenceInternalToExternalPath',payloadObject['OutboundDataPacket']=CFileReferenceInternalToExternalPathRequest,payloadObject['InboundDataFunction']=function(CFileReferenceInternalToExternalPathResult){if(CFileReferenceInternalToExternalPathResult){if(CFileReferenceInternalToExternalPathResult['Success']){var sFileURL=CFileReferenceInternalToExternalPathResult['URL'];ctrlJobBoardApplicantImport['LoadHTMLDocumentURLIntoDiv'](sDiv,sFileURL);}else TriSysApex['UI']['errorAlert'](CFileReferenceInternalToExternalPathResult['ErrorMessage'],TriSysWeb['Constants']['ApplicationName']);}else TriSysApex['UI']['ShowMessage']('No\x20response\x20from\x20'+payloadObject['URL'],TriSysWeb['Constants']['ApplicationName']);return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ctrlJobBoardApplicantImport.DisplayApplicantCV:\x20',request,status,error,![]);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'LoadHTMLDocumentURLIntoDiv':function(sDiv,sFileURL){$('#'+sDiv)['load'](sFileURL,function(response,status,xhr){ctrlJobBoardApplicantImport['WaitingProgressSpinner'](![],!![]);if(status=='error'){var msg='Document\x20Conversion\x20Error:\x20';TriSysApex['UI']['ShowError'](null,msg+xhr['status']+'\x20'+xhr['statusText']);return;}});},'WaitingProgressSpinner':function(bVisible,bConvertedWordDocument,bPDFDocument){var sConvertedDiv='ctrlJobBoardApplicantImport-document-viewer-converted-contents',pdfViewer='ctrlJobBoardApplicantImport-document-viewer-pdf-viewer',sWaitingDiv='ctrlJobBoardApplicantImport-document-viewer-waiting',sSliderDiv='ctrlJobBoardApplicantImport-document-viewer-zoom';if(bVisible)$('#'+sConvertedDiv)['hide'](),$('#'+pdfViewer)['hide'](),$('#'+sWaitingDiv)['show'](),$('#'+sSliderDiv)['hide'](),setTimeout(TriSysProUI['kendoUI_Overrides'],0x32);else{$('#'+sWaitingDiv)['hide'](),$('#'+sSliderDiv)['hide']();if(bConvertedWordDocument)$('#'+sConvertedDiv)['show'](),$('#'+sSliderDiv)['show']();else bPDFDocument&&$('#'+pdfViewer)['show']();}},'DisplayNonWordDocumentInViewer':function(sURL){if(TriSysSDK['Controls']['FileManager']['isPDFFile'](sURL)){var pdfViewer='ctrlJobBoardApplicantImport-document-viewer-pdf-viewer',fnCallback=function(sFileURL){ctrlJobBoardApplicantImport['WaitingProgressSpinner'](![],![],!![]);var pdfViewerObject=$('#'+pdfViewer);pdfViewerObject['css']('width',ctrlJobBoardApplicantImport['GetViewerAndSliderWidth'](![],''));var sFilePathToSet=sFileURL;sFilePathToSet+=TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),pdfViewerObject['removeAttr']('data'),pdfViewerObject['attr']('data',sFilePathToSet),pdfViewerObject['clone']()['appendTo']('#ctrlJobBoardApplicantImport-cv-viewer-block'),pdfViewerObject['remove']();var pdfViewerObject=$('#'+pdfViewer);pdfViewerObject['attr']('data',sFilePathToSet);};TriSysSDK['Controls']['FileManager']['GetFileReferenceServerFilePathToExternalFilePath'](sURL,fnCallback);}},'CommenceCVParsing':function(sFileName,sBase64Text){var CParseServerCVRequest={'FileName':sFileName,'Base64Text':sBase64Text},payloadObject={};payloadObject['URL']='CVParser/ParseServerCV',payloadObject['OutboundDataPacket']=CParseServerCVRequest,payloadObject['InboundDataFunction']=function(CParseServerCVResponse){return CParseServerCVResponse&&(CParseServerCVResponse['Success']&&ctrlJobBoardApplicantImport['DisplayApplicantDetailsAfterCVParsing'](CParseServerCVResponse)),!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ctrlJobBoardApplicantImport.CommenceCVParsing:\x20',request,status,error,![]);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayApplicantDetailsAfterCVParsing':function(CParseServerCVResponse){if(CParseServerCVResponse['Demographics']){var sFieldPrefix='ctrlJobBoardApplicantImport-form-applicant-',demographics=CParseServerCVResponse['Demographics'];ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Title',demographics['Title'],TriSysSDK['Controls']['FieldTypes']['SkillCombo']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Forenames',demographics['Forenames'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Surname',demographics['Surname'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('MobileTelNo',demographics['MobileTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('WorkTelNo',demographics['WorkTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('PersonalEMail',demographics['EMail'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('Street',demographics['AddressStreet'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('City',demographics['AddressCity'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('County',demographics['AddressCounty'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('PostCode',demographics['AddressPostCode'],TriSysSDK['Controls']['FieldTypes']['Text']),TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+'Country',demographics['AddressCountry']?demographics['AddressCountry']:TriSysSDK['Countries']['DefaultCountryName']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('HomeTelNo',demographics['HomeTelNo'],TriSysSDK['Controls']['FieldTypes']['Text']),ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('JobTitle',demographics['JobTitle'],TriSysSDK['Controls']['FieldTypes']['Text']);if(demographics['DateOfBirth'])ctrlJobBoardApplicantImport['DisplayApplicantFieldOnlyIfBlank']('DateOfBirth',demographics['DateOfBirth'],TriSysSDK['Controls']['FieldTypes']['Date']);}},'PopulatePotentialDuplicateGrid':function(potentialDuplicateCandidates){if(!potentialDuplicateCandidates){$('#ctrlJobBoardApplicantImport-DuplicateBlock')['hide'](),ctrlJobBoardApplicantImport['DisplayCandidateDetails'](0x0);return;}var sDivTag='ctrlJobBoardApplicantImport-DataGrid',sGridName=sDivTag+'-GridInstance',fnRowClickHandler=function(e,gridObject,gridLayout){var selectedItem=TriSysSDK['Grid']['GetFirstGridCheckedItem'](gridObject);if(selectedItem){var lContactId=selectedItem['ContactId'];ctrlJobBoardApplicantImport['DisplayCandidateDetails'](lContactId);}},bPopulated=![],fnPostPopulationCallback=function(lRecordCount){!bPopulated&&TriSysSDK['Grid']['SelectFirstRow'](sDivTag);};TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sGridName,'Title':'Potential\x20Duplicate\x20Candidates','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':potentialDuplicateCandidates,'Columns':[{'field':'ContactId','title':'ContactId','type':'number','width':0x46,'hidden':!![]},{'field':'FullName','title':'Full\x20Name','type':'string'},{'field':'HomeAddressStreet','title':'Street','type':'string'},{'field':'HomeAddressCity','title':'City','type':'string'},{'field':'HomeAddressPostCode','title':'Post\x20Code','type':'string'},{'field':'HomeAddressTelNo','title':'Home\x20Tel.','type':'string'},{'field':'PersonalEMail','title':'Personal\x20E-Mail','type':'string'},{'field':'MobileTelNo','title':'Personal\x20Mobile\x20Tel.','type':'string'}],'KeyColumnName':'ContactId','MultiRowSelect':![],'SingleRowSelect':!![],'RowClickHandler':fnRowClickHandler,'PostPopulationCallback':fnPostPopulationCallback,'ColumnFilters':![],'Grouping':![]}),setTimeout(fnPostPopulationCallback,0x64);},'OpenSelectedDuplicateCV':function(){var candidate=ctrlJobBoardApplicantImport['GetSelectedExistingCandidate']();if(candidate){if(candidate['CVFileRef']){TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](candidate['CVFileRef']);return;}}TriSysApex['UI']['ShowMessage']('No\x20CV\x20available\x20for\x20existing\x20candidate.');},'GetSelectedExistingCandidate':function(){var lContactId=ctrlJobBoardApplicantImport['Data']['_SelectedContactId'];if(lContactId>0x0){var candidate=ctrlJobBoardApplicantImport['Data']['GetDuplicateCandidate'](lContactId);if(candidate)return candidate;}},'SelectNone':function(){var sDivTag='ctrlJobBoardApplicantImport-DataGrid',grid=$('#'+sDivTag)['data']('kendoGrid');grid['clearSelection'](),ctrlJobBoardApplicantImport['DisplayCandidateDetails'](0x0);},'DisplayCandidateDetails':function(lContactId){ctrlJobBoardApplicantImport['Data']['_SelectedContactId']=lContactId;var cvBlock=$('#ctrlJobBoardApplicantImport-CVBlock'),applicantBlock=$('#ctrlJobBoardApplicantImport-ApplicantBlock'),duplicatesBlock=$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock'),bCVBlockHidden=cvBlock['css']('display')=='none',sApplicantBlockClass=bCVBlockHidden?'col-md-8\x20col-lg-8':'col-md-4\x20col-lg-4',candidate=ctrlJobBoardApplicantImport['Data']['GetDuplicateCandidate'](lContactId);if(!candidate){duplicatesBlock['hide'](),applicantBlock['removeClass']()['addClass'](bCVBlockHidden?'col-md-12\x20col-lg-12':'col-md-8\x20col-lg-8');return;}duplicatesBlock['show'](),applicantBlock['removeClass']()['addClass'](sApplicantBlockClass);var sFieldPrefix='ctrlJobBoardApplicantImport-form-duplicate-';$('#'+sFieldPrefix+'Forenames')['val'](candidate['Forenames']),$('#'+sFieldPrefix+'Surname')['val'](candidate['Surname']),$('#'+sFieldPrefix+'MobileTelNo')['val'](candidate['MobileTelNo']),$('#'+sFieldPrefix+'WorkTelNo')['val'](candidate['WorkTelNo']),$('#'+sFieldPrefix+'PersonalEMail')['val'](candidate['PersonalEMail']),$('#'+sFieldPrefix+'WorkEMail')['val'](candidate['WorkEMail']),$('#'+sFieldPrefix+'Street')['val'](candidate['HomeAddressStreet']),$('#'+sFieldPrefix+'City')['val'](candidate['HomeAddressCity']),$('#'+sFieldPrefix+'County')['val'](candidate['HomeAddressCounty']),$('#'+sFieldPrefix+'PostCode')['val'](candidate['HomeAddressPostCode']),TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+'Country',candidate['HomeAddressCountry']?candidate['HomeAddressCountry']:TriSysSDK['Countries']['DefaultCountryName']),$('#'+sFieldPrefix+'HomeTelNo')['val'](candidate['HomeAddressTelNo']),$('#'+sFieldPrefix+'JobTitle')['val'](candidate['JobTitle']),TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+'Title',candidate['Title']),TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+'Gender',candidate['Gender']),TriSysSDK['CShowForm']['SetTextInCombo'](sFieldPrefix+'ContactSource',candidate['Source']),TriSysSDK['CShowForm']['SetSkillsInList'](sFieldPrefix+'TypeOfWorkRequired',candidate['TypeOfWork']);if(candidate['DateOfBirth']){var dtDoB=moment(candidate['DateOfBirth'])['format']('DD\x20MMM\x20YYYY');if(dtDoB['indexOf']('0001')<0x0)$('#'+sFieldPrefix+'DateOfBirth')['val'](dtDoB);}$('#'+sFieldPrefix+'ContactPhoto')['attr']('src',TriSysApex['Constants']['DefaultContactImage']);if(candidate['ContactPhoto']){var fnShowExistingPhoto=function(sFileURL){$('#'+sFieldPrefix+'ContactPhoto')['attr']('src',sFileURL);};TriSysSDK['Controls']['FileManager']['GetFileReferenceServerFilePathToExternalFilePath'](candidate['ContactPhoto'],fnShowExistingPhoto);}},'SaveApplicantAsCandidateRecord':function(){var candidate={},sFieldPrefix='ctrlJobBoardApplicantImport-form-applicant-';candidate=ctrlJobBoardApplicantImport['ReadCandidateRecordBeforeSave'](sFieldPrefix,candidate);if(!candidate)return;var fnAfterSavingCandidateRecord=function(lContactId){$('#ctrlJobBoardApplicantImport-DuplicateBlock')['hide']();var duplicatesBlock=$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock');duplicatesBlock['hide']();var cvBlock=$('#ctrlJobBoardApplicantImport-CVBlock'),bCVBlockHidden=cvBlock['css']('display')=='none',sApplicantBlockClass=bCVBlockHidden?'col-md-12\x20col-lg-12':'col-md-8\x20col-lg-8',applicantBlock=$('#ctrlJobBoardApplicantImport-ApplicantBlock');applicantBlock['removeClass']()['addClass'](sApplicantBlockClass),$('#ctrlJobBoardApplicantImport-ApplicantBlock-Buttons')['hide'](),candidate['ContactId']=lContactId,ctrlJobBoardApplicantImport['PromptToShortlistAfterSavingApplicantOrCandidate']('Create\x20New\x20Candidate',candidate);};ctrlJobBoardApplicantImport['SubmitCandidateRecord'](candidate,'Creating',fnAfterSavingCandidateRecord);},'UpdateExistingCandidateRecord':function(){var candidate=ctrlJobBoardApplicantImport['GetSelectedExistingCandidate']();if(!candidate){TriSysApex['UI']['ShowMessage']('Unidentified\x20candidate.');return;}var sFieldPrefix='ctrlJobBoardApplicantImport-form-duplicate-';candidate=ctrlJobBoardApplicantImport['ReadCandidateRecordBeforeSave'](sFieldPrefix,candidate);if(!candidate)return;candidate['UpdateCandidate']=!![];var fnAfterUpdatingCandidateRecord=function(lContactId){var applicantBlock=$('#ctrlJobBoardApplicantImport-ApplicantBlock');applicantBlock['hide'](),$('#ctrlJobBoardApplicantImport-DuplicateBlock')['hide']();var cvBlock=$('#ctrlJobBoardApplicantImport-CVBlock'),bCVBlockHidden=cvBlock['css']('display')=='none',sExistingBlockClass=bCVBlockHidden?'col-md-12\x20col-lg-12':'col-md-8\x20col-lg-8',existingBlock=$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock');existingBlock['removeClass']()['addClass'](sExistingBlockClass),$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock-Buttons')['hide'](),candidate['ContactId']=lContactId,ctrlJobBoardApplicantImport['PromptToShortlistAfterSavingApplicantOrCandidate']('Update\x20Existing\x20Candidate',candidate);};ctrlJobBoardApplicantImport['SubmitCandidateRecord'](candidate,'Updating',fnAfterUpdatingCandidateRecord);},'ReadCandidateRecordBeforeSave':function(sFieldPrefix,candidate){candidate['Forenames']=$('#'+sFieldPrefix+'Forenames')['val'](),candidate['Surname']=$('#'+sFieldPrefix+'Surname')['val'](),candidate['MobileTelNo']=$('#'+sFieldPrefix+'MobileTelNo')['val'](),candidate['WorkTelNo']=$('#'+sFieldPrefix+'WorkTelNo')['val'](),candidate['PersonalEMail']=$('#'+sFieldPrefix+'PersonalEMail')['val'](),candidate['WorkEMail']=$('#'+sFieldPrefix+'WorkEMail')['val'](),candidate['HomeAddressStreet']=$('#'+sFieldPrefix+'Street')['val'](),candidate['HomeAddressCity']=$('#'+sFieldPrefix+'City')['val'](),candidate['HomeAddressCounty']=$('#'+sFieldPrefix+'County')['val'](),candidate['HomeAddressPostCode']=$('#'+sFieldPrefix+'PostCode')['val'](),candidate['HomeAddressCountry']=TriSysSDK['CShowForm']['GetTextFromCombo'](sFieldPrefix+'Country'),candidate['HomeAddressTelNo']=$('#'+sFieldPrefix+'HomeTelNo')['val'](),candidate['JobTitle']=$('#'+sFieldPrefix+'JobTitle')['val'](),candidate['Title']=TriSysSDK['CShowForm']['GetTextFromCombo'](sFieldPrefix+'Title'),candidate['Gender']=TriSysSDK['CShowForm']['GetTextFromCombo'](sFieldPrefix+'Gender'),candidate['ContactSource']=TriSysSDK['CShowForm']['GetTextFromCombo'](sFieldPrefix+'ContactSource'),candidate['TypeOfWorkRequired']=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](sFieldPrefix+'TypeOfWorkRequired',null,!![]),candidate['DateOfBirth']=$('#'+sFieldPrefix+'DateOfBirth')['val'](),candidate['ContactPhoto']=$('#'+sFieldPrefix+'ContactPhoto')['attr']('src'),candidate['CVFileRef']=ctrlJobBoardApplicantImport['Data']['_CVServerPath'];var sValidationError=null;if(!candidate['Forenames']||!candidate['Surname'])sValidationError='must\x20have\x20a\x20full\x20name';else{if(candidate['Gender']=='')sValidationError='must\x20have\x20an\x20assigned\x20gender';}if(sValidationError)return TriSysApex['UI']['ShowMessage']('The\x20candidate\x20record\x20'+sValidationError),null;return candidate['Street']=candidate['HomeAddressStreet'],candidate['City']=candidate['HomeAddressCity'],candidate['County']=candidate['HomeAddressCity'],candidate['PostCode']=candidate['HomeAddressPostCode'],candidate['Country']=candidate['HomeAddressCountry'],candidate['HomeTelNo']=candidate['HomeAddressTelNo'],candidate['ProcessSummary']='Job\x20Board\x20Applicant\x20Import',candidate;},'PromptToShortlistAfterSavingApplicantOrCandidate':function(sWhatHappened,candidate){var fnYes=function(){return ctrlJobBoardApplicantImport['AddToShortlist'](),!![];},fnNo=function(){$('#ctrlJobBoardApplicantImport-DuplicateBlock')['hide']();var duplicatesBlock=$('#ctrlJobBoardApplicantImport-SelectedDuplicateBlock');duplicatesBlock['hide']();var applicantBlock=$('#ctrlJobBoardApplicantImport-ApplicantBlock');applicantBlock['hide']();var cvBlock=$('#ctrlJobBoardApplicantImport-CVBlock'),bCVBlockHidden=cvBlock['css']('display')=='none';if(!bCVBlockHidden)cvBlock['removeClass']()['addClass']('col-md-12\x20col-lg-12');return!![];},sMessage=candidate['Forenames']+'\x20'+candidate['Surname']+'\x20has\x20been\x20saved\x20as\x20a\x20candidate.<br\x20/>'+'Add\x20to\x20shortlist\x20now?';TriSysApex['UI']['questionYesNo'](sMessage,sWhatHappened,'Yes',fnYes,'No',fnNo);},'SubmitCandidateRecord':function(CCreateFromCVAutoRecognitionRequest,sProcess,fnCallback){var payloadObject={};payloadObject['URL']='Contact/CreateFromCVAutoRecognition',payloadObject['OutboundDataPacket']=CCreateFromCVAutoRecognitionRequest,payloadObject['InboundDataFunction']=function(CCreateFromCVAutoRecognitionResponse){TriSysApex['UI']['HideWait']();if(CCreateFromCVAutoRecognitionResponse){if(CCreateFromCVAutoRecognitionResponse['Success'])ctrlJobBoardApplicantImport['Data']['_SelectedContactId']=CCreateFromCVAutoRecognitionResponse['ContactId'],ctrlJobBoardApplicantImport['Data']['_ImportedCandidateName']=CCreateFromCVAutoRecognitionRequest['Forenames']+'\x20'+CCreateFromCVAutoRecognitionRequest['Surname'],fnCallback(CCreateFromCVAutoRecognitionResponse['ContactId']);else TriSysApex['UI']['errorAlert'](CCreateFromCVAutoRecognitionResponse['ErrorMessage']);}else{}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlJobBoardApplicantImport.SubmitCandidateRecord:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,sProcess+'\x20Candidate...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AddToShortlist':function(){var lContactId=ctrlJobBoardApplicantImport['Data']['_SelectedContactId'],sName=ctrlJobBoardApplicantImport['Data']['_ImportedCandidateName'],sJobBoard=$('#ctrlJobBoardApplicantImport-Channel')['html']();if(!sName){TriSysApex['UI']['ShowMessage']('Please\x20create\x20a\x20new\x20candidate,\x20or\x20save\x20an\x20existing\x20record\x20before\x20shortlisting.');return;}ctrlJobBoardApplicants['AddToShortlistCandidateAfterImport'](lContactId,sName,sJobBoard),TriSysApex['UI']['CloseModalPopup']();},'Data':{'_Requirement':null,'_Applicant':null,'_PotentialDuplicateCandidates':null,'_CVServerPath':null,'_SelectedContactId':0x0,'_ImportedCandidateName':null,'Set':function(requirement,applicant,potentialDuplicateCandidates,sCVServerPath){ctrlJobBoardApplicantImport['Data']['_Requirement']=requirement,ctrlJobBoardApplicantImport['Data']['_Applicant']=applicant,ctrlJobBoardApplicantImport['Data']['_PotentialDuplicateCandidates']=potentialDuplicateCandidates,ctrlJobBoardApplicantImport['Data']['_CVServerPath']=sCVServerPath;},'GetDuplicateCandidate':function(lContactId){if(ctrlJobBoardApplicantImport['Data']['_PotentialDuplicateCandidates'])for(var i=0x0;i<ctrlJobBoardApplicantImport['Data']['_PotentialDuplicateCandidates']['length'];i++){var candidate=ctrlJobBoardApplicantImport['Data']['_PotentialDuplicateCandidates'][i];if(candidate['ContactId']==lContactId)return candidate;}},'OpenApplicantCV':function(){var sCVServerPath=ctrlJobBoardApplicantImport['Data']['_CVServerPath'];sCVServerPath&&TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](sCVServerPath);}},'AllowDropPhoto':function(ev){ev['preventDefault']();},'DropPhoto':function(ev,sField){ev['preventDefault']();var sImageURL=ev['dataTransfer']['getData']('text');if(ev['dataTransfer']['files']){if(ev['dataTransfer']['files']['length']>0x0){var myFile=ev['dataTransfer']['files'][0x0],fnCallback=function(myUploadedServerFilePath){var fnDisplayImage=function(sURL){$(ev['target'])['attr']('src',sURL);};TriSysSDK['FileUpload']['AfterUploadingAFileMoveItAndGetExternalURL'](myUploadedServerFilePath,fnDisplayImage,!![]);return;sImageURL=TriSysAPI['Constants']['SecureURL']+'upload/'+myUploadedServerFilePath['replace'](/\\/g,'/'),$(ev['target'])['attr']('src',sImageURL);};TriSysSDK['Controls']['FileManager']['UploadFile'](myFile,fnCallback);return;}}$(ev['target'])['attr']('src',sImageURL);},'InitialiseZoomSlider':function(sSuffix,fnChange){var slider=$('#ctrlJobBoardApplicantImport-form-slider'+sSuffix)['kendoSlider']({'increaseButtonTitle':'Right','decreaseButtonTitle':'Left','min':0x19,'max':0x190,'smallStep':0x19,'largeStep':0x32,'change':fnChange})['data']('kendoSlider');setTimeout(ctrlJobBoardApplicantImport['KludgeSlider'],0x64);},'KludgeSlider':function(){var slider=$('#ctrlJobBoardApplicantImport-form-slider')['getKendoSlider']();slider['wrapper']['css']('width',ctrlJobBoardApplicantImport['GetViewerAndSliderWidth'](![],'')),slider['resize']();},'GetViewerAndSliderWidth':function(bReduceFactorise,sSuffix){var iWidth=$('#ctrlJobBoardApplicantImport-cv-viewer-block'+sSuffix)['width']();if(bReduceFactorise)iWidth-=0x46;return iWidth;},'ZoomCVViewer':function(e){ctrlJobBoardApplicantImport['ZoomCVViewerEventHandler'](e,'');},'ZoomCVViewerEventHandler':function(e,sSuffix){var fZoom=e['value']/0x64,lFixedHeight=0x336,viewers=['ctrlJobBoardApplicantImport-document-viewer-converted-contents'+sSuffix];for(var i=0x0;i<viewers['length'];i++){var viewer=viewers[i],viewerDOMObject=$('#'+viewer);if(viewerDOMObject['css']('display')!='none'){var lHeight=viewerDOMObject['height'](),iTime=0x190;viewerDOMObject['animate']({'zoom':fZoom,'height':lFixedHeight/fZoom},0x190);}}}};