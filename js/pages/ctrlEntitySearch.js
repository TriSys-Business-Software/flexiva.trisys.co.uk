var ctrlEntitySearch={'Load':function(sEntityName){var sForm=TriSysApex['FormsManager']['ContentDivPrefix']+sEntityName+'Search',sSuffix='-'+sEntityName;TriSysSDK['Controls']['General']['RenameElementIdsWithParentIdPrefixOrSuffix'](sForm,sEntityName,![]),$('#ctrlEntitySearch-tab-searches'+sSuffix)['off']()['on']('click',function(){TriSysSDK['EntityFormTabs']['TabContainerClickEvent']($(this),'ctrlEntitySearch-tab-panel-searches'+sSuffix,ctrlEntitySearch['TabClickEvent']);}),$('#ctrlEntitySearch-tab-search'+sSuffix)['off']()['on']('click',function(){TriSysSDK['EntityFormTabs']['TabContainerClickEvent']($(this),'ctrlEntitySearch-tab-panel-search'+sSuffix,ctrlEntitySearch['TabClickEvent']);}),$('#ctrlEntitySearch-tab-favourites'+sSuffix)['off']()['on']('click',function(){TriSysSDK['EntityFormTabs']['TabContainerClickEvent']($(this),'ctrlEntitySearch-tab-panel-favourites'+sSuffix,ctrlEntitySearch['TabClickEvent']);}),$('#ctrlEntitySearch-tab-excluded'+sSuffix)['off']()['on']('click',function(){TriSysSDK['EntityFormTabs']['TabContainerClickEvent']($(this),'ctrlEntitySearch-tab-panel-excluded'+sSuffix,ctrlEntitySearch['TabClickEvent']);}),TriSysSDK['EntityFormTabs']['AddClickEventHandlers']('ctrlEntitySearch-tab-nav-horizontal'+sSuffix,!![]);var fnChangeUsers=function(){ctrlEntitySearch['LoadSearches'](sEntityName);},userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),sUserName=userCredentials['LoggedInUser']['ForenameAndSurname'],sUserComboId='ctrlEntitySearch-Users'+sSuffix;TriSysSDK['CShowForm']['MultiUserCombo'](sUserComboId,fnChangeUsers),TriSysSDK['CShowForm']['SetSkillsInList'](sUserComboId,sUserName),TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-searches'+sSuffix),$('#ctrlEntitySearch-add-search-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddNewSearch'](sEntityName);}),$('#ctrlEntitySearch-clone-search-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['CloneSearch'](sEntityName);}),$('#ctrlEntitySearch-edit-search-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['OpenSearchForEdit'](sEntityName);}),$('#ctrlEntitySearch-delete-search-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['DeleteSearch'](sEntityName);});var sGrid='ctrlEntitySearch-searches-grid'+sSuffix;TriSysSDK['FormMenus']['DrawGridMenu']('ctrlEntitySearch-searches-GridMenu'+sSuffix,sGrid);var sSelectecCounterSpan='\x20<span\x20id=\x22ctrlEntitySearch-form-grid-selected-counter\x22></span>',sSearchResultsGridCaption='ctrlEntitySearch-search-grid-caption'+sSuffix;$('#'+sSearchResultsGridCaption)['html']('<strong>'+sEntityName+'</strong>\x20Search\x20Results'+sSelectecCounterSpan),$('#ctrlEntitySearch-open-search-result-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['OpenSearchResult'](sEntityName);}),$('#ctrlEntitySearch-add-search-result-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddSearchResultToFavourites'](sEntityName);}),$('#ctrlEntitySearch-exclude-search-result-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddSearchResultToExcluded'](sEntityName);});var sSearchResultsGrid='ctrlEntitySearch-search-grid'+sSuffix;TriSysSDK['FormMenus']['DrawGridMenu']('ctrlEntitySearch-search-GridMenu'+sSuffix,sSearchResultsGrid);if(sEntityName=='Task')$('#ctrlEntitySearch-search-ActionsMenu'+sSuffix)['hide'](),$('#ctrlEntitySearch-favourites-ActionsMenu'+sSuffix)['hide'](),$('#ctrlEntitySearch-add-search-result-button'+sSuffix)['hide'](),$('#ctrlEntitySearch-form-tab-favourites'+sSuffix)['hide'](),$('#ctrlEntitySearch-form-tab-excluded'+sSuffix)['hide']();else{ctrlEntitySearch['DrawActionsDropDown'](sEntityName,'ctrlEntitySearch-search-ActionsMenu'+sSuffix),ctrlEntitySearch['DrawActionsDropDown'](sEntityName,'ctrlEntitySearch-favourites-ActionsMenu'+sSuffix),ctrlEntitySearch['DrawActionsDropDown'](sEntityName,'ctrlEntitySearch-excluded-ActionsMenu'+sSuffix);const fnResizeActionsMenus=function(){const lstActionsMenus=['ctrlEntitySearch-search-ActionsMenu'+sSuffix,'ctrlEntitySearch-favourites-ActionsMenu'+sSuffix,'ctrlEntitySearch-excluded-ActionsMenu'+sSuffix];lstActionsMenus['forEach'](function(sMenuID){try{var iHeightFactor=$('#ctrlEntitySearch-search-grid-container'+sSuffix)['position']()['top']+0x78;$('#'+sMenuID+'\x20.dropdown-menu.dropdown-custom\x20>\x20li')['css']('max-height',$(window)['height']()-iHeightFactor+'px');}catch(e){}});};setTimeout(fnResizeActionsMenus,0x7d0);}$('#ctrlEntitySearch-open-favourites-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['OpenFavourite'](sEntityName);}),$('#ctrlEntitySearch-add-favourites-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddToFavourites'](sEntityName);}),$('#ctrlEntitySearch-remove-favourites-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['RemoveFromFavourites'](sEntityName);});var sFavouritesGrid='ctrlEntitySearch-favourites-grid'+sSuffix;$('#ctrlEntitySearch-add-exclude-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddSelectedGridRowsToExcluded'](sEntityName,sFavouritesGrid),ctrlEntitySearch['LoadFavourites'](ctrlEntitySearch['EntitySearchId'],sEntityName);}),TriSysSDK['FormMenus']['DrawGridMenu']('ctrlEntitySearch-favourites-GridMenu'+sSuffix,sFavouritesGrid),$('#ctrlEntitySearch-exportToExcel-button'+sSuffix)['off']()['on']('click',function(){TriSysSDK['Grid']['ExportToExcel']('ctrlEntitySearch-search-grid'+sSuffix);}),$('#ctrlEntitySearch-exportToExcel-favourites-button'+sSuffix)['off']()['on']('click',function(){TriSysSDK['Grid']['ExportToExcel']('ctrlEntitySearch-favourites-grid'+sSuffix);}),$('#ctrlEntitySearch-open-excluded-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['OpenExcluded'](sEntityName);}),$('#ctrlEntitySearch-add-excluded-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['AddToExcluded'](sEntityName);}),$('#ctrlEntitySearch-remove-excluded-button'+sSuffix)['off']()['on']('click',function(){ctrlEntitySearch['RemoveFromExcluded'](sEntityName);});var sExcludedGrid='ctrlEntitySearch-excluded-grid'+sSuffix;TriSysSDK['FormMenus']['DrawGridMenu']('ctrlEntitySearch-excluded-GridMenu'+sSuffix,sExcludedGrid);},'TabClickEvent':function(sTabID){var sEntityName=null,parts=sTabID['split']('ctrlEntitySearch-tab-panel-searches-');if(parts&&parts['length']==0x2){sEntityName=parts[0x1],ctrlEntitySearch['LoadSearches'](sEntityName);return;}parts=sTabID['split']('ctrlEntitySearch-tab-panel-search-');if(parts&&parts['length']==0x2){sEntityName=parts[0x1];if(ctrlEntitySearch['EntitySearchId']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20create\x20or\x20select\x20a\x20search\x20record\x20before\x20commencing\x20the\x20search\x20process.');var sSuffix='-'+sEntityName;TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-searches'+sSuffix);return;}return;}parts=sTabID['split']('ctrlEntitySearch-tab-panel-favourites-');if(parts&&parts['length']==0x2){sEntityName=parts[0x1];if(ctrlEntitySearch['EntitySearchId']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20create\x20or\x20select\x20a\x20search\x20record\x20before\x20viewing\x20favourites.');var sSuffix='-'+sEntityName;TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-searches'+sSuffix);return;}ctrlEntitySearch['LoadFavourites'](ctrlEntitySearch['EntitySearchId'],sEntityName);return;}parts=sTabID['split']('ctrlEntitySearch-tab-panel-excluded-');if(parts&&parts['length']==0x2){sEntityName=parts[0x1];if(ctrlEntitySearch['EntitySearchId']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20create\x20or\x20select\x20a\x20search\x20record\x20before\x20viewing\x20excluded.');var sSuffix='-'+sEntityName;TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-searches'+sSuffix);return;}ctrlEntitySearch['LoadExcluded'](ctrlEntitySearch['EntitySearchId'],sEntityName);return;}},'AddNewSearch':function(sEntityName){ctrlEntitySearch['EditSearch'](0x0,sEntityName);},'CloneSearch':function(sEntityName){var lApexEntitySearchId=ctrlEntitySearch['GetSingletonApexEntitySearchId'](sEntityName);if(lApexEntitySearchId>0x0){var CCloneApexEntitySearchRequest={'ApexEntitySearchId':lApexEntitySearchId,'ControlIdPrefix':'search-criteria-tree-ctrlEntitySearch-lookup-criteria-'+sEntityName+'-id-'},payloadObject={};payloadObject['URL']='EntitySearch/Clone',payloadObject['OutboundDataPacket']=CCloneApexEntitySearchRequest,payloadObject['InboundDataFunction']=function(CCloneApexEntitySearchResponse){TriSysApex['UI']['HideWait']();if(CCloneApexEntitySearchResponse){if(CCloneApexEntitySearchResponse['Success']){ctrlEntitySearch['LoadSearches'](sEntityName);return;}else TriSysApex['UI']['ShowMessage'](CCloneApexEntitySearchResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditEntitySearch.CloneSearch:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Cloning\x20Search...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'OpenSearchForEdit':function(sEntityName){var lApexEntitySearchId=ctrlEntitySearch['GetSingletonApexEntitySearchId'](sEntityName);if(lApexEntitySearchId>0x0)ctrlEntitySearch['EditSearch'](lApexEntitySearchId,sEntityName);},'DeleteSearch':function(sEntityName){var lApexEntitySearchId=ctrlEntitySearch['GetSingletonApexEntitySearchId'](sEntityName);if(lApexEntitySearchId>0x0)ctrlEntitySearch['DeleteSearchPrompt'](lApexEntitySearchId,sEntityName);},'GetSingletonApexEntitySearchId':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-searches-grid'+sSuffix,lApexEntitySearchId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](sGrid,'ApexEntitySearchId',sEntityName+'\x20Search');return lApexEntitySearchId;},'LoadSearches':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-searches-grid'+sSuffix;ctrlEntitySearch['EntitySearchId']=0x0,$('#ctrlEntitySearch-Title'+sSuffix)['html'](sEntityName+'\x20Search');var sUserComboId='ctrlEntitySearch-Users'+sSuffix,userList=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](sUserComboId,'\x27');if(!userList){TriSysSDK['Grid']['Clear'](sGrid),TriSysApex['UI']['ShowMessage']('Please\x20choose\x20one\x20or\x20more\x20users.');return;}var sUsers=userList,fnPopulationByFunction={'API':'EntitySearch/List','Parameters':function(request){request['EntityName']=sEntityName,request['UserNames']=sUsers;},'DataTableFunction':function(response){return response['List'];}};ctrlEntitySearch['LoadGrid'](sEntityName,fnPopulationByFunction);},'LoadGrid':function(sEntityName,fnPopulationByFunction){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-searches-grid'+sSuffix;TriSysSDK['Grid']['VirtualMode']({'Div':sGrid,'ID':sGrid,'Title':sEntityName&'\x20Searches','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':[{'field':'ApexEntitySearchId','title':'Id','type':'number','width':0x46,'hidden':!![]},{'field':'EntityName','title':'Entity\x20Name','type':'string','hidden':!![]},{'field':'SearchName','title':'Search\x20Name','type':'string'},{'field':'SearchDescription','title':'Description','type':'string'},{'field':'DateLastUpdated','title':'Last\x20Update/Run','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'UserName','title':'User','type':'string'}],'KeyColumnName':'ApexEntitySearchId','DrillDownFunction':function(rowData){ctrlEntitySearch['EntitySearchId']=rowData['ApexEntitySearchId'];var sSearchName=rowData['SearchName'];ctrlEntitySearch['LoadSearch'](ctrlEntitySearch['EntitySearchId'],sEntityName,sSearchName);},'MultiRowSelect':!![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![],'OpenButtonCaption':'Search','HyperlinkedColumns':['SearchName'],'SelectedRowsCounterId':'entitySearches-grid-selected-counter-'+sEntityName});},'EntitySearchId':0x0,'EntityName':null,'EditSearch':function(lApexEntitySearchId,sEntityName){ctrlEntitySearch['EntitySearchId']=lApexEntitySearchId,ctrlEntitySearch['EntityName']=sEntityName;var bAllowSave=!![],bNewSearch=lApexEntitySearchId<=0x0;if(lApexEntitySearchId>0x0){}var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=(lApexEntitySearchId>0x0?'Edit':'New')+'\x20'+sEntityName+'\x20Search',parametersObject['Image']='gi-pen',parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'ctrlEditEntitySearch.html',parametersObject['ButtonRightText']=bAllowSave?'Cancel':'Close',parametersObject['ButtonRightVisible']=!![];if(bAllowSave){var fnAfterSave=function(lEntitySearchId,sSearchName){ctrlEntitySearch['LoadSearches'](sEntityName),bNewSearch&&(ctrlEntitySearch['EntitySearchId']=lEntitySearchId,ctrlEntitySearch['LoadSearch'](lEntitySearchId,sEntityName,sSearchName));};parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlEditEntitySearch['SaveButtonClick'](fnAfterSave);};}TriSysApex['UI']['PopupMessage'](parametersObject);},'DeleteSearchPrompt':function(lApexEntitySearchId,sEntityName){var fnYes=function(){return ctrlEntitySearch['DeleteSearchThroughWebAPI'](lApexEntitySearchId,sEntityName),!![];},fnNo=function(){return!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20this\x20'+sEntityName+'\x20Search?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20'+sEntityName+'\x20Search','Yes',fnYes,'No/Cancel',fnNo);},'DeleteSearchThroughWebAPI':function(lApexEntitySearchId,sEntityName){var CDeleteApexEntitySearchRequest={'ApexEntitySearchId':lApexEntitySearchId},payloadObject={};payloadObject['URL']='EntitySearch/Delete',payloadObject['OutboundDataPacket']=CDeleteApexEntitySearchRequest,payloadObject['InboundDataFunction']=function(CDeleteApexEntitySearchResponse){TriSysApex['UI']['HideWait']();if(CDeleteApexEntitySearchResponse){if(CDeleteApexEntitySearchResponse['Success']){ctrlEntitySearch['LoadSearches'](sEntityName);return;}else TriSysApex['UI']['ShowMessage'](CDeleteApexEntitySearchResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditEntitySearch.DeleteSearchThroughWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Search...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'LoadSearch':function(lApexEntitySearchId,sEntityName,sSearchName,bRefresh){var sSuffix='-'+sEntityName,sSearchTree='ctrlEntitySearch-lookup-criteria'+sSuffix,sGrid='ctrlEntitySearch-search-grid'+sSuffix;if(sSearchName)$('#ctrlEntitySearch-Title'+sSuffix)['html'](sEntityName+'\x20Search:\x20'+sSearchName);!bRefresh&&TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-search'+sSuffix);var oldTreeElement=$('[id*=\x22'+sSearchTree+'\x22]');oldTreeElement['empty']();var sOldID=oldTreeElement['attr']('id'),sSearchDivForRecord=sSearchTree+'-id-'+lApexEntitySearchId;$('#'+sOldID)['attr']('id',sSearchDivForRecord),ctrlEntitySearch['ShowGridLoadingWhilstSearchCriteriaTreeIsPopulated'](sEntityName,!![]),TriSysSDK['SearchCriteria']['Load'](sEntityName,0x0,sSearchDivForRecord,ctrlEntitySearch['InvokeLookupFromCriteria']);const fnResizeSavedSearchesMenu=function(){var iHeightFactor=$('#ctrlEntitySearch-tab-panel-search'+sSuffix)['position']()['top']+0x32,sID='saved-search-menu-li-item-search-criteria-tree-'+sSearchDivForRecord;$('#'+sID)['css']('max-height',$(window)['height']()-iHeightFactor+'px');};setTimeout(fnResizeSavedSearchesMenu,0x7d0);},'ShowGridLoadingWhilstSearchCriteriaTreeIsPopulated':function(sEntityName,bSpin){var spinnerWait={'Div':'ctrlEntitySearch-search-grid-container-'+sEntityName};TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,bSpin);},'InvokeLookupFromCriteria':function(sEntityName,lRecordId,sJson,dynamicColumns){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-search-grid'+sSuffix;ctrlEntitySearch['ShowGridLoadingWhilstSearchCriteriaTreeIsPopulated'](sEntityName,![]);if(!sJson){TriSysSDK['Grid']['Empty'](sGrid),TriSysApex['Toasters']['Warning']('Please\x20enter\x20'+sEntityName+'\x20search\x20criteria.');return;}ctrlEntitySearch['PopulateEntityGrid'](sEntityName,sGrid,sJson,dynamicColumns);},'PopulateEntityGrid':function(sEntityName,sGrid,sJson,dynamicColumns,options){ctrlEntitySearch['ShowEntityRecordsInGrid'](sEntityName,sGrid,sJson,dynamicColumns,options);},'ShowEntityRecordsInGrid':function(sEntityName,sGrid,sJson,dynamicColumns,parameterOptions){var sFunction='/List',sController=sEntityName+'s';switch(sEntityName){case'Company':sController='Companies';break;case'Task':sFunction='/PagedList';}var fnPopulationByFunction={'API':sController+sFunction,'Parameters':function(request){var bSearchTreeEnabled=!![],searchObject=JSON['parse'](sJson);searchObject&&searchObject['AICriteria']&&(bSearchTreeEnabled=![],request['AICriteria']=searchObject['AICriteria']),request['SearchTreeEnabled']=bSearchTreeEnabled,request['SearchTreeJson']=sJson,request['ColumnNames']=TriSysSDK['Grid']['Custom']['DisplayColumnNames'](sGrid),request['EntitySearchId']=ctrlEntitySearch['EntitySearchId'],parameterOptions&&(request['FavouritesOnly']=parameterOptions['FavouritesOnly'],request['ExcludedOnly']=parameterOptions['ExcludedOnly']);},'DataTableFunction':function(response){if(sEntityName=='Task')return response['Tasks'];else return response['List'];}},options={'DynamicColumns':dynamicColumns,'Json':sJson,'SelectedRowsCounterId':'ctrlEntitySearch-form-grid-selected-counter'};switch(sEntityName){case'Contact':TriSysWeb['Pages']['Contacts']['PopulateGrid'](sGrid,'grdContacts','Contacts',fnPopulationByFunction,null,options);break;case'Company':TriSysWeb['Pages']['Companies']['PopulateGrid'](sGrid,'grdCompanies','Companies',fnPopulationByFunction,null,options);break;case'Requirement':TriSysWeb['Pages']['Requirements']['PopulateGrid'](sGrid,'grdRequirements','Requirements',fnPopulationByFunction,options);break;case'Placement':TriSysWeb['Pages']['Placements']['PopulateGrid'](sGrid,'grdPlacements','Placements',fnPopulationByFunction,options);break;case'Timesheet':TriSysWeb['Pages']['Timesheets']['PopulateGrid'](sGrid,'grdTimesheets','Timesheets',fnPopulationByFunction,options);break;case'Task':TriSysWeb['Pages']['Tasks']['PopulateGrid'](sGrid,'grdTasks','Tasks',fnPopulationByFunction,options);break;}},'OpenSearchResult':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-search-grid'+sSuffix;ctrlEntitySearch['OpenGridEntityRecord'](sEntityName,sGrid);},'OpenGridEntityRecord':function(sEntityName,sGrid){var sIDField=sEntityName+'_'+sEntityName+'Id',bTaskEntity=sEntityName=='Task';if(bTaskEntity)sIDField=sEntityName+'Id';var lRecordId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](sGrid,sIDField,sEntityName);if(lRecordId<=0x0)return;if(bTaskEntity)TriSysApex['ModalDialogue']['Task']['QuickShow'](lRecordId);else TriSysApex['FormsManager']['OpenForm'](sEntityName,lRecordId);},'DrawActionsDropDown':function(sEntityName,sButtonId){var sCallbackFunction='ctrlEntitySearch.ActionInvocation';TriSysActions['Menus']['Draw'](sButtonId,sEntityName,sCallbackFunction);},'LoadFavourites':function(lApexEntitySearchId,sEntityName){ctrlEntitySearch['LoadFavouritesIntoGrid'](sEntityName,null,{'FavouritesOnly':!![]});},'LoadFavouritesIntoGrid':function(sEntityName,sSQL,options){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-favourites-grid'+sSuffix;ctrlEntitySearch['PopulateEntityGrid'](sEntityName,sGrid,sSQL,null,options);},'AddSearchResultToFavourites':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-search-grid'+sSuffix,sIDField=sEntityName+'_'+sEntityName+'Id',recordIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sIDField);if(!recordIds||recordIds['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20'+sEntityName+'\x20records.');return;}ctrlEntitySearch['AddListOfRecordsToFavourites'](sEntityName,recordIds);},'AddListOfRecordsToFavourites':function(sEntityName,recordIds,bRefreshGrid){var sSuffix='-'+sEntityName,CAddToFavouritesApexEntitySearchRequest={'ApexEntitySearchId':ctrlEntitySearch['EntitySearchId'],'RecordIdList':recordIds},payloadObject={};payloadObject['URL']='EntitySearch/AddToFavourites',payloadObject['OutboundDataPacket']=CAddToFavouritesApexEntitySearchRequest,payloadObject['InboundDataFunction']=function(CAddToFavouritesApexEntitySearchResponse){TriSysApex['UI']['HideWait']();if(CAddToFavouritesApexEntitySearchResponse){if(CAddToFavouritesApexEntitySearchResponse['Success']){TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-favourites'+sSuffix);if(bRefreshGrid)ctrlEntitySearch['LoadFavourites'](ctrlEntitySearch['EntitySearchId'],sEntityName);var fnRefreshSearchResults=function(){var bRefresh=!![];ctrlEntitySearch['LoadSearch'](ctrlEntitySearch['EntitySearchId'],sEntityName,null,bRefresh);};setTimeout(fnRefreshSearchResults,0x400);return;}else TriSysApex['UI']['ShowMessage'](CAddToFavouritesApexEntitySearchResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditEntitySearch.AddListOfRecordsToFavourites:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Adding\x20to\x20Favourites...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenFavourite':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-favourites-grid'+sSuffix;ctrlEntitySearch['OpenGridEntityRecord'](sEntityName,sGrid);},'AddToFavourites':function(sEntityName){var fnSelected=function(sEntityName,lRecordId,sName){ctrlEntitySearch['AddListOfRecordsToFavourites'](sEntityName,[lRecordId],!![]);};TriSysApex['ModalDialogue']['EntityRecord']['Select'](sEntityName,fnSelected);},'RemoveFromFavourites':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-favourites-grid'+sSuffix,sIDField=sEntityName+'_'+sEntityName+'Id',recordIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sIDField);if(!recordIds||recordIds['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20'+sEntityName+'\x20records.');return;}ctrlEntitySearch['RemoveFromSearchResultsWebAPI'](sEntityName,recordIds,'Favourites',function(){ctrlEntitySearch['LoadFavourites'](ctrlEntitySearch['EntitySearchId'],sEntityName);});},'RemoveFromSearchResultsWebAPI':function(sEntityName,recordIds,sWhat,fnCallbackToRefresh){var CRemoveFromFavouritesApexEntitySearchRequest={'ApexEntitySearchId':ctrlEntitySearch['EntitySearchId'],'RecordIdList':recordIds},payloadObject={};payloadObject['URL']='EntitySearch/RemoveFromFavourites',payloadObject['OutboundDataPacket']=CRemoveFromFavouritesApexEntitySearchRequest,payloadObject['InboundDataFunction']=function(CRemoveFromFavouritesApexEntitySearchResponse){TriSysApex['UI']['HideWait']();if(CRemoveFromFavouritesApexEntitySearchResponse){if(CRemoveFromFavouritesApexEntitySearchResponse['Success']){fnCallbackToRefresh();var fnRefreshSearchResults=function(){var bRefresh=!![];ctrlEntitySearch['LoadSearch'](ctrlEntitySearch['EntitySearchId'],sEntityName,null,bRefresh);};setTimeout(fnRefreshSearchResults,0x400);return;}else TriSysApex['UI']['ShowMessage'](CRemoveFromFavouritesApexEntitySearchResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditEntitySearch.RemoveFromSearchResultsWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Removing\x20'+sWhat+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ActionInvocation':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-search-grid'+sSuffix,elemFaveTab=$('#ctrlEntitySearch-form-tab-favourites'+sSuffix);if(elemFaveTab['hasClass']('active'))sGrid='ctrlEntitySearch-favourites-grid'+sSuffix;var elemExcludedTab=$('#ctrlEntitySearch-form-tab-excluded'+sSuffix);if(elemExcludedTab['hasClass']('active'))sGrid='ctrlEntitySearch-excluded-grid'+sSuffix;var sIDField=sEntityName+'_'+sEntityName+'Id',recordIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sIDField);return recordIds;},'LoadExcluded':function(lApexEntitySearchId,sEntityName){ctrlEntitySearch['LoadExcludedIntoGrid'](sEntityName,null,{'ExcludedOnly':!![]});},'LoadExcludedIntoGrid':function(sEntityName,sSQL,options){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-excluded-grid'+sSuffix;ctrlEntitySearch['PopulateEntityGrid'](sEntityName,sGrid,sSQL,null,options);},'OpenExcluded':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-excluded-grid'+sSuffix;ctrlEntitySearch['OpenGridEntityRecord'](sEntityName,sGrid);},'AddToExcluded':function(sEntityName){var fnSelected=function(sEntityName,lRecordId,sName){ctrlEntitySearch['AddListOfRecordsToExclude'](sEntityName,[lRecordId],!![]);};TriSysApex['ModalDialogue']['EntityRecord']['Select'](sEntityName,fnSelected);},'AddSearchResultToExcluded':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-search-grid'+sSuffix;ctrlEntitySearch['AddSelectedGridRowsToExcluded'](sEntityName,sGrid);},'AddSelectedGridRowsToExcluded':function(sEntityName,sGrid){var sSuffix='-'+sEntityName,sIDField=sEntityName+'_'+sEntityName+'Id',recordIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sIDField);if(!recordIds||recordIds['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20'+sEntityName+'\x20records.');return;}ctrlEntitySearch['AddListOfRecordsToExclude'](sEntityName,recordIds);},'AddListOfRecordsToExclude':function(sEntityName,recordIds,bRefreshGrid){var sSuffix='-'+sEntityName,CAddToExcludedApexEntitySearchRequest={'ApexEntitySearchId':ctrlEntitySearch['EntitySearchId'],'RecordIdList':recordIds},payloadObject={};payloadObject['URL']='EntitySearch/AddToExcluded',payloadObject['OutboundDataPacket']=CAddToExcludedApexEntitySearchRequest,payloadObject['InboundDataFunction']=function(CAddToExcludedApexEntitySearchResponse){TriSysApex['UI']['HideWait']();if(CAddToExcludedApexEntitySearchResponse){if(CAddToExcludedApexEntitySearchResponse['Success']){TriSysSDK['Controls']['Button']['Click']('ctrlEntitySearch-form-tab-excluded'+sSuffix);if(bRefreshGrid)ctrlEntitySearch['LoadExcluded'](ctrlEntitySearch['EntitySearchId'],sEntityName);var fnRefreshSearchResults=function(){var bRefresh=!![];ctrlEntitySearch['LoadSearch'](ctrlEntitySearch['EntitySearchId'],sEntityName,null,bRefresh);};setTimeout(fnRefreshSearchResults,0x400);return;}else TriSysApex['UI']['ShowMessage'](CAddToExcludedApexEntitySearchResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlEditEntitySearch.AddListOfRecordsToExclude:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Adding\x20to\x20Excluded...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'RemoveFromExcluded':function(sEntityName){var sSuffix='-'+sEntityName,sGrid='ctrlEntitySearch-excluded-grid'+sSuffix,sIDField=sEntityName+'_'+sEntityName+'Id',recordIds=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](sGrid,sIDField);if(!recordIds||recordIds['length']==0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20one\x20or\x20more\x20'+sEntityName+'\x20records.');return;}ctrlEntitySearch['RemoveFromSearchResultsWebAPI'](sEntityName,recordIds,'Excluded',function(){ctrlEntitySearch['LoadExcluded'](ctrlEntitySearch['EntitySearchId'],sEntityName);});}};