var ctrlSendCandidateVacancyToFriend={'JobReferenceID':'ctrlSendCandidateVacancyToFriend_JobReference','JobReferenceLabelID':'ctrlSendCandidateVacancyToFriend_JobReferenceLabel','JobTitleID':'ctrlSendCandidateVacancyToFriend_JobTitle','JobTitleFormBlockID':'ctrlSendCandidateVacancyToFriend_JobTitleBlock','ToEMailID':'ctrlSendCandidateVacancyToFriend_ToEMail','FromID':'ctrlSendCandidateVacancyToFriend_From','CommentsID':'ctrlSendCandidateVacancyToFriend_Comments','CookieName':'ctrlSendCandidateVacancyToFriend.Settings','Load':function(){var iCount=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId']['length'],sReference=iCount==0x1?TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['Reference']:iCount,sJobTitle=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['JobTitle'];iCount>0x1&&($('#'+ctrlSendCandidateVacancyToFriend['JobReferenceLabelID'])['html']('Vacancy\x20Count'),$('#'+ctrlSendCandidateVacancyToFriend['JobTitleFormBlockID'])['hide']());$('#'+ctrlSendCandidateVacancyToFriend['JobReferenceID'])['html'](sReference),$('#'+ctrlSendCandidateVacancyToFriend['JobTitleID'])['html'](sJobTitle);var settings=TriSysAPI['Persistence']['Read'](ctrlSendCandidateVacancyToFriend['CookieName']);if(settings)$('#'+ctrlSendCandidateVacancyToFriend['ToEMailID'])['val'](settings['ToEMail']),$('#'+ctrlSendCandidateVacancyToFriend['FromID'])['val'](settings['From']);else{var fnPopulate=function(candidate){$('#'+ctrlSendCandidateVacancyToFriend['FromID'])['val'](candidate['Forenames']+'\x20'+candidate['Surname']);};TriSysWebJobs['ContactUs']['LoadLoggedInUserDetails'](fnPopulate,!![]);}},'SendJob':function(){var settings={'ToEMail':$('#'+ctrlSendCandidateVacancyToFriend['ToEMailID'])['val'](),'From':$('#'+ctrlSendCandidateVacancyToFriend['FromID'])['val']()},sComments=$('#'+ctrlSendCandidateVacancyToFriend['CommentsID'])['val'](),sError=null;if(!settings['ToEMail']||!settings['From'])sError='Please\x20enter\x20both\x20a\x20to\x20e-mail\x20address\x20and\x20a\x20from\x20name';else{if(!TriSysApex['LoginCredentials']['validateEmail'](settings['ToEMail']))sError='Invalid\x20e-mail\x20address';}if(sError)return TriSysApex['UI']['ShowMessage'](sError,TriSysWebJobs['Constants']['ApplicationName']),![];var CVacancyMultipleSendToFriend={'ToEMail':settings['ToEMail'],'From':settings['From'],'Comments':sComments,'RequirementIdCollection':TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId'],'WebJobsRequest':TriSysWebJobs['Agency']['WebJobsRequest']()},iCount=TriSysWebJobs['Vacancies']['MultipleSelectedVacancies']['RequirementId']['length'];return ctrlSendCandidateVacancyToFriend['SendMultipleJobDetailsToFriendViaServer'](CVacancyMultipleSendToFriend,iCount,settings['ToEMail']),TriSysAPI['Persistence']['Write'](ctrlSendCandidateVacancyToFriend['CookieName'],settings),!![];},'SendMultipleJobDetailsToFriendViaServer':function(CVacancyMultipleSendToFriend,iNumberOfJobs,sToEMail){var bAsynchronous=!![],fnPostSend=function(){TriSysApex['UI']['HideWait']();var sMessage='Vacancy\x20details\x20of\x20'+iNumberOfJobs+'\x20job'+(iNumberOfJobs==0x1?'':'s')+'\x20has\x20been\x20sent\x20to:\x20'+sToEMail;TriSysApex['UI']['ShowMessage'](sMessage,TriSysWebJobs['Constants']['ApplicationName']);},sWaitMessage='Sending\x20'+iNumberOfJobs+'\x20Vacancy\x20E-Mail'+(iNumberOfJobs>0x1?'s':'')+'...';TriSysApex['UI']['ShowWait'](null,sWaitMessage);var payloadObject={};payloadObject['URL']='Vacancy/SendMultipleToFriend',payloadObject['OutboundDataPacket']=CVacancyMultipleSendToFriend,payloadObject['InboundDataFunction']=function(data){var CVacancySendToFriendResult=data;if(CVacancySendToFriendResult){TriSysApex['UI']['HideWait']();if(CVacancySendToFriendResult['Success']){if(!bAsynchronous)fnPostSend();}else TriSysApex['UI']['errorAlert'](CVacancySendToFriendResult['ErrorMessage'],TriSysWebJobs['Constants']['ApplicationName']);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlSendCandidateVacancyToFriend.SendMultipleJobDetailsToFriendViaServer:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);if(bAsynchronous)setTimeout(fnPostSend,0xfa);}};$(document)['ready'](function(){ctrlSendCandidateVacancyToFriend['Load']();});