var CandidateRegistration={'SocialNetworkCredentials':null,'Load':function(){TriSysWebJobs['CandidateRegistration']['LoadContactTitleLookup']('txtCandidateRegistrationTitle'),TriSysWebJobs['CandidateRegistration']['LoadCityFromGeoLocation']('txtCandidateRegistrationCity'),TriSysWebJobs['CandidateRegistration']['LoadCountryLookup']('txtCandidateRegistrationCountry'),TriSysWebJobs['CandidateRegistration']['LoadContactPhotoWidgets']('CandidateRegistrationContactPhoto','imgCandidateRegistrationEditor'),TriSysWebJobs['CandidateRegistration']['LoadCVFileRefWidget']('txtCandidateRegistrationCVFileRef',![],!![]),CandidateRegistration['Social']['AddEventHandlers'](),TriSysWebJobs['Frame']['ApplyDynamicFeaturesAndStyleAfterFormLoaded'](),CandidateRegistration['JobTitleSelectionMode'](),CandidateRegistration['PrinciplesOfEngagement']();},'PostCodelookup':function(){var sPrefix='txtCandidateRegistration';TriSysSDK['PostCode']['Lookup'](sPrefix+'PostCode',sPrefix+'Street',sPrefix+'City',sPrefix+'County',sPrefix+'Country');},'SubmitButtonClick':function(){var sTitle=TriSysSDK['CShowForm']['GetTextFromCombo']('txtCandidateRegistrationTitle'),sForenames=$('#txtCandidateRegistrationForenames')['val'](),sSurname=$('#txtCandidateRegistrationSurname')['val'](),sPassword=$('#txtCandidateRegistrationPassword')['val'](),sVerifyPassword=$('#txtCandidateRegistrationPasswordConfirmation')['val'](),sEMail=$('#txtCandidateRegistrationEMail')['val'](),sJobTitle=$('#txtCandidateRegistrationJobTitle')['val'](),sStreet=$('#txtCandidateRegistrationStreet')['val'](),sCity=$('#txtCandidateRegistrationCity')['val'](),sCounty=$('#txtCandidateRegistrationCounty')['val'](),sPostCode=$('#txtCandidateRegistrationPostCode')['val'](),sCountry=$('#txtCandidateRegistrationCountry')['val'](),sHomeTelNo=$('#txtCandidateRegistrationHomeTelNo')['val'](),sMobileTelNo=$('#txtCandidateRegistrationMobileTelNo')['val'](),sCVFileRef=TriSysSDK['Controls']['FileReference']['GetFile']('txtCandidateRegistrationCVFileRef'),sPhoto=TriSysSDK['Controls']['FileReference']['GetFile']('CandidateRegistrationContactPhoto'),bPrinciplesOfEngagementAgree=TriSysSDK['CShowForm']['GetCheckBoxValue']('candidateRegistration-PrinciplesOfEngagement-Agree',![]),sRuleFailure='';if(!sForenames)sRuleFailure+='Please\x20enter\x20your\x20forename(s)'+'<br\x20/>';if(!sSurname)sRuleFailure+='Please\x20enter\x20your\x20surname'+'<br\x20/>';if(!TriSysApex['LoginCredentials']['validateEmail'](sEMail))sRuleFailure+='Please\x20enter\x20a\x20valid\x20e-mail\x20address.'+'<br\x20/>';var bPasswordMandatory=!CandidateRegistration['SocialNetworkCredentials'];if(bPasswordMandatory){if(!sPassword)sRuleFailure+='Please\x20enter\x20a\x20password'+'<br\x20/>';else{var iMinLength=TriSysApex['Constants']['iMinimumPasswordLength'];if(sPassword['length']<iMinLength)sRuleFailure+='Please\x20enter\x20a\x20password\x20with\x20a\x20mininum\x20length\x20of\x20'+iMinLength+'\x20characters'+'<br\x20/>';}if(sPassword!=sVerifyPassword)sRuleFailure+='Please\x20confirm\x20your\x20password'+'<br\x20/>';}if(!sCVFileRef&&TriSysWebJobs['Constants']['CandidateRegistrationCVMandatory'])sRuleFailure+='Please\x20upload\x20a\x20copy\x20of\x20your\x20CV'+'<br\x20/>';var bSSR=TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()=='sopra-steria-recruitment';if(bSSR){if(!bPrinciplesOfEngagementAgree)sRuleFailure+='Please\x20agree\x20to\x20our\x20principles\x20of\x20engagement'+'<br\x20/>';}if(sRuleFailure['length']>0x0){TriSysApex['UI']['ShowMessage'](sRuleFailure,TriSysWebJobs['Constants']['ApplicationName']);return;}var sURL=TriSysWebJobs['Constants']['HomePage']+'/?'+TriSysWebJobs['Constants']['CandidateRegistrationConfirmationForm']+'/#GUID#/'+TriSysWebJobs['Agency']['CustomerID'],CNewCandidateSignUpRequest={'Forenames':sForenames,'Surname':sSurname,'Password':sPassword,'EMail':sEMail,'Title':sTitle,'JobTitle':sJobTitle,'Street':sStreet,'City':sCity,'County':sCounty,'PostCode':sPostCode,'Country':sCountry,'HomeTelNo':sHomeTelNo,'MobileTelNo':sMobileTelNo,'CVFileRef':sCVFileRef,'Photo':sPhoto,'URL':sURL,'WebJobsRequest':TriSysWebJobs['Agency']['WebJobsRequest'](),'SocialNetworkLoginParameters':CandidateRegistration['SocialNetworkCredentials'],'RequirementId':TriSysWebJobs['Vacancies']['RequirementId']},fnPostLoginRedirection=function(){return TriSysApex['FormsManager']['OpenForm'](TriSysWebJobs['Constants']['CandidateLoginForm'],0x0,!![]),!![];};TriSysWebJobs['CandidateRegistration']['SubmitToServer'](CNewCandidateSignUpRequest,fnPostLoginRedirection);},'Social':{'AddEventHandlers':function(){var fnLoadControlHTML=function(){TriSysApex['FormsManager']['loadControlIntoDiv']('CandidateRegistration-SocialNetworkButtons','ctrlSocialNetworkLoginButtons.html',function(response,status,xhr){ctrlSocialNetworkLoginButtons['OnSuccessfulLoginFunction']=CandidateRegistration['Social']['SendToWebAPI'],ctrlSocialNetworkLoginButtons['HelpLabel']('You\x20may\x20login\x20with\x20any\x20social\x20network\x20to\x20populate\x20fields\x20below,\x20and\x20to\x20login\x20with\x20the\x20same\x20details\x20in\x20future.');});};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlSocialNetworkLoginButtons.js',null,fnLoadControlHTML);},'SendToWebAPI':function(provider_name,connection_token,user_token){var CReadSocialNetworkAuthenticatedCredentialsRequest={'ProviderName':provider_name,'ConnectionToken':connection_token,'UserToken':user_token};TriSysWebJobs['SocialNetwork']['ReadAuthenticatedCredentials'](CReadSocialNetworkAuthenticatedCredentialsRequest,CandidateRegistration['Social']['DisplayAuthenticatedSocialNetworkCredentials']);},'DisplayAuthenticatedSocialNetworkCredentials':function(CReadSocialNetworkAuthenticatedCredentialsResponse){CandidateRegistration['SocialNetworkCredentials']=CReadSocialNetworkAuthenticatedCredentialsResponse;var socialData=CandidateRegistration['SocialNetworkCredentials'];if(socialData['Forenames'])$('#txtCandidateRegistrationForenames')['val'](socialData['Forenames']);if(socialData['Surname'])$('#txtCandidateRegistrationSurname')['val'](socialData['Surname']);if(socialData['EMail'])$('#txtCandidateRegistrationEMail')['val'](socialData['EMail']);if(socialData['OrgJobTitle'])$('#txtCandidateRegistrationJobTitle')['val'](socialData['OrgJobTitle']);if(socialData['CurrentLocation']){var parts=socialData['CurrentLocation']['split'](',\x20');parts&&(parts['length']==0x2&&($('#txtCandidateRegistrationCity')['val'](parts[0x0]),TriSysSDK['CShowForm']['SetTextInCombo']('txtCandidateRegistrationCountry',parts[0x1])));}$('#trisys-social-network-social-button')['show']();var sClass=CandidateRegistration['Social']['GetSocialImage'](socialData['ProviderName']);$('#trisys-social-network-logo')['removeClass'](),$('#trisys-social-network-logo')['addClass'](sClass),$('#trisys-social-network-name')['html'](socialData['ProviderName']),$('#trisys-social-network-fullname')['html'](socialData['FullName']?socialData['FullName']:socialData['Forenames']+'\x20'+socialData['Surname']),$('#trisys-social-network-profile')['html'](socialData['ProfileURL']);var sPhoto=TriSysApex['Constants']['DefaultContactGreyImage'];if(socialData['PhotoURL'])sPhoto=socialData['PhotoURL'];$('#trisys-social-network-photo')['attr']('src',sPhoto),socialData['PhotoURL']&&CandidateRegistration['EspeciallyComplicatedFileUploadManagement'](sPhoto);},'GetSocialImage':function(sProviderName){switch(sProviderName['toLowerCase']()){case'windows\x20live':return'fa\x20fa-windows';default:return'fa\x20fa-'+sProviderName['toLowerCase']();}}},'EspeciallyComplicatedFileUploadManagement':function(sFileURL){var fnCallback=function(sLocalFile){var sPhoto=sLocalFile,photoWidget=$('#imgCandidateRegistrationEditor');photoWidget['attr']('src',sPhoto),photoWidget['show'](),TriSysSDK['Controls']['FileReference']['SetFile']('CandidateRegistrationContactPhoto',sPhoto);};TriSysSDK['FileUpload']['UploadFileURL'](sFileURL,'registration-photo.jpg',![],'CandidateRegistrationContactPhoto','imgCandidateRegistrationEditor');},'JobTitleSelectionMode':function(){var bJobTitleSelectionMode=![],bManeGroup=TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()=='Mane-Group'['toLowerCase']();if(bManeGroup)bJobTitleSelectionMode=!![];bJobTitleSelectionMode&&($('#txtCandidateRegistrationJobTitle')['attr']('readonly','readonly'),$('#tr-CandidateRegistrationJobTitle')['show']());},'JobTitleLookup':function(){var sJobTitleField='txtCandidateRegistrationJobTitle',sJobTitle=null;TriSysSDK['JobTitle']['Lookup'](sJobTitle,sJobTitleField);},'PrinciplesOfEngagement':function(){var bSSR=TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()=='sopra-steria-recruitment';bSSR&&$('#candidateRegistration-PrinciplesOfEngagement-block')['show']();}};$(document)['ready'](function(){CandidateRegistration['Load']();});