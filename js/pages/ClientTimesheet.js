var ClientTimesheet={'LoadFromURL':function(sParameters){TriSysWebJobs['Timesheet']['TimesheetId']=TriSysApex['Pages']['Controller']['ParseLoadRecordURLParameter'](sParameters,0x0,!![]),ClientTimesheet['Load'](TriSysWebJobs['Timesheet']['TimesheetId']);},'Load':function(lTimesheetId){ClientTimesheet['ShowTimesheetSummary'](lTimesheetId);},'ShowTimesheetSummary':function(lTimesheetId){var CTimesheetRequest={'TimesheetId':lTimesheetId};ClientTimesheet['PlacementId']=TriSysWebJobs['Placement']['PlacementId'];if(lTimesheetId==0x0)CTimesheetRequest['PlacementId']=TriSysWebJobs['Placement']['PlacementId'];var payloadObject={};payloadObject['URL']='Timesheet/Read',payloadObject['OutboundDataPacket']=CTimesheetRequest,payloadObject['InboundDataFunction']=function(CTimesheetResponse){TriSysApex['UI']['HideWait']();if(CTimesheetResponse&&CTimesheetResponse['Success']){var timesheet=CTimesheetResponse['Timesheet'];if(timesheet){var placement=CTimesheetResponse['Placement'],sHyperlink='<a\x20href=\x22javascript:void(0)\x22\x20onclick=\x22TriSysWebJobs.Placement.Open('+placement['PlacementId']+',\x20true)\x22>'+placement['Reference']+'</a>';$('#trisys-timesheet-reference')['html'](sHyperlink),$('#trisys-timesheet-candidate')['html'](placement['CandidateName']),$('#trisys-timesheet-linemanager')['html'](placement['LineManagerName']),$('#trisys-timesheet-type')['html'](placement['Type']),$('#trisys-timesheet-jobtitle')['html'](placement['JobTitle']);var sLocation=placement['Location'];if(sLocation)sLocation=sLocation['replace'](/\n/g,'<br\x20/>');$('#trisys-timesheet-location')['html'](sLocation),$('#trisys-timesheet-company')['html'](placement['CompanyName']);var sStartDate=moment(placement['StartDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY');$('#trisys-timesheet-startdate')['html'](sStartDate);if(placement['EndDate']){var sEndDate=moment(placement['EndDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY');$('#trisys-timesheet-enddate')['html'](sEndDate);var bNoEndDate=moment(placement['EndDate'])['year']()<=0x76c;if(bNoEndDate)$('#trisys-timesheet-enddate-formgroup')['hide']();}$('#trisys-timesheet-id')['html'](TriSysSDK['Numbers']['Pad'](CTimesheetResponse['TimesheetId'],0x6)),$('#trisys-timesheet-period')['html'](timesheet['Period']),$('#trisys-timesheet-inputdate')['html'](moment(timesheet['InputDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY'));var bAuthorised=timesheet['PaymentAuthorised'];$('#trisys-timesheet-status')['html']((bAuthorised?'':'Not\x20')+'Authorised');bAuthorised&&($('#trisys-timesheet-authorised')['html'](moment(timesheet['AuthorisedDate'])['format']('dddd\x20DD\x20MMMM\x20YYYY')),$('#trisys-timesheet-authorised-form-group')['show'](),$('#trisys-timesheet-authorisedby')['html'](timesheet['AuthorisedBy']),$('#trisys-timesheet-authorisedby-form-group')['show']());var bPaid=timesheet['Payrolled'];bPaid&&($('#trisys-timesheet-paid')['html'](bPaid?'Yes':'No'),$('#trisys-timesheet-paid-form-group')['show']());if(placement['Custom']&&placement['Custom']['IdentificationLink']){var sTitle='Candidate\x20ID';$('#trisys-timesheet-IdentificationLink')['click'](function(){TriSysSDK['Controls']['FileManager']['GetOpenFileURLFromWebService'](sTitle,placement['Custom']['IdentificationLink'],sTitle);}),$('#trisys-timesheet-IdentificationLink')['html']('Click\x20to\x20Open');}var bClientContact=!![];TriSysWebJobs['Timesheet']['PopulateAmountsTable'](CTimesheetResponse['Rates'],bClientContact),TriSysWebJobs['Timesheet']['PopulateSummaryTable'](CTimesheetResponse,bClientContact);var bCanEdit=![];TriSysWebJobs['Timesheet']['PopulateGrid'](CTimesheetResponse,'trisys-timesheet-hours-grid',bCanEdit);var bAuthorisationRequested=timesheet['AuthorisationRequested']&&moment(timesheet['AuthorisationRequested'])['year']()>=0x76c;$('#ClientTimesheet-Menu-Authorise')['attr']('disabled',bAuthorised);var bAllowDecline=TriSysWebJobs['Agency']['CustomerIDMatch']('CoSector');if(!bAuthorised&&bAuthorisationRequested&&bAllowDecline)$('#ClientTimesheet-Menu-Decline')['show']();if(bAuthorisationRequested){var sAuthorisationRequested=moment(timesheet['AuthorisationRequested'])['format']('dddd\x20DD\x20MMMM\x20YYYY');$('#trisys-timesheet-authorisationrequested')['html'](sAuthorisationRequested);}ClientTimesheet['CustomerSpecificConfiguration'](lTimesheetId,placement);}else{TriSysApex['UI']['ShowMessage']('Unable\x20to\x20find\x20timesheet');return;}return!![];}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),alert('ClientTimesheet.ShowTimesheetSummary:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Timesheet...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'Authorise':function(){var lTimesheetId=parseInt($('#trisys-timesheet-id')['html']());if(lTimesheetId<=0x0)return;var fnConfirmed=function(lTimesheetId){$('#ClientTimesheet-Menu-Authorise')['attr']('disabled',!![]),setTimeout(function(){var sMessage=TriSysSDK['Resources']['Message']('TriSysWeb.Pages.Timesheet.ConfirmedAuthorisationCallback.Message');TriSysApex['UI']['ShowMessage'](sMessage,TriSysWebJobs['Constants']['ApplicationName']);},0x64);},fnAuthoriseRequest=function(){return TriSysWebJobs['Timesheet']['AuthoriseRequest'](lTimesheetId,fnConfirmed),!![];},sCaption=TriSysSDK['Resources']['Message']('TriSysWeb.Pages.Timesheet.Authorise.PromptCaption'),sMessage=TriSysSDK['Resources']['Message']('TriSysWeb.Pages.Timesheet.Authorise.PromptMessage');TriSysApex['UI']['questionYesNo'](sMessage,sCaption,'Yes',fnAuthoriseRequest,'No',null);},'Decline':function(){var timesheetDetails={};timesheetDetails['TimesheetId']=parseInt($('#trisys-timesheet-id')['html']()),timesheetDetails['TimesheetId']=$('#trisys-timesheet-id')['html'](),timesheetDetails['Period']=$('#trisys-timesheet-period')['html'](),timesheetDetails['Candidate']=$('#trisys-timesheet-candidate')['html'](),timesheetDetails['CompanyName']=$('#trisys-timesheet-company')['html'](),timesheetDetails['ClientFullName']=$('#trisys-timesheet-linemanager')['html']();var fnAfterDecline=function(){$('#ClientTimesheet-Menu-Authorise')['attr']('disabled',!![]),$('#ClientTimesheet-Menu-Decline')['attr']('disabled',!![]);};TriSysWebJobs['Timesheet']['ClientDecline'](timesheetDetails,fnAfterDecline);},'CustomerSpecificConfiguration':function(lTimesheetId,placement){if(TriSysWebJobs['Agency']['CustomerIDMatch']('CoSector')){var bIntern=placement['Type']=='Intern';bIntern&&($('#trisys-timesheet-hours-rates-amounts-summary-block')['hide'](),$('#trisys-timesheet-please-check-message-block')['show']()),$('#trisys-timesheet-hours-rates-amounts-text')['html']('Hours\x20and\x20Rates'),$('#amountsTable\x20th:nth-child(6),\x20#amountsTable\x20td:nth-child(6)')['hide']();}}};$(document)['ready'](function(){});