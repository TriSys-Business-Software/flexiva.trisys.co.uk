var ctrlJobBoardApplicants={'_RequirementId':0x0,'Load':function(requirement){ctrlJobBoardApplicants['_RequirementId']=requirement['RequirementId'],$('#ctrlJobBoardApplicants-Requirement')['html'](requirement['Reference']),$('#ctrlJobBoardApplicants-JobTitle')['html'](requirement['JobTitle']),$('#ctrlJobBoardApplicants-JobBroadcaster')['html'](requirement['JobBroadcaster']),TriSysSDK['FormMenus']['DrawGridMenu']('ctrlJobBoardApplicants-GridMenu','ctrlJobBoardApplicants-DataGrid'),setTimeout(TriSysProUI['kendoUI_Overrides'],0xfa),ctrlJobBoardApplicants['ReadApplicantsFromJobBroadcaster'](requirement);var iFudgeFactor=0x1c2,lHeight=$(window)['height']()-iFudgeFactor;$('#ctrlJobBoardApplicants-GridScroller')['height'](lHeight);},'ReadApplicantsFromJobBroadcaster':function(requirement){var CReadApplicantsRequest={'Reference':requirement['Reference'],'JobBroadcaster':requirement['JobBroadcaster']},payloadObject={};payloadObject['URL']='JobBroadcaster/ReadApplicants',payloadObject['OutboundDataPacket']=CReadApplicantsRequest,payloadObject['InboundDataFunction']=function(CReadApplicantsResponse){TriSysApex['UI']['HideWait']();if(CReadApplicantsResponse){if(CReadApplicantsResponse['Success'])ctrlJobBoardApplicants['_BroadcasterJobURL']=CReadApplicantsResponse['BroadcasterJobURL'],ctrlJobBoardApplicants['PopulateGrid'](CReadApplicantsResponse['Applicants']);else{var sError=CReadApplicantsResponse['ErrorMessage'];if(!sError)sError='No\x20applicants\x20identified\x20via\x20'+requirement['JobBroadcaster'];TriSysApex['UI']['ShowMessage'](sError);}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlJobBoardApplicants.ReadApplicantsFromJobBroadcaster:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Applicants...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PopulateGrid':function(applicants){if(!applicants)return;for(var i=0x0;i<applicants['length'];i++){var applicant=applicants[i];applicant['Applicant_Id']+=0x1,applicant['Flag']='white';switch(applicant['Rank']){case'UnSuitable':applicant['Flag']='red';break;case'MaybeSuitable':applicant['Flag']='yellow';break;case'Suitable':applicant['Flag']='green';break;}}applicants['sort'](function(a,b){return b['ApplicationTime']>a['ApplicationTime'];}),ctrlJobBoardApplicants['_Applicants']=applicants;var sDivTag='ctrlJobBoardApplicants-DataGrid',sGridName=sDivTag+'-GridInstance';TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sGridName,'Title':'Applicants','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':applicants,'Columns':[{'field':'Applicant_Id','title':'Applicant_Id','type':'number','width':0x46,'hidden':!![]},{'field':'Suitability','title':'\x20','template':'<img\x20src=\x22images/trisys/72x72/flag-#=\x20Flag\x20#.png?ts=201803221020\x22\x20style=\x22width:\x2024px;\x20height:\x2024px;\x22\x20alt=\x22#=\x20Flag\x20#\x22>','width':0x23,'filterable':![]},{'field':'Name','title':'Applicant\x20Name','type':'string'},{'field':'ApplicationTime','title':'Applied','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x64},{'field':'Email','title':'E-Mail','type':'string'},{'field':'HomeTelNo','title':'Home\x20Tel\x20No','type':'string','hidden':!![]},{'field':'WorkTelNo','title':'Work\x20Tel\x20No','type':'string','hidden':!![]},{'field':'MobileTelNo','title':'Mobile\x20Tel\x20No','type':'string','hidden':!![]},{'field':'ChannelName','title':'Channel','type':'string'},{'field':'Rank','title':'Rank','type':'string','hidden':!![]}],'KeyColumnName':'Applicant_Id','MultiRowSelect':!![],'Grouping':![]});},'_Applicants':null,'GetSelectedSingletonApplicantIdFromGrid':function(){var lApplicantId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid']('ctrlJobBoardApplicants-DataGrid','Applicant_Id','applicant');return lApplicantId;},'GetApplicant':function(lApplicantId){var applicants=ctrlJobBoardApplicants['_Applicants'];if(applicants)for(var i=0x0;i<applicants['length'];i++){var applicant=applicants[i];if(applicant['Applicant_Id']==lApplicantId)return applicant;}return null;},'OpenCV':function(){var lApplicantId=ctrlJobBoardApplicants['GetSelectedSingletonApplicantIdFromGrid']();if(!lApplicantId)return;var applicant=ctrlJobBoardApplicants['GetApplicant'](lApplicantId);if(!applicant)return;if(!applicant['Doc_Text']||!applicant['FileName']){TriSysApex['UI']['ShowMessage']('No\x20CV\x20supplied\x20by\x20'+applicant['Name']);return;}var CGenerateApplicantCVRequest={'Base64':applicant['Doc_Text'],'FileName':applicant['FileName'],'JobBroadcaster':$('#ctrlJobBoardApplicants-JobBroadcaster')['html']()},payloadObject={};payloadObject['URL']='JobBroadcaster/GenerateApplicantCV',payloadObject['OutboundDataPacket']=CGenerateApplicantCVRequest,payloadObject['InboundDataFunction']=function(CGenerateApplicantCVResponse){TriSysApex['UI']['HideWait']();if(CGenerateApplicantCVResponse){if(CGenerateApplicantCVResponse['Success'])TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](CGenerateApplicantCVResponse['ServerFilePath']);else TriSysApex['UI']['ShowMessage'](CGenerateApplicantCVResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlJobBoardApplicants.OpenCV:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Generating\x20CV...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AddToShortlist':function(){var lApplicantId=ctrlJobBoardApplicants['GetSelectedSingletonApplicantIdFromGrid']();if(!lApplicantId)return;var applicant=ctrlJobBoardApplicants['GetApplicant'](lApplicantId);if(!applicant)return;var CImportApplicantRequest={'Applicant':applicant,'JobBroadcaster':$('#ctrlJobBoardApplicants-JobBroadcaster')['html']()},payloadObject={};payloadObject['URL']='JobBroadcaster/ImportApplicant',payloadObject['OutboundDataPacket']=CImportApplicantRequest,payloadObject['InboundDataFunction']=function(CImportApplicantResponse){TriSysApex['UI']['HideWait']();if(CImportApplicantResponse){if(CImportApplicantResponse['Success'])ctrlJobBoardApplicants['OpenApplicantImportPopup'](applicant,CImportApplicantResponse['PotentialDuplicates'],CImportApplicantResponse['CVServerPath']);else TriSysApex['UI']['ShowMessage'](CImportApplicantResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlJobBoardApplicants.AddToShortlist:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Importing\x20Applicant...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenApplicantImportPopup':function(applicant,potentialDuplicateCandidates,sCVServerPath){var requirement={'RequirementId':TriSysApex['Pages']['RequirementForm']['RequirementId'],'Reference':$('#ctrlJobBoardApplicants-Requirement')['html'](),'JobTitle':$('#ctrlJobBoardApplicants-JobTitle')['html'](),'JobBroadcaster':$('#ctrlJobBoardApplicants-JobBroadcaster')['html']()},fnLoadModal=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Job\x20Board\x20Applicant\x20Import',parametersObject['FullScreen']=!![],parametersObject['Image']='gi-parents',parametersObject['Draggable']=![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlJobBoardApplicantImport.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Add\x20to\x20Shortlist',parametersObject['ButtonLeftFunction']=function(){return ctrlJobBoardApplicantImport['AddToShortlist'](),![];},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightFunction']=function(){return!![];},parametersObject['OnLoadCallback']=function(){ctrlJobBoardApplicantImport['Load'](requirement,applicant,potentialDuplicateCandidates,sCVServerPath);},TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlJobBoardApplicantImport.js',null,fnLoadModal);},'_BroadcasterJobURL':null,'OpenJobAdvert':function(){ctrlJobBoardApplicants['_BroadcasterJobURL']&&TriSysSDK['Browser']['OpenURL'](ctrlJobBoardApplicants['_BroadcasterJobURL']);},'AddToShortlistCandidateAfterImport':function(lContactId,sCandidateName,sJobBoard){var fnCallback=function(){ctrlRequirementForm['PopulateCandidateGrid']('requirementForm-ShortlistGrid',![],!![]),TriSysApex['Toasters']['Information'](sCandidateName+'\x20has\x20been\x20added\x20to\x20the\x20shortlist.');},CAddToShortlistRequest={'RequirementId':ctrlJobBoardApplicants['_RequirementId'],'ContactId':lContactId,'JobBroadcaster':$('#ctrlJobBoardApplicants-JobBroadcaster')['html'](),'JobBoard':sJobBoard},payloadObject={};payloadObject['URL']='JobBroadcaster/AddToShortlist',payloadObject['OutboundDataPacket']=CAddToShortlistRequest,payloadObject['InboundDataFunction']=function(CAddToShortlistResponse){if(CAddToShortlistResponse){if(CAddToShortlistResponse['Success'])fnCallback();else TriSysApex['UI']['ShowMessage'](CAddToShortlistResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('ctrlJobBoardApplicants.AddToShortlist:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};