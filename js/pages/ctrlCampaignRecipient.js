var ctrlCampaignRecipient={'Load':function(lContactId,lMarketingCampaignId){var CReadCampaignRecipientRequest={'MarketingCampaignId':lMarketingCampaignId,'ContactId':lContactId},payloadObject={};payloadObject['URL']='Marketing/ReadCampaignRecipient',payloadObject['OutboundDataPacket']=CReadCampaignRecipientRequest,payloadObject['InboundDataFunction']=function(CReadCampaignRecipientResponse){if(CReadCampaignRecipientResponse){if(CReadCampaignRecipientResponse['Success']){$('#ctrlCampaignRecipient-CampaignName')['html'](CReadCampaignRecipientResponse['Campaign']['Name']),$('#ctrlCampaignRecipient-ContactName')['html'](CReadCampaignRecipientResponse['Contact']['FullName']),ctrlCampaignRecipient['ShowDateField']('Added',CReadCampaignRecipientResponse['Added']),ctrlCampaignRecipient['ShowDateField']('Scheduled',CReadCampaignRecipientResponse['Scheduled']),ctrlCampaignRecipient['ShowDateField']('Sent',CReadCampaignRecipientResponse['Sent']),ctrlCampaignRecipient['ShowDateField']('Delivered',CReadCampaignRecipientResponse['Delivered']),ctrlCampaignRecipient['ShowDateField']('Undelivered',CReadCampaignRecipientResponse['Undelivered']),ctrlCampaignRecipient['ShowDateField']('Opened',CReadCampaignRecipientResponse['Opened']);if(CReadCampaignRecipientResponse['Clicks']){var clicks=CReadCampaignRecipientResponse['Clicks'],sClicks='';clicks['forEach'](function(clickItem){if(sClicks['length']>0x0)sClicks+='<br\x20/><br\x20/>';var sHyperlink='<a\x20href=\x22'+clickItem['RedirectURL']+'\x22\x20target=\x22_blank\x22>'+clickItem['RedirectURL']+'</a>';sClicks+=moment(clickItem['Timestamp'])['format']('dddd\x20DD\x20MMMM\x20YYYY\x20HH:mm')+'<br\x20/>'+sHyperlink;}),$('#ctrlCampaignRecipient-Clicks')['html'](sClicks),$('#ctrlCampaignRecipient-ClickCount')['html'](clicks['length']);}else $('#ctrlCampaignRecipient-Clicks-tr')['hide']();}else TriSysApex['UI']['ShowMessage'](CReadCampaignRecipientResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ctrlCampaignRecipient.Load:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowDateField':function(sField,dtValue){var sValue='',bHide=![],dt=new Date(dtValue);if(dt['getFullYear']()>=0x7e2)sValue=moment(dt)['format']('dddd\x20DD\x20MMMM\x20YYYY\x20HH:mm');else bHide=!![];$('#ctrlCampaignRecipient-'+sField)['html'](sValue),bHide?$('#ctrlCampaignRecipient-'+sField+'-tr')['hide']():$('#ctrlCampaignRecipient-'+sField+'-tr')['show']();},'OpenEMail':function(lContactId,lMarketingCampaignId){var CReadSentCampaignEMailRequest={'MarketingCampaignId':lMarketingCampaignId,'ContactId':lContactId},payloadObject={};payloadObject['URL']='Marketing/ReadSentCampaignEMail',payloadObject['OutboundDataPacket']=CReadSentCampaignEMailRequest,payloadObject['InboundDataFunction']=function(CReadSentCampaignEMailResponse){if(CReadSentCampaignEMailResponse){if(CReadSentCampaignEMailResponse['Success'])TriSysSDK['Controls']['FileManager']['GetOpenFileURLFromWebService'](CReadSentCampaignEMailResponse['Title'],CReadSentCampaignEMailResponse['FilePath'],CReadSentCampaignEMailResponse['FileName']);else TriSysApex['UI']['ShowMessage'](CReadSentCampaignEMailResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('ctrlCampaignRecipient.OpenEMail:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};