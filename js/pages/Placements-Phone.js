var PlacementsPhone={'SearchTextCookieName':'PlacementsPhone-Text','Load':function(sText){!sText&&(sText=TriSysAPI['Cookies']['getCookie'](PlacementsPhone['SearchTextCookieName'])),sText&&($('#placements-form-lookup')['val'](sText),PlacementsPhone['LookupButtonClick']()),$('#placements-form-lookup')['keyup'](function(e){e['keyCode']==0xd&&PlacementsPhone['LookupButtonClick']();}),$('#placements-form-lookup-button')['click'](PlacementsPhone['LookupButtonClick']);},'LookupButtonClick':function(){var sText=$('#placements-form-lookup')['val']();TriSysAPI['Cookies']['setCookie'](PlacementsPhone['SearchTextCookieName'],sText),$('#placements-form-paged-list-container')['empty'](),PlacementsPhone['ShowFigures'](),PlacementsPhone['_CurrentPageNumber']=0x1,PlacementsPhone['WebAPISearch'](sText,PlacementsPhone['_CurrentPageNumber']);},'WebAPISearch':function(sWildcard,iPageNumber){var spinnerWait={'Div':'placements-form-paged-list-container'},CPlacementsSearchRequest={'Wildcard':sWildcard,'PageNumber':iPageNumber,'RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'SortColumnName':'StartDate','SortAscending':![]};TriSysPhoneGap['ParseEntityIdInSearchExpression'](sWildcard,CPlacementsSearchRequest);var payloadObject={};payloadObject['URL']='Placements/Search',payloadObject['OutboundDataPacket']=CPlacementsSearchRequest,payloadObject['InboundDataFunction']=function(CPlacementsSearchResponse){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]);if(CPlacementsSearchResponse){PlacementsPhone['ShowFigures'](CPlacementsSearchResponse['Results']);if(CPlacementsSearchResponse['Success'])PlacementsPhone['AppendRecordsToDOM'](CPlacementsSearchResponse['Results']);else{}return;}TriSysApex['UI']['ShowError']('PlacementsPhone.WebAPISearch\x20Error:\x20null\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,![]),TriSysApex['UI']['errorAlert']('PlacementsPhone.WebAPISearch:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysSDK['Grid']['WaitSpinnerMode'](spinnerWait,!![]),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowFigures':function(CPlacementsSearchResults){var figures=$('#placements-form-lookup-figures');figures['html'](CPlacementsSearchResults?'No\x20records\x20found':'Searching...'),$('#placements-form-first-page-button')['hide'](),$('#placements-form-next-page-button')['hide']();if(CPlacementsSearchResults){figures['html']('Showing\x20rows\x201\x20to\x20'+CPlacementsSearchResults['LastRowNumber']+'\x20of\x20'+CPlacementsSearchResults['TotalRecordCount']+'\x20records');if(CPlacementsSearchResults['LastRowNumber']>0x8)$('#placements-form-first-page-button')['show']();PlacementsPhone['_CurrentPageNumber']=CPlacementsSearchResults['PageNumber'];if(CPlacementsSearchResults['PageNumber']<CPlacementsSearchResults['TotalPageCount']){$('#placements-form-next-page-button')['show']();var iNextPage=parseInt(CPlacementsSearchResults['PageNumber'])+0x1;$('#placements-form-next-page-button-text')['html']('Next\x20Page\x20'+iNextPage+'\x20of\x20'+CPlacementsSearchResults['TotalPageCount']);}}},'AppendRecordsToDOM':function(CPlacementsSearchResults){if(CPlacementsSearchResults['TotalRecordCount']>0x0&&CPlacementsSearchResults['Placements']){for(var i=0x0;i<CPlacementsSearchResults['Placements']['length'];i++){var placement=CPlacementsSearchResults['Placements'][i],sHTML=PlacementsPhone['BuildRecordFromTemplate'](placement);$('#placements-form-paged-list-container')['append'](sHTML);}TriSysApex['Device']['FixTextEllipsesHack']('.truncated-placements-text');if(PlacementsPhone['_CurrentPageNumber']>0x1)setTimeout(PlacementsPhone['ScrollToBottom'],0xa);}},'BuildRecordFromTemplate':function(CPlacementSummarySuperset){var sHTML=$('#placements-form-template')['html']();sHTML=sHTML['replace']('#:PlacementId#',CPlacementSummarySuperset['PlacementId']),sHTML=sHTML['replace']('#:Reference#',CPlacementSummarySuperset['Reference']),sHTML=sHTML['replace']('#:Consultant#',CPlacementSummarySuperset['UserName']),sHTML=sHTML['replace']('#:JobTitle#',CPlacementSummarySuperset['JobTitle']),sHTML=sHTML['replace']('#:Status#',CPlacementSummarySuperset['Status']),sHTML=sHTML['replace']('#:CompanyName#',CPlacementSummarySuperset['CompanyName']),sHTML=sHTML['replace']('#:City#',CPlacementSummarySuperset['City']);var sStart=moment(CPlacementSummarySuperset['StartDate'])['format']('ddd\x20DD\x20MMM\x20YYYY');sHTML=sHTML['replace']('#:ClientContact#',CPlacementSummarySuperset['ClientName']),sHTML=sHTML['replace']('#:CandidateContact#',CPlacementSummarySuperset['CandidateName']),sHTML=sHTML['replace']('#:StartDate#',sStart);if(!CPlacementSummarySuperset['CompanyLogoURL'])CPlacementSummarySuperset['CompanyLogoURL']=TriSysApex['Constants']['DefaultCompanyImage'];return sHTML=sHTML['replace']('#:CompanyLogoURL#',CPlacementSummarySuperset['CompanyLogoURL']),sHTML;},'RowClick':function(thisRow){var lPlacementId=thisRow;TriSysApex['FormsManager']['OpenForm']('Placement',lPlacementId,!![]);},'New':function(){TriSysApex['Pages']['PlacementForm']['NewRecord'](0x0);},'ScrollToTop':function(){$(document['body'])['scrollTop']($('#placements-form-top')['offset']()['top']-0x78);},'ScrollToBottom':function(){$(document['body'])['scrollTop']($('#placements-form-first-page-button')['offset']()['top']);},'_CurrentPageNumber':0x0,'NextPage':function(){var sText=$('#placements-form-lookup')['val']();PlacementsPhone['WebAPISearch'](sText,PlacementsPhone['_CurrentPageNumber']+0x1);}};