var ctrlPermanentSalary={'Initialise':function(bRequirement){var sRequirementRow='trisys-requirement-form-permanent-salary-row',sPlacementRow='trisys-placement-form-permanent-salary-row',sRowToShow=bRequirement?sRequirementRow:sPlacementRow;$('#'+sRowToShow)['show']();var sEntityName=bRequirement?'Requirement':'Placement';TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_MaximumSalary',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_Bonus',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_BenefitsValue',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_CarValue',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_FeePercentage',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_Fee',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('RequirementConfigFields_FixedTermDurationWeeks',ctrlPermanentSalary['RequirementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_Salary',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_Bonus',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_BenefitsValue',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_CarValue',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_FeePercentage',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_Fee',ctrlPermanentSalary['PlacementCalculationEngine']),TriSysApex['FieldEvents']['AddNumberChangeFieldOfInterest']('PlacementConfigFields_FixedTermDurationWeeks',ctrlPermanentSalary['PlacementCalculationEngine']),ctrlPermanentSalary['FlatFee'](sEntityName),$('#'+sEntityName+'ConfigFields_FlatFee')['change'](function(){ctrlPermanentSalary['FlatFee'](sEntityName,!![]);}),ctrlPermanentSalary['CompanyCarFields'](sEntityName),ctrlPermanentSalary['FixedTerm'](sEntityName),$('#'+sEntityName+'ConfigFields_FixedTerm')['change'](function(){ctrlPermanentSalary['FixedTerm'](sEntityName,!![]);}),$('#permanent-salary-calculate-fee-by-total-package')['change'](function(){ctrlPermanentSalary['CalculateFeeByTotalPackage'](!![]);}),TriSysSDK['Controls']['CurrencyAmount']['Readonly'](sEntityName+'ConfigFields_TotalPackageValue',!![]),TriSysSDK['Controls']['CurrencyAmount']['SetIncrement'](sEntityName+'ConfigFields_Bonus',0x64),TriSysSDK['Controls']['CurrencyAmount']['SetIncrement'](sEntityName+'ConfigFields_Fee',0x64),TriSysSDK['Controls']['NumericSpinner']['SetIncrement'](sEntityName+'ConfigFields_FeePercentage',0.25),TriSysSDK['Controls']['CurrencyAmountPeriod']['SetIncrement']('PlacementConfigFields_Salary',0x64),ctrlPermanentSalary['CalculationEngine'](sEntityName),ctrlPermanentSalary['CustomerSpecificOverrides']['Initialise']();},'FlatFee':function(sEntityName,bRecalculate){var bFlatFee=TriSysSDK['CShowForm']['CheckBoxValue'](sEntityName+'ConfigFields_FlatFee');TriSysSDK['Controls']['CurrencyAmount']['Readonly'](sEntityName+'ConfigFields_Fee',!bFlatFee),TriSysSDK['Controls']['NumericSpinner']['Readonly'](sEntityName+'ConfigFields_FeePercentage',bFlatFee);if(bRecalculate)ctrlPermanentSalary['CalculationEngine'](sEntityName,sEntityName+'ConfigFields_FlatFee',bFlatFee);},'CompanyCarFields':function(sEntityName,bRecalculate){var sCompanyCarText=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPermanentSalary['CompanyCarFieldName'](sEntityName));TriSysApex['Logging']['LogMessage']('CompanyCarFields:\x20'+sCompanyCarText);var bCarIncluded=sCompanyCarText=='Included';if(ctrlPermanentSalary['CustomerSpecificOverrides']['CarValueReadOnly']())TriSysSDK['Controls']['CurrencyAmount']['Readonly'](sEntityName+'ConfigFields_CarValue',!bCarIncluded);TriSysSDK['CShowForm']['ComboEnabled'](ctrlPermanentSalary['IncludeCompanyCarInFeeFieldName'](sEntityName),bCarIncluded);if(bRecalculate)ctrlPermanentSalary['CalculationEngine'](sEntityName,ctrlPermanentSalary['CompanyCarFieldName'](sEntityName),bCarIncluded);},'FixedTerm':function(sEntityName,bRecalculate){var bFixedTerm=TriSysSDK['CShowForm']['CheckBoxValue'](sEntityName+'ConfigFields_FixedTerm');TriSysSDK['Controls']['NumericSpinner']['Readonly'](sEntityName+'ConfigFields_FixedTermDurationWeeks',!bFixedTerm);if(bRecalculate)ctrlPermanentSalary['CalculationEngine'](sEntityName,sEntityName+'ConfigFields_FixedTerm',bFixedTerm);},'CalculateFeeByTotalPackage':function(bRecalculate){var sField='permanent-salary-calculate-fee-by-total-package',bCalculateFeeByTotalPackage=TriSysSDK['CShowForm']['CheckBoxValue'](sField);if(bRecalculate)ctrlPermanentSalary['RequirementCalculationEngine'](sField,bCalculateFeeByTotalPackage);},'SalaryFieldNameForCalculation':function(sEntityName){var sFieldName=sEntityName+'ConfigFields_'+(sEntityName=='Requirement'?'Maximum':'')+'Salary';return sFieldName;},'CompanyCarFieldName':function(sEntityName){var sFieldName=sEntityName+'ConfigFields_'+(sEntityName=='Requirement'?'Company':'')+'Car';return sFieldName;},'IncludeCompanyCarInFeeFieldName':function(sEntityName){var sFieldName=sEntityName+'ConfigFields_'+(sEntityName=='Placement'?'Placement':'')+'IncludeCarInFee';return sFieldName;},'RequirementCalculationEngine':function(sFieldID,fValue){ctrlPermanentSalary['CalculationEngine']('Requirement',sFieldID,fValue);},'PlacementCalculationEngine':function(sFieldID,fValue){ctrlPermanentSalary['CalculationEngine']('Placement',sFieldID,fValue);},'CalculationEngine':function(sEntityName,sFieldID,fValue){TriSysApex['Logging']['LogMessage']('ctrlPermanentSalary.CalculationEngine:\x20'+sFieldID+'='+fValue);var sSalaryField=ctrlPermanentSalary['SalaryFieldNameForCalculation'](sEntityName),sMaximumSalary=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetCurrencyAmountPeriod'](sSalaryField),sMinimumSalary=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetCurrencyAmountPeriod'](sEntityName+'ConfigFields_MinimumSalary');TriSysApex['Logging']['LogMessage']('ctrlPermanentSalary.CalculationEngine:\x201');var sCurrency=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetCurrency'](sSalaryField),fBonus=TriSysSDK['Controls']['CurrencyAmount']['GetAmount'](sEntityName+'ConfigFields_Bonus'),fBenefits=TriSysSDK['Controls']['CurrencyAmount']['GetAmount'](sEntityName+'ConfigFields_BenefitsValue'),fCarValue=TriSysSDK['Controls']['CurrencyAmount']['GetAmount'](sEntityName+'ConfigFields_CarValue'),fMaximumSalaryAmount=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetAmount'](sSalaryField),fMinimumSalaryAmount=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetAmount'](sEntityName+'ConfigFields_MinimumSalary'),sCompanyCarText=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPermanentSalary['CompanyCarFieldName'](sEntityName)),sIncludeCarInFeeText=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPermanentSalary['IncludeCompanyCarInFeeFieldName'](sEntityName));TriSysApex['Logging']['LogMessage']('ctrlPermanentSalary.CalculationEngine:\x202:\x20'+sIncludeCarInFeeText);var bCarValueIncluded=sCompanyCarText=='Included'&&sIncludeCarInFeeText=='Include';if(!bCarValueIncluded)fCarValue=0x0;var fTotalPackage=fMaximumSalaryAmount+fBonus+fBenefits+fCarValue;TriSysApex['Logging']['LogMessage']('ctrlPermanentSalary.CalculationEngine:\x203:\x20'+fTotalPackage),TriSysSDK['Controls']['CurrencyAmount']['SetCurrencyAmount'](sEntityName+'ConfigFields_TotalPackageValue',sCurrency+fTotalPackage);var fTotalAmountForFeeCalculation=fMaximumSalaryAmount+fCarValue;if(sEntityName=='Requirement'){var bCalculateFeeByTotalPackage=TriSysSDK['CShowForm']['CheckBoxValue']('permanent-salary-calculate-fee-by-total-package');if(bCalculateFeeByTotalPackage)fTotalAmountForFeeCalculation=fTotalPackage;}var fFeeAmount=TriSysSDK['Controls']['CurrencyAmount']['GetAmount'](sEntityName+'ConfigFields_Fee'),bFlatFee=TriSysSDK['CShowForm']['CheckBoxValue'](sEntityName+'ConfigFields_FlatFee');if(bFlatFee){var fFeePercentage=fFeeAmount/fTotalAmountForFeeCalculation*0x64;TriSysSDK['Controls']['NumericSpinner']['SetValue'](sEntityName+'ConfigFields_FeePercentage',fFeePercentage);}else{var fFeePercentage=TriSysSDK['Controls']['NumericSpinner']['GetValue'](sEntityName+'ConfigFields_FeePercentage');fFeeAmount=fTotalAmountForFeeCalculation*(fFeePercentage/0x64);var bFixedTerm=TriSysSDK['CShowForm']['CheckBoxValue'](sEntityName+'ConfigFields_FixedTerm');if(bFixedTerm){var fFixedTermDurationWeeks=TriSysSDK['Controls']['NumericSpinner']['GetValue'](sEntityName+'ConfigFields_FixedTermDurationWeeks');fFeeAmount=fFeeAmount/0x34*fFixedTermDurationWeeks;}TriSysSDK['Controls']['CurrencyAmount']['SetCurrencyAmount'](sEntityName+'ConfigFields_Fee',sCurrency+fFeeAmount);}TriSysApex['Logging']['LogMessage']('ctrlPermanentSalary.CalculationEngine:\x20EXIT:\x20'+fTotalPackage);var figures={};figures['Salary']=fMaximumSalaryAmount,figures['Bonus']=fBonus,figures['Benefits']=fBenefits,figures['Car']=fCarValue,ctrlPermanentSalary['DrawChart'](sEntityName,figures);},'DrawChart':function(sEntityName,figures){var sChart='trisys-'+sEntityName['toLowerCase']()+'-form-permanent-salary-chart',lColorSalary=TriSysProUI['NavBarInverseColour'](),lColorBonus=TriSysProUI['BackColour'](),lColorBenefits=TriSysProUI['ThemedSidebarBackgroundLight'](0.25),lColorCar=TriSysProUI['BackColour'](0.2);if(TriSysProUI['CurrentThemeNameLike']('Night'))lColorBonus=TriSysProUI['LightenColour'](lColorBonus,0.1);var fTotal=figures['Salary']+figures['Bonus']+figures['Benefits']+figures['Car'],fnCalcPercentage=function(fValue,fTotal){var fPercentage=0x0;if(fValue>0x0)fPercentage=fValue/fTotal*0x64;return fPercentage;},fSalaryPercentage=fnCalcPercentage(figures['Salary'],fTotal),fBonusPercentage=fnCalcPercentage(figures['Bonus'],fTotal),fBenefitsPercentage=fnCalcPercentage(figures['Benefits'],fTotal),fCarPercentage=fnCalcPercentage(figures['Car'],fTotal),seriesData=[],seriesColors=[];if(fSalaryPercentage>0x0){seriesColors['push'](lColorSalary);var salaryData={'category':'Salary','value':fSalaryPercentage};seriesData['push'](salaryData);}if(fBonusPercentage>0x0){seriesColors['push'](lColorBonus);var bonusData={'category':'Bonus','value':fBonusPercentage};seriesData['push'](bonusData);}if(fBenefitsPercentage>0x0){seriesColors['push'](lColorBenefits);var benefitsData={'category':'Benefits','value':fBenefitsPercentage};seriesData['push'](benefitsData);}if(fCarPercentage>0x0){seriesColors['push'](lColorCar);var carData={'category':'Car','value':fCarPercentage};seriesData['push'](carData);}$('#'+sChart)['kendoChart']({'legend':{'position':'bottom','labels':{'font':TriSysSDK['KendoUICharts']['Font']}},'chartArea':{'height':0x15e},'seriesDefaults':{'labels':{'template':'#=\x20category\x20#\x20-\x20#=\x20kendo.format(\x27{0:P}\x27,\x20percentage)#','position':'outsideEnd','visible':![],'background':'transparent','font':TriSysSDK['KendoUICharts']['Font']}},'seriesColors':seriesColors,'series':[{'type':'donut','data':seriesData}],'tooltip':{'visible':!![],'template':'<span\x20style=\x22color:white;\x22>#=\x20category\x20#\x20-\x20#=\x20kendo.format(\x22{0:P}\x22,\x20percentage)\x20#</span>'}});},'CustomerSpecificOverrides':{'Initialise':function(){ctrlPermanentSalary['CustomerSpecificOverrides']['_AlmaITSalesRecruitment']=TriSysApex['LoginCredentials']['isLoggedInToSpecificCompanyAsRecruiter']('Alma\x20IT\x20Sales\x20Recruitment\x20Ltd');if(ctrlPermanentSalary['CustomerSpecificOverrides']['_AlmaITSalesRecruitment']){var currencyAmountPeriods=['RequirementConfigFields_MinimumSalary-CurrencyAmountPeriod_Period','RequirementConfigFields_MaximumSalary-CurrencyAmountPeriod_Period'];$['each'](currencyAmountPeriods,function(index,item){var elem=$('#'+item)['data']('kendoDropDownList');if(elem)elem['enable'](![]);}),TriSysSDK['CShowForm']['SetSkillsInList']('RequirementConfigFields_IncludeCarInFee','Include'),TriSysSDK['CShowForm']['SetSkillsInList']('PlacementConfigFields_PlacementIncludeCarInFee','Include'),TriSysSDK['CShowForm']['SetCheckBoxValue']('permanent-salary-calculate-fee-by-total-package',![]),TriSysSDK['Controls']['CurrencyAmount']['Readonly']('RequirementConfigFields_CarValue',![]);}},'_AlmaITSalesRecruitment':![],'CarValueReadOnly':function(){if(ctrlPermanentSalary['CustomerSpecificOverrides']['_AlmaITSalesRecruitment'])return![];return!![];}}};