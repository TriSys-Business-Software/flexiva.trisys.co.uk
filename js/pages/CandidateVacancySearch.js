var CandidateVacancySearch={'ReferenceID':'txtVacancySearchReference','JobTitleComboID':'txtVacancySearchJobTitle','ContactTypeComboID':'txtVacancySearchType','LocationComboID':'txtVacancySearchLocation','CategoriesAttributesComboID':'txtVacancySearchSkillCategories','FreeTextID':'txtVacancySearchFreeText','MinimumSalaryRateID':'txtVacancySearchMinimumSalaryRate','MaximumSalaryRateID':'txtVacancySearchMaximumSalaryRate','StartDateID':'dtVacancySearchStartDate','StartDateOperatorID':'cmbVacancySearchStartDateOperator','DateOnOrAfter':'On\x20or\x20after','DateOnOrBefore':'On\x20or\x20before','CookieName':'CandidateVacancySearch.SearchCriteria','GridID':'divCandidateVacancySearchGrid','MapID':'divCandidateVacancySearchMap','Menu_ShowOnMap':'CandidateVacancySearch-Menu-ShowOnMap','Menu_ShowInGrid':'CandidateVacancySearch-Menu-ShowInGrid','Menu_SendToFriend':'CandidateVacancySearch-Menu-SendToFriend','Menu_Apply':'CandidateVacancySearch-Menu-Apply','Menu_AddToFavourites':'CandidateVacancySearch-Menu-AddToFavourites','Menu_Grid':'CandidateVacancySearch-Menu-Grid','Menu_Grid_Class':'.btn.btn-sm.btn-default.dropdown-toggle.enable-tooltip','CategorySkillSeparator':'\x20>\x20','Mobile_Button_RemoveJobTitles':'btnVacancySearchJobTitle','Mobile_Button_RemoveTypes':'btnVacancySearchType','Mobile_Button_RemoveLocations':'btnVacancySearchLocation','Mobile_Button_RemoveSkillCategories':'btnVacancySearchSkillCategories','MapKey':'CandidateVacancySearch-MapKey','LoadFromURL':function(sParameters){CandidateVacancySearch['Load']();},'Load':function(){$('#webjobs-customer-name')['html'](TriSysWebJobs['Agency']['CustomerName']),TriSysSDK['CShowForm']['contactTypeOfWorkField'](CandidateVacancySearch['ContactTypeComboID']),TriSysSDK['Controls']['CurrencyAmountPeriod']['PopulateCurrencyAmountPeriodWidget'](CandidateVacancySearch['MinimumSalaryRateID'],0x1,'Annum'),TriSysSDK['Controls']['CurrencyAmountPeriod']['PopulateCurrencyAmountPeriodWidget'](CandidateVacancySearch['MaximumSalaryRateID'],0x1,'Annum'),TriSysSDK['CShowForm']['datePicker'](CandidateVacancySearch['StartDateID']);var sourceWhen=[{'text':CandidateVacancySearch['DateOnOrAfter'],'value':0x0},{'text':CandidateVacancySearch['DateOnOrBefore'],'value':0x1}];TriSysSDK['CShowForm']['populateComboFromDataSource'](CandidateVacancySearch['StartDateOperatorID'],sourceWhen,0x0);var bPhone=TriSysApex['Device']['isPhone'](),bTablet=TriSysApex['Device']['isTablet']();if(!bPhone&&!bTablet)TriSysSDK['FormMenus']['DrawGridMenu'](CandidateVacancySearch['Menu_Grid'],CandidateVacancySearch['GridID']);else{if(bPhone)$('#'+CandidateVacancySearch['Menu_Grid'])['hide']();}TriSysApex['Device']['isTouch']()&&($('#'+CandidateVacancySearch['Mobile_Button_RemoveJobTitles'])['show'](),$('#'+CandidateVacancySearch['Mobile_Button_RemoveTypes'])['show'](),$('#'+CandidateVacancySearch['Mobile_Button_RemoveLocations'])['show'](),$('#'+CandidateVacancySearch['Mobile_Button_RemoveSkillCategories'])['show']());CandidateVacancySearch['LoadSearchCriteria']();if(!TriSysWebJobs['Constants']['CandidateVacancySearchPageHeaderVisible'])$('#CandidateVacancySearchPageHeader')['hide']();TriSysWebJobs['Frame']['ApplyDynamicFeaturesAndStyleAfterFormLoaded'](),$('#'+CandidateVacancySearch['FreeTextID'])['keyup'](function(e){e['keyCode']==0xd&&CandidateVacancySearch['Search']();});},'Search':function(){TriSysApex['UI']['ShowWait'](null,'Searching...');var searchCriteria={};searchCriteria['Reference']=$('#'+CandidateVacancySearch['ReferenceID'])['val'](),searchCriteria['JobTitles']=TriSysSDK['CShowForm']['GetSelectedSkillsFromListAsArray'](CandidateVacancySearch['JobTitleComboID']),searchCriteria['Locations']=TriSysSDK['CShowForm']['GetSelectedSkillsFromListAsArray'](CandidateVacancySearch['LocationComboID']),searchCriteria['CategoriesAttributes']=TriSysSDK['CShowForm']['GetSelectedSkillsFromListAsArray'](CandidateVacancySearch['CategoriesAttributesComboID']),searchCriteria['FreeText']=$('#'+CandidateVacancySearch['FreeTextID'])['val'](),searchCriteria['Types']=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](CandidateVacancySearch['ContactTypeComboID']),searchCriteria['MinSalaryRate']=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetCurrencyAmountPeriod'](CandidateVacancySearch['MinimumSalaryRateID']),searchCriteria['MaxSalaryRate']=TriSysSDK['Controls']['CurrencyAmountPeriod']['GetCurrencyAmountPeriod'](CandidateVacancySearch['MaximumSalaryRateID']),searchCriteria['StartDateOperator']=TriSysSDK['CShowForm']['GetTextFromCombo'](CandidateVacancySearch['StartDateOperatorID']),searchCriteria['StartDate']=TriSysSDK['CShowForm']['getDatePickerValue'](CandidateVacancySearch['StartDateID']),TriSysAPI['Persistence']['Write'](TriSysWebJobs['Security']['CookieName'](CandidateVacancySearch['CookieName']),searchCriteria);if(!searchCriteria['Reference'])searchCriteria['Reference']='%';else searchCriteria['Reference']='%'+searchCriteria['Reference']+'%';if(searchCriteria['StartDate'])searchCriteria['StartDate']=moment(searchCriteria['StartDate'])['format']('YYYY-MM-DD');var bOnOrAfter=searchCriteria['StartDateOperator']==CandidateVacancySearch['DateOnOrAfter'],bPermanent=!![],bContract=!![],bTemp=!![];searchCriteria['Types']&&(bPermanent=searchCriteria['Types']['indexOf']('Perm')>=0x0,bContract=searchCriteria['Types']['indexOf']('Contract')>=0x0,bTemp=searchCriteria['Types']['indexOf']('Temp')>=0x0);var lstSkillCategories=null;if(searchCriteria['CategoriesAttributes']){var sCurrentCategory=null;for(var i=0x0;i<searchCriteria['CategoriesAttributes']['length'];i++){var sCategorySkill=searchCriteria['CategoriesAttributes'][i],iOurSeparator=sCategorySkill['indexOf'](CandidateVacancySearch['CategorySkillSeparator']);if(iOurSeparator>0x0){var sCategory=sCategorySkill['substring'](0x0,iOurSeparator),sSkill=sCategorySkill['substring'](iOurSeparator+CandidateVacancySearch['CategorySkillSeparator']['length']);if(!lstSkillCategories)lstSkillCategories=[];var skillCategory=null;sCurrentCategory!=sCategory?(skillCategory={'Category':sCategory,'Skills':[sSkill]},lstSkillCategories['push'](skillCategory),sCurrentCategory=sCategory):(skillCategory=lstSkillCategories[lstSkillCategories['length']-0x1],skillCategory['Skills']['push'](sSkill));}else{var bManeGroup=TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()=='Mane-Group'['toLowerCase']();if(bManeGroup){var sCategory='Advertising\x20Industry';if(!lstSkillCategories)lstSkillCategories=[{'Category':sCategory,'Skills':[sCategorySkill]}];else lstSkillCategories[0x0]['Skills']['push'](sCategorySkill);}}}}var fnPopulationByFunction={'API':'Vacancies/Search','Parameters':function(CVacancySearchCriteria){CVacancySearchCriteria['Reference']=searchCriteria['Reference'],CVacancySearchCriteria['Status']='Active',CVacancySearchCriteria['Locations']=searchCriteria['Locations'],CVacancySearchCriteria['JobTitles']=searchCriteria['JobTitles'],CVacancySearchCriteria['Permanent']=bPermanent,CVacancySearchCriteria['Contract']=bContract,CVacancySearchCriteria['Temp']=bTemp,CVacancySearchCriteria['Types']=searchCriteria['Types'],CVacancySearchCriteria['StartDate']=searchCriteria['StartDate'],CVacancySearchCriteria['StartDateOnOrAfter']=bOnOrAfter,CVacancySearchCriteria['SalaryRateMinimum']=searchCriteria['MinSalaryRate'],CVacancySearchCriteria['SalaryRateMaximum']=searchCriteria['MaxSalaryRate'],CVacancySearchCriteria['SortColumnName']='StartDate',CVacancySearchCriteria['SortAscending']=![],CVacancySearchCriteria['SkillCategories']=lstSkillCategories,CVacancySearchCriteria['FreeText']=searchCriteria['FreeText'];},'DataTableFunction':function(response){return TriSysApex['UI']['HideWait'](),TriSysWebJobs['Mapping']['PopulateVacanciesMap'](response['Vacancies'],CandidateVacancySearch['MapID'],CandidateVacancySearch['Menu_ShowInGrid'],CandidateVacancySearch['ShowOnMap']),response['Vacancies'];}};CandidateVacancySearch['PopulateVacanciesGrid'](fnPopulationByFunction);},'PopulateVacanciesGrid':function(fnPopulationByFunction){TriSysWebJobs['Vacancies']['PopulateGrid'](CandidateVacancySearch['GridID'],fnPopulationByFunction);},'LoadSearchCriteria':function(){var CVacancySearchLookupsRequest={'LiveOnly':!![]},payloadObject={};payloadObject['URL']='Vacancies/Lookups',payloadObject['OutboundDataPacket']=CVacancySearchLookupsRequest,payloadObject['InboundDataFunction']=function(CVacancySearchLookupsResponse){var locations=[],jobTitles=[],categoriesAttributes=[];if(CVacancySearchLookupsResponse['JobTitles'])for(var i=0x0;i<CVacancySearchLookupsResponse['JobTitles']['length'];i++){var sJobTitle=CVacancySearchLookupsResponse['JobTitles'][i];if(sJobTitle&&sJobTitle['length']>0x1)jobTitles['push']({'text':sJobTitle,'value':sJobTitle});}TriSysSDK['CShowForm']['populateMultiSelectComboFromDataSource'](CandidateVacancySearch['JobTitleComboID'],jobTitles);if(CVacancySearchLookupsResponse['Locations'])for(var i=0x0;i<CVacancySearchLookupsResponse['Locations']['length'];i++){var sLocation=CVacancySearchLookupsResponse['Locations'][i];if(sLocation&&sLocation['length']>0x1)locations['push']({'text':sLocation,'value':sLocation});}TriSysSDK['CShowForm']['populateMultiSelectComboFromDataSource'](CandidateVacancySearch['LocationComboID'],locations);if(CVacancySearchLookupsResponse['SkillCategories'])for(var i=0x0;i<CVacancySearchLookupsResponse['SkillCategories']['length'];i++){var skillCategory=CVacancySearchLookupsResponse['SkillCategories'][i];for(var iSkill=0x0;iSkill<skillCategory['Skills']['length'];iSkill++){var sSkill=skillCategory['Skills'][iSkill],sCategoryAttribute=skillCategory['Category']+CandidateVacancySearch['CategorySkillSeparator']+sSkill,bManeGroup=TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()=='Mane-Group'['toLowerCase']();if(bManeGroup){if(skillCategory['Category']!='Advertising\x20Industry')sCategoryAttribute=null;else sCategoryAttribute=sSkill;}if(sCategoryAttribute)categoriesAttributes['push']({'text':sCategoryAttribute,'value':sCategoryAttribute});}}return TriSysSDK['CShowForm']['populateMultiSelectComboFromDataSource'](CandidateVacancySearch['CategoriesAttributesComboID'],categoriesAttributes),$('#CandidateVacancySearchLoadBlock')['hide'](),$('#CandidateVacancySearchCriteriaBlock')['show'](),$('#CandidateVacancySearchGridBlock')['show'](),CandidateVacancySearch['AfterLoadingWebAPILookups'](),!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){console['log']('CandidateVacancySearch.LoadSearchCriteria:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AfterLoadingWebAPILookups':function(){var searchCriteria=TriSysAPI['Persistence']['Read'](TriSysWebJobs['Security']['CookieName'](CandidateVacancySearch['CookieName']));searchCriteria&&($('#'+CandidateVacancySearch['ReferenceID'])['val'](searchCriteria['Reference']),$('#'+CandidateVacancySearch['FreeTextID'])['val'](searchCriteria['FreeText']),TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['JobTitleComboID'],searchCriteria['JobTitles']),TriSysSDK['CShowForm']['SetSkillsInList'](CandidateVacancySearch['ContactTypeComboID'],searchCriteria['Types']),TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['LocationComboID'],searchCriteria['Locations']),TriSysSDK['CShowForm']['SetValueInCombo'](CandidateVacancySearch['StartDateOperatorID'],searchCriteria['StartDateOperator']),TriSysSDK['CShowForm']['setDatePickerValue'](CandidateVacancySearch['StartDateID'],searchCriteria['StartDate']),TriSysSDK['Controls']['CurrencyAmountPeriod']['SetCurrencyAmountPeriod'](CandidateVacancySearch['MinimumSalaryRateID'],searchCriteria['MinSalaryRate']),TriSysSDK['Controls']['CurrencyAmountPeriod']['SetCurrencyAmountPeriod'](CandidateVacancySearch['MaximumSalaryRateID'],searchCriteria['MaxSalaryRate']),TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['CategoriesAttributesComboID'],searchCriteria['CategoriesAttributes'])),CandidateVacancySearch['Search']();},'Apply':function(){TriSysWebJobs['VacancyApplications']['ApplyFromGrid'](CandidateVacancySearch['GridID']);},'AddToFavourites':function(){TriSysWebJobs['Vacancies']['AddToFavourites'](CandidateVacancySearch['GridID'],TriSysWebJobs['Vacancies']['AfterAddToFavourite']);},'SendToFriend':function(){TriSysWebJobs['Vacancies']['SendToFriend'](CandidateVacancySearch['GridID']);},'ShowOnMap':function(){$('#'+CandidateVacancySearch['Menu_ShowOnMap'])['hide'](),$('#'+CandidateVacancySearch['GridID'])['hide'](),$('#'+CandidateVacancySearch['Menu_ShowInGrid'])['show'](),$('#'+CandidateVacancySearch['MapID'])['show'](),$('#'+CandidateVacancySearch['MapKey'])['show'](),TriSysWebJobs['Mapping']['MappingData']['Draw'](),$('#'+CandidateVacancySearch['Menu_Apply'])['addClass']('disabled'),$('#'+CandidateVacancySearch['Menu_AddToFavourites'])['addClass']('disabled'),$('#'+CandidateVacancySearch['Menu_SendToFriend'])['addClass']('disabled');var sGridMenuDiv=TriSysApex['FormsManager']['ContentDivPrefix']+'CandidateVacancySearch',gridMenu=$('#'+sGridMenuDiv)['find'](CandidateVacancySearch['Menu_Grid_Class']);if(gridMenu)gridMenu['addClass']('disabled');},'ShowInGrid':function(){$('#'+CandidateVacancySearch['Menu_ShowOnMap'])['show'](),$('#'+CandidateVacancySearch['GridID'])['show'](),$('#'+CandidateVacancySearch['Menu_ShowInGrid'])['hide'](),$('#'+CandidateVacancySearch['MapID'])['hide'](),$('#'+CandidateVacancySearch['MapKey'])['hide'](),$('#'+CandidateVacancySearch['Menu_Apply'])['removeClass']('disabled'),$('#'+CandidateVacancySearch['Menu_AddToFavourites'])['removeClass']('disabled'),$('#'+CandidateVacancySearch['Menu_SendToFriend'])['removeClass']('disabled');var sGridMenuDiv=TriSysApex['FormsManager']['ContentDivPrefix']+'CandidateVacancySearch',gridMenu=$('#'+sGridMenuDiv)['find'](CandidateVacancySearch['Menu_Grid_Class']+'.disabled');if(gridMenu)gridMenu['removeClass']('disabled');},'RemoveAllJobTitles':function(){TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['JobTitleComboID'],'');},'RemoveAllTypes':function(){TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['ContactTypeComboID'],'');},'RemoveAllLocations':function(){TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['LocationComboID'],'');},'RemoveAllSkillCategories':function(){TriSysSDK['CShowForm']['SetValuesArrayInList'](CandidateVacancySearch['CategoriesAttributesComboID'],'');}};$(document)['ready'](function(){});