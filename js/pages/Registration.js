var Registration={'SocialNetworkCredentials':null,'CompanyEntityName':'Company','Load':function(){TriSysSDK['Titles']['LoadCombo']('txtRegistrationTitle'),TriSysWebJobs['CandidateRegistration']['LoadCityFromGeoLocation']('txtRegistrationCity'),TriSysWebJobs['CandidateRegistration']['LoadCountryLookup']('txtRegistrationCountry');var bPhone=TriSysApex['Device']['isPhone']();bPhone&&$('#registration-title')['html']('Start\x20your\x20Subscription');Registration['Social']['AddEventHandlers']();try{var sCustomerPrefix='#customer~';if(window['location']['hash']&&window['location']['hash']['indexOf'](sCustomerPrefix)>=0x0){var parts=window['location']['hash']['split'](sCustomerPrefix);if(parts['length']==0x2){var sGUID=parts[0x1];Registration['PreRegistrationVisualsForExistingCustomer'](sGUID);}}Registration['GetPlanFromURL']();}catch(err){alert(err);}TriSysApex['Resourcer']['isResourcerWebSite']()&&($('#registration-title')['html']('Sign-Up\x20as\x20a\x20Candidate\x20Resourcer'),$('#trisys-registration-form-prices-button-block')['hide'](),$('#registration-company-block-title')['html']('Your\x20Account\x20Address'),$('#registration-company-block-company-name')['hide'](),$('#registration-company-block-switchboard-telno')['hide'](),$('#btn-register-free-trial')['text']('Submit\x20Resourcer\x20Registration'));},'GetPlanFromURL':function(){var sURL=window['location']['href'],sPlanPrefix='plan~';if(sURL['indexOf'](sPlanPrefix)>=0x0){var parts=sURL['split'](sPlanPrefix);if(parts['length']==0x2){var sPlan=parts[0x1];$('#registration-plan')['html'](sPlan);var elemTitle=$('#registration-title'),sTitle=elemTitle['text']()+'\x20to\x20the\x20<strong>'+sPlan['replace'](/-/g,'\x20')+'</strong>\x20plan';elemTitle['html'](sTitle);var bPlatformixGroupware=sPlan['toLowerCase']()==='Platformix-Groupware'['toLowerCase']();bPlatformixGroupware&&(Registration['CompanyEntityName']='Group',$('#registration-company-block-title')['text']('Your\x20'+Registration['CompanyEntityName']+'\x20Information'),$('#lblCompanyName')['text'](Registration['CompanyEntityName']+'\x20Name'));}}},'PostCodelookup':function(){var sPrefix='txtRegistration';TriSysSDK['PostCode']['Lookup'](sPrefix+'PostCode',sPrefix+'Street',sPrefix+'City',sPrefix+'County',sPrefix+'Country');},'ShowTermsAndConditions':function(){TriSysApex['ModalDialogue']['TermsAndConditions']['Show']();},'ShowPrivacyPolicy':function(){TriSysApex['ModalDialogue']['PrivacyPolicy']['Show']();},'ShowPrices':function(){var sURL='https://irp.cdn-website.com/f3b4d364/files/uploaded/Apex-Pricing-2021.pdf'+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache']();TriSysApex['ModalDialogue']['DocumentViewer']['Show'](TriSysApex['Copyright']['ShortProductName']+'\x20Prices',sURL);},'SubmitButtonClick':function(){var sTitle=TriSysSDK['CShowForm']['GetTextFromCombo']('txtRegistrationTitle'),sForenames=$('#txtRegistrationForenames')['val'](),sSurname=$('#txtRegistrationSurname')['val'](),sPassword=$('#txtRegistrationPassword')['val'](),sVerifyPassword=$('#txtRegistrationPasswordConfirmation')['val'](),sEMail=$('#txtRegistrationEMail')['val'](),sCompany=$('#txtRegistrationCompany')['val'](),sJobTitle=$('#txtRegistrationJobTitle')['val'](),sStreet=$('#txtRegistrationStreet')['val'](),sCity=$('#txtRegistrationCity')['val'](),sCounty=$('#txtRegistrationCounty')['val'](),sPostCode=$('#txtRegistrationPostCode')['val'](),sCountry=$('#txtRegistrationCountry')['val'](),sWorkTelNo=$('#txtRegistrationWorkTelNo')['val'](),sMobileTelNo=$('#txtRegistrationMobileTelNo')['val'](),sSwitchboardTelNo=$('#txtRegistrationCompanyTelNo')['val'](),bAgreeToTermsAndConditions=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkSignUp_Agree'),bAgreeToPrivacyPolicy=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkSignUp_AgreeToPrivacyPolicy'),sPlan=$('#registration-plan')['html'](),sFullName=sForenames+'\x20'+sSurname,bPasswordMandatory=!Registration['SocialNetworkCredentials'],lstErrors=[],iMinFullNameChars=0x5,iMinCompanyNameChars=0x3;if(!sCompany&&TriSysApex['Resourcer']['isResourcerWebSite']())sCompany='Unknown';if(!sCountry)sCountry=TriSysSDK['Countries']['DefaultCountryName'];!sCounty&&(sCounty='-');if(!TriSysApex['LoginCredentials']['validateEmail'](sEMail))lstErrors['push']({'Message':'E-Mail\x20address\x20must\x20be\x20completed.','ID':'#txtRegistrationEMail'});if(bPasswordMandatory&&(!sPassword||sPassword['length']<TriSysApex['Constants']['iMinimumPasswordLength']))lstErrors['push']({'Message':'Password\x20must\x20be\x20at\x20least\x20'+TriSysApex['Constants']['iMinimumPasswordLength']+'\x20characters.','ID':'#txtRegistrationPassword'});if(bPasswordMandatory&&sPassword!=sVerifyPassword)lstErrors['push']({'Message':'Passwords\x20must\x20match.','ID':'#txtRegistrationPasswordConfirmation'});if(bPasswordMandatory&&sPassword){if(sPassword['indexOf']('--')>=0x0)lstErrors['push']({'Message':'Passwords\x20must\x20not\x20include\x20\x27--\x27\x20as\x20this\x20pattern\x20is\x20used\x20in\x20SQL\x20injection\x20attacks.','ID':'#txtRegistrationPasswordConfirmation'});if(sPassword['indexOf']('\x22\x22')>=0x0)lstErrors['push']({'Message':'Passwords\x20must\x20not\x20include\x20consecutive\x20\x22\x20characters.','ID':'#txtRegistrationPasswordConfirmation'});}if(!sFullName||sFullName['length']<iMinFullNameChars)lstErrors['push']({'Message':'Full\x20name\x20must\x20be\x20at\x20least\x20'+iMinFullNameChars+'\x20characters.','ID':'#txtRegistrationForenames'});if(sFullName&&sFullName['indexOf']('\x20')<=0x0)lstErrors['push']({'Message':'Full\x20name\x20must\x20include\x20a\x20forename\x20and\x20a\x20surname,\x20separated\x20by\x20a\x20space.','ID':'#txtRegistrationSurname'});if(!sWorkTelNo)lstErrors['push']({'Message':'Work\x20Telephone\x20number\x20must\x20be\x20completed.','ID':'#txtRegistrationWorkTelNo'});if(!TriSysApex['Resourcer']['isResourcerWebSite']()){if(!sCompany||sCompany['length']<iMinCompanyNameChars)lstErrors['push']({'Message':Registration['CompanyEntityName']+'\x20name\x20must\x20be\x20at\x20least\x20'+iMinCompanyNameChars+'\x20characters.','ID':'#txtRegistrationCompany'});if(sCompany&&sCompany['toLowerCase']()=='unknown')lstErrors['push']({'Message':Registration['CompanyEntityName']+'\x20name\x20cannot\x20be\x20unknown.','ID':'#txtRegistrationCompany'});}if(!sStreet)lstErrors['push']({'Message':'Street\x20address\x20is\x20required.','ID':'#txtRegistrationStreet'});if(!sCity)lstErrors['push']({'Message':'City/Town\x20is\x20required.','ID':'#txtRegistrationCity'});if(!sCounty)lstErrors['push']({'Message':'County/State\x20is\x20required.','ID':'#txtRegistrationCounty'});if(!sPostCode)lstErrors['push']({'Message':'Post/Zip\x20Code\x20is\x20required.','ID':'#txtRegistrationPostCode'});if(!sCountry)lstErrors['push']({'Message':'Country\x20is\x20required.','ID':'#txtRegistrationCountry'});if(!bAgreeToTermsAndConditions)lstErrors['push']({'Message':'You\x20must\x20agree\x20to\x20our\x20terms\x20and\x20conditions.','ID':'#registration-terms-group'});if(!bAgreeToPrivacyPolicy)lstErrors['push']({'Message':'You\x20must\x20agree\x20to\x20our\x20privacy\x20policy.','ID':'#registration-privacy-group'});if(lstErrors['length']>0x0){TriSysApex['TourGuide']['ShowFormErrorsAsATourGuide'](TriSysApex['Copyright']['ShortProductName']+'\x20Sign-Up\x20Validation\x20Error'+(lstErrors['length']==0x1?'':'s'),lstErrors);return;}(!sCompany||sCompany=='Unknown')&&(sCompany=TriSysApex['Resourcer']['isResourcerWebSite']()?sFullName['replace'](/ /g,''):'Unknown');if(!sCountry)sCountry=TriSysSDK['Countries']['DefaultCountryName'];if(!TriSysPhoneGap['isConnectedToComms'](!![],'register'))return![];var sTypeOfRequest=TriSysApex['Resourcer']['isResourcerWebSite']()?'Resourcer':'Trial',dataPacket={'Title':sTitle,'FullName':sFullName,'Company':sCompany,'EMail':sEMail,'TelNo':sWorkTelNo,'Street':sStreet,'City':sCity,'County':sCounty,'PostCode':sPostCode,'Country':sCountry,'Password':sPassword,'TypeOfRequest':sTypeOfRequest,'MobileTelNo':sMobileTelNo,'SwitchboardTelNo':sSwitchboardTelNo,'JobTitle':sJobTitle,'Plan':sPlan,'SocialNetworkLoginParameters':Registration['SocialNetworkCredentials']},fnSuccess=function(CNewCustomerSignUpResponse){return Registration['PostRegistrationVisuals'](CNewCustomerSignUpResponse),!![];};TriSysApex['LoginCredentials']['SignUpRequest'](dataPacket,fnSuccess);},'PreRegistrationVisualsForExistingCustomer':function(sGUID){$('#trisys-registration-form-data-entry-block')['hide'](),$('#trisys-registration-form-existing-customer-data-entry-block')['show'](),$('#trisys-registration-form-post-signup-block')['hide'](),$('#trisys-registration-form-post-resourcer-signup-block')['hide'](),$('#txtRegistrationExistingEMail')['keyup'](function(e){e['keyCode']==0xd&&Registration['ExistingSubmitButtonClick']();}),sGUID&&($('#txtRegistrationExistingEMail')['val'](sGUID),$('#txtRegistrationExistingEMail')['attr']('readonly','readonly'));},'PostRegistrationVisuals':function(CNewCustomerSignUpResponse){$('#trisys-registration-form-data-entry-block')['hide'](),$('#trisys-registration-form-existing-customer-data-entry-block')['hide'](),$('#registration-description')['html']('Thank\x20you\x20for\x20supplying\x20your\x20details.');if(TriSysApex['Resourcer']['isResourcerWebSite']()){$('#trisys-registration-form-post-resourcer-signup-block')['show']();return;}else{try{if(!CNewCustomerSignUpResponse['CapturePayment']){var sPre='#trisys-registration-form-post-signup-block-p';$(sPre+'1')['hide'](),$(sPre+'2')['hide'](),$(sPre+'3')['hide'](),$(sPre+'4')['show']();}}catch(e){}$('#trisys-registration-form-post-signup-block')['show']();}if(CNewCustomerSignUpResponse){if(CNewCustomerSignUpResponse['GUID']){var sGUID=CNewCustomerSignUpResponse['GUID'],payloadObject={},ConfirmCustomerRegistrationRequest={'GUID':sGUID};payloadObject['URL']='Users/ConfirmCustomerRegistrationRequest',payloadObject['OutboundDataPacket']=ConfirmCustomerRegistrationRequest,payloadObject['InboundDataFunction']=function(ConfirmCustomerRegistrationResponse){TriSysApex['UI']['HideWait']();if(ConfirmCustomerRegistrationResponse){var bSuccess=ConfirmCustomerRegistrationResponse['Success'];if(!bSuccess&&ConfirmCustomerRegistrationResponse['ErrorMessage']['indexOf']('Activation\x20code\x20expired\x20or\x20not\x20found')>=0x0)return;if(bSuccess){Registration['CommencePaymentCaptureAfterConfirmingRegistration'](sGUID,ConfirmCustomerRegistrationResponse);return;}else TriSysApex['UI']['ShowMessage'](ConfirmCustomerRegistrationResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('Registration.PostRegistrationVisuals:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Confirming\x20Registration...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}}},'CommencePaymentCaptureAfterConfirmingRegistration':function(sGUID,ConfirmCustomerRegistrationResponse){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Create\x20Your\x20Account',parametersObject['Image']='gi-database_plus',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlPaymentGateway.html'),parametersObject['OnLoadCallback']=function(){var bTargetParent=!![],options={'FreePlan':!ConfirmCustomerRegistrationResponse['CapturePayment']};ctrlPaymentGateway['Load'](sGUID,ConfirmCustomerRegistrationResponse,bTargetParent,options);},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Cancel',parametersObject['ButtonLeftFunction']=function(){return!![];},TriSysApex['UI']['PopupMessage'](parametersObject);},'ExistingSubmitButtonClick':function(){var sTitle='Sign-Up',sEMail=$('#txtRegistrationExistingEMail')['val']();if(!TriSysApex['LoginCredentials']['validateEmail'](sEMail)){TriSysApex['UI']['ShowMessage']('Please\x20enter\x20a\x20valid\x20e-mail\x20address.',sTitle);return;}var bAgree=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkExisting_Agree');if(!bAgree){TriSysApex['UI']['ShowMessage']('Please\x20agree\x20to\x20our\x20terms\x20and\x20conditions.',sTitle);return;}var bAgreeToPrivacyPolicy=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkExisting_AgreeToPrivacyPolicy');if(!bAgreeToPrivacyPolicy){TriSysApex['UI']['ShowMessage']('Please\x20agree\x20to\x20our\x20privacy\x20policy.',sTitle);return;}Registration['Subscription']['RegisterExistingCustomer'](sEMail);},'Social':{'AddEventHandlers':function(){if(!TriSysPhoneGap['isConnectedToComms']()||TriSysPhoneGap['Enabled']()){$('#trisys-registration-form-social-row')['hide']();return;}var fnLoadControlHTML=function(){TriSysApex['FormsManager']['loadControlIntoDiv']('Registration-SocialNetworkButtons','ctrlSocialNetworkLoginButtons.html',function(response,status,xhr){ctrlSocialNetworkLoginButtons['OnSuccessfulLoginFunction']=Registration['Social']['SendToWebAPI'],ctrlSocialNetworkLoginButtons['HelpLabel']('You\x20may\x20login\x20with\x20any\x20social\x20network\x20to\x20populate\x20fields\x20below,\x20and\x20to\x20login\x20with\x20the\x20same\x20details\x20in\x20future.');});};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlSocialNetworkLoginButtons.js',null,fnLoadControlHTML);},'SendToWebAPI':function(provider_name,connection_token,user_token){var CReadSocialNetworkAuthenticatedCredentialsRequest={'ProviderName':provider_name,'ConnectionToken':connection_token,'UserToken':user_token};TriSysWebJobs['SocialNetwork']['ReadAuthenticatedCredentials'](CReadSocialNetworkAuthenticatedCredentialsRequest,Registration['Social']['DisplayAuthenticatedSocialNetworkCredentials']);},'DisplayAuthenticatedSocialNetworkCredentials':function(CReadSocialNetworkAuthenticatedCredentialsResponse){Registration['SocialNetworkCredentials']=CReadSocialNetworkAuthenticatedCredentialsResponse;var socialData=Registration['SocialNetworkCredentials'];$('#trisys-social-network-instructions')['hide']();if(socialData['Forenames'])$('#txtRegistrationForenames')['val'](socialData['Forenames']);if(socialData['Surname'])$('#txtRegistrationSurname')['val'](socialData['Surname']);if(socialData['EMail'])$('#txtRegistrationEMail')['val'](socialData['EMail']);if(socialData['OrgCompany'])$('#txtRegistrationCompany')['val'](socialData['OrgCompany']);if(socialData['OrgJobTitle'])$('#txtRegistrationJobTitle')['val'](socialData['OrgJobTitle']);if(socialData['CurrentLocation']){var parts=socialData['CurrentLocation']['split'](',\x20');parts&&(parts['length']==0x2&&($('#txtRegistrationCity')['val'](parts[0x0]),TriSysSDK['CShowForm']['SetTextInCombo']('txtRegistrationCountry',parts[0x1])));}$('#trisys-social-network-social-button')['show']();var sClass=Registration['Social']['GetSocialImage'](socialData['ProviderName']);$('#trisys-social-network-logo')['removeClass'](),$('#trisys-social-network-logo')['addClass'](sClass),$('#trisys-social-network-name')['html'](socialData['ProviderName']),$('#trisys-social-network-fullname')['html'](socialData['FullName']?socialData['FullName']:socialData['Forenames']+'\x20'+socialData['Surname']),$('#trisys-social-network-profile')['html'](socialData['ProfileURL']);var sPhoto=TriSysApex['Constants']['DefaultContactGreyImage'];if(socialData['PhotoURL'])sPhoto=socialData['PhotoURL'];$('#trisys-social-network-photo')['attr']('src',sPhoto);},'GetSocialImage':function(sProviderName){switch(sProviderName['toLowerCase']()){case'windows\x20live':return'fa\x20fa-windows';default:return'fa\x20fa-'+sProviderName['toLowerCase']();}}},'Subscription':{'RegisterExistingCustomer':function(sEMail){TriSysApex['UI']['ShowMessage']('Registration.Subscription.RegisterExistingCustomer');}}};$(document)['ready'](function(){Registration['Load']();});