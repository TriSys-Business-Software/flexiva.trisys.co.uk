var ctrlManageCollections={'Dashboards':[],'SelectedDashboardName':null,'Default':'Default','Load':function(){ctrlManageCollections['PopulateListOfDashboards'](),$('#dashboard-manager-description')['on']('change\x20keyup\x20paste\x20click',ctrlManageCollections['DescriptionChangeEvent']),$('#dashboard-manager-view-menu')['on']('click',ctrlManageCollections['ViewMenuClickEvent']),$('#dashboard-manager-copy')['on']('click',ctrlManageCollections['CopyDashboard']),$('#dashboard-manager-delete')['on']('click',ctrlManageCollections['DeleteDashboard']);},'PopulateListOfDashboards':function(sName){var payloadObject={};payloadObject['URL']='Dashboard/ReadCollection',payloadObject['InboundDataFunction']=function(CReadDashboardCollectionResponse){if(CReadDashboardCollectionResponse){if(CReadDashboardCollectionResponse['Success'])ctrlManageCollections['Dashboards']=CReadDashboardCollectionResponse['Dashboards'],ctrlManageCollections['DisplayDashboards'](sName);else TriSysApex['Logging']['LogMessage'](CReadDashboardCollectionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('ctrlManageCollections.PopulateListOfDashboards:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayDashboards':function(sSelectedDashboardName){var sItemPrefix='dashboard-manager-list-item-',sItemTemplate=sItemPrefix+'template',sRowTemplateHTML=document['getElementById'](sItemTemplate)['outerHTML'],sUL='dashboard-manager-list';$('#'+sUL)['find']('li')['each'](function(){var sID=this['id'];if(sID!=sItemTemplate)$(this)['remove']();});for(var i=0x0;i<ctrlManageCollections['Dashboards']['length'];i++){var dashboard=ctrlManageCollections['Dashboards'][i],sRowItemHTML=sRowTemplateHTML,sItemID=sItemPrefix+dashboard['Name']['replace'](/ /g,'-');sRowItemHTML=sRowItemHTML['replace'](sItemTemplate,sItemID),sRowItemHTML=TriSysSDK['DocumentObjectModel']['RemoveStyleDisplayNone'](sRowItemHTML);var sOnClick='ctrlManageCollections.Select(\x27'+dashboard['Name']+'\x27)';sRowItemHTML=sRowItemHTML['replace']('##dashboard-click-event##',sOnClick);var sIcon='gi\x20gi-pie_chart';sRowItemHTML=sRowItemHTML['replace']('##dashboard-icon##',sIcon),sRowItemHTML=sRowItemHTML['replace']('##dashboard-name##',dashboard['Name']),$('#'+sUL)['append'](sRowItemHTML);if(!sSelectedDashboardName){if(i==0x0)sSelectedDashboardName=dashboard['Name'];}if(sSelectedDashboardName==dashboard['Name'])ctrlManageCollections['Select'](dashboard['Name']);}},'CopyDashboard':function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Copy\x20Dashboard:\x20'+ctrlManageCollections['SelectedDashboardName'],parametersObject['Image']='fa-plus-square-o',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'dashboard/ctrlCopyDashboard.html',parametersObject['ButtonLeftText']='Apply',parametersObject['ButtonLeftFunction']=function(){var sName=$('#dashboard-copy-name')['val'](),bValidated=ctrlManageCollections['ValidateCopyName'](sName);if(!bValidated)return bValidated;var sDescription=$('#dashboard-copy-description')['val'](),fnCopy=function(){ctrlManageCollections['CopyDashboardAndViews'](sName,sDescription);};return setTimeout(fnCopy,0x64),!![];},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'ValidateCopyName':function(sName){if(!sName)return![];for(var i=0x0;i<ctrlManageCollections['Dashboards']['length'];i++){var dashboard=ctrlManageCollections['Dashboards'][i];if(dashboard['Name']==sName)return![];}return!![];},'CopyDashboardAndViews':function(sName,sDescription){var CDashboardCopyRequest={'Source':ctrlManageCollections['SelectedDashboardName'],'Destination':sName,'Description':sDescription},payloadObject={};payloadObject['URL']='Dashboard/Copy',payloadObject['OutboundDataPacket']=CDashboardCopyRequest,payloadObject['InboundDataFunction']=function(CDashboardCopyResponse){TriSysApex['UI']['HideWait']();if(CDashboardCopyResponse){if(CDashboardCopyResponse['Success'])ctrlManageCollections['PopulateListOfDashboards'](sName);else TriSysApex['Logging']['LogMessage'](CDashboardCopyResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ShowMessage']('ctrlManageCollections.CopyDashboardAndViews:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Copying\x20Dashboard...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteDashboard':function(){if(ctrlManageCollections['SelectedDashboardName']==ctrlManageCollections['Default']){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20delete\x20the\x20default\x20dashboard.');return;}var sPrompt='Delete\x20the\x20\x27'+ctrlManageCollections['SelectedDashboardName']+'\x27\x20dashboard?';TriSysApex['UI']['questionYesNo'](sPrompt,'Delete\x20Dashboard','Yes',ctrlManageCollections['DeleteSelectedDashboardViaWebAPI'],'No');},'DeleteSelectedDashboardViaWebAPI':function(){var CDashboardDeleteRequest={'Source':ctrlManageCollections['SelectedDashboardName']},payloadObject={};return payloadObject['URL']='Dashboard/Delete',payloadObject['OutboundDataPacket']=CDashboardDeleteRequest,payloadObject['InboundDataFunction']=function(CDashboardDeleteResponse){TriSysApex['UI']['HideWait']();if(CDashboardDeleteResponse){if(CDashboardDeleteResponse['Success'])ctrlManageCollections['PopulateListOfDashboards']();else TriSysApex['Logging']['LogMessage'](CDashboardDeleteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ShowMessage']('ctrlManageCollections.DeleteDashboard:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Dashboard...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];},'NameChangeEvent':function(){var dashboard=ctrlManageCollections['GetCurrentDashboard']();dashboard['Caption']=$('#dashboard-manager-name')['val']();},'DescriptionChangeEvent':function(){var dashboard=ctrlManageCollections['GetCurrentDashboard']();dashboard['Description']=$('#dashboard-manager-description')['val'](),ctrlManageCollections['SilentUpdate'](dashboard);},'ViewMenuClickEvent':function(){var dashboard=ctrlManageCollections['GetCurrentDashboard']();dashboard['ViewMenuVisible']=TriSysSDK['CShowForm']['GetCheckBoxValue']('dashboard-manager-view-menu'),ctrlManageCollections['SilentUpdate'](dashboard);},'GetCurrentDashboard':function(){return ctrlManageCollections['GetDashboard'](ctrlManageCollections['SelectedDashboardName']);},'GetDashboard':function(sName){for(var i=0x0;i<ctrlManageCollections['Dashboards']['length'];i++){var dashboard=ctrlManageCollections['Dashboards'][i];if(dashboard['Name']==sName)return dashboard;}},'Select':function(sName){var sUL='dashboard-manager-list';$('#'+sUL)['find']('li')['each'](function(){$(this)['removeClass']('active');});var sItemPrefix='dashboard-manager-list-item-',sItemID=sItemPrefix+sName['replace'](/ /g,'-');$('#'+sItemID)['addClass']('active');var sDefaultViewName=ctrlManageCollections['Default'],dashboard=ctrlManageCollections['GetDashboard'](sName);if(dashboard){$('#dashboard-manager-name')['val'](dashboard['Name']),$('#dashboard-manager-description')['val'](dashboard['Description']),$('#dashboard-manager-view-summary')['html'](dashboard['ViewSummary']);var sViewMenuID='dashboard-manager-view-menu';TriSysSDK['CShowForm']['SetCheckBoxValue'](sViewMenuID,dashboard['ViewMenuVisible']);}ctrlManageCollections['SelectedDashboardName']=sName;},'SelectCurrent':function(){var dashboard=ctrlManageCollections['GetCurrentDashboard']();if(!dashboard)return;if(dashboard['Name']==ctrlManageCollections['Default']){TriSysApex['UI']['ShowMessage']('You\x20cannot\x20choose\x20the\x20\x27'+ctrlManageCollections['Default']+'\x27\x20dashboard.');return;}TriSysApex['UI']['questionYesNo']('Overwrite\x20your\x20\x27'+ctrlManageCollections['Default']+'\x27\x20dashboard\x20with\x20\x27'+dashboard['Name']+'\x27?','Select\x20'+ctrlManageCollections['Default']+'\x20Dashboard','Yes',function(){ctrlManageCollections['SelectDashboardViaWebAPI'](dashboard);},'No');},'SelectDashboardViaWebAPI':function(dashboard){var CDashboardSelectRequest={'Dashboard':dashboard},payloadObject={};return payloadObject['URL']='Dashboard/SelectDashboard',payloadObject['OutboundDataPacket']=CDashboardSelectRequest,payloadObject['InboundDataFunction']=function(CDashboardSelectResponse){TriSysApex['UI']['HideWait']();if(CDashboardSelectResponse){if(CDashboardSelectResponse['Success'])ctrlManageCollections['RestartDashboardEcosystem'](dashboard);else TriSysApex['UI']['errorAlert'](CDashboardSelectResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ShowMessage']('ctrlManageCollections.SelectCurrent:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Restarting\x20Dashboard...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),![];},'RestartDashboardEcosystem':function(dashboard){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['UI']['CloseModalPopup'](),ctrlDashboard['ViewConfiguration']=null;var bHide=!dashboard['ViewMenuVisible'];TriSysApex['Cache']['SystemSettingManager']['SetValue'](TriSysApex['Constants']['DashboardHideViewMenu'],bHide);var bRetainFormInMemory=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',![]),![]);TriSysApex['Cache']['UserSettingManager']['SetValue']('RetainFormInMemory',![]),TriSysApex['FormsManager']['CloseCurrentForm'](),TriSysApex['FormsManager']['OpenForm']('Dashboard'),TriSysApex['Cache']['UserSettingManager']['SetValue']('RetainFormInMemory',bRetainFormInMemory);},'SilentUpdate':function(dashboard){var CDashboardUpdateRequest={'Dashboard':dashboard},payloadObject={};payloadObject['URL']='Dashboard/Update',payloadObject['OutboundDataPacket']=CDashboardUpdateRequest,payloadObject['InboundDataFunction']=function(CDashboardUpdateResponse){if(CDashboardUpdateResponse){if(CDashboardUpdateResponse['Success']){}else TriSysApex['Logging']['LogMessage'](CDashboardUpdateResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ShowMessage']('ctrlManageCollections.SilentUpdate:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PublishSelected':function(){var dashboard=ctrlManageCollections['GetCurrentDashboard']();if(dashboard){var fnPrompt=function(){var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20publish\x20the\x20dashboard:\x20\x27'+dashboard['Name']+'\x27\x20to\x20all\x20customer\x20databases?';TriSysApex['UI']['questionYesNo'](sMessage,'Publish\x20Dashboard','Yes',function(){return ctrlManageCollections['PublishSelectedDashboard'](dashboard),!![];},'No');};return setTimeout(fnPrompt,0x64),!![];}},'PublishSelectedDashboard':function(dashboard){var CDashboardPublishRequest={'Dashboard':dashboard},payloadObject={};payloadObject['URL']='Dashboard/Publish',payloadObject['OutboundDataPacket']=CDashboardPublishRequest,payloadObject['InboundDataFunction']=function(CDashboardPublishResponse){TriSysApex['UI']['HideWait']();if(CDashboardPublishResponse){if(CDashboardPublishResponse['Success'])TriSysApex['UI']['CloseModalPopup']();else TriSysApex['UI']['ErrorMessage'](CDashboardPublishResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ShowMessage']('ctrlManageCollections.PublishSelectedDashboard:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Publishing\x20'+dashboard['Name']+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};$(document)['ready'](function(){ctrlManageCollections['Load']();});