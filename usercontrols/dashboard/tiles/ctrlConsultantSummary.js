var ctrlConsultantSummary={'ParametersID':'consultant-and-date-range','WaitSpinnerID':'wait-spinner','DataTableID':'table-data','Setting':'ctrlConsultantSummary_Parameters','LoadedInTile':function(sTileID,persistedSettings){var sPrefix=sTileID+'-';ctrlConsultantSummary['Load'](sTileID,sPrefix,persistedSettings);var bPhone=TriSysApex['Device']['isPhone']();if(bPhone){for(var i=0x1;i<=0x2;i++)$('#'+sPrefix+'ctrlConsultantSummary-block-'+i)['removeClass']()['addClass']('col-sm-12');}},'Load':function(sTileID,sPrefix,persistedSettings){var sSpinnerID=sPrefix+ctrlConsultantSummary['WaitSpinnerID'],sTableID=sPrefix+ctrlConsultantSummary['DataTableID'],lHeight=$('#'+sTableID)['height']();$('#'+sTableID)['hide'](),TriSysSDK['WaitSpinner']['Load'](sSpinnerID,lHeight),TriSysProUI['TweakIconsToTheme'](sTableID),ctrlConsultantSummary['HyperlinkCallbacks'](sPrefix);var sConsultantAndDateRange=sPrefix+ctrlConsultantSummary['ParametersID'],fnCallback=function(lstUserNames,dtStart,dtEnd){ctrlConsultantSummary['LoadMetric'](sTileID,sPrefix,lstUserNames,dtStart,dtEnd);},parameters=ctrlDashboard['Persistence']['GetSettingValue'](persistedSettings,ctrlConsultantSummary['Setting'],null);if(parameters&&parameters['Recorded']){var dtNow=new Date(),iDays=moment(parameters['Recorded'])['diff'](moment(dtNow),'days');iDays>0x0&&(parameters['StartDate']=moment(parameters['StartDate'])['add'](iDays,'days'),parameters['EndDate']=moment(parameters['EndDate'])['add'](iDays,'days'));}TriSysSDK['ConsultantsAndDateRange']['Load'](sConsultantAndDateRange,parameters,fnCallback);},'Waiting':function(sPrefix,bWaiting){var sSpinnerID=sPrefix+ctrlConsultantSummary['WaitSpinnerID'],sTableID=sPrefix+ctrlConsultantSummary['DataTableID'];bWaiting?($('#'+sTableID)['hide'](),$('#'+sSpinnerID)['show']()):($('#'+sSpinnerID)['hide'](),$('#'+sTableID)['show']());},'LoadMetric':function(sTileID,sPrefix,lstUserNames,dtStart,dtEnd){ctrlConsultantSummary['Waiting'](sPrefix,!![]);var sDateFormat='YYYY-MM-DD\x20hh:mm:ss',parameters={'UserNames':lstUserNames,'StartDate':moment(dtStart)['format'](sDateFormat),'EndDate':moment(dtEnd)['format'](sDateFormat),'Recorded':new Date()},persistedSetting={'Setting':ctrlConsultantSummary['Setting'],'Value':parameters};ctrlDashboard['Persistence']['SaveTileSetting'](sTileID,persistedSetting);var fnCallback=function(CDashboardMetricConsultantSummaryResponse){ctrlConsultantSummary['WriteMetricsToTable'](sPrefix,CDashboardMetricConsultantSummaryResponse);};ctrlConsultantSummary['ReadMetricDataFromWebAPI'](sPrefix,lstUserNames,dtStart,dtEnd,fnCallback);},'ReadMetricDataFromWebAPI':function(sPrefix,lstUserNames,dtStart,dtEnd,fnCallback){var CDashboardMetricConsultantSummaryRequest={'UserNames':lstUserNames,'StartDate':moment(dtStart)['format']('YYYY-MM-DD\x20hh:mm:ss'),'EndDate':moment(dtEnd)['format']('YYYY-MM-DD\x20hh:mm:ss')},payloadObject={};payloadObject['URL']='DashboardMetric/ConsultantSummary',payloadObject['OutboundDataPacket']=CDashboardMetricConsultantSummaryRequest,payloadObject['InboundDataFunction']=function(CDashboardMetricConsultantSummaryResponse){if(CDashboardMetricConsultantSummaryResponse){if(CDashboardMetricConsultantSummaryResponse['Success'])ctrlConsultantSummary['Waiting'](sPrefix,![]),fnCallback(CDashboardMetricConsultantSummaryResponse);else TriSysApex['UI']['ErrorMessage'](CDashboardMetricConsultantSummaryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('ctrlConsultantSummary.ReadMetricDataFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'WriteMetricsToTable':function(sPrefix,CDashboardMetricConsultantSummaryResponse){$('#'+sPrefix+'AvgContractRate')['html'](CDashboardMetricConsultantSummaryResponse['AvgContractRate']),$('#'+sPrefix+'AvgDealPerm')['html'](CDashboardMetricConsultantSummaryResponse['AvgDealPerm']),$('#'+sPrefix+'AvgMarginContract')['html'](CDashboardMetricConsultantSummaryResponse['AvgMarginContract']),$('#'+sPrefix+'AvgMarginPerm')['html'](CDashboardMetricConsultantSummaryResponse['AvgMarginPerm']),$('#'+sPrefix+'CandidateMeetings')['html'](CDashboardMetricConsultantSummaryResponse['CandidateMeetings']),$('#'+sPrefix+'CandidateCalls')['html'](CDashboardMetricConsultantSummaryResponse['CandidateCalls']),$('#'+sPrefix+'CandidateScreeningInterviews')['html'](CDashboardMetricConsultantSummaryResponse['CandidateScreeningInterviews']),$('#'+sPrefix+'ClientMeetings')['html'](CDashboardMetricConsultantSummaryResponse['ClientMeetings']),$('#'+sPrefix+'ClientCalls')['html'](CDashboardMetricConsultantSummaryResponse['ClientCalls']),$('#'+sPrefix+'ContractorsOut')['html'](CDashboardMetricConsultantSummaryResponse['ContractorsOut']),$('#'+sPrefix+'ContractsAdded')['html'](CDashboardMetricConsultantSummaryResponse['ContractsAdded']),$('#'+sPrefix+'ContractsEnded')['html'](CDashboardMetricConsultantSummaryResponse['ContractsEnded']),$('#'+sPrefix+'ContractSales')['html'](CDashboardMetricConsultantSummaryResponse['ContractSales']),$('#'+sPrefix+'ContractsStarted')['html'](CDashboardMetricConsultantSummaryResponse['ContractsStarted']),$('#'+sPrefix+'CVsSent')['html'](CDashboardMetricConsultantSummaryResponse['CVsSent']),$('#'+sPrefix+'FirstInterviews')['html'](CDashboardMetricConsultantSummaryResponse['FirstInterviews']),$('#'+sPrefix+'FurtherInterviews')['html'](CDashboardMetricConsultantSummaryResponse['FurtherInterviews']),$('#'+sPrefix+'InterviewsPending')['html'](CDashboardMetricConsultantSummaryResponse['InterviewsPending']),$('#'+sPrefix+'JobsAdded')['html'](CDashboardMetricConsultantSummaryResponse['JobsAdded']),$('#'+sPrefix+'LiveJobs')['html'](CDashboardMetricConsultantSummaryResponse['LiveJobs']),$('#'+sPrefix+'NewCandidates')['html'](CDashboardMetricConsultantSummaryResponse['NewCandidates']),$('#'+sPrefix+'PermPlacements')['html'](CDashboardMetricConsultantSummaryResponse['PermPlacements']),$('#'+sPrefix+'PermPlacementsStarted')['html'](CDashboardMetricConsultantSummaryResponse['PermPlacementsStarted']),$('#'+sPrefix+'PermSales')['html'](CDashboardMetricConsultantSummaryResponse['PermSales']),$('#'+sPrefix+'SpeculativeCVsSent')['html'](CDashboardMetricConsultantSummaryResponse['SpeculativeCVsSent']),$('#'+sPrefix+'TotalCVsSent')['html'](CDashboardMetricConsultantSummaryResponse['TotalCVsSent']),$('#'+sPrefix+'TotalSales')['html'](CDashboardMetricConsultantSummaryResponse['TotalSales']);},'HyperlinkCallbacks':function(sPrefix){var sHypPrefix=sPrefix+'hyperlink-',hyperlinks=[{'ID':'interviews-pending','Callback':{'Field':'InterviewsPending','GridType':'Interviews','Title':'The\x20number\x20of\x20scheduled\x20interviews\x20which\x20have\x20not\x20taken\x20place'}},{'ID':'contractors-out','Callback':{'Field':'ContractorsOut','GridType':'Placements','Title':'The\x20number\x20of\x20contract\x20or\x20temporary\x20workers\x20on\x20placement'}},{'ID':'jobs-added','Callback':{'Field':'JobsAdded','GridType':'Requirements','Title':'The\x20number\x20of\x20requirements\x20added'}},{'ID':'cvs-sent','Callback':{'Field':'CVsSent','GridType':'Tasks','Title':'The\x20number\x20of\x20CV\x27s\x20sent\x20for\x20specific\x20requirements'}},{'ID':'client-meetings','Callback':{'Field':'ClientMeetings','GridType':'Tasks','Title':'The\x20number\x20of\x20client\x20meetings\x20i.e.\x20tasks\x20of\x20type\x20\x22Meeting\x22'}},{'ID':'client-calls','Callback':{'Field':'ClientCalls','GridType':'Tasks','Title':'The\x20number\x20of\x20recorded\x20tasks\x20of\x20type\x20\x22Telephone\x20Call\x22\x20linked\x20to\x20client\x20contacts'}},{'ID':'1st-interviews','Callback':{'Field':'FirstInterviews','GridType':'Tasks','Title':'The\x20number\x20of\x20first\x20interviews'}},{'ID':'perm-placements','Callback':{'Field':'PermPlacements','GridType':'Placements','Title':'The\x20number\x20of\x20permanent\x20workers\x20on\x20placement\x20which\x20were\x20added'}},{'ID':'contract-sales','Callback':{'Field':'ContractSales','GridType':'Placements','Title':'The\x20sum\x20of\x20all\x20contract\x20placement\x20margins'}},{'ID':'avg-deal-perm','Callback':{'Field':'AvgDealPerm','GridType':'Placements','Title':'The\x20average\x20permanent\x20placement\x20salary'}},{'ID':'avg-margin-contract','Callback':{'Field':'AvgMarginContract','GridType':'Placements','Title':'The\x20average\x20contract\x20placement\x20margin'}},{'ID':'live-jobs','Callback':{'Field':'LiveJobs','GridType':'Requirements','Title':'The\x20number\x20of\x20active\x20requirements'}},{'ID':'new-candidates','Callback':{'Field':'NewCandidates','GridType':'Contacts','Title':'The\x20number\x20of\x20new\x20candidates\x20registered','Candidate':!![]}},{'ID':'total-cvs-sent','Callback':{'Field':'TotalCVsSent','GridType':'Tasks','Title':'The\x20total\x20number\x20of\x20CV\x27s\x20sent'}},{'ID':'speculative-cvs-sent','Callback':{'Field':'SpeculativeCVsSent','GridType':'Tasks','Title':'The\x20number\x20of\x20CV\x27s\x20sent\x20which\x20are\x20not\x20linked\x20to\x20a\x20specific\x20requirement'}},{'ID':'candidate-meetings','Callback':{'Field':'CandidateMeetings','GridType':'Tasks','Title':'The\x20number\x20of\x20candidate\x20meetings\x20i.e.\x20tasks\x20of\x20type\x20\x22Meeting\x22'}},{'ID':'candidate-calls','Callback':{'Field':'CandidateCalls','GridType':'Tasks','Title':'The\x20number\x20of\x20recorded\x20tasks\x20of\x20type\x20\x22Telephone\x20Call\x22\x20linked\x20to\x20candidates'}},{'ID':'further-interviews','Callback':{'Field':'FurtherInterviews','GridType':'Tasks','Title':'The\x20number\x20of\x20second,\x20third,\x20fourth\x20or\x20more\x20interviews'}},{'ID':'perm-sales','Callback':{'Field':'PermSales','GridType':'Placements','Title':'The\x20total\x20of\x20all\x20permanent\x20placement\x20fees'}},{'ID':'total-sales','Callback':{'Field':'TotalSales','GridType':'Placements','Title':'The\x20total\x20margin\x20for\x20both\x20contract/temp\x20and\x20permanent\x20placements'}},{'ID':'avg-margin-perm','Callback':{'Field':'AvgMarginPerm','GridType':'Placements','Title':'The\x20average\x20permanent\x20placement\x20fee/margin'}},{'ID':'candidate-screening-interviews','Callback':{'Field':'CandidateScreeningInterviews','GridType':'Tasks','Title':'The\x20number\x20of\x20screening\x20interviews'}},{'ID':'perm-placements-started','Callback':{'Field':'PermPlacementsStarted','GridType':'Placements','Title':'The\x20number\x20of\x20permanent\x20workers\x20on\x20placement\x20who\x20started'}},{'ID':'contracts-added','Callback':{'Field':'ContractsAdded','GridType':'Placements','Title':'The\x20number\x20of\x20contract\x20or\x20temporary\x20workers\x20on\x20placements\x20who\x20were\x20added'}},{'ID':'contracts-started','Callback':{'Field':'ContractsStarted','GridType':'Placements','Title':'The\x20number\x20of\x20contract\x20or\x20temporary\x20workers\x20on\x20placements\x20who\x20started'}},{'ID':'contracts-ended','Callback':{'Field':'ContractsEnded','GridType':'Placements','Title':'The\x20number\x20of\x20contract\x20or\x20temporary\x20workers\x20on\x20placements\x20who\x20are\x20scheduled\x20to\x20end\x20work'}},{'ID':'avg-rate-contract','Callback':{'Field':'AvgContractRate','GridType':'Placements','Title':'The\x20average\x20standard\x20contract\x20charge\x20rate'}}],fnCallbackClosure=function(sPrefix,sID,callback){return function(){ctrlConsultantSummary['HyperlinkEvent'](sPrefix,sID,callback);};};for(var i=0x0;i<hyperlinks['length'];i++){var hyperlink=hyperlinks[i],hyp=$('#'+sHypPrefix+hyperlink['ID']);hyp['click'](fnCallbackClosure(sPrefix,hyperlink['ID'],hyperlink['Callback']));var sTooltip=hyperlink['Callback']['Title'];hyp['attr']('title',sTooltip);}},'HyperlinkEvent':function(sPrefix,sID,callback){var fnCallback=function(userNameArray,dtStart,dtEnd){ctrlConsultantSummary['PopupDrillDownRequest'](userNameArray,dtStart,dtEnd,callback);},sConsultantAndDateRange=sPrefix+ctrlConsultantSummary['ParametersID'];ctrlConsultantsAndDateRange['RequestParameters'](sConsultantAndDateRange,fnCallback);},'PopupDrillDownRequest':function(lstUserNames,dtStart,dtEnd,callback){if(!callback)return;var CDashboardMetricConsultantSummaryRequest={'UserNames':lstUserNames,'StartDate':moment(dtStart)['format']('YYYY-MM-DD\x20hh:mm:ss'),'EndDate':moment(dtEnd)['format']('YYYY-MM-DD\x20hh:mm:ss'),'DataSetRequest':{'Field':callback['Field'],'GridType':callback['GridType']}},payloadObject={};payloadObject['URL']='DashboardMetric/ConsultantSummary',payloadObject['OutboundDataPacket']=CDashboardMetricConsultantSummaryRequest,payloadObject['InboundDataFunction']=function(CDashboardMetricConsultantSummaryResponse){TriSysApex['UI']['HideWait']();if(CDashboardMetricConsultantSummaryResponse){if(CDashboardMetricConsultantSummaryResponse['Success']){var CDashboardMetricConsultantSummaryDataSetResponse=CDashboardMetricConsultantSummaryResponse['DataSetRequestResponse'];ctrlConsultantSummary['OpenPopupGrid'](CDashboardMetricConsultantSummaryDataSetResponse,callback);}else TriSysApex['UI']['ErrorMessage'](CDashboardMetricConsultantSummaryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlConsultantSummary.PopupDrillDownRequest:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Preparing\x20Data...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenPopupGrid':function(CDashboardMetricConsultantSummaryDataSetResponse,callback){var gridColumns=null;switch(callback['GridType']){case'Contacts':var contacts=CDashboardMetricConsultantSummaryDataSetResponse['Contacts'];if(contacts)TriSysApex['ModalDialogue']['ContactsByObject']['Show'](callback['Title'],contacts,callback['Candidate']);break;case'Requirements':var requirements=CDashboardMetricConsultantSummaryDataSetResponse['Requirements'];if(requirements)TriSysApex['Activities']['ShowLiveRequirements'](requirements,callback['Title']);break;case'Interviews':var interviews=CDashboardMetricConsultantSummaryDataSetResponse['Interviews'];if(interviews)TriSysApex['Activities']['ShowInterviews'](interviews,callback['Title']);break;case'Placements':var placements=CDashboardMetricConsultantSummaryDataSetResponse['Placements'];if(placements)TriSysApex['Activities']['ShowPlacementsInModalGrid'](callback['Title'],placements);break;case'Tasks':var tasks=CDashboardMetricConsultantSummaryDataSetResponse['Tasks'];if(tasks)TriSysApex['Activities']['ShowInterviews'](tasks,callback['Title']);break;}}};