var AppStudioToolBar={'ToolbarTreeViewRoot':'ctrlAppToolBar-TreeView','Prefix':'ctrlAppToolBar-','SelectedTreeViewItem':null,'SelectedNodeElement':null,'SelectedNodeTreeViewID':null,'DroppedNodeTreeViewID':null,'Load':function(configurator){const fnPopulateForm=function(){AppStudioToolBar['InitialiseFields'](configurator);const fnAfterPopulation=function(){ctrlAppStudioConfigurator['MakeAllBlocksTheSameHeight']([AppStudioToolBar['ToolbarTreeViewRoot'],'ctrlAppToolBar-Properties']);};AppStudioToolBar['ToolBarEditor'](fnAfterPopulation);};AppStudioToolBar['Persistence']['ReadFormDataFromWebAPI'](fnPopulateForm);},'InitialiseFields':function(configurator){var sFormName='ctrlAppToolBar';TriSysSDK['CShowForm']['InitialiseFields'](sFormName);const sPropertiesPrefix=AppStudioToolBar['Prefix']+'Properties-';$('#'+sPropertiesPrefix+'Caption')['on']('input',function(){var newText=$(this)['val']();AppStudioToolBar['SelectedTreeViewItem']&&(AppStudioToolBar['SelectedTreeViewItem']['set']('text',newText),AppStudioToolBar['SelectedTreeViewItem']['data']['Caption']=newText);}),$('#'+sPropertiesPrefix+'Description')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['Description']=newText;}),$('#'+sPropertiesPrefix+'Tooltip')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['Tooltip']=newText;}),$('#'+sPropertiesPrefix+'BrandName')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['BrandName']=newText;}),$('#'+sPropertiesPrefix+'ProductName')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['ProductName']=newText;}),$('#'+sPropertiesPrefix+'ProductLogoImage')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['ProductLogoImage']=newText;}),$('#'+sPropertiesPrefix+'NavBarBottomLogoImage')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['NavBarBottomLogoImage']=newText;}),$('#'+sPropertiesPrefix+'NavBarBottomLogo-Height')['data']('kendoNumericTextBox')['bind']('change',function(e){var iDimension=parseInt(this['value']());if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['NavBarBottomLogoHeight']=iDimension;}),$('#'+sPropertiesPrefix+'NavBarBottomLogo-Width')['data']('kendoNumericTextBox')['bind']('change',function(e){var iDimension=parseInt(this['value']());if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['NavBarBottomLogoWidth']=iDimension;}),$('#'+sPropertiesPrefix+'NavBarBottomLogo-Margin')['data']('kendoNumericTextBox')['bind']('change',function(e){var iDimension=parseInt(this['value']());if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['NavBarBottomLogoMargin']=iDimension;}),$('#'+sPropertiesPrefix+'Visible')['on']('input',function(){var bChecked=TriSysSDK['CShowForm']['GetCheckBoxValue'](this['id']);if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['Visible']=bChecked;}),$('#'+sPropertiesPrefix+'Form')['data']('kendoDropDownList')['bind']('change',function(e){var sFormName=this['value']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['Form']=sFormName;}),$('#'+sPropertiesPrefix+'DataEntryForm')['data']('kendoDropDownList')['bind']('change',function(e){var sFormName=this['value']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['DataEntryForm']=sFormName;}),$('#'+sPropertiesPrefix+'SectionBefore')['on']('input',function(){var newText=$(this)['val']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['SectionBefore']=newText;}),$('#'+sPropertiesPrefix+'Style')['data']('kendoDropDownList')['bind']('change',function(e){var sValue=this['value']();if(AppStudioToolBar['SelectedTreeViewItem'])AppStudioToolBar['SelectedTreeViewItem']['data']['Style']=sValue;});},'IconPicked':function(sFieldID,sIcon){var fnReplaceIconInTreeAndInItemData=function(sIcon){if(AppStudioToolBar['SelectedNodeElement']){var $selectedNode=$(AppStudioToolBar['SelectedNodeElement']),$selectedNodeIcon=$selectedNode['find']('span.k-icon');$selectedNodeIcon['length']>0x0&&AppStudioToolBar['SelectedTreeViewItem']['set']('icon',TriSysApex['ModalDialogue']['IconPicker']['DisplayIcon'](sIcon));const selectedNodeDataItem=AppStudioToolBar['SelectedTreeViewItem'];selectedNodeDataItem['data']&&(selectedNodeDataItem['data']['Icon']=sIcon);}};setTimeout(function(){fnReplaceIconInTreeAndInItemData(sIcon);},0xa);},'ToolBarEditor':function(fnCallback){AppStudioToolBar['Persistence']['ReadDataFromWebAPI'](function(treeViewObjectArray){const sIconStyle='style=\x22width:\x2020px;\x20padding:\x204px;\x20margin:\x204px;'+'\x20color:\x20'+TriSysProUI['NavBarInverseColour']()+';\x20\x22',toolBarConfiguration={'dataSource':treeViewObjectArray,'dragAndDrop':!![],'checkboxes':![],'loadOnDemand':![],'select':AppStudioToolBar['SelectTreeItem'],'dragstart':AppStudioToolBar['DragStart'],'dragend':AppStudioToolBar['DragEnd'],'drop':AppStudioToolBar['Drop'],'template':'<span\x20class=\x22k-icon\x20#=\x20item.icon\x20#\x22'+sIconStyle+'></span>\x20#:\x20item.text\x20#\x20&nbsp;','dataBound':function(){AppStudioToolBar['SelectFirstHighLevelNode']();if(fnCallback)fnCallback();}};$('#'+AppStudioToolBar['ToolbarTreeViewRoot'])['kendoTreeView'](toolBarConfiguration);});},'SelectFirstHighLevelNode':function(){var treeview=$('#'+AppStudioToolBar['ToolbarTreeViewRoot'])['data']('kendoTreeView');if(!treeview){console['log']('TreeView\x20not\x20found');return;}var firstItem=treeview['dataSource']['at'](0x0);if(!firstItem){console['error']('No\x20items\x20found\x20in\x20the\x20TreeView');return;}console['log']('First\x20high-level\x20item:',firstItem);var firstNode=treeview['findByUid'](firstItem['uid']);if(!firstNode||!firstNode['length']){console['error']('Could\x20not\x20find\x20DOM\x20node\x20for\x20first\x20item');return;}console['log']('First\x20high-level\x20node:',firstNode),treeview['select'](firstNode),AppStudioToolBar['SelectTreeItem']['call'](treeview,{'sender':treeview,'node':firstNode});},'DragStart':function(e){var treeView=this,draggedNode=e['sourceNode'],draggedItem=treeView['dataItem'](draggedNode),isTopLevel=![],parentItem=draggedItem['parentNode']();!parentItem&&(isTopLevel=!![]),AppStudioToolBar['_dragInfo']={'isTopLevel':isTopLevel,'originalItem':draggedItem,'parentItem':parentItem,'parentID':parentItem&&parentItem['data']?parentItem['data']['ID']:null};},'DragEnd':function(e){delete AppStudioToolBar['_dragInfo'];},'Drop':function(e){if(!AppStudioToolBar['_dragInfo'])return;if(AppStudioToolBar['_dragInfo']['isTopLevel']){e['setValid'](![]),TriSysApex['Toasters']['Warning']('Top-level\x20categories\x20cannot\x20be\x20moved');return;}var treeView=this,dropPosition=e['dropPosition'],destinationNode=e['destinationNode'],destinationItem=treeView['dataItem'](destinationNode),newParentID=null;dropPosition==='over'?newParentItem=destinationItem:newParentItem=destinationItem['parentNode']();var newParentID=newParentItem&&newParentItem['data']?newParentItem['data']['ID']:null;AppStudioToolBar['_dragInfo']['parentID']!==newParentID&&(e['setValid'](![]),TriSysApex['Toasters']['Warning']('Items\x20cannot\x20be\x20moved\x20outside\x20their\x20original\x20parent\x20node'));},'SelectTreeItem':function(e){AppStudioToolBar['SelectedTreeViewItem']=this['dataItem'](e['node']),AppStudioToolBar['SelectedNodeElement']=e['node'],AppStudioToolBar['SelectedNodeTreeViewID']=this['element']['attr']('id'),AppStudioToolBar['ShowProperties'](AppStudioToolBar['SelectedTreeViewItem']);},'ShowProperties':function(properties){const sPrefix=AppStudioToolBar['Prefix'];if(!properties){$('#'+sPrefix+'Properties-Table')['hide']();return;}const selectedItemData=properties['data'];$('#'+sPrefix+'Properties-Label')['text'](TriSysSDK['Miscellaneous']['CamelCaseToMultipleWords'](selectedItemData['Type'])+'\x20Properties');const showPropertiesObject={'Type':selectedItemData['Type'],'TypeVisible':!![],'Locked':selectedItemData['Locked'],'LockedVisible':!![],'ID':selectedItemData['ID'],'IDVisible':!![],'Name':selectedItemData['Name'],'NameVisible':!![],'Description':selectedItemData['Description'],'DescriptionVisible':!![],'Caption':selectedItemData['Caption'],'CaptionVisible':!![],'Tooltip':selectedItemData['Tooltip'],'TooltipVisible':!![],'Icon':selectedItemData['Icon'],'IconVisible':!![],'Visible':selectedItemData['Visible'],'VisibleVisible':!![],'ProductLogoImage':selectedItemData['ProductLogoImage'],'ProductLogoImageVisible':![],'BrandName':selectedItemData['BrandName'],'BrandNameVisible':![],'ProductName':selectedItemData['ProductName'],'ProductNameVisible':![],'NavBarBottomLogoImage':selectedItemData['NavBarBottomLogoImage'],'NavBarBottomLogoImageVisible':![],'NavBarBottomLogoHeight':selectedItemData['NavBarBottomLogoHeight']||0x0,'NavBarBottomLogoWidth':selectedItemData['NavBarBottomLogoWidth']||0x0,'NavBarBottomLogoMargin':selectedItemData['NavBarBottomLogoMargin']||0x0,'Form':selectedItemData['Form'],'DataEntryForm':selectedItemData['DataEntryForm'],'FormVisible':![],'DataEntryFormVisible':![],'SectionBefore':selectedItemData['SectionBefore'],'SectionBeforeVisible':![],'Style':selectedItemData['Style'],'StyleVisible':![],'AccountSummaryActivityMetricsVisible':![]};switch(selectedItemData['Type']){case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['NavBar']:showPropertiesObject['CaptionVisible']=![],showPropertiesObject['TooltipVisible']=![],showPropertiesObject['IconVisible']=![],showPropertiesObject['ProductLogoImageVisible']=!![],showPropertiesObject['BrandNameVisible']=!![],showPropertiesObject['ProductNameVisible']=!![],showPropertiesObject['NavBarBottomLogoImageVisible']=!![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['SearchBox']:break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['HistoryMenu']:break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AddMenu']:break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AddMenuItem']:showPropertiesObject['DataEntryFormVisible']=!![],showPropertiesObject['SectionBeforeVisible']=!![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['CustomButtons']:showPropertiesObject['IconVisible']=![],showPropertiesObject['CaptionVisible']=![],showPropertiesObject['TooltipVisible']=![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['CustomButton']:showPropertiesObject['FormVisible']=!![],showPropertiesObject['StyleVisible']=!![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['ShowHelp']:showPropertiesObject['StyleVisible']=!![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AccountSummary']:showPropertiesObject['IconVisible']=![],showPropertiesObject['CaptionVisible']=![],showPropertiesObject['TooltipVisible']=![];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AccountSummaryItem']:showPropertiesObject['CaptionVisible']=showPropertiesObject['Caption']&&selectedItemData['Caption']!=='',showPropertiesObject['IconVisible']=showPropertiesObject['CaptionVisible'],showPropertiesObject['AccountSummaryActivityMetricsVisible']=showPropertiesObject['Name']=='Activity\x20Metrics';break;default:TriSysApex['UI']['ShowMessage']('Unknown\x20type:\x20'+selectedItemData['Type']);return;}if(showPropertiesObject){$('#'+sPrefix+'Properties-Table')['show']();const sFieldPrefix=sPrefix+'Properties-';var sFieldID=sFieldPrefix+'Type',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['TypeVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Type'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'ID',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['IDVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['ID'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'Name',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['NameVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Name'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'Description',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['DescriptionVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Description'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'Locked',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['LockedVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Locked'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['YesNo']});else parentRow['hide']();sFieldID=sFieldPrefix+'Caption',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['CaptionVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Caption'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'Tooltip',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['TooltipVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Tooltip'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'Visible',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['VisibleVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Visible'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['YesNo']});else parentRow['hide']();sFieldID=sFieldPrefix+'Icon',parentRow=$('#'+sFieldID)['closest']('tr')['closest']('table')['parent']()['closest']('tr');if(showPropertiesObject['IconVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Icon'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Icon']});else parentRow['hide']();sFieldID=sFieldPrefix+'BrandName',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['BrandNameVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['BrandName'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'ProductName',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['ProductNameVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['ProductName'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'ProductLogoImage',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['ProductLogoImageVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['ProductLogoImage'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'NavBarBottomLogoImage',parentRow=$('#'+sFieldID)['closest']('tr');var sDimensionsTableID=sFieldPrefix+'NavBarBottomLogoDimensions-Table',subRowsOfParent=$('#'+sDimensionsTableID)['closest']('tr');if(showPropertiesObject['NavBarBottomLogoImageVisible']){parentRow['show'](),subRowsOfParent['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['NavBarBottomLogoImage'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),sFieldID=sFieldPrefix+'NavBarBottomLogo';var sDimensionFieldID=sFieldID+'-Height';TriSysSDK['CShowForm']['writeFieldValueToWidget'](sDimensionFieldID,showPropertiesObject['NavBarBottomLogoHeight'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Integer']}),sDimensionFieldID=sFieldID+'-Width',TriSysSDK['CShowForm']['writeFieldValueToWidget'](sDimensionFieldID,showPropertiesObject['NavBarBottomLogoWidth'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Integer']}),sDimensionFieldID=sFieldID+'-Margin',TriSysSDK['CShowForm']['writeFieldValueToWidget'](sDimensionFieldID,showPropertiesObject['NavBarBottomLogoMargin'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Integer']});}else parentRow['hide'](),subRowsOfParent['hide']();const sFormID=sFieldPrefix+'Form',sDataEntryFormID=sFieldPrefix+'DataEntryForm';parentRow=$('#'+sFormID)['closest']('tr');if(showPropertiesObject['FormVisible']||showPropertiesObject['DataEntryFormVisible']){TriSysSDK['CShowForm']['ComboVisible'](sFormID,showPropertiesObject['FormVisible']),TriSysSDK['CShowForm']['ComboVisible'](sDataEntryFormID,showPropertiesObject['DataEntryFormVisible']);if(showPropertiesObject['FormVisible'])TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFormID,showPropertiesObject['Form'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Combo']});else showPropertiesObject['DataEntryFormVisible']&&TriSysSDK['CShowForm']['writeFieldValueToWidget'](sDataEntryFormID,showPropertiesObject['DataEntryForm'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Combo']});parentRow['show']();}else parentRow['hide']();sFieldID=sFieldPrefix+'SectionBefore',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['SectionBeforeVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['SectionBefore'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});else parentRow['hide']();sFieldID=sFieldPrefix+'SeparatorAfter',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['SeparatorAfterVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['SeparatorAfter'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['YesNo']});else parentRow['hide']();sFieldID=sFieldPrefix+'Style',parentRow=$('#'+sFieldID)['closest']('tr');if(showPropertiesObject['StyleVisible'])parentRow['show'](),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sFieldID,showPropertiesObject['Style'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Combo']});else parentRow['hide']();const sRowID=sFieldPrefix+'Help-AccountSummary-ActivityMetrics';parentRow=$('#'+sRowID);if(showPropertiesObject['AccountSummaryActivityMetricsVisible'])parentRow['show']();else parentRow['hide']();}},'Delete':function(){if(AppStudioToolBar['SelectedTreeViewItem']){var item=AppStudioToolBar['SelectedTreeViewItem'],node=AppStudioToolBar['SelectedNodeElement'];const selectedItemData=item['data'];if(selectedItemData['Locked']){TriSysApex['UI']['ShowError']('You\x20cannot\x20delete\x20the\x20this\x20item\x20as\x20it\x20is\x20locked.');return;}const sMessage='Delete:\x20'+item['text']+'?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete','Yes',function(){var treeview=$('#'+AppStudioToolBar['SelectedNodeTreeViewID'])['data']('kendoTreeView');AppStudioToolBar['DroppedNodeTreeViewID']&&(treeview=$('#'+AppStudioToolBar['DroppedNodeTreeViewID'])['data']('kendoTreeView'),AppStudioToolBar['DroppedNodeTreeViewID']=null);var selectedNode=treeview['select']();if(selectedNode['length']){var parentNode=null,parentDataItem=treeview['dataItem'](selectedNode)['parentNode']();parentDataItem&&(parentNode=treeview['findByUid'](parentDataItem['uid'])),treeview['remove'](selectedNode),parentNode&&parentNode['length']?(treeview['select'](parentNode),AppStudioToolBar['SelectTreeItem']['call'](treeview,{'sender':treeview,'node':parentNode})):(AppStudioToolBar['ShowProperties'](null),AppStudioToolBar['SelectedTreeViewItem']=null,AppStudioToolBar['SelectedNodeElement']=null,AppStudioToolBar['SelectedNodeTreeViewID']=null,AppStudioToolBar['DroppedNodeTreeViewID']=null);}else TriSysApex['UI']['ShowError']('No\x20node\x20is\x20selected.');return!![];},'No');}},'AddItem'(){if(!AppStudioToolBar['SelectedTreeViewItem']){TriSysApex['UI']['ShowMessage']('Please\x20select\x20an\x20element\x20to\x20configure.');return;}var selectedItem=AppStudioToolBar['SelectedTreeViewItem'],selectedNode=AppStudioToolBar['SelectedNodeElement'];const selectedItemData=selectedItem['data'];var sWhatToAdd=selectedItemData['Type'],sNewType=null;switch(selectedItemData['Type']){case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AddMenu']:sWhatToAdd='Add\x20Menu\x20Item',sNewType=TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['AddMenuItem'];break;case TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['CustomButtons']:sWhatToAdd='Add\x20Custom\x20Button',sNewType=TriSysFlexiva['Settings']['Constants']['AppToolbar_Type']['CustomButton'];break;default:TriSysApex['Toasters']['Warning']('Unable\x20to\x20add\x20additional\x20items\x20to\x20'+selectedItemData['Type']);return;}const fnAddItemToTreeView=function(sName){var treeView=$('#'+AppStudioToolBar['SelectedNodeTreeViewID'])['data']('kendoTreeView');const newItem={'Type':sNewType,'ID':TriSysSDK['Miscellaneous']['GUID'](),'Name':sName,'Description':'Added\x20by\x20'+TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['CRMContact']['FullName']+'\x20on\x20'+moment()['format']('dddd\x20DD\x20MMMM\x20YYYY'),'Caption':sName,'Icon':'gi\x20gi-warning_sign','Visible':!![]},newTreeViewNode={'id':newItem['ID'],'text':newItem['Caption'],'icon':newItem['Icon'],'data':newItem,'items':[]};var parentDataItem=treeView['dataItem'](selectedNode);parentDataItem&&(parentDataItem['append'](newTreeViewNode),treeView['expand'](selectedNode));AppStudioToolBar['UnselectAllNodesInTreeView']();var dataItem=treeView['dataSource']['get'](newItem['ID']);if(dataItem){var newNode=treeView['findByUid'](dataItem['uid']);newNode&&newNode['length']>0x0&&(treeView['select'](newNode),AppStudioToolBar['SelectTreeItem']['call'](treeView,{'sender':treeView,'node':newNode}));}return!![];};var options={'Label':'Name'};TriSysApex['ModalDialogue']['New']['Popup'](sWhatToAdd,'gi-circle_plus',fnAddItemToTreeView,options);},'UnselectAllNodesInTreeView':function(){var treeView=$('#'+AppStudioToolBar['ToolbarTreeViewRoot'])['data']('kendoTreeView');treeView['select'](null);},'FormList':function(){return TriSysFlexiva['Settings']['StringListToComboItems'](AppStudioToolBar['Persistence']['_FormList']);},'DataEntryFormList':function(){return TriSysFlexiva['Settings']['StringListToComboItems'](AppStudioToolBar['Persistence']['_DataEntryFormList']);},'StyleList':function(){const lstStyle=TriSysFlexiva['Settings']['Constants']['Bootstrap_Colours']['List']();return TriSysFlexiva['Settings']['StringListToComboItems'](lstStyle);},'Persistence':{'ReadFormDataFromWebAPI':function(fnPopulateForm){const fnLoadForms=function(lstFile,sServerFormsFolder){lstFile['forEach'](function(file){AppStudioToolBar['Persistence']['_FormList']['push'](file['Name']);const sBase64=file['Base64Text'];if(sBase64){const sJSON=TriSysAPI['Encryption']['Base64']['decode'](sBase64),formData=JSON['parse'](sJSON);if(formData&&formData['Form']&&formData['Form']['Type']){if(formData['Form']['Type']==TriSysFlexiva['Settings']['Constants']['FormType_DataEntry'])AppStudioToolBar['Persistence']['_DataEntryFormList']['push'](file['Name']);}}}),fnPopulateForm();};TriSysFlexiva['Forms']['WebAPI']['ReadForms'](fnLoadForms,{'ReadFileDetail':!![]});},'_FormList':[],'_DataEntryFormList':[],'ReadDataFromWebAPI':function(fnCallback){TriSysFlexiva['AppToolBar']['WebAPI']['Read'](function(sJSON){if(sJSON){const treeViewObjectArray=JSON['parse'](sJSON);fnCallback(treeViewObjectArray);}});},'WriteDataToWebAPI':function(treeViewHierarchy,fnCallback){var payloadObject={};payloadObject['URL']='AppStudio/WriteAppToolbar';const sJSON=JSON['stringify'](treeViewHierarchy),sBase64=TriSysAPI['Encryption']['Base64']['encode'](sJSON);payloadObject['OutboundDataPacket']={'JSON':sBase64},payloadObject['InboundDataFunction']=function(CWriteCustomAppToolbarResponse){if(CWriteCustomAppToolbarResponse&&CWriteCustomAppToolbarResponse['Success']&&fnCallback)fnCallback(CWriteCustomAppToolbarResponse);},payloadObject['ErrorHandlerFunction']=function(request,status,error){console['log'](TriSysAPI['Data']['BaseAddress']()+':\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ReadTreeView':function(){var treeView=$('#'+AppStudioToolBar['ToolbarTreeViewRoot'])['data']('kendoTreeView'),treeViewHierarchy=AppStudioToolBar['Persistence']['GetTreeViewHierarchy'](treeView);return treeViewHierarchy;},'GetTreeViewHierarchy':function(treeView){var hierarchy=[];function traverseNodes(nodes){return nodes['map'](function(node){var item={'text':node['text'],'icon':node['icon'],'data':node['data'],'items':[]};return node['items']&&node['items']['length']>0x0&&(item['items']=traverseNodes(node['items'])),item;});}var rootNodes=treeView['dataSource']['view']();return hierarchy=traverseNodes(rootNodes),hierarchy;},'Save':function(bApplyChanges){var treeViewHierarchy=AppStudioToolBar['Persistence']['ReadTreeView']();AppStudioToolBar['Persistence']['WriteDataToWebAPI'](treeViewHierarchy,function(){bApplyChanges&&TriSysFlexiva['AppToolBar']['GUI']['Apply']();});}}};