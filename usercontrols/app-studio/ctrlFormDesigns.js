var ctrlFormDesigns={'Load':function(context){ctrlFormDesigns['InitialiseFields'](),ctrlFormDesigns['SetDimensions'](),ctrlFormDesigns['LoadForms'](context);},'InitialiseFields':function(){var sFormName='ctrlFormDesigns';TriSysSDK['CShowForm']['InitialiseFields'](sFormName);},'SetDimensions':function(){const sGridID=ctrlFormDesigns['Settings']['GridID'],gridParentBlock=$('#'+sGridID)['parent']();var iHeight=$(window)['height']()-0x180;gridParentBlock['css']('height',iHeight+'px');const sPropertiesID=ctrlFormDesigns['Settings']['PropertiesID'],propertiesParentBlock=$('#'+sPropertiesID)['parent']();propertiesParentBlock['css']('height',iHeight+'px');},'LoadForms':function(context){const fnLoadForms=function(lstFile,sServerFormsFolder){ctrlFormDesigns['Settings']['ServerFormsFolder']=sServerFormsFolder,ctrlFormDesigns['PopulateGrid'](lstFile,context?context['loadOptions']:null);};TriSysFlexiva['Forms']['WebAPI']['ReadForms'](fnLoadForms);},'PopulateGrid':function(lstFile,loadOptions){const sGridID=ctrlFormDesigns['Settings']['GridID'];TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':sGridID,'Title':'Forms','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':lstFile,'Columns':[{'field':'FullPath','title':'FullPath','type':'string','width':0x10e,'hidden':!![]},{'field':'Name','title':'Form\x20Name','type':'string'},{'field':'Size','title':'Size','width':0x46,'type':'string'},{'field':'DateCreated','title':'Date\x20Created','width':0x82,'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'DateModified','title':'Last\x20Modified','width':0x82,'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'}],'KeyColumnName':'Name','OpenButtonCaption':'Edit','DrillDownFunction':function(rowData){TriSysSDK['Grid']['SelectRowByColumnValue']({'Div':sGridID},'Name',rowData['Name']),ctrlFormDesigns['ShowFormProperties'](rowData),ctrlFormDesigns['EditFormPropertiesModal'](rowData['Name']);},'RowClickHandler':function(e,gridObject,gridLayout){var rowData=TriSysSDK['Grid']['GetFirstGridCheckedItem'](gridObject);rowData&&ctrlFormDesigns['ShowFormProperties'](rowData);},'MultiRowSelect':![],'ColumnFilters':![],'Grouping':![]}),lstFile['length']>0x0&&setTimeout(function(){loadOptions&&loadOptions['formID']?TriSysSDK['Grid']['SelectPageContainingRowByColumnValue']({'Div':sGridID},'Name',loadOptions['formID'],function(page){TriSysSDK['Grid']['SelectRowByColumnValue']({'Div':sGridID},'Name',loadOptions['formID'],function(item){TriSysSDK['Grid']['TriggerSelectedRowClickEvent'](sGridID);});}):TriSysSDK['Grid']['SelectFirstRow'](ctrlFormDesigns['Settings']['GridID']);},0x1f4);},'ShowFormProperties':function(file){ctrlFormDesigns['Settings']['SelectedGridRow']=file;var fnCallback=function(fileObject){fileObject&&fileObject['FileData']?file['FileData']=fileObject['FileData']:file['FileData']={};var sDataSourceDescription='';if(file['FileData']['DataSources']&&file['FileData']['DataSources']['length']>0x0){var iDataSourceCounter=0x0;file['FileData']['DataSources']['forEach'](function(dataSource){iDataSourceCounter+=0x1;if(sDataSourceDescription['length']>0x0)sDataSourceDescription+='<br>';sDataSourceDescription+=iDataSourceCounter+':\x20'+dataSource['Type']+'\x20['+dataSource['RequestId']+']';});}const sPrefix='#ctrlFormDesigns-Properties-';$(sPrefix+'SelectedFormName')['text'](file['Name']),$(sPrefix+'Name')['text'](file['Name']);var iconElement=$(sPrefix+'Icon');iconElement['removeClass'](function(index,className){return(className['match'](/(^|\s)(gi-\S+|fa-(?!2x)\S+)/g)||[])['join']('\x20');}),iconElement['addClass'](file['FileData']['Form']['Icon']),$(sPrefix+'Type')['text'](file['FileData']['Form']['Type']),$(sPrefix+'Purpose')['text'](file['FileData']['Purpose']),$(sPrefix+'Description')['text'](file['FileData']['Form']['Description']),$(sPrefix+'RecordSummary')['text'](file['FileData']['Form']['RecordSummary']?file['FileData']['Form']['RecordSummary']:''),$(sPrefix+'DataSource')['html'](sDataSourceDescription),$(sPrefix+'FullPath')['text'](file['FullPath']),$(sPrefix+'Size')['text'](file['Size']),$(sPrefix+'DateCreated')['text'](moment(file['DateCreated'])['format'](sDateFormat)),$(sPrefix+'DateModified')['text'](moment(file['DateModified'])['format'](sDateFormat)),$('#'+ctrlFormDesigns['Settings']['PropertiesBlockID'])['show']();};const sDateFormat='dddd\x20DD\x20MMMM\x20YYYY';!file&&(file={'Name':'New','Description':'Created\x20by\x20'+TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['CRMContact']['FullName']+'\x20on\x20'+moment()['format'](sDateFormat),'FullPath':'','Size':'','DateCreated':new Date(),'DateModified':new Date()}),ctrlFormDesigns['ReadFormPropertiesFromWebAPI'](file['FullPath'],fnCallback);},'GetSelectedGridRow':function(){var grid=$('#'+ctrlFormDesigns['Settings']['GridID'])['data']('kendoGrid');return TriSysSDK['Grid']['GetFirstGridCheckedItem'](grid);},'ReadFormPropertiesFromWebAPI':function(sFullPath,fnCallback){TriSysFlexiva['Forms']['WebAPI']['ReadFile'](sFullPath,function(sJSON){var fileObject=null;sJSON&&(fileObject={'FullPath':sFullPath,'FileData':JSON['parse'](sJSON)}),fnCallback(fileObject);});},'OpenForm':function(sFormName,sFullPath){TriSysFlexiva['Forms']['WebAPI']['ReadFile'](sFullPath,function(sJSON){if(sJSON){const context={'FullPath':sFullPath,'JSON':sJSON};setTimeout(function(){ctrlFormDesigns['OpenFormDesigner'](context);},0x1f4),TriSysApex['UI']['CloseModalPopup']();}});},'OpenFormDesigner':function(context){var fnOpenForm=function(){const options={'PostLoadCallbackFunction':function(){ctrlFormDesigner2024['Load'](context);}};TriSysApex['FormsManager']['OpenForm']('FormDesigner2024',context,!![],options);};TriSysApex['WhiteLabelling']['LoadJavascriptFile'](TriSysApex['Constants']['UserControlFolder']+'app-studio/ctrlFormDesigner2024.js',null,fnOpenForm);},'AddForm':function(){ctrlFormDesigns['ShowFormProperties'](),ctrlFormDesigns['EditFormPropertiesModal']();},'EditForm':function(){ctrlFormDesigns['EditFormPropertiesModal']();},'EditFormPropertiesModal':function(options){const formGridRow=ctrlFormDesigns['Settings']['SelectedGridRow'];var sWhat=formGridRow?'Edit':'Add',sName=formGridRow?formGridRow['Name']:'New';const sImage='gi\x20gi-imac';var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sWhat+'\x20Form\x20Properties:\x20'+sName,parametersObject['Image']=sImage,parametersObject['Maximize']=!![];const iScreenWidth=$(window)['width']();if(iScreenWidth>0x4b0)parametersObject['Width']=0x400;else parametersObject['FullScreen']=!![];parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['Constants']['UserControlFolder']+'app-studio/ctrlFormProperties.html';const bShowDesignButton=formGridRow&&!options||options&&!options['HideDesignButton'];bShowDesignButton&&(parametersObject['ButtonLeftText']='Design',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlFormDesigns['OpenForm'](formGridRow['Name'],formGridRow['FullPath']),!![];}),parametersObject['ButtonCentreText']='Apply',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){return ctrlFormDesigns['ApplyFormProperties']();},parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['OnLoadCallback']=function(){ctrlFormDesigns['LoadModalProperties'](formGridRow);},TriSysApex['UI']['PopupMessage'](parametersObject);},'LoadModalProperties':function(formGridRow){const sPrefix='ctrlFormProperties-';$('#'+sPrefix+'FullPath')['text'](formGridRow?formGridRow['FullPath']:''),TriSysSDK['CShowForm']['HTMLFieldsCodeInjection']({'rootElementId':sPrefix+'Root'}),ctrlFormDesigns['InitialiseTabs'](!![]);if(formGridRow&&formGridRow['FullPath'])TriSysFlexiva['Forms']['WebAPI']['ReadFile'](formGridRow['FullPath'],function(sJSON){if(sJSON){const formObject=JSON['parse'](sJSON);ctrlFormDesigns['DisplayFormProperties'](formObject);}});else{const sDateFormat='dddd\x20DD\x20MMMM\x20YYYY',formObject={'Name':'','Purpose':'','Form':{'Icon':'gi\x20gi-warning_sign','Caption':'','Description':'Created\x20by\x20'+TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['CRMContact']['FullName']+'\x20on\x20'+moment()['format'](sDateFormat)}};ctrlFormDesigns['DisplayFormProperties'](formObject);}setTimeout(TriSysProUI['kendoUI_Overrides'],0x3e8);const formNameElement=$('#'+sPrefix+'Name'),stripInvalidCharsAndUpdate=function(inputField){var curPos=inputField[0x0]['selectionStart'],currentValue=inputField['val'](),newValue=currentValue['replace'](/[^a-zA-Z0-9\-]/g,'');if(currentValue!==newValue){var diff=currentValue['length']-newValue['length'],newPos=Math['max'](0x0,curPos-diff);inputField['val'](newValue),inputField[0x0]['setSelectionRange'](newPos,newPos);}};formNameElement['on']('keydown',function(e){if(e['key']==='\x20'||e['keyCode']===0x20)return e['preventDefault'](),![];}),formNameElement['on']('input',function(){stripInvalidCharsAndUpdate($(this));}),formNameElement['on']('paste',function(e){const elem=$(this),fn=function(){stripInvalidCharsAndUpdate(elem);};setTimeout(fn,0x0);}),formNameElement['on']('drop',function(e){const elem=$(this),fn=function(){stripInvalidCharsAndUpdate(elem);};setTimeout(fn,0x0);}),formNameElement['on']('blur',function(){stripInvalidCharsAndUpdate($(this));}),formNameElement['on']('focus',function(){stripInvalidCharsAndUpdate($(this));});},'InitialiseTabs':function(bLoading){bLoading&&(TriSysSDK['EntityFormTabs']['AddClickEventHandlers']('ctrlFormProperties-tabs',!![]),TriSysSDK['EntityFormTabs']['HighlightTabButton']('ctrlFormProperties-tab-details'));var iMaxHeight=0x0;const elemSelector=$('#ctrlFormProperties-Root\x20.tab-content\x20.tab-pane');elemSelector['each'](function(){const iHeight=$(this)['outerHeight']();if(iHeight>iMaxHeight)iMaxHeight=iHeight;}),elemSelector['each'](function(){$(this)['css']('min-height',iMaxHeight+'px');});},'TabButtonCallback':function(sTabID){ctrlFormDesigns['InitialiseTabs'](![]);switch(sTabID){case'ctrlFormProperties-tab-pane-details':break;case'ctrlFormProperties-tab-pane-data-sources':break;case'ctrlFormProperties-tab-pane-developer':break;}},'DisplayFormProperties':function(formObject){ctrlFormDesigns['Settings']['EditedFormObject']=formObject;const sPrefix='ctrlFormProperties-';TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Name',formObject['Name'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Purpose',formObject['Purpose'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Icon',formObject['Form']['Icon'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Icon']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Caption',formObject['Form']['Caption'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Description',formObject['Form']['Description'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'Type',formObject['Form']['Type'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['SkillCombo']}),TriSysFlexiva['DataSources']['GUI']['DisplayDataSources']({'DataSources':formObject['DataSources'],'Prefix':sPrefix+'DataSource-'});const lstFormButton=formObject['Form']['Buttons'];if(lstFormButton&&lstFormButton['length']>0x0){var saveButton=null,deleteButton=null;lstFormButton['forEach'](function(button){if(button['ID']=='save')saveButton=button;else{if(button['ID']=='delete')deleteButton=button;}});if(saveButton){if(TriSysAPI['Operators']['isEmpty'](saveButton['Visible']))saveButton['Visible']=!![];TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Update-On',saveButton['Visible'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['YesNo']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Update-Caption',saveButton['Caption'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Update-Icon',saveButton['Icon'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Icon']});}if(deleteButton){if(TriSysAPI['Operators']['isEmpty'](deleteButton['Visible']))deleteButton['Visible']=!![];TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Delete-On',deleteButton['Visible'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['YesNo']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Delete-Caption',deleteButton['Caption'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']}),TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'CRUD-Delete-Icon',deleteButton['Icon'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Icon']});}}TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'History-RecordSummary',formObject['Form']['RecordSummary'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});if(!formObject['Developer'])formObject['Developer']={};if(!formObject['Developer']['Scripts'])formObject['Developer']['Scripts']=[];TriSysSDK['CShowForm']['writeFieldValueToWidget'](sPrefix+'FormScriptObjectName',formObject['Developer']['FormScriptObjectName'],{'FieldTypeId':TriSysSDK['Controls']['FieldTypes']['Text']});const parameterOptions={'GridID':'ctrlFormProperties-scripts-grid','Data':formObject['Developer']['Scripts'],'AddRowCaption':'Add\x20Custom\x20Script','Model':{'id':'Url','fields':{'Url':{'type':'string','validation':{'required':!![]}},'Description':{'type':'string'}}},'Columns':[{'field':'Url','title':'Url'},{'field':'Description','title':'Description','width':'250px'}],'SaveFunctionCallback':function(lstRow){formObject['Developer']['Scripts']=lstRow;}};TriSysFlexiva['Configurators']['PopulateKeyValuePairDataEntryGrid'](parameterOptions),ctrlFormDesigns['InitialiseTabs'](![]),$('#'+sPrefix+'Name')['focus']();},'EditDataSource':function(sType){var formObject=ctrlFormDesigns['Settings']['EditedFormObject'];if(!formObject['FullPath']){TriSysApex['UI']['ShowMessage']('Please\x20create\x20the\x20form\x20by\x20applying\x20changes\x20before\x20adding\x20data\x20sources');return;}const sPrefix='ctrlFormProperties-DataSource-',elemSpan=$('#'+sPrefix+sType),sBase64=elemSpan['data']('dataSourceRequest');var request=null;if(sBase64){const sJSON=TriSysAPI['Encryption']['Base64']['decode'](sBase64);request=JSON['parse'](sJSON);}TriSysFlexiva['DataSources']['GUI']['Select'](sType,request,ctrlFormDesigns['SelectedDataSourceRequest']);},'RemoveDataSource':function(sType){var formObject=ctrlFormDesigns['Settings']['EditedFormObject'];if(formObject&&formObject['DataSources'])TriSysFlexiva['DataSources']['GUI']['RemoveRequest'](sType,'ctrlFormProperties-DataSource-',formObject['DataSources']);},'SelectedDataSourceRequest':function(sType,request){var formObject=ctrlFormDesigns['Settings']['EditedFormObject'];if(!formObject['DataSources'])formObject['DataSources']=[];var bFoundType=![];formObject['DataSources']['length']>0x0&&formObject['DataSources']['forEach'](function(dataSource){sType==dataSource['Type']&&(bFoundType=!![],dataSource['RequestId']=request['RequestId']);});if(!bFoundType){const dataSource={'RequestId':request['RequestId'],'Type':sType};formObject['DataSources']['push'](dataSource);}TriSysFlexiva['DataSources']['GUI']['DisplayDataSources']({'DataSources':formObject['DataSources'],'Prefix':'ctrlFormProperties-DataSource-'});},'ApplyFormProperties':function(){var formObject=ctrlFormDesigns['Settings']['EditedFormObject'];const sPrefix='ctrlFormProperties-';formObject['Name']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Name',TriSysSDK['Controls']['FieldTypes']['Text']),formObject['Purpose']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Purpose',TriSysSDK['Controls']['FieldTypes']['Text']),formObject['Form']['Caption']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Caption',TriSysSDK['Controls']['FieldTypes']['Text']),formObject['Form']['Description']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Description',TriSysSDK['Controls']['FieldTypes']['Text']),formObject['Form']['Icon']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Icon',TriSysSDK['Controls']['FieldTypes']['Icon']),formObject['Form']['Type']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'Type',TriSysSDK['Controls']['FieldTypes']['SkillCombo']);if(!formObject['Form']['Type'])formObject['Form']['Type']=TriSysFlexiva['Settings']['Constants']['FormType_Lookup'];if(!formObject['Developer'])formObject['Developer']={};formObject['Developer']['FormScriptObjectName']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'FormScriptObjectName',TriSysSDK['Controls']['FieldTypes']['Text']);const lstFormButton=formObject['Form']['Buttons'];if(lstFormButton&&lstFormButton['length']>0x0){var saveButton=null,deleteButton=null;lstFormButton['forEach'](function(button){if(button['ID']=='save')saveButton=button;else{if(button['ID']=='delete')deleteButton=button;}}),saveButton&&(saveButton['Visible']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Update-On',TriSysSDK['Controls']['FieldTypes']['YesNo']),saveButton['Caption']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Update-Caption',TriSysSDK['Controls']['FieldTypes']['Text']),saveButton['Icon']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Update-Icon',TriSysSDK['Controls']['FieldTypes']['Icon'])),deleteButton&&(deleteButton['Visible']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Delete-On',TriSysSDK['Controls']['FieldTypes']['YesNo']),deleteButton['Caption']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Delete-Caption',TriSysSDK['Controls']['FieldTypes']['Text']),deleteButton['Icon']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'CRUD-Delete-Icon',TriSysSDK['Controls']['FieldTypes']['Icon']));}formObject['Form']['RecordSummary']=TriSysSDK['CShowForm']['readFieldValueFromWidget'](sPrefix+'History-RecordSummary',TriSysSDK['Controls']['FieldTypes']['Text']),formObject['Name']=TriSysSDK['Controls']['FileManager']['StripInconvenientFileNameCharacters'](formObject['Name'],!![],!![]);var lstError=[];if(!formObject['Name'])lstError['push']('Name\x20is\x20required');if(!formObject['Purpose'])lstError['push']('Purpose\x20is\x20required');if(!formObject['Form']['Caption'])lstError['push']('Caption\x20is\x20required');if(!formObject['Form']['Description'])lstError['push']('Description\x20is\x20required');if(formObject['Developer']['Scripts']&&formObject['Developer']['Scripts']['length']>0x0&&!formObject['Developer']['FormScriptObjectName'])lstError['push']('Form\x20Object\x20Name\x20is\x20required\x20where\x20custom\x20scripts\x20are\x20used');const formGridRow=ctrlFormDesigns['Settings']['SelectedGridRow'];if(formGridRow){if(!formGridRow['FullPath'])lstError['push']('File\x20path\x20is\x20missing');}else formObject=ctrlFormDesigns['CloneNewFormObject'](formObject);if(lstError['length']>0x0){const sBullet='<br><i\x20class=\x22gi\x20gi-warning_sign\x20fa-2x\x20themed-color\x22></i>\x20&nbsp;\x20';lstError[0x0]=sBullet+lstError[0x0];const sError='<span\x20class=\x22themed-color\x22>Please\x20address\x20the\x20following\x20data\x20integrity\x20issue'+(lstError['length']==0x1?'':'s')+':</span\x20>\x0a\x09\x09\x09\x09\x09\x09\x09\x20<br>'+lstError['join']('<br>'+sBullet);return TriSysApex['UI']['ShowError'](sError,'Form\x20Properties\x20Validation\x20Error'),![];}return formObject['AuthorDetails']['UpdatingUser']=TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['CRMContact']['FullName'],formObject['AuthorDetails']['LastUpdated']=moment()['format']('DD\x20MMM\x20YYYY\x20HH:mm'),ctrlFormDesigns['SaveFormPropertiesToWebAPI'](formObject),![];},'CloneNewFormObject':function(formObject){const sDefaultFormPath=TriSysApex['Constants']['UserControlFolder']+'app-studio/components/form.json',defaultFormObject=TriSysApex['Forms']['Configuration']['GetJSONFromFileUsingAjax'](sDefaultFormPath);return defaultFormObject&&(defaultFormObject['Name']=formObject['Name'],formObject['Created']=moment()['format']('DD\x20MMM\x20YYYY'),defaultFormObject['Purpose']=formObject['Purpose'],defaultFormObject['Form']['Type']=formObject['Form']['Type'],defaultFormObject['Form']['Caption']=formObject['Form']['Caption'],defaultFormObject['Form']['Description']=formObject['Form']['Description'],defaultFormObject['Form']['Icon']=formObject['Form']['Icon'],defaultFormObject['Tabs']&&defaultFormObject['Tabs']['forEach'](function(tab){if(tab['HTML'])for(var i=0x0;i<tab['HTML']['length'];i++){var sHTML=tab['HTML'][i];const iMax=0x32;for(var g=0x1;g<=iMax;g++){const sPlaceholder='{{GUID-'+g+'}}';if(sHTML['indexOf'](sPlaceholder)>=0x0){const sGUID=TriSysSDK['Miscellaneous']['GUID']();sHTML=sHTML['replace'](sPlaceholder,sGUID);const sDataAttributePanel='flexiva-data-panel=\x22',sDataAttributeComponent='flexiva-data-component=\x22',sDataAttributeField='flexiva-data-field=\x22',lstAttributes=[sDataAttributePanel,sDataAttributeComponent,sDataAttributeField];lstAttributes['forEach'](function(sDataAttribute){if(sHTML['indexOf'](sDataAttribute)>=0x0){const iStart=sHTML['indexOf'](sDataAttribute)+sDataAttribute['length'],iEnd=sHTML['indexOf']('\x22',iStart),sBase64=sHTML['substring'](iStart,iEnd);if(sBase64){var sJSON=TriSysAPI['Encryption']['Base64']['decode'](sBase64),flexivaDataObject=JSON['parse'](sJSON);if(flexivaDataObject['GUID'])flexivaDataObject['GUID']=sGUID;if(flexivaDataObject['ID'])flexivaDataObject['ID']=sGUID;sJSON=JSON['stringify'](flexivaDataObject);const sNewBase64=TriSysAPI['Encryption']['Base64']['encode'](sJSON);sHTML=sHTML['replace'](sBase64,sNewBase64);}}});}}tab['HTML'][i]=sHTML;}})),defaultFormObject;},'SaveFormPropertiesToWebAPI':function(formObject){const formGridRow=ctrlFormDesigns['Settings']['SelectedGridRow'];var sFullPath=formGridRow?formGridRow['FullPath']:null;if(sFullPath){var sFileName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFullPath);if(sFileName!==formObject['Name']+'.json'){const fileRenameRequest={'FileName':formObject['Name']+'.json','RootPath':sFullPath};var payloadObject={};payloadObject['URL']='DeveloperStudio/RenameFile',payloadObject['OutboundDataPacket']=fileRenameRequest,payloadObject['InboundDataFunction']=function(fileResponse){TriSysApex['UI']['HideWait']();if(fileResponse){if(fileResponse['Success'])sFullPath=fileResponse['FilePath'],ctrlFormDesigns['SaveFormPropertiesFileToWebAPI'](sFullPath,formObject);else TriSysApex['UI']['ShowMessage'](fileResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlFormDesigns.SaveFormPropertiesToWebAPI:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Renaming\x20File...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}else ctrlFormDesigns['SaveFormPropertiesFileToWebAPI'](sFullPath,formObject);}else{sFullPath=ctrlFormDesigns['Settings']['ServerFormsFolder'];if(!sFullPath){TriSysApex['UI']['ShowError']('File\x20path\x20is\x20missing');return;}else sFullPath+='\x5c'+formObject['Name']+'.json',ctrlFormDesigns['SaveFormPropertiesFileToWebAPI'](sFullPath,formObject);}},'SaveFormPropertiesFileToWebAPI':function(sFullPath,formObject){const sJSON=JSON['stringify'](formObject),fileRequest={'FileName':sFullPath,'Base64Text':TriSysAPI['Encryption']['Base64']['encode'](sJSON)};var payloadObject={};payloadObject['URL']='DeveloperStudio/WriteFile',payloadObject['OutboundDataPacket']=fileRequest,payloadObject['InboundDataFunction']=function(fileResponse){TriSysApex['UI']['HideWait']();if(fileResponse){if(fileResponse['Success']){const sURL=fileResponse['URL'];TriSysApex['Toasters']['Success']('Form\x20properties:\x20'+formObject['Name']+'\x20saved.'),ctrlFormDesigns['PostSaveFormPropertiesToWebAPI'](formObject);}else TriSysApex['UI']['ShowMessage'](fileResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlFormDesigns.SaveFormPropertiesFileToWebAPI:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Form\x20Properties...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PostSaveFormPropertiesToWebAPI':function(formObject){TriSysApex['UI']['CloseModalPopup']();const bFormConfiguratorOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'id=\x22ctrlFormDesigns-Root\x22'});if(!bFormConfiguratorOpen)AppStudioHome['OpenTool']('Forms',{'formID':formObject['Name']});else{const context={'loadOptions':{'formID':formObject['Name']}};ctrlFormDesigns['LoadForms'](context);}},'CopyForm':function(){const formGridRow=ctrlFormDesigns['GetSelectedGridRow']();if(formGridRow){const sClonedAt='\x20cloned\x20at\x20';var sNewName=formGridRow['Name'];const iClonedAt=sNewName['indexOf'](sClonedAt);if(iClonedAt>0x1)sNewName+='\x20and\x20at\x20';else sNewName+=sClonedAt;sNewName+=moment()['format']('HHmmss')+'.json',ctrlFormDesigns['CloneFormViaWebAPI'](formGridRow['FullPath'],sNewName);}},'CloneFormViaWebAPI':function(sFullPath,sNewName){var fileRequest={'SourceFileName':sFullPath,'DestinationFileName':sNewName},payloadObject={};payloadObject['URL']=ctrlFormDesigns['Settings']['CopyFileAPI'],payloadObject['OutboundDataPacket']=fileRequest,payloadObject['InboundDataFunction']=function(fileResponse){TriSysApex['UI']['HideWait']();if(fileResponse){if(fileResponse['Success'])TriSysFlexiva['Forms']['WebAPI']['ReadFile'](fileResponse['CopiedFilePath'],function(sJSON){if(sJSON){const formObject=JSON['parse'](sJSON);formObject['Name']=sNewName['replace']('.json',''),ctrlFormDesigns['SaveFormPropertiesFileToWebAPI'](fileResponse['CopiedFilePath'],formObject);}});else TriSysApex['UI']['ShowMessage'](fileResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlFormDesigns.CloneFormViaWebAPI:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Form...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteForm':function(){const formGridRow=ctrlFormDesigns['GetSelectedGridRow']();if(formGridRow){const sMessage='Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20the\x20form\x20\x27'+formGridRow['Name']+'\x27?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Form','Yes',function(){return ctrlFormDesigns['DeleteFormViaWebAPI'](formGridRow['FullPath']),![];},'No');}},'DeleteFormViaWebAPI':function(sFullPath){var fileRequest={'FileName':sFullPath},payloadObject={};payloadObject['URL']=ctrlFormDesigns['Settings']['DeleteFileAPI'],payloadObject['OutboundDataPacket']=fileRequest,payloadObject['InboundDataFunction']=function(fileResponse){TriSysApex['UI']['HideWait']();if(fileResponse){if(fileResponse['Success'])TriSysApex['UI']['CloseModalPopup'](),ctrlFormDesigns['LoadForms']();else TriSysApex['UI']['ShowMessage'](fileResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('ctrlFormDesigns.DeleteFormViaWebAPI:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Form...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AddRecordSummaryField':function(){const formObject=ctrlFormDesigns['Settings']['EditedFormObject'];if(!formObject||!formObject['DataSources']||formObject['DataSources']['length']==0x0){TriSysApex['UI']['ShowMessage']('No\x20data\x20sources\x20available\x20to\x20select\x20a\x20field\x20from');return;}var bFoundRead=![];formObject['DataSources']['forEach'](function(dataSource){if(dataSource['Type']=='Read'){ctrlFormDesigns['PromptToSelectDataSourceField'](dataSource),bFoundRead=!![];return;}});if(!bFoundRead){TriSysApex['UI']['ShowMessage']('One\x20of\x20the\x20data\x20sources\x20must\x20be\x20of\x20type\x20\x27Read\x27.');return;}},'PromptToSelectDataSourceField':function(dataSource){sRequestId=dataSource['RequestId'],TriSysFlexiva['DataSources']['Management']['ReadRequestObject'](sRequestId,function(dataSourceRequest){if(dataSourceRequest['request']&&dataSourceRequest['request']['Fields']){var lstField=[];dataSourceRequest['request']['Fields']['forEach'](function(field){lstField['push']({'text':field['Field'],'value':field['Field']});});const sMessage='Select\x20Data\x20Source\x20Field',options={'Instructions':'Select\x20one\x20of\x20the\x20data\x20source\x20fields\x20to\x20use\x20as\x20part\x20of\x20the\x20record\x20summary.','ComboLabel':'Field','ComboDataSource':lstField},fnCallback=function(sFieldName){return ctrlFormDesigns['InsertIntoRecordSummaryField']('{'+sFieldName+'}'),!![];};TriSysApex['ModalDialogue']['Combo']['Popup'](sMessage,'fa-database',fnCallback,options);}});},'InsertIntoRecordSummaryField':function(sText){var $input=$('#ctrlFormProperties-History-RecordSummary');$input['focus']();var pos=$input[0x0]['selectionStart'],text=$input['val'](),newText=text['substring'](0x0,pos)+sText+text['substring'](pos);$input['val'](newText),$input[0x0]['selectionStart']=$input[0x0]['selectionEnd']=pos+sText['length'];},'Settings':{'GridID':'ctrlFormDesigns-Grid','PropertiesID':'ctrlFormDesigns-Properties','PropertiesBlockID':'ctrlFormDesigns-Properties-Block','CopyFileAPI':'DeveloperStudio/CopyFile','DeleteFileAPI':'DeveloperStudio/DeleteFile','ServerFormsFolder':null,'SelectedGridRow':null,'EditedFormObject':null}};