var ctrlPlacementDocumentation={'ClientID':'ctrlPlacementDocumentation-Client','PlacementID':'ctrlPlacementDocumentation-Placement','CandidateID':'ctrlPlacementDocumentation-Candidate','DocumentTypeID':'ctrlPlacementDocumentation-DocumentType','EMailTemplatesID':'ctrlPlacementDocumentation-EMailTemplate','EditEMailTemplateButtonID':'ctrlPlacementDocumentation-EditEMailTemplate','ContractTemplatesID':'ctrlPlacementDocumentation-Contract','EditContractTemplateButtonID':'ctrlPlacementDocumentation-EditContract','NoteHistoryID':'ctrlPlacementDocumentation-NoteHistory','FollowUpID':'ctrlPlacementDocumentation-FollowUp','InsertHeaderAndFooterID':'ctrlPlacementDocumentation-InsertHeaderAndFooter','MergeContractToPDFID':'ctrlPlacementDocumentation-MergeToPDF','AttachContracttoEMailID':'ctrlPlacementDocumentation-AttachContract','SubjectID':'ctrlPlacementDocumentation-Subject','AttachmentsID':'ctrlPlacementDocumentation-Attachments','ManageAttachmentsButtonID':'ctrlPlacementDocumentation-ManageAttachmentLibrary','Load':function(){TriSysSDK['CShowForm']['skillCombo'](ctrlPlacementDocumentation['DocumentTypeID'],'Placement\x20Document','Client\x20Contract');var sPlacementDocumentation='Placement\x20Documentation',sPlacementDocumentationFolder=TriSysActions['MailMerge']['MasterTemplateFolder']+sPlacementDocumentation+'/';TriSysActions['MailMerge']['PopulateTemplates']('Placement\x20Contract',sPlacementDocumentationFolder,ctrlPlacementDocumentation['ContractTemplatesID'],sPlacementDocumentation,ctrlPlacementDocumentation['EditContractTemplateButtonID']),TriSysActions['MailMerge']['PopulateTemplates']('E-Mail',sPlacementDocumentationFolder,ctrlPlacementDocumentation['EMailTemplatesID'],sPlacementDocumentation,ctrlPlacementDocumentation['EditEMailTemplateButtonID']),TriSysActions['MailMerge']['PopulateAttachments'](ctrlPlacementDocumentation['AttachmentsID'],ctrlPlacementDocumentation['ManageAttachmentsButtonID']);var defaults={'TaskType':'Placement\x20Document','Attributes':!![],'Category':'Placement\x20Document'};TriSysActions['NoteHistory']['Load'](ctrlPlacementDocumentation['NoteHistoryID'],defaults);var dtFollowUp=TriSysActions['FollowUp']['FollowUpDateTomorrow']();defaults={'CreateFollowUp':!![],'StartDateTime':dtFollowUp,'Attributes':!![],'Category':'Placement\x20Document'},TriSysActions['FollowUp']['Load'](ctrlPlacementDocumentation['FollowUpID'],defaults),ctrlPlacementDocumentation['PopulateActionData']();},'PopulateActionData':function(){var CReadPlacementDocumentationDetailsActionRequest=new TriSysActions['Invocation']['ActionData'](),payloadObject={};payloadObject['URL']='Action/ReadPlacementDocumentationDetails',payloadObject['OutboundDataPacket']=CReadPlacementDocumentationDetailsActionRequest,payloadObject['InboundDataFunction']=function(CPlacementResponse){TriSysApex['UI']['HideWait']();if(CPlacementResponse){if(CPlacementResponse['Success']){ctrlPlacementDocumentation['DisplayPlacementDetails'](CPlacementResponse),TriSysActions['Persistence']['Read'](ctrlPlacementDocumentation['ReadPersistedSettingsCallback']);return;}else TriSysApex['UI']['ShowMessage'](CPlacementResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlPlacementDocumentation.PopulateActionData:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Placement...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayPlacementDetails':function(placement){placement&&($('#'+ctrlPlacementDocumentation['PlacementID'])['html'](placement['Reference']+':\x20'+placement['JobTitle']),$('#'+ctrlPlacementDocumentation['ClientID'])['html'](placement['ClientName']+',\x20'+placement['CompanyName']),$('#'+ctrlPlacementDocumentation['CandidateID'])['html'](placement['CandidateName']));},'MailMergeData':function(){var sDocumentType=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPlacementDocumentation['DocumentTypeID']),actionSpecificData={'ActionName':'PlacementDocumentation','ActionDisplayName':'Placement\x20Documentation','Values':[{'FieldName':'DocumentType','FieldDisplayName':'Document\x20Type','Value':sDocumentType}]};return actionSpecificData;},'Finish':function(){var mySettings=ctrlPlacementDocumentation['GetSettingsForSelectedDocumentType']();if(!mySettings)return;var NoteHistoryData=ctrlNoteHistory['Validation']();if(!NoteHistoryData)return;var FollowUpData=ctrlFollowUp['Validation']();if(!FollowUpData)return;ctrlPlacementDocumentation['SendActionDataToWebAPI'](mySettings,NoteHistoryData,FollowUpData);},'SendActionDataToWebAPI':function(mySettings,NoteHistoryData,FollowUpData){var CPlacementDocumentationActionRequest=mySettings;CPlacementDocumentationActionRequest['ActionData']=new TriSysActions['Invocation']['ActionData'](),CPlacementDocumentationActionRequest['NoteHistory']=NoteHistoryData,CPlacementDocumentationActionRequest['FollowUp']=FollowUpData;var payloadObject={};payloadObject['URL']='Action/PlacementDocumentation',payloadObject['OutboundDataPacket']=CPlacementDocumentationActionRequest,payloadObject['InboundDataFunction']=function(CPlacementDocumentationActionResponse){TriSysApex['UI']['HideWait']();if(CPlacementDocumentationActionResponse){if(CPlacementDocumentationActionResponse['Success']){TriSysActions['Invocation']['PostInvocationCompletion']();if(CPlacementDocumentationActionResponse['URL'])for(var i=0x0;i<CPlacementDocumentationActionResponse['URL']['length'];i++){var sURL=CPlacementDocumentationActionResponse['URL'][i];TriSysApex['ModalDialogue']['DocumentViewer']['DownloadAndOpen']('e-mail',sURL);}return;}else TriSysApex['UI']['ShowMessage'](CPlacementDocumentationActionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlPlacementDocumentation.SendActionDataToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Generating\x20Contract...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PersistedSettings':null,'ReadPersistedSettingsCallback':function(mySettings){ctrlPlacementDocumentation['PersistedSettings']=mySettings;var sDocumentType=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPlacementDocumentation['DocumentTypeID']);ctrlPlacementDocumentation['ApplyPersistedSetting'](sDocumentType);},'GetSettingsIndexForDocumentType':function(sDocumentType){if(ctrlPlacementDocumentation['PersistedSettings']&&ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes'])for(var i=0x0;i<ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes']['length'];i++){var settings=ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes'][i];if(settings['DocumentType']==sDocumentType)return i;}return-0x1;},'GetSettingsForDocumentType':function(sDocumentType){var iIndex=ctrlPlacementDocumentation['GetSettingsIndexForDocumentType'](sDocumentType);if(iIndex>=0x0)return ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes'][iIndex];},'ApplyPersistedSetting':function(sDocumentType){var mySettings=ctrlPlacementDocumentation['GetSettingsForDocumentType'](sDocumentType);mySettings&&(TriSysSDK['CShowForm']['SetTextInCombo'](ctrlPlacementDocumentation['ContractTemplatesID'],mySettings['ContractTemplate']),TriSysSDK['CShowForm']['SetTextInCombo'](ctrlPlacementDocumentation['EMailTemplatesID'],mySettings['EMailTemplate']),TriSysSDK['CShowForm']['SetCheckBoxValue'](ctrlPlacementDocumentation['InsertHeaderAndFooterID'],mySettings['InsertHeaderAndFooter']),TriSysSDK['CShowForm']['SetCheckBoxValue'](ctrlPlacementDocumentation['MergeContractToPDFID'],mySettings['MergeContractToPDF']),TriSysSDK['CShowForm']['SetCheckBoxValue'](ctrlPlacementDocumentation['AttachContracttoEMailID'],mySettings['AttachContractToEMail']),$('#'+ctrlPlacementDocumentation['SubjectID'])['val'](mySettings['Subject']),TriSysSDK['CShowForm']['SetSkillsInList'](ctrlPlacementDocumentation['AttachmentsID'],mySettings['Attachments']),TriSysActions['PersistedSettingsSafeguard']['WaitUntilTaskControlsAreLoaded'](!![],!![],function(){ctrlNoteHistory['Reload'](mySettings['NoteHistory']),ctrlFollowUp['Reload'](mySettings['FollowUp']);}));},'GetSettings':function(){var mySettings=ctrlPlacementDocumentation['GetSettingsForSelectedDocumentType']();if(!mySettings)return;if(!ctrlPlacementDocumentation['PersistedSettings'])ctrlPlacementDocumentation['PersistedSettings']={'Default':mySettings['DocumentType'],'DocumentTypes':[]};var iIndex=ctrlPlacementDocumentation['GetSettingsIndexForDocumentType'](mySettings['DocumentType']);if(iIndex>=0x0)ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes']['splice'](iIndex,0x1);return ctrlPlacementDocumentation['PersistedSettings']['DocumentTypes']['push'](mySettings),ctrlPlacementDocumentation['PersistedSettings']['Default']=mySettings['DocumentType'],ctrlPlacementDocumentation['PersistedSettings'];},'GetSettingsForSelectedDocumentType':function(){var sError=null,sDocumentType=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlPlacementDocumentation['DocumentTypeID']),sContractTemplate=TriSysActions['MailMerge']['GetTemplateFromCombo'](ctrlPlacementDocumentation['ContractTemplatesID']),sEMailTemplate=TriSysActions['MailMerge']['GetTemplateFromCombo'](ctrlPlacementDocumentation['EMailTemplatesID']),bInsertHeaderAndFooter=TriSysSDK['CShowForm']['CheckBoxValue'](ctrlPlacementDocumentation['InsertHeaderAndFooterID']),bMergeContractToPDF=TriSysSDK['CShowForm']['CheckBoxValue'](ctrlPlacementDocumentation['MergeContractToPDFID']),bAttachContractToEMail=TriSysSDK['CShowForm']['CheckBoxValue'](ctrlPlacementDocumentation['AttachContracttoEMailID']),sSubject=$('#'+ctrlPlacementDocumentation['SubjectID'])['val'](),sAttachments=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](ctrlPlacementDocumentation['AttachmentsID']);if(sError)return TriSysApex['UI']['ShowMessage'](sError),null;var mySettings={'DocumentType':sDocumentType,'ContractTemplate':sContractTemplate,'EMailTemplate':sEMailTemplate,'InsertHeaderAndFooter':bInsertHeaderAndFooter,'MergeContractToPDF':bMergeContractToPDF,'AttachContractToEMail':bAttachContractToEMail,'Subject':sSubject,'Attachments':sAttachments,'NoteHistory':ctrlNoteHistory['Validation'](),'FollowUp':ctrlFollowUp['Validation']()};return mySettings;},'Configure':function(){var mySettings=ctrlPlacementDocumentation['GetSettings']();if(!mySettings)return;TriSysActions['Persistence']['Write'](mySettings);}};$(document)['ready'](function(){ctrlPlacementDocumentation['Load']();});