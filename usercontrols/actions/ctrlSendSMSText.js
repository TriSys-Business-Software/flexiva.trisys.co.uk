var ctrlSendSMSText={'MobileFieldID':'ctrlSendSMSText-MobileField','FromFieldID':'ctrlSendSMSText-FromField','FollowUpID':'ctrlSendSMSText-FollowUp','MessageID':'ctrlSendSMSText-Message','Personal':'Personal\x20Mobile','Work':'Work\x20Mobile','CompanyName':'Company\x20Name','OtherNumber':'Other\x20Number...','Load':function(){var mobileFields=[{'value':ctrlSendSMSText['Personal'],'text':ctrlSendSMSText['Personal']},{'value':ctrlSendSMSText['Work'],'text':ctrlSendSMSText['Work']}];TriSysSDK['CShowForm']['populateComboFromDataSource'](ctrlSendSMSText['MobileFieldID'],mobileFields,0x0);var fromFields=[{'value':ctrlSendSMSText['CompanyName'],'text':ctrlSendSMSText['CompanyName']},{'value':ctrlSendSMSText['Personal'],'text':ctrlSendSMSText['Personal']},{'value':ctrlSendSMSText['Work'],'text':ctrlSendSMSText['Work']},{'value':ctrlSendSMSText['OtherNumber'],'text':ctrlSendSMSText['OtherNumber']}],fnSelectFromField=function(value,sText,sFieldID){if(sText==ctrlSendSMSText['OtherNumber']){var fnNewNumber=function(sNewNumber){if(sNewNumber){var numObject={'value':sNewNumber,'text':sNewNumber};return TriSysSDK['CShowForm']['addItemToCombo'](ctrlSendSMSText['FromFieldID'],sNewNumber,!![],numObject,!![]),!![];}},sMessage='From\x20Number/Name',options={'Label':'From'};TriSysApex['ModalDialogue']['New']['Popup'](sMessage,'gi-iphone',fnNewNumber,options);}};TriSysSDK['CShowForm']['populateComboFromDataSource'](ctrlSendSMSText['FromFieldID'],fromFields,0x2,fnSelectFromField),TriSysActions['FollowUp']['Load'](ctrlSendSMSText['FollowUpID']),TriSysActions['Persistence']['Read'](ctrlSendSMSText['ReadPersistedSettingsCallback']);},'Finish':function(){var mySettings=ctrlSendSMSText['GetSettings'](!![]);if(!mySettings)return;var FollowUpData=ctrlFollowUp['Validation']();if(!FollowUpData)return;var sendSMSTextActionData=new TriSysActions['Invocation']['ActionData']();sendSMSTextActionData['MobileField']=mySettings['MobileField'],sendSMSTextActionData['FromField']=mySettings['FromField'],sendSMSTextActionData['Message']=mySettings['Message'],sendSMSTextActionData['FollowUp']=FollowUpData,ctrlSendSMSText['SendActionDataToWebAPI'](sendSMSTextActionData);},'SendActionDataToWebAPI':function(CSendSMSTextActionRequest){var payloadObject={};payloadObject['URL']='Action/SendSMSText',payloadObject['OutboundDataPacket']=CSendSMSTextActionRequest,payloadObject['InboundDataFunction']=function(CSendSMSTextActionResponse){TriSysApex['UI']['HideWait']();if(CSendSMSTextActionResponse){if(CSendSMSTextActionResponse['Success']){TriSysActions['Invocation']['PostInvocationCompletion']();return;}else TriSysApex['UI']['ShowMessage'](CSendSMSTextActionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlSendSMSText.SendActionDataToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Sending\x20Message...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'Configure':function(){var mySettings=ctrlSendSMSText['GetSettings'](![]);if(!mySettings)return;TriSysActions['Persistence']['Write'](mySettings);},'GetSettings':function(bMandatoryFields){var sError=null,sMobileField=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlSendSMSText['MobileFieldID']),sFromField=TriSysSDK['CShowForm']['GetTextFromCombo'](ctrlSendSMSText['FromFieldID']),sMessage=$('#'+ctrlSendSMSText['MessageID'])['val']();if(!sMessage)sError='Please\x20enter\x20a\x20message\x20to\x20send.';if(sError)return TriSysApex['UI']['ShowMessage'](sError),null;var mySettings={'MobileField':sMobileField,'FromField':sFromField,'Message':sMessage,'FollowUp':ctrlFollowUp['Validation']()};return mySettings;},'ReadPersistedSettingsCallback':function(mySettings){TriSysSDK['CShowForm']['SetTextInCombo'](ctrlSendSMSText['MobileFieldID'],mySettings['MobileField']),$('#'+ctrlSendSMSText['MessageID'])['val'](mySettings['Message']);if(mySettings['Message'])try{document['getElementById'](ctrlSendSMSText['MessageID'])['focus'](),document['getElementById'](ctrlSendSMSText['MessageID'])['select']();}catch(e){}TriSysActions['PersistedSettingsSafeguard']['WaitUntilTaskControlsAreLoaded'](![],!![],function(){ctrlFollowUp['Reload'](mySettings['FollowUp']);});}};$(document)['ready'](function(){ctrlSendSMSText['Load']();});