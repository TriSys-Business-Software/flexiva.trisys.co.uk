var ctrlInviteTimesheetCompletion={'ClientID':'ctrlInviteTimesheetCompletion-Client','CandidateID':'ctrlInviteTimesheetCompletion-Candidate','ClientTemplatesID':'ctrlInviteTimesheetCompletion-ClientTemplate','CandidateTemplatesID':'ctrlInviteTimesheetCompletion-CandidateTemplate','EditClientTemplateButtonID':'ctrlInviteTimesheetCompletion-EditClientTemplate','EditCandidateTemplateButtonID':'ctrlInviteTimesheetCompletion-EditCandidateTemplate','ClientSubjectID':'ctrlInviteTimesheetCompletion-ClientSubject','CandidateSubjectID':'ctrlInviteTimesheetCompletion-CandidateSubject','NoteHistoryID':'ctrlInviteTimesheetCompletion-NoteHistory','FollowUpID':'ctrlInviteTimesheetCompletion-FollowUp','ClientMergeCheckboxID':'ctrlInviteTimesheetCompletion-ClientMerge','CandidateMergeCheckboxID':'ctrlInviteTimesheetCompletion-CandidateMerge','ClientMergeRowsPrefix':'ctrlInviteTimesheetCompletion-ClientTemplate-tr','CandidateMergeRowsPrefix':'ctrlInviteTimesheetCompletion-CandidateTemplate-tr','Load':function(){var sPlacement=$('#Timesheet_PlacementId')['val'](),sCandidate=$('#Timesheet_Candidate')['val'](),sPeriod=TriSysSDK['CShowForm']['GetTextFromCombo']('Timesheet_Period'),lTimesheetId=TriSysApex['Pages']['TimesheetForm']['TimesheetId'];$('#ctrlInviteTimesheetCompletion-Placement')['html'](sPlacement),$('#ctrlInviteTimesheetCompletion-Candidate')['html'](sCandidate),$('#ctrlInviteTimesheetCompletion-Period')['html'](sPeriod),$('#ctrlInviteTimesheetCompletion-TimesheetId')['html'](lTimesheetId);var sInvite='Invite\x20Timesheet\x20Completion',sInviteFolder=sInvite+'/';TriSysActions['MailMerge']['PopulateTemplates'](sInvite+':\x20Client',TriSysActions['MailMerge']['MasterTemplateFolder']+sInviteFolder+TriSysActions['MailMerge']['ClientTemplatesFolder'],ctrlInviteTimesheetCompletion['ClientTemplatesID'],'Invite',ctrlInviteTimesheetCompletion['EditClientTemplateButtonID']),TriSysActions['MailMerge']['PopulateTemplates'](sInvite+':\x20Candidate',TriSysActions['MailMerge']['MasterTemplateFolder']+sInviteFolder+TriSysActions['MailMerge']['CandidateTemplatesFolder'],ctrlInviteTimesheetCompletion['CandidateTemplatesID'],'Invite',ctrlInviteTimesheetCompletion['EditCandidateTemplateButtonID']);var defaults={'TaskType':'Letter'};TriSysActions['NoteHistory']['Load'](ctrlInviteTimesheetCompletion['NoteHistoryID'],defaults);var dtFollowUp=TriSysActions['FollowUp']['FollowUpDateTomorrow']();defaults={'CreateFollowUp':!![],'StartDateTime':dtFollowUp},TriSysActions['FollowUp']['Load'](ctrlInviteTimesheetCompletion['FollowUpID'],defaults),$('#'+ctrlInviteTimesheetCompletion['ClientMergeCheckboxID'])['click'](function(){var bChecked=$(this)['is'](':checked'),elem1=$('#'+ctrlInviteTimesheetCompletion['ClientMergeRowsPrefix']+'1'),elem2=$('#'+ctrlInviteTimesheetCompletion['ClientMergeRowsPrefix']+'2');bChecked?(elem1['show'](),elem2['show']()):(elem1['hide'](),elem2['hide']());}),$('#'+ctrlInviteTimesheetCompletion['CandidateMergeCheckboxID'])['click'](function(){var bChecked=$(this)['is'](':checked'),elem1=$('#'+ctrlInviteTimesheetCompletion['CandidateMergeRowsPrefix']+'1'),elem2=$('#'+ctrlInviteTimesheetCompletion['CandidateMergeRowsPrefix']+'2');bChecked?(elem1['show'](),elem2['show']()):(elem1['hide'](),elem2['hide']());}),TriSysActions['Persistence']['Read'](ctrlInviteTimesheetCompletion['ReadPersistedSettingsCallback']);},'Configure':function(){var mySettings=ctrlInviteTimesheetCompletion['GetSettings']();if(!mySettings)return;TriSysActions['Persistence']['Write'](mySettings);},'GetSettings':function(){var sError=null,sClientTemplate=TriSysActions['MailMerge']['GetTemplateFromCombo'](ctrlInviteTimesheetCompletion['ClientTemplatesID']),sCandidateTemplate=TriSysActions['MailMerge']['GetTemplateFromCombo'](ctrlInviteTimesheetCompletion['CandidateTemplatesID']),sClientSubject=$('#'+ctrlInviteTimesheetCompletion['ClientSubjectID'])['val'](),sCandidateSubject=$('#'+ctrlInviteTimesheetCompletion['CandidateSubjectID'])['val'](),bSendToClient=TriSysSDK['CShowForm']['GetCheckBoxValue'](ctrlInviteTimesheetCompletion['ClientMergeCheckboxID']),bSendToCandidate=TriSysSDK['CShowForm']['GetCheckBoxValue'](ctrlInviteTimesheetCompletion['CandidateMergeCheckboxID']);if(sError)return TriSysApex['UI']['ShowMessage'](sError),null;var mySettings={'ClientTemplate':sClientTemplate,'CandidateTemplate':sCandidateTemplate,'ClientSubject':sClientSubject,'CandidateSubject':sCandidateSubject,'SendToClient':bSendToClient,'SendToCandidate':bSendToCandidate,'NoteHistory':ctrlNoteHistory['Validation'](),'FollowUp':ctrlFollowUp['Validation']()};return mySettings;},'ReadPersistedSettingsCallback':function(mySettings){TriSysSDK['CShowForm']['SetTextInCombo'](ctrlInviteTimesheetCompletion['ClientTemplatesID'],mySettings['ClientTemplate']),TriSysSDK['CShowForm']['SetTextInCombo'](ctrlInviteTimesheetCompletion['CandidateTemplatesID'],mySettings['CandidateTemplate']),$('#'+ctrlInviteTimesheetCompletion['ClientSubjectID'])['val'](mySettings['ClientSubject']),$('#'+ctrlInviteTimesheetCompletion['CandidateSubjectID'])['val'](mySettings['CandidateSubject']),TriSysSDK['CShowForm']['SetCheckBoxValue'](ctrlInviteTimesheetCompletion['ClientMergeCheckboxID'],mySettings['SendToClient']),TriSysSDK['CShowForm']['SetCheckBoxValue'](ctrlInviteTimesheetCompletion['CandidateMergeCheckboxID'],mySettings['SendToCandidate']),TriSysActions['PersistedSettingsSafeguard']['WaitUntilTaskControlsAreLoaded'](!![],!![],function(){ctrlNoteHistory['Reload'](mySettings['NoteHistory']),ctrlFollowUp['Reload'](mySettings['FollowUp']);});},'MailMergeData':function(){var actionSpecificData={'ActionName':'InviteTimesheetCompletion','ActionDisplayName':'Invite\x20Timesheet\x20Completion','Values':[{'FieldName':'Placement','FieldDisplayName':'Placement','Value':$('#ctrlInviteTimesheetCompletion-Placement')['html']()}]};return actionSpecificData;},'Finish':function(){var mySettings=ctrlInviteTimesheetCompletion['GetSettings']();if(!mySettings)return;var NoteHistoryData=ctrlNoteHistory['Validation']();if(!NoteHistoryData)return;var FollowUpData=ctrlFollowUp['Validation']();if(!FollowUpData)return;var sError=null;if(!mySettings['SendToClient']&&!mySettings['SendToCandidate'])sError='You\x20must\x20send\x20to\x20either\x20client\x20or\x20candidate,\x20or\x20both.';else{if(mySettings['SendToClient']&&(!mySettings['ClientTemplate']||!mySettings['ClientSubject']))sError='You\x20must\x20choose\x20a\x20client\x20template\x20and\x20enter\x20a\x20subject.';else{if(mySettings['SendToCandidate']&&(!mySettings['CandidateTemplate']||!mySettings['CandidateSubject']))sError='You\x20must\x20choose\x20a\x20candidate\x20template\x20and\x20enter\x20a\x20subject.';}}if(sError)return TriSysApex['UI']['ShowMessage'](sError),null;ctrlInviteTimesheetCompletion['SendActionDataToWebAPI'](mySettings,NoteHistoryData,FollowUpData);},'SendActionDataToWebAPI':function(mySettings,NoteHistoryData,FollowUpData){var CInviteTimesheetCompletionActionRequest={'ClientTemplate':mySettings['ClientTemplate'],'CandidateTemplate':mySettings['CandidateTemplate'],'ClientSubject':mySettings['ClientSubject'],'CandidateSubject':mySettings['CandidateSubject'],'SendToClient':mySettings['SendToClient'],'SendToCandidate':mySettings['SendToCandidate'],'ActionData':new TriSysActions['Invocation']['ActionData'](),'NoteHistory':NoteHistoryData,'FollowUp':FollowUpData},payloadObject={};payloadObject['URL']='Action/InviteTimesheetCompletion',payloadObject['OutboundDataPacket']=CInviteTimesheetCompletionActionRequest,payloadObject['InboundDataFunction']=function(CInviteTimesheetCompletionActionResponse){TriSysApex['UI']['HideWait']();if(CInviteTimesheetCompletionActionResponse){if(CInviteTimesheetCompletionActionResponse['Success']){TriSysActions['Invocation']['PostInvocationCompletion']();if(CInviteTimesheetCompletionActionResponse['URL'])for(var i=0x0;i<CInviteTimesheetCompletionActionResponse['URL']['length'];i++){var sURL=CInviteTimesheetCompletionActionResponse['URL'][i];TriSysApex['ModalDialogue']['DocumentViewer']['DownloadAndOpen']('e-mail',sURL);}return;}else TriSysApex['UI']['ShowMessage'](CInviteTimesheetCompletionActionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlInviteTimesheetCompletion.SendActionDataToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Generating\x20E-Mail...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};$(document)['ready'](function(){ctrlInviteTimesheetCompletion['Load']();});