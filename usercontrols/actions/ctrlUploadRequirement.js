var ctrlUploadRequirement={'NetworkID':'ctrlUploadRequirement-Network','MessageID':'ctrlUploadRequirement-Message','Load':function(){ctrlUploadRequirement['PopulateNetworks'](),ctrlUploadRequirement['GetJobSummaryFromAPI']();},'GetJobSummaryFromAPI':function(){var lRequirementId=TriSysActions['Data']['MasterEntityId'];if(lRequirementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20requirement.');return;}var CSummaryForSocialRequest={'RequirementId':lRequirementId},payloadObject={};payloadObject['URL']='Vacancy/SummaryForSocialNetwork',payloadObject['OutboundDataPacket']=CSummaryForSocialRequest,payloadObject['InboundDataFunction']=function(CSummaryForSocialResponse){TriSysApex['UI']['HideWait']();if(CSummaryForSocialResponse){if(CSummaryForSocialResponse['Success']){$('#'+ctrlUploadRequirement['MessageID'])['val'](CSummaryForSocialResponse['Message']);return;}else TriSysApex['UI']['ShowMessage'](CSummaryForSocialResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlUploadRequirement.GetJobSummaryFromAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Preparing\x20Vacancy...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'JobSummaryText':function(){var lRequirementId=TriSysActions['Data']['MasterEntityId'];if(lRequirementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20requirement.');return;}},'PopulateNetworks':function(){var sBroadbeanLoginName=TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanLoginName'),sBroadbeanPassword=TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanPassword'),sLogicMelonLoginName=TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonLoginName'),sLogicMelonPassword=TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonPassword');sBroadbeanLoginName&&sBroadbeanPassword&&ctrlUploadRequirement['Networks']['push']({'ID':'Broadbean','Caption':'Broadbean','Function':'ctrlUploadRequirement.NetworkDelivery.Broadbean'});sLogicMelonLoginName&&sLogicMelonPassword&&ctrlUploadRequirement['Networks']['push']({'ID':'LogicMelon','Caption':'LogicMelon','Function':'ctrlUploadRequirement.NetworkDelivery.LogicMelon'});var sourceNetworks=[];for(var i=0x0;i<ctrlUploadRequirement['Networks']['length'];i++){var network=ctrlUploadRequirement['Networks'][i],sourceStruct={'value':network['ID'],'text':network['Caption']};sourceNetworks['push'](sourceStruct);}TriSysSDK['CShowForm']['populateMultiSelectComboFromDataSource'](ctrlUploadRequirement['NetworkID'],sourceNetworks);},'Networks':[{'ID':'Twitter','Caption':'Twitter','Function':null},{'ID':'LinkedIn','Caption':'LinkedIn','Function':null},{'ID':'Facebook','Caption':'Facebook','Function':null}],'GetNetworkFromCaption':function(sCaption){for(var i=0x0;i<ctrlUploadRequirement['Networks']['length'];i++){var network=ctrlUploadRequirement['Networks'][i];if(network['Caption']==sCaption)return network;}},'NetworkDelivery':{'Broadbean':function(sMessage){ctrlUploadRequirement['NetworkDelivery']['BroadcastJob']('Broadbean',sMessage);},'LogicMelon':function(sMessage){ctrlUploadRequirement['NetworkDelivery']['BroadcastJob']('LogicMelon',sMessage);},'BroadcastJob':function(sService,sMessage){var lRequirementId=TriSysActions['Data']['MasterEntityId'];if(lRequirementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20requirement.');return;}var CSendToJobBroadcasterRequest={'RequirementId':lRequirementId,'Message':sMessage,'Broadcaster':sService},payloadObject={};payloadObject['URL']='Action/SendToJobBroadcaster',payloadObject['OutboundDataPacket']=CSendToJobBroadcasterRequest,payloadObject['InboundDataFunction']=function(CSendToJobBroadcasterResponse){TriSysApex['UI']['HideWait']();if(CSendToJobBroadcasterResponse){if(CSendToJobBroadcasterResponse['Success']){TriSysSDK['Browser']['OpenURL'](CSendToJobBroadcasterResponse['URL']),TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CSendToJobBroadcasterResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlUploadRequirement.NetworkDelivery.BroadcastJob:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Broadcasting\x20Job...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'isSocialNetwork':function(network){var socialNetworks=['Twitter','LinkedIn','Facebook'];return socialNetworks['indexOf'](network['Caption'])>=0x0;},'Finish':function(){var lRequirementId=TriSysActions['Data']['MasterEntityId'];if(lRequirementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20requirement.');return;}var sNetworks=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](ctrlUploadRequirement['NetworkID']),sMessage=$('#'+ctrlUploadRequirement['MessageID'])['val'](),sError=null;if(!sNetworks)sError='Please\x20choose\x20a\x20social\x20or\x20job\x20network.';else{if(!sMessage)sError='Please\x20enter\x20a\x20job\x20description.';else{var iTwitterCharacterLimit=0x8c;if(sNetworks['indexOf']('Twitter')>=0x0&&sMessage['length']>iTwitterCharacterLimit)sError='Twitter\x20character\x20limit\x20is:\x20'&iTwitterCharacterLimit&'.\x20You\x20have\x20'&sMessage['length']&'\x20characters\x20currently.';}}if(sError){TriSysApex['UI']['ShowMessage'](sError);return;}ctrlUploadRequirement['SendToNetworks'](lRequirementId,sNetworks,sMessage);},'SendToNetworks':function(lRequirementId,sNetworks,sMessage){var socialNetworks=[],networkParts=sNetworks['split'](',');for(var i=0x0;i<networkParts['length'];i++){var networkPart=networkParts[i],sNetwork=networkPart['replace']('\x20',''),network=ctrlUploadRequirement['GetNetworkFromCaption'](sNetwork);if(network){if(ctrlUploadRequirement['isSocialNetwork'](network))socialNetworks['push'](network['ID']);else TriSysActions['Invocation']['CallDynamicFunction'](network['Function'],!![],sMessage);}}if(socialNetworks['length']>0x0){ctrlUploadRequirement['SendToSocialNetworks'](lRequirementId,sMessage,socialNetworks);return;}},'SendToSocialNetworks':function(lRequirementId,sMessage,socialNetworks){var CSendToSocialNetworkRequest={'RequirementId':lRequirementId,'Message':sMessage,'SocialNetworks':socialNetworks},payloadObject={};payloadObject['URL']='Action/SendToSocialNetwork',payloadObject['OutboundDataPacket']=CSendToSocialNetworkRequest,payloadObject['InboundDataFunction']=function(CSendToSocialNetworkResponse){TriSysApex['UI']['HideWait']();if(CSendToSocialNetworkResponse){if(CSendToSocialNetworkResponse['Success']){if(CSendToSocialNetworkResponse['SocialNetworks'])for(var i=0x0;i<CSendToSocialNetworkResponse['SocialNetworks']['length'];i++){var socialNetworkURL=CSendToSocialNetworkResponse['SocialNetworks'][i];TriSysSDK['Browser']['OpenURL'](socialNetworkURL);}TriSysApex['UI']['CloseModalPopup']();return;}else TriSysApex['UI']['ShowMessage'](CSendToSocialNetworkResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('ctrlUploadRequirement.SendToSocialNetworks:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Sending\x20to\x20Social\x20Network...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}};$(document)['ready'](function(){ctrlUploadRequirement['Load']();});