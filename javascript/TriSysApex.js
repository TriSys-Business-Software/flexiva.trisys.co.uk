var TriSysApex={'Copyright':{'AllRightsReserved':'TriSys\x20Business\x20Software','LongProductDescription':'Flexible\x20Interactive\x20Visual\x20App\x20for\x20Business','ShortProductName':'TriSys','FrameworkName':'Flexiva','HomePage':'www.trisys.co.uk','ShortProductNameBrowserTabText':function(){var sText=TriSysApex['Copyright']['ShortProductName'];if(sText['indexOf']('&amp;')>0x0)sText=sText['replace']('&amp;','&');return sText;}},'UI':{'ShowMessage':function(sMessage,sTitle,fnButton,sOK,showMessageOptions){if(!sTitle)sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Message';if(!sOK)sOK='OK';var iWidth=null;if(showMessageOptions){if(showMessageOptions['PostImage']){const sImageTitle=showMessageOptions['PostImageTitle']?showMessageOptions['PostImageTitle']:sTitle,sStyleWidth=showMessageOptions['PostImageWidth']?'\x20style=\x22width:\x20'+showMessageOptions['PostImageWidth']+'px;\x22':'';sMessage+='<br\x20/><br\x20/><img\x20src=\x22'+showMessageOptions['PostImage']+'\x22\x20'+sStyleWidth+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20title=\x22'+sImageTitle+'\x22\x20alt=\x22show\x20message\x20image\x22\x20>',iWidth=showMessageOptions['PostImageWidth']?showMessageOptions['PostImageWidth']+0x28:null;}}var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['MessageText']=sMessage,parametersObject['Image']='information',parametersObject['CloseTopRightButton']=!![];if(iWidth)parametersObject['Width']=iWidth;parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreText']=sOK;if(fnButton)parametersObject['ButtonCentreFunction']=fnButton;TriSysApex['UI']['PopupMessage'](parametersObject);},'ShowError':function(catchErrorObject,sTitle,fOKButtonFunction){if(!sTitle)sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Error';var sMessage=null;try{sMessage=catchErrorObject;if(catchErrorObject['message'])sMessage=catchErrorObject['message'];}catch(err){}TriSysApex['UI']['errorAlert'](sMessage,sTitle,fOKButtonFunction);},'ShowWait':function(sCaption,sMessage){if(TriSysAPI['Data']['_RetryingConnectionPopupDisplayed'])return;if(!sCaption)sCaption='Please\x20Wait';var bInDev=TriSysApex['Environment']['isDeployedInTestMode'](),bPhoneGapEnabled=TriSysApex['Device']['PhoneGapEnabled'](),sPrefix='';$('#trisys-wait-modal-message')['html']('<img\x20src=\x22'+sPrefix+TriSysApex['Constants']['ShowWaitTopLeftIcon']+'\x22\x20style=\x22border-radius:\x204px;\x22\x20/>\x20&nbsp;\x20'+sMessage),$('#pleaseWaitDiv')['modal']({'backdrop':'static','show':!![],'keyboard':![]});},'HideWait':function(){$('#pleaseWaitDiv')['modal']('hide');},'ShowMessageParameters':function(){this['Title']=TriSysApex['Copyright']['ShortProductName']+'\x20Message',this['MessageText']='',this['ButtonLeftVisible']=![],this['ButtonLeftText']='OK',this['ButtonLeftWidth']=0x32,this['ButtonLeftFunction']=null,this['ButtonCentreVisible']=![],this['ButtonCentreText']='?',this['ButtonCentreWidth']=0x32,this['ButtonCentreFunction']=null,this['ButtonRightVisible']=![],this['ButtonRightText']='Cancel',this['ButtonRightWidth']=0x32,this['ButtonRightFunction']=null,this['ButtonFarLeftVisible']=![],this['ButtonFarLeftText']=null,this['ButtonFarLeftWidth']=0x32,this['ButtonFarLeftFunction']=null,this['ButtonSecondLeftVisible']=![],this['ButtonSecondLeftText']=null,this['ButtonSecondLeftWidth']=0x32,this['ButtonSecondLeftFunction']=null,this['ButtonThirdLeftVisible']=![],this['ButtonThirdLeftText']=null,this['ButtonThirdLeftWidth']=0x32,this['ButtonThirdLeftFunction']=null,this['Height']=0x0,this['Width']=0x0,this['Resizable']=!![],this['Maximize']=![],this['Draggable']=TriSysApex['Constants']['ModalDraggable'],this['Image']='information',this['Layer']=0x1,this['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlTriSysMessageBox.html'),this['ModalDialogueContainer']='ctrlModalDialogue.html',this['UserControlFolder']=TriSysApex['Constants']['UserControlFolder'],this['ModalControl']=null,this['OnLoadCallback']=null,this['VerticalScrollbar']=![],this['MaximumHeight']=0x0,this['FullScreen']=![],this['CloseTopRightButton']=![],this['CloseTopRightButtonFunction']=null;},'CurrentShowMessageParameters':null,'AllocateMultiStackedModalDialogues':function(){var iMax=0x5,modalStackArray=$('#divModalStackArray'),sModalTemplate=modalStackArray['html']();for(var i=0x0;i<iMax;i++){var sModalHTML=sModalTemplate,iNum=i+0x2,divs=['trisys-modal-regular','trisys-modal-dialogue','trisys-modal-header','trisys-modal-close-button','trisys-modal-title','trisys-modal-dynamic-content','trisys-modal-default','trisys-modal-info','trisys-modal-success','trisys-modal-warning','trisys-modal-danger','trisys-modal-primary','trisys-modal-content'];for(var k=0x0;k<divs['length'];k++){var sItem=divs[k],sCopy=sItem+'-'+iNum;sModalHTML=sModalHTML['replace'](sItem,sCopy);}modalStackArray['append'](sModalHTML);}},'GetNextStackedModalIndex':function(){var divs=['trisys-modal-regular','trisys-modal-regular-2','trisys-modal-regular-3','trisys-modal-regular-4','trisys-modal-regular-5','trisys-modal-regular-6'];for(var k=0x0;k<divs['length'];k++){var sItem=divs[k];sDisplay=$('#'+sItem)['attr']('style');if(sDisplay['indexOf']('display:\x20none')>=0x0)return k;}},'GetLastOpenStackedModalDiv':function(sPrefix){if(!sPrefix)sPrefix='trisys-modal-regular';var sSuffix=TriSysApex['UI']['GetCurrentlyOpenStackedModalDivSuffix']();if(sSuffix!=null){var sItem=sPrefix+sSuffix;return sItem;}return null;},'GetCurrentlyOpenStackedModalDivSuffix':function(){var divs=['trisys-modal-regular','trisys-modal-regular-2','trisys-modal-regular-3','trisys-modal-regular-4','trisys-modal-regular-5','trisys-modal-regular-6'];for(var k=divs['length']-0x1;k>=0x0;k--){var sItem=divs[k];sDisplay=$('#'+sItem)['attr']('style');if(sDisplay){if(sDisplay['indexOf']('display:\x20block')>=0x0){if(k==0x0)return'';else return'-'+(k+0x1);}}}return null;},'ProUIPopupMessage':function(parametersObject){if(TriSysAPI['Data']['_RetryingConnectionPopupDisplayed'])return;var bMessageBox=parametersObject['ContentURL']['indexOf']('ctrlTriSysMessageBox.html')>=0x0;if(!bMessageBox){if(!TriSysPhoneGap['isConnectedToComms'](!![],'open\x20modal\x20dialogue:\x20'+parametersObject['ContentURL']))return;}var iNextModalIndex=TriSysApex['UI']['GetNextStackedModalIndex'](),sSuffix=iNextModalIndex==0x0?'':'-'+(iNextModalIndex+0x1),jQueryModalRegular=$('#trisys-modal-regular'+sSuffix),sTitleDiv='#trisys-modal-title'+sSuffix,sContentDiv='#trisys-modal-dynamic-content'+sSuffix,jQueryModalHeader=$('#trisys-modal-header'+sSuffix),modalDialogue=$('#trisys-modal-dialogue'+sSuffix),modalContent=$('#trisys-modal-content'+sSuffix),jQueryContentDiv=$(sContentDiv),jQueryTitleDiv=$(sTitleDiv),divContent=[sTitleDiv,sContentDiv];for(var k=0x0;k<divContent['length'];k++){var sItem=divContent[k];$(sItem)['html']('');}jQueryModalRegular['removeClass']()['addClass']('modal'),jQueryModalRegular['attr']('style','display:\x20none;\x20z-index:\x20199998;\x20zoom:\x201;'),jQueryContentDiv['css']('margin-top','0px'),jQueryContentDiv['css']('padding-left','20px'),jQueryContentDiv['css']('overflow-y','auto');var iMaxHeight=$(window)['height']()-0xd2;jQueryContentDiv['css']('max-height',iMaxHeight+'px'),jQueryContentDiv['css']('overflow-x','hidden');try{TriSysApex['UI']['VerticalScrollOnModalIfNecessary'](jQueryModalRegular,jQueryTitleDiv,jQueryContentDiv,parametersObject['VerticalScrollbar'],parametersObject['MaximumHeight'],parametersObject['FullScreen'],!![]);}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}TriSysApex['UI']['HideWait']();var buttons=['trisys-modal-default'+sSuffix,'trisys-modal-info'+sSuffix,'trisys-modal-success'+sSuffix,'trisys-modal-warning'+sSuffix,'trisys-modal-danger'+sSuffix,'trisys-modal-primary'+sSuffix];for(var i=0x0;i<buttons['length'];i++){var sDiv=buttons[i],elem=$('#'+sDiv);elem['hide'](),elem['unbind']('click'),elem['attr']('disabled',![]);}var sLeftButton='#trisys-modal-success'+sSuffix,sCentreButton='#trisys-modal-warning'+sSuffix,sRightButton='#trisys-modal-primary'+sSuffix,bLeftEnabled=parametersObject['ButtonLeftText']&&parametersObject['ButtonLeftVisible'],bCentreEnabled=parametersObject['ButtonCentreText']&&parametersObject['ButtonCentreVisible'],bRightEnabled=parametersObject['ButtonRightText']&&parametersObject['ButtonRightVisible'],sFarLeftButton='#trisys-modal-default'+sSuffix,sSecondLeftButton='#trisys-modal-info'+sSuffix,sThirdLeftButton='#trisys-modal-danger'+sSuffix,bFarLeftEnabled=parametersObject['ButtonFarLeftText']&&parametersObject['ButtonFarLeftVisible'],bSecondLeftEnabled=parametersObject['ButtonSecondLeftText']&&parametersObject['ButtonSecondLeftVisible'],bThirdLeftEnabled=parametersObject['ButtonThirdLeftText']&&parametersObject['ButtonThirdLeftVisible'],bMoreThan3Buttons=bFarLeftEnabled||bSecondLeftEnabled||bThirdLeftEnabled;if(!bMoreThan3Buttons){if(!bLeftEnabled&&!bRightEnabled)sCentreButton=sRightButton;if(bLeftEnabled&&bRightEnabled&&!bCentreEnabled)sLeftButton=sCentreButton;}if(bLeftEnabled){var sButtonLeftText=TriSysSDK['Resources']['Message'](parametersObject['ButtonLeftText']);TriSysApex['UI']['ConfigureModalButton'](sLeftButton,sButtonLeftText,parametersObject['ButtonLeftFunction']);}if(bCentreEnabled){var sButtonCentreText=TriSysSDK['Resources']['Message'](parametersObject['ButtonCentreText']);TriSysApex['UI']['ConfigureModalButton'](sCentreButton,sButtonCentreText,parametersObject['ButtonCentreFunction']);}if(bRightEnabled){var sButtonRightText=TriSysSDK['Resources']['Message'](parametersObject['ButtonRightText']);TriSysApex['UI']['ConfigureModalButton'](sRightButton,sButtonRightText,parametersObject['ButtonRightFunction']);}if(bFarLeftEnabled){var sButtonFarLeftText=TriSysSDK['Resources']['Message'](parametersObject['ButtonFarLeftText']);TriSysApex['UI']['ConfigureModalButton'](sFarLeftButton,sButtonFarLeftText,parametersObject['ButtonFarLeftFunction']);}if(bSecondLeftEnabled){var sButtonSecondLeftText=TriSysSDK['Resources']['Message'](parametersObject['ButtonSecondLeftText']);TriSysApex['UI']['ConfigureModalButton'](sSecondLeftButton,sButtonSecondLeftText,parametersObject['ButtonSecondLeftFunction']);}if(bThirdLeftEnabled){var sButtonThirdLeftText=TriSysSDK['Resources']['Message'](parametersObject['ButtonThirdLeftText']);TriSysApex['UI']['ConfigureModalButton'](sThirdLeftButton,sButtonThirdLeftText,parametersObject['ButtonThirdLeftFunction']);}var sHeaderClass='alert\x20alert-info',sHeaderIcon='fa-info-circle';switch(parametersObject['Image']){case'error':sHeaderClass='alert\x20alert-danger',sHeaderIcon='fa-times-circle';break;case'question':sHeaderIcon='fa-question-circle';break;case'information':break;case'email':sHeaderIcon='fa-envelope-o';break;default:sHeaderIcon=parametersObject['Image'];break;}var closeButtonElement=$('#trisys-modal-close-button'+sSuffix);if(parametersObject['CloseTopRightButton'])closeButtonElement['show'](),closeButtonElement['css']('color','white'),parametersObject['CloseTopRightButtonFunction']&&(closeButtonElement['unbind']('click'),closeButtonElement['click'](parametersObject['CloseTopRightButtonFunction']));else closeButtonElement['hide']();!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID']&&(sHeaderClass='alert',jQueryModalHeader['css']('background-color',TriSysWebJobs['Constants']['ModalCaptionBackgroundColour']),jQueryModalHeader['css']('color',TriSysWebJobs['Constants']['ModalCaptionFontColour']));jQueryModalHeader['removeClass']()['addClass']('modal-header\x20'+sHeaderClass);var sIcon=null,sImageHTML=null;if(sHeaderIcon){var bPath=sHeaderIcon['indexOf']('/')>=0x0;bPath?(sIcon=sHeaderIcon,sImageHTML='<img\x20src=\x22'+sIcon+'\x22\x20height=\x2224\x22\x20width=\x2224\x22\x20style=\x22margin-top:\x20-7px;\x22>'):(sIcon=TriSysApex['ModalDialogue']['IconPicker']['DisplayIcon'](sHeaderIcon),sImageHTML='<i\x20class=\x22'+sIcon+'\x22\x20style=\x22margin-top:\x20-7px;\x22></i>');}var sTitle=TriSysSDK['Resources']['Message'](parametersObject['Title']);$(sTitleDiv)['html'](sImageHTML+'\x20&nbsp;\x20'+sTitle);var sSize='';if(parametersObject['Maximize']){var iWindowWidth=$(window)['width']();if(!parametersObject['FullScreen']&&!parametersObject['Width']){var iDivisor=iWindowWidth>0x400?0x2:0x1,iMinus=iWindowWidth<0x400?0x64:0x0;parametersObject['Width']=iWindowWidth/ iDivisor-iMinus;}}if(parametersObject['FullScreen'])modalDialogue['css']('top','0px');else modalDialogue['css']('top',$(window)['height']()/0x3+'px'),modalContent['css']('width',$(window)['width']()/0x3+'px');modalDialogue['removeClass']()['addClass']('modal-dialog'+sSize),modalDialogue['css']('width','');if(TriSysApex['Device']['isPhone']()){var sWidth=document['body']['offsetWidth']+'px';sWidth=$(window)['width']()-0x1a+'px',modalDialogue['css']('width',sWidth),sWidth=$(window)['width']()-0x18+'px',modalContent['css']('width',sWidth);var iKludgeTimeout=0xa,fnKludge=function(){modalDialogue['css']('top','0px'),modalDialogue['css']('left','6px'),modalDialogue['css']('height',''),modalDialogue['css']('position',''),setTimeout(function(){modalDialogue['css']('top','39px'),modalDialogue['css']('left','6px');var iHeightKludgeFactor=0x2e,sHeight=$(window)['height']()-iHeightKludgeFactor+'px';modalDialogue['css']('height',sHeight);},iKludgeTimeout);};setTimeout(fnKludge,iKludgeTimeout);}else{if(parametersObject['Width']>0x0)modalContent['css']('width',parametersObject['Width']+'px');if(parametersObject['Height']>0x0)modalDialogue['css']('height',parametersObject['Height']+'px');else{var fHeightFactor=0.9,fHeight=$(window)['height']()*fHeightFactor;modalDialogue['css']('height',fHeight+'px');}}var fnFinalTheming=function(){try{TriSysProUI['kendoUI_Overrides'](),TriSysApex['UI']['VerticalScrollOnModalIfNecessary'](jQueryModalRegular,jQueryTitleDiv,jQueryContentDiv,parametersObject['VerticalScrollbar'],parametersObject['MaximumHeight'],parametersObject['FullScreen']);}catch(e){}};if(bMessageBox){var sMessageText=parametersObject['MessageText'];if(TriSysApex['Device']['isPhone']())sMessageText='<div\x20style=\x22margin:\x2020px;\x22>'+sMessageText+'</div>';jQueryContentDiv['html'](sMessageText),setTimeout(fnFinalTheming,0xa);}else{var sCustomModalFormURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](parametersObject['ContentURL']);if(sCustomModalFormURL)parametersObject['ContentURL']=sCustomModalFormURL;var sURLContent=parametersObject['ContentURL'];if(!parametersObject['SupressAppendedTimestamp'])sURLContent+=TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](parametersObject['ContentURL']);var fnCallback=function(){fnFinalTheming();if(parametersObject['OnLoadCallback'])parametersObject['OnLoadCallback']();};$['get'](sURLContent)['done'](function(result){var b404=result['indexOf']('<!DOCTYPE\x20html>')==0x0&&result['indexOf']('404</title>')>0x0;b404?(setTimeout(function(){TriSysApex['UI']['errorAlert'](sURLContent,'Invalid\x20URL');},0xa),TriSysApex['UI']['CloseModalPopup']()):jQueryContentDiv['load'](sURLContent,fnCallback);})['fail'](function(jqXHR,textStatus,errorThrown){TriSysApex['UI']['errorAlert'](sURLContent,'Invalid\x20URL');});}TriSysApex['ModalDialogue']['Current']['SetName'](parametersObject['ContentURL'],parametersObject['Title']),jQueryModalRegular['off']('shown.bs.modal');var fnOnShown=function(){$(sRightButton)['focus']();};jQueryModalRegular['on']('shown.bs.modal',fnOnShown),jQueryModalRegular['modal']({'backdrop':'static','show':!![],'keyboard':![],'closeOnEscape':![]});if(!TriSysApex['Device']['isPhone']()&&parametersObject['Draggable']&&!TriSysSDK['Browser']['Safari']()){var fnDraggableSetup=function(){var lHeight=$(window)['height'](),lWidth=$(window)['width'](),lModalContentWidth=modalContent['width'](),lTopMin=-0x1*lHeight+0x1e;jQueryModalRegular['draggable']({'start':function(event,ui){},'drag':function(event,ui){var lModalContentHeight=modalContent['height'](),iLeftMin=-0x1*lWidth,iCurrentRelativeLeftMost=iLeftMin-lModalContentWidth;if(ui['position']['left']<iCurrentRelativeLeftMost)ui['position']['left']=iCurrentRelativeLeftMost;var iLeftMax=-0x1*lWidth+lModalContentWidth;if(ui['position']['left']>iLeftMax)ui['position']['left']=iLeftMax;if(ui['position']['top']<lTopMin)ui['position']['top']=lTopMin;var iTopMax=0x0-lModalContentHeight-0x32;if(ui['position']['top']>iTopMax)ui['position']['top']=iTopMax;},'stop':function(event,ui){}}),jQueryModalRegular['height'](lHeight*0x3+'px'),jQueryModalRegular['css']('width',lWidth*0x3+'px'),jQueryModalRegular['css']('left',-0x1*lWidth+'px'),jQueryModalRegular['css']('top',lTopMin+'px'),modalDialogue['css']('top',lHeight+'px');var lDialogueWidth=lModalContentWidth;lDialogueWidth>0x0&&modalDialogue['css']('width',lDialogueWidth+'px'),modalDialogue['css']('left','0px');};try{fnDraggableSetup();}catch(e){}}else try{jQueryModalRegular['draggable']({'disabled':!![]});}catch(e){}setTimeout(function(){TriSysApex['ErrorHandling']['SendScreenshot'](parametersObject['ContentURL'],{'MessageBox':!![]});},0x7d0);},'FullScreenModal':function(){var bFullScreen=!![],iMaximumHeight=0x0,bVerticalScrollbar=![],fWidthFactor=0.9,fHeightFactor=0.9;bFullScreen&&(bVerticalScrollbar=!![],iMaximumHeight=$(window)['height']()*fHeightFactor);var iCurrentModalIndex=TriSysApex['UI']['GetNextStackedModalIndex']()-0x1,sSuffix=iCurrentModalIndex<=0x0?'':'-'+iCurrentModalIndex,jQueryModalRegular=$('#trisys-modal-regular'+sSuffix),sTitleDiv='#trisys-modal-title'+sSuffix,sContentDiv='#trisys-modal-dynamic-content'+sSuffix,jQueryModalHeader=$('#trisys-modal-header'+sSuffix),jQueryContentDiv=$(sContentDiv),jQueryTitleDiv=$(sTitleDiv),lContentHeight=jQueryContentDiv['height'](),lCaptionAndFooterHeight=jQueryTitleDiv['height'](),lModalHeight=jQueryModalRegular['height'](),lInternalSpacing=0xa;lModalHeight=lContentHeight+0x2*lCaptionAndFooterHeight+lInternalSpacing;var position=jQueryModalRegular['position'](),lTop=position['top'],lWindowHeight=$(window)['height'](),bAddScrollBar=0x2*lTop+lModalHeight>=lWindowHeight||bVerticalScrollbar;if(bAddScrollBar){var iVerticalSpacingTotal=0x50,lScrollHeight=lWindowHeight-0x2*lTop-0x2*lCaptionAndFooterHeight-iVerticalSpacingTotal;if(lScrollHeight>iMaximumHeight&&iMaximumHeight>0x0)lScrollHeight=iMaximumHeight;jQueryContentDiv['css']('height',lScrollHeight+'px'),jQueryContentDiv['css']('overflow-y','auto');}if(bFullScreen&&!TriSysApex['Device']['isPhone']()){var modalContent=jQueryContentDiv['parent'](),iWidth=$(window)['width']()*fWidthFactor,iHeight=$(window)['height']()*fHeightFactor;modalContent['css']('width',iWidth+'px');var modalDialogue=modalContent['parent']();modalDialogue['css']('width',iWidth+'px'),jQueryModalRegular['css']('top','0px');}},'VerticalScrollOnModalIfNecessary':function(jQueryModalRegular,jQueryTitleDiv,jQueryContentDiv,bVerticalScrollbar,iMaximumHeight,bFullScreen,bClear){if(bClear){jQueryContentDiv['css']('overflow-y',''),jQueryContentDiv['css']('height',''),jQueryModalRegular['css']('height',''),jQueryModalRegular['height']('');if(TriSysApex['Device']['isPhone']()){var iWidthFactor=0x20;jQueryContentDiv['css']('width',document['body']['offsetWidth']-iWidthFactor),jQueryContentDiv['css']('overflow-x','hidden');}}else{var lContentHeight=jQueryContentDiv['height'](),lCaptionAndFooterHeight=jQueryTitleDiv['height'](),lModalHeight=jQueryModalRegular['height'](),lInternalSpacing=0x14;lModalHeight=lContentHeight+0x2*lCaptionAndFooterHeight+lInternalSpacing;var fWidthFactor=0.9,fHeightFactor=0.77;bFullScreen&&(bVerticalScrollbar=!![],iMaximumHeight=$(window)['height']()*fHeightFactor);var position=jQueryModalRegular['position'](),lTop=position['top'],lWindowHeight=$(window)['height'](),bAddScrollBar=lModalHeight>=lWindowHeight||bVerticalScrollbar;if(bAddScrollBar){var iVerticalSpacingTotal=0xb4,lScrollHeight=lWindowHeight-0x2*lCaptionAndFooterHeight-iVerticalSpacingTotal;if(lScrollHeight>iMaximumHeight&&iMaximumHeight>0x0)lScrollHeight=iMaximumHeight;jQueryContentDiv['css']('height',lScrollHeight+'px'),jQueryContentDiv['css']('overflow-y','auto');}if(bFullScreen&&!TriSysApex['Device']['isPhone']()){var modalContent=jQueryContentDiv['parent'](),iWidth=$(window)['width']()*fWidthFactor,iHeight=$(window)['height']()*fHeightFactor;modalContent['css']('width',iWidth+'px');var modalDialogue=modalContent['parent']();modalDialogue['css']('width',iWidth+'px');}}},'ConfigureModalButton':function(sButtonID,sText,fnButton){$(sButtonID)['show'](),$(sButtonID)['html'](sText),fnButton?$(sButtonID)['click'](function(){var bClose=fnButton();if(bClose)TriSysApex['UI']['CloseModalPopup']();}):$(sButtonID)['click'](function(){TriSysApex['UI']['CloseModalPopup']();});},'isModalOpen':function(options){try{if(options){if(options['BodyMatchString']){const modalBodies=document['querySelectorAll']('.modal-body');var bBodyMatch=![];return modalBodies['forEach'](element=>{if(element['innerHTML']['includes'](options['BodyMatchString'])){var parentModalElement=$('#'+element['id'])['parent']()['parent']()['parent']();if(parentModalElement['is'](':visible')&&parentModalElement['attr']('id')['indexOf']('trisys-modal-regular')==0x0)bBodyMatch=!![];}}),bBodyMatch;}}var sDiv=TriSysApex['UI']['GetLastOpenStackedModalDiv'](),bOpen=sDiv!==null?!![]:![];return bOpen;}catch(err){}},'CloseModalPopup':function(){var sDiv=TriSysApex['UI']['GetLastOpenStackedModalDiv']();if(sDiv){$('#'+sDiv)['modal']('hide');try{$('#'+sDiv)['find']('.modal-body')['first']()['empty']();}catch(e){}}},'PopupMessage':function(parametersObject){if(!parametersObject)return;if(parametersObject['MessageText']){if(typeof parametersObject['MessageText']==='function')var programmer='knobhead';else parametersObject['MessageText']=parametersObject['MessageText']['replace'](/\r\n/g,'<br\x20/>');}TriSysApex['UI']['ProUIPopupMessage'](parametersObject);},'SetTopmostModalImageAndTitle':function(sHeaderIcon,sTitle){var sSuffix=TriSysApex['UI']['GetCurrentlyOpenStackedModalDivSuffix'](),sIcon=TriSysApex['ModalDialogue']['IconPicker']['DisplayIcon'](sHeaderIcon);$('#trisys-modal-title'+sSuffix)['html']('<i\x20class=\x22'+sIcon+'\x22></i>\x20'+sTitle);},'cssUpdate':function(selector,property,value){for(var i=0x0;i<document['styleSheets']['length'];i++){try{document['styleSheets'][i]['insertRule'](selector+'\x20{'+property+':'+value+'}',document['styleSheets'][i]['cssRules']['length']);}catch(err){try{document['styleSheets'][i]['addRule'](selector,property+':'+value);}catch(err){}}}},'alert':function(sMessage,sTitle){if(!sTitle)sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Alert';var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['MessageText']=sMessage,parametersObject['Image']='information',TriSysApex['UI']['PopupMessage'](parametersObject);},'ErrorMessage':function(sMessage,sTitle,fOKButtonFunction){TriSysApex['UI']['errorAlert'](sMessage,sTitle,fOKButtonFunction);},'errorAlert':function(sMessage,sTitle,fOKButtonFunction){if(!sMessage)return;if(typeof sMessage==='string'){if(sMessage['indexOf']('Expired\x20DataServicesKey')>=0x0){TriSysApex['UI']['ExpiredDataServicesKeyWorkflow']();return;}if(!sTitle)sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Error';TriSysApex['Logging']['LogMessage'](sTitle+':\x20'+sMessage),TriSysApex['ErrorHandling']['SendErrorToWebAPI'](sMessage);var iMaxLength=0x400;if(sMessage['length']>iMaxLength)sMessage=sMessage['substring'](0x0,iMaxLength)+'...';var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['MessageText']=sMessage,parametersObject['Image']='error',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ButtonCentreFunction']=fOKButtonFunction,parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreText']='OK',TriSysApex['UI']['PopupMessage'](parametersObject),setTimeout(function(){TriSysApex['ErrorHandling']['SendScreenshot']('TriSysApex.UI.errorAlert',{'ErrorCondition':!![]});},0x1f4);}},'questionYesNo':function(sMessage,sTitle,sYesCaption,fnYesFunction,sNoCaption,fnNoFunction,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['MessageText']=sMessage,parametersObject['Image']='question',parametersObject['ButtonLeftText']=sYesCaption,parametersObject['ButtonLeftFunction']=fnYesFunction,parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']=sNoCaption,parametersObject['ButtonRightFunction']=fnNoFunction;if(options){if(options['CloseTopRightButton'])parametersObject['CloseTopRightButton']=!![];}TriSysApex['UI']['PopupMessage'](parametersObject);},'questionYesNoCancel':function(sMessage,sTitle,sYesCaption,fnYesFunction,sNoCaption,fnNoFunction,sCancelCaption,fnCancelFunction,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['MessageText']=sMessage,parametersObject['Image']='question',parametersObject['ButtonLeftText']=sYesCaption,parametersObject['ButtonLeftFunction']=fnYesFunction,parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreText']=sNoCaption,parametersObject['ButtonCentreFunction']=fnNoFunction,parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']=sCancelCaption,parametersObject['ButtonRightFunction']=fnCancelFunction;if(options){if(options['CloseTopRightButton'])parametersObject['CloseTopRightButton']=!![];}TriSysApex['UI']['PopupMessage'](parametersObject);},'CheckBoxFieldValueToBoolean':function(sField){var sValue=$('input[name='+sField+']')['is'](':checked');switch(sValue){case'on':case'true':case'1':case!![]:return!![];default:return![];}},'SetCheckBoxFieldValue':function(sField,bChecked){var sID='#'+sField;$(sID)['prop']('checked',bChecked);try{var spanObject=$(sID)['parent']('span');bChecked&&spanObject&&spanObject['attr']('class','checked');}catch(ex){}},'ErrorHandlerRedirector':function(sFunction,request,status,error,bDisplayAlert){var sResponseError=null;if(request)sResponseError=request['responseText'];if(status=='timeout')sResponseError=status;var sError=sFunction+'Error:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+sResponseError;TriSysApex['Logging']['LogMessage'](sError);switch(sResponseError){case'Expired\x20DataServicesKey':TriSysApex['UI']['ExpiredDataServicesKeyWorkflow']();break;case'timeout':if(bDisplayAlert)TriSysApex['UI']['errorAlert'](sFunction+':\x20The\x20request\x20has\x20taken\x20too\x20long\x20and\x20has\x20timed-out.','Error');break;default:if(TriSysAPI['Operators']['isEmpty'](bDisplayAlert))bDisplayAlert=!![];if(bDisplayAlert){var bHTML=![];if(sResponseError)bHTML=sResponseError['indexOf']('<html')==0x0;if(bHTML)TriSysApex['UI']['errorAlert'](sResponseError,'Error');else console['log'](sError);}break;}},'ExpiredDataServicesKeyWorkflow':function(){if(TriSysApex['UI']['_ExpiredDataServicesKeyWorkflowInOperation'])return;TriSysApex['UI']['_ExpiredDataServicesKeyWorkflowInOperation']=!![];var sCustomFolder=TriSysWebJobs['Agency']['CustomerID'],sReason='Your\x20session\x20has\x20expired,\x20possibly\x20because\x20your\x20account\x20was\x20used\x20on\x20another\x20computer'+',\x20or\x20because\x20the\x20cached\x20data\x20services\x20key\x20in\x20rss\x5ccustom\x5c'+sCustomFolder+'\x20is\x20out\x20of\x20date.';sReason=TriSysApex['Constants']['SessionExpiredMessage'];var fnRefresh=function(){return TriSysApex['LoginCredentials']['Logoff'](![]),!![];};setTimeout(fnRefresh,0x3*0x3e8),TriSysApex['UI']['errorAlert'](sReason,TriSysApex['Copyright']['ShortProductName'],fnRefresh);},'_ExpiredDataServicesKeyWorkflowInOperation':![],'Notifications':{'Error':function(sTitle,sMessage){TriSysApex['Toasters']['Error'](sMessage);},'Info':function(sTitle,sMessage){TriSysApex['Toasters']['Info'](sMessage);},'UploadSuccess':function(sTitle,sMessage){TriSysApex['Toasters']['Success'](sMessage);}}},'Forms':{'AboutTriSys':function(){var bWebJobsMode=!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID'];if(bWebJobsMode){if(TriSysWebJobs['Constants']['SupressHelpAbout']){if(TriSysWebJobs['Constants']['HelpAboutRedirectURL'])TriSysSDK['Browser']['OpenURL'](TriSysWebJobs['Constants']['HelpAboutRedirectURL']);return;}}var sTitle='About\x20'+TriSysApex['Copyright']['ShortProductName'];if(TriSysApex['Device']['isPhone']()){var sWebAPIVersion=TriSysPhoneGap['isConnectedToComms']()?TriSysAPI['Data']['Version']():'No\x20Internet',d=new Date(),iYear=d['getFullYear'](),sProductNameHTML='<b>'+TriSysApex['Copyright']['ShortProductName']+'</b>&nbsp;'+TriSysApex['Copyright']['LongProductDescription'],sContactUsHTML='&copy;'+'\x201994-'+iYear+'\x20'+TriSysApex['Copyright']['AllRightsReserved'],sWebLinkHTML='<a\x20href=\x22http://'+TriSysApex['Copyright']['HomePage']+'\x22\x20target=\x22_blank\x22\x20alt=\x22TriSys\x20Home\x20Page\x22\x20title=\x22'+TriSysApex['Copyright']['HomePage']+'\x22>'+TriSysApex['Copyright']['HomePage']+'</a>',sVersionString=sProductNameHTML+'<br\x20/>'+'<br\x20/>Flexiva\x20Version:\x20'+TriSysApex['Application']['Version']()+'<br\x20/>Web\x20API\x20Version:\x20'+sWebAPIVersion+'<br\x20/><br\x20/>'+sContactUsHTML+'<br\x20/>'+sWebLinkHTML;TriSysApex['UI']['ShowMessage'](sVersionString,sTitle);}else{var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='gi-circle_info',parametersObject['Maximize']=![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlAbout.html'),parametersObject['Width']=0x2df,parametersObject['ButtonLeftText']='Visit\x20Us',parametersObject['ButtonLeftFunction']=function(){return ctrlAbout['VisitUsButtonClick'](),!![];},parametersObject['ButtonLeftVisible']=!![],TriSysApex['Constants']['ShowTermsAndConditionsButtonOnHelpAbout']&&(parametersObject['ButtonCentreText']='Terms\x20&amp;\x20Conditions',parametersObject['ButtonCentreFunction']=function(){return setTimeout(TriSysApex['ModalDialogue']['TermsAndConditions']['Show'],0x32),!![];},parametersObject['ButtonCentreVisible']=!![]),parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='OK',TriSysApex['UI']['PopupMessage'](parametersObject);}},'OpenHomePageInNewTab':function(){var sURL=TriSysApex['Copyright']['HomePage'];if(sURL['indexOf']('http')<0x0)sURL='http://'+sURL;TriSysSDK['Browser']['OpenURL'](sURL);},'Login':{'areLoginNameAndCompanyNameFieldsCompleted':function(sLoginDiv,sCompanyDiv){var sLoginName=$('#'+sLoginDiv)['val'](),sCompany=$('#'+sCompanyDiv)['val'](),bNotNull=sLoginName&&sCompany;return bNotNull;},'ValidatedLoginCredentialsCallback':function(){TriSysApex['UI']['ShowWait'](null,'Loading\x20forms...'),TriSysApex['LoginCredentials']['ReadLoggedInUserSettings'](TriSysApex['Forms']['Login']['AfterReadingLoggedInUserSettings']);},'AfterReadingLoggedInUserSettings':function(CDataConnectionKey){TriSysApex['LoginCredentials']['CacheStandingData'](CDataConnectionKey,TriSysApex['Forms']['Login']['Authenticated']);},'Authenticated':function(CDataConnectionKey,CCachedStandingDataWithBOLObjects){TriSysApex['Pages']['Index']['PostLoginVisuals'](!![],CDataConnectionKey),TriSysApex['FormsManager']['CloseAllForms'](!![],!![]),TriSysApex['Forms']['Login']['StorePartialCDataConnectionKey'](CDataConnectionKey),TriSysFlexiva['PostLogin']['Initialise'](),TriSysFlexiva['Variables']['Load']({'Silent':!![],'CDataConnectionKey':CDataConnectionKey}),TriSysApex['UI']['HideWait']();if(TriSysApex['CustomFormsAndComponents']['_LoadingCustomModule'])return;TriSysApex['Forms']['Login']['PostLoginRedirection'](CDataConnectionKey);},'StorePartialCDataConnectionKey':function(CDataConnectionKey){TriSysApex['Constants']['_Data']['CDataConnectionKey']=CDataConnectionKey;},'PostLoginRedirection':function(CDataConnectionKey){if(CDataConnectionKey){if(CDataConnectionKey['LoggedInAgencyContact']){TriSysWebJobs['ClientOrCandidateLogin']['AfterReadingLoggedInUserSettings'](CDataConnectionKey);return;}}var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup){ContactPreviewMode['PostLogin']();return;}var sPostLoginFormName=TriSysApex['FormsManager']['PostLoginFormName']();if(sPostLoginFormName)TriSysApex['FormsManager']['OpenForm'](sPostLoginFormName,0x0);},'ShowRegistrationForm':function(){TriSysApex['FormsManager']['OpenForm'](TriSysApex['Constants']['RegistrationForm'],0x0,!![]);},'ShowLoginForm':function(){TriSysApex['FormsManager']['OpenForm'](TriSysApex['Constants']['LoginForm'],0x0,!![]);},'Parameter':function(sParam){if(!sParam)return;switch(sParam['toLowerCase']()){case'register':case'freetrial':case'trial':case'registration':TriSysApex['Forms']['Login']['ShowRegistrationForm']();break;default:var sParts=sParam['split']('=');if(sParts&&sParts['length']==0x2){var sAction=sParts[0x0]['toLowerCase'](),sGUID=sParts[0x1];switch(sAction){case'auto-login':TriSysApex['Toaster']['Info']('ToDo');break;}}break;}},'PasswordResetWorkflow':function(sGUID,fnValid){if(sGUID){var dataPacket={'GUID':sGUID},payloadObject={};return payloadObject['URL']='Security/PasswordResetInvocation',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var objCompleted=data;if(objCompleted){if(objCompleted['Success']){fnValid(objCompleted['EMail']);return;}else TriSysApex['UI']['ShowMessage'](objCompleted['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Forms.Login.PasswordResetWorkflow:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Verifying\x20password\x20reset...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];}return![];},'resetPasswordData':null,'ValidateResetPassword':function(sGUID){var fnResetPassword=function(sEMail){TriSysApex['Forms']['Login']['resetPasswordData']={'GUID':sGUID,'EMail':sEMail};var fnCommenceLogin=function(sEMail,sPassword,sLoginURL){if(sLoginURL){if(sLoginURL['indexOf']('ClientLogin')>0x0||sLoginURL['indexOf']('CandidateLogin')>0x0||sLoginURL['indexOf']('AgencyLogin')>0x0){TriSysWebJobs['Security']['CacheLoginCredentialsAsCookies'](sEMail,sPassword,!![]),window['location']['href']=sLoginURL;return;}}var credentialPacket={'EMailAddress':sEMail,'Password':sPassword};TriSysWeb['Security']['WritePersistedLoginCredentials'](credentialPacket);var sURL=window['location']['href'],sResetPrefix='#resetpassword~',parts=sURL['split'](sResetPrefix),bAppendLoginFormToURL=parts['length']>0x1;sURL=parts[0x0]+(bAppendLoginFormToURL?'?'+TriSysApex['Constants']['LoginForm']:''),window['location']['href']=sURL;},fnCallback=function(){var CChangeLoginCredentials=ctrlChangeLoginCredentials['Validate'](!![]);if(CChangeLoginCredentials)return TriSysApex['Forms']['Login']['PostPasswordResetToServer'](sGUID,sEMail,CChangeLoginCredentials['NewPassword'],fnCommenceLogin),!![];},parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Reset\x20Password',parametersObject['Image']='gi-unlock',parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlChangeLoginCredentials.html'),parametersObject['ButtonLeftText']='Set',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=fnCallback,parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightFunction']=function(){return!![];},TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['Forms']['Login']['PasswordResetWorkflow'](sGUID,fnResetPassword);},'ResetPasswordButtonClick':function(sEMailDiv,sPasswordDiv,sConfirmationDiv){var sEMail=$('#'+sEMailDiv)['val'](),sPassword=$('#'+sPasswordDiv)['val'](),sConfirmation=$('#'+sConfirmationDiv)['val'](),sMessageTitle='Reset\x20'+TriSysApex['Copyright']['ShortProductName']+'\x20Password',sError=TriSysApex['LoginCredentials']['ValidatePassword'](sPassword);if(!sError&&sPassword!=sConfirmation)sError='Passwords\x20do\x20not\x20match.';if(sError){TriSysApex['UI']['ShowMessage'](sError,sMessageTitle);return;}var sGUID=TriSysApex['Forms']['Login']['resetPasswordData']['GUID'];TriSysApex['Forms']['Login']['PostPasswordResetToServer'](sGUID,sEMail,sPassword);},'PostPasswordResetToServer':function(sGUID,sEMail,sPassword,fnCallback){var dataPacket={'GUID':sGUID,'EMail':sEMail,'Password':sPassword},payloadObject={};payloadObject['URL']='Security/PasswordResetSubmission',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var objCompleted=data;if(objCompleted){if(objCompleted['Success']){fnCallback(sEMail,sPassword,objCompleted['LoginURL']);return;}else TriSysApex['UI']['ShowMessage'](objCompleted['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Forms.Login.PostPasswordResetToServer:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Resetting\x20password...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'ForgottenPassword':{'ButtonClick':function(sEMailDiv){var sTitle='Forgotten\x20Password',sEMail=$('#'+sEMailDiv)['val']();if(!TriSysApex['LoginCredentials']['validateEmail'](sEMail)){TriSysApex['UI']['ShowMessage']('Please\x20enter\x20a\x20valid\x20e-mail\x20address.',sTitle);return;}var fnForgottenPasswordComplete=function(){var fnOpenLoginForm=function(){TriSysApex['FormsManager']['OpenForm'](TriSysApex['Constants']['LoginForm'],0x0,!![]),setTimeout(function(){$('#txtLoginEMail')['val'](sEMail),$('#txtLoginPassword')['focus']();},0x3e8);};return setTimeout(fnOpenLoginForm,0x64),!![];};try{if(!TriSysPhoneGap['isConnectedToComms'](!![],'request\x20your\x20password'))return![];}catch(e){}TriSysApex['LoginCredentials']['ForgottenPasswordRequest'](sEMail,fnForgottenPasswordComplete);}},'SignUp':{'ButtonClick':function(sTypeOfRequest){var sTitle='Sign-Up',sFullName=$('#txtSignUp_FullName')['val'](),sCompany=$('#txtSignUp_Company')['val'](),sEMail=$('#txtSignUp_EMail')['val'](),sTelNo=$('#txtSignUp_TelNo')['val'](),sStreet=$('#txtSignUp_Street')['val'](),sCity=$('#txtSignUp_City')['val'](),sCounty=$('#txtSignUp_County')['val'](),sPostCode=$('#txtSignUp_PostCode')['val'](),sCountry=$('#txtSignUp_Country')['val'](),sPassword=$('#txtSignUp_Password')['val'](),sVerifyPassword=$('#txtSignUp_VerifyPassword')['val'](),bAgree=TriSysApex['UI']['CheckBoxFieldValueToBoolean']('chkSignUp_Agree'),bValidate=TriSysApex['LoginCredentials']['ValidateSignUp'](sFullName,sCompany,sEMail,sTelNo,sStreet,sCity,sCounty,sPostCode,sCountry,sPassword,sVerifyPassword,bAgree);if(!bValidate)return;if(!sCompany)sCompany='Unknown';if(!sCountry)sCountry=TriSysSDK['Countries']['DefaultCountryName'];var dataPacket={'FullName':sFullName,'Company':sCompany,'EMail':sEMail,'TelNo':sTelNo,'Street':sStreet,'City':sCity,'County':sCounty,'PostCode':sPostCode,'Country':sCountry,'Password':sPassword,'TypeOfRequest':sTypeOfRequest},fnSuccess=function(){var sThankYou='Thank\x20you\x20for\x20signing-up\x20to\x20the\x20service.<br\x20/>'+'You\x20have\x20been\x20sent\x20an\x20automated\x20e-mail\x20confirming\x20your\x20request.<br\x20/>';if(sTypeOfRequest=='Trial'){var fnAutoLogin=function(){return TriSysApex['Forms']['Login']['ShowLoginForm'](),!![];},fnReturnToLoginForm=function(){var bForceClose=!![];return TriSysApex['FormsManager']['CloseAllForms'](bForceClose),!![];},bOptionA_ProvisionedTrial=![];bOptionA_ProvisionedTrial?TriSysApex['UI']['questionYesNo'](sThankYou+'You\x20will\x20be\x20able\x20to\x20use\x20the\x20link\x20in\x20this\x20e-mail\x20to\x20login\x20to\x20the\x20trial\x20at\x20any\x20time.<br\x20/>'+'Would\x20you\x20like\x20to\x20login\x20now?','Sign-Up\x20to\x20TriSys\x20Trial','Yes',fnAutoLogin,'No',fnReturnToLoginForm):TriSysApex['UI']['ShowMessage'](sThankYou,null,fnAutoLogin);}else TriSysApex['UI']['ShowMessage'](sThankYou+'You\x20will\x20then\x20have\x20the\x20opportunity\x20to\x20pay\x20the\x20monthly\x20subscription\x20in\x20order\x20to\x20'+'provision\x20your\x20private\x20and\x20secure\x20cloud\x20database.');};TriSysApex['LoginCredentials']['SignUpRequest'](dataPacket,fnSuccess);}},'Configuration':{'Pages':null,'Views':null,'_JsonFileCache':[],'Initialise':function(options){var config=TriSysApex['Forms']['Configuration'];!config['Pages']&&(config['Pages']=config['PagesFile'](),config['Views']=config['ViewsFile']());},'Initialised':function(){var config=TriSysApex['Forms']['Configuration'],bInitialised=config['Pages']&&config['Views'];return bInitialised;},'JsonFileData':function(sFile,bCustomConfiguration,bDefaultIfCustomNotFound){var jsonData=null,bAssumeCorrectFilePath=![];if(!bCustomConfiguration){var lstCustomFiles=['navbar.json','forms.json','actions.json'];if(lstCustomFiles['indexOf'](sFile['toLowerCase']())>=0x0){var sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sFile);sFileURL&&(sFile=sFileURL,bAssumeCorrectFilePath=!![]);}}if(bCustomConfiguration&&bDefaultIfCustomNotFound){jsonData=TriSysApex['Forms']['Configuration']['JsonFileData'](sFile,bCustomConfiguration);if(!jsonData)jsonData=TriSysApex['Forms']['Configuration']['JsonFileData'](sFile,![]);return jsonData;}if(bCustomConfiguration){if(TriSysApex['Constants']['WhiteLabelCustomApp'])sFile='configuration/custom/'+TriSysApex['Constants']['WhiteLabelCustomFolder']+'/'+sFile;else sFile=TriSysApex['CustomFormsAndComponents']['CustomCodeFolderURL']()+sFile;}else{if(!bAssumeCorrectFilePath){if(sFile['indexOf']('/')<0x0)sFile='configuration/'+sFile;}}var bInDev=TriSysApex['Pages']['Controller']['isDeveloper']()||TriSysApex['Environment']['isDeployedInTestMode']();if(!bInDev){TriSysApex['Forms']['Configuration']['_JsonFileCache']['forEach'](function(cache){if(cache['file']==sFile)jsonData=cache['data'];});if(jsonData)return jsonData;}jsonData=TriSysApex['Forms']['Configuration']['GetJSONFromFileUsingAjax'](sFile);var lstFilesNotToCache=['upgrade.json'],bAddToCache=!![];lstFilesNotToCache['forEach'](function(sFileNotToCache){if(sFile['toLowerCase']()['indexOf'](sFileNotToCache['toLowerCase']())>=0x0)bAddToCache=![];});if(bAddToCache)TriSysApex['Forms']['Configuration']['_JsonFileCache']['push']({'file':sFile,'data':jsonData});return jsonData;},'GetJSONFromFileUsingAjax':function(sFile){var jsonData=null;const sURL=sFile+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache']();return $['ajax']({'type':'GET','url':sURL,'dataType':'json','success':function(data){jsonData=data;},'error':function(request,status,error){var sMessage='Error:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'];TriSysApex['Logging']['LogMessage']('TriSysApex.Forms.Configuration.GetJSONFromFileUsingAjax('+sFile+'):\x20'+sMessage);},'async':![]}),jsonData;},'PagesFile':function(bCustomConfiguration){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('forms.json',bCustomConfiguration);return jsonData;},'GetPage':function(sFormName){if(TriSysApex['Forms']['Configuration']['Pages'])for(var i=0x0;i<TriSysApex['Forms']['Configuration']['Pages']['length'];i++){var page=TriSysApex['Forms']['Configuration']['Pages'][i];if(page&&sFormName){if(page['FormName']['toLowerCase']()==sFormName['toLowerCase']())return page;}}},'GetImagePathFromEntity':function(sEntityName){for(var i=0x0;i<TriSysApex['Forms']['Configuration']['Pages']['length'];i++){var page=TriSysApex['Forms']['Configuration']['Pages'][i];if(page&&sEntityName){if(page['EntityName']){if(page['EntityName']['toLowerCase']()==sEntityName['toLowerCase']())return page['ImagePath'];}if(page['FormName']){if(page['FormName']['toLowerCase']()==sEntityName['toLowerCase']())return page['ImagePath'];}}}},'ViewsFile':function(){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('formviews.json');return jsonData;},'GetViewsForCustomer':function(sCustomer){var config=TriSysApex['Forms']['Configuration'];if(config['Views'])for(var i=0x0;i<config['Views']['length'];i++){var customerView=config['Views'][i];if(sCustomer==customerView['Customer'])return customerView['Views'];}},'GetViewFile':function(sViewName,sCustomer,sViewType){var config=TriSysApex['Forms']['Configuration'],customerViews=config['GetViewsForCustomer'](sCustomer),sFile=config['GetViewFileForTypeFromCustomerViews'](customerViews,sViewName,sViewType);if(!sFile){var defaultViews=config['GetViewsForCustomer']('default');sFile=config['GetViewFileForTypeFromCustomerViews'](defaultViews,sViewName,sViewType,!![]);}return!sFile&&(sFile=sViewName),sFile;},'GetViewFileForTypeFromCustomerViews':function(customerViews,sViewName,sViewType,bDesktopDefault){if(customerViews)for(var i=0x0;i<customerViews['length'];i++){var view=customerViews[i];if(view['Name']==sViewName){try{var viewTypes=view['Types'],sFile=viewTypes[sViewType];if(sFile)return sFile;}catch(err){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](err));}if(bDesktopDefault)try{var sDesktopFile=view['Types'][TriSysApex['Device']['Desktop']];if(sDesktopFile)return sDesktopFile;}catch(err){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](err));}}}}},'EntityForm':{'EntityName':null,'LoadRecord':function(sEntityName,lRecordId){TriSysApex['Forms']['EntityForm']['EntityName']=sEntityName,TriSysSDK['CShowForm']['readEntityFormDataFromServer'](sEntityName,lRecordId,TriSysApex['Forms']['EntityForm']['AfterFormDataLoaded']);},'AfterFormDataLoaded':function(lRecordId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids'](TriSysApex['Forms']['EntityForm']['EntityName']);var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad'](TriSysApex['Forms']['EntityForm']['EntityName'],lRecordId,fieldDescriptions);},'SaveEvent':function(sEntityName,lRecordId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields){var fieldDescriptions=TriSysSDK['CShowForm']['ReadFieldDescriptionValues'](sEntityName,!![],TriSysApex['Forms']['bEditingForm']);if(!fieldDescriptions||fieldDescriptions['length']==0x0){TriSysApex['UI']['ShowError']('Form:\x20Save:\x20No\x20field\x20descriptions.');return;}if(fnBeforeSaveFieldDescriptions)fieldDescriptions=fnBeforeSaveFieldDescriptions(fieldDescriptions);if(!mandatoryFields)mandatoryFields=[];TriSysApex['Forms']['EntityForm']['InjectCustomMandatoryFields'](sEntityName,mandatoryFields,fieldDescriptions);if(mandatoryFields){var errors=[],lstErrors=[];for(var iMandatory=0x0;iMandatory<mandatoryFields['length'];iMandatory++){var mandatoryField=mandatoryFields[iMandatory];for(var iField=0x0;iField<fieldDescriptions['length'];iField++){var fieldDescription=fieldDescriptions[iField];fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']==mandatoryField['Name']&&(!fieldDescription['Value']?(errors['push'](mandatoryField['Caption']),lstErrors['push']({'ID':fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],'Message':mandatoryField['Caption']})):mandatoryField['InvalidValues']&&(mandatoryField['InvalidValues']['indexOf'](fieldDescription['Value'])>=0x0&&(errors['push'](mandatoryField['Caption']),lstErrors['push']({'ID':fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],'Message':mandatoryField['Caption']}))));}}if(errors['length']>0x0){var sError='Please\x20enter\x20a\x20value\x20for\x20each\x20of\x20the\x20following\x20'+sEntityName+'\x20fields:\x20<br\x20/><br\x20/>',sFieldPrefix='\x20&nbsp;\x20&nbsp;\x20';for(var iError=0x0;iError<errors['length'];iError++){sError+=sFieldPrefix+errors[iError]+'<br\x20/>';}for(var i=0x0;i<lstErrors['length'];i++){var error=lstErrors[i];error['Message']='Please\x20enter\x20a\x20value\x20for\x20'+error['Message'],error['ID']='#'+error['ID'];}TriSysApex['TourGuide']['ShowFormErrorsAsATourGuide'](lstErrors['length']+'\x20'+sEntityName+'\x20Form\x20Error'+(lstErrors['length']==0x1?'':'s'),lstErrors);return;}}var bProceedToUpdate=TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityBeforeUpdate'](sEntityName,lRecordId);bProceedToUpdate&&TriSysSDK['CShowForm']['writeEntityFormDataToServer'](sEntityName,lRecordId,fieldDescriptions,fnAfterSaveRecord);},'AfterSaveConfirmation':function(sEntityName,lRecordId){TriSysApex['Toasters']['Success'](sEntityName+'\x20Record\x20Saved');},'LoadTaskGrid':function(sFormName,sDivTag,fnParameters,bScheduled,fnPostPopulationCallback,gridOptions){var fnPopulationByFunction={'API':'Tasks/PagedList','Parameters':function(request){request['Scheduled']=bScheduled,fnParameters(request);},'DataTableFunction':function(response){return response['Tasks'];}},fnHideTaskTypeImageColumnMenu=function(iTotalRecordCount){var grid=$('#'+sDivTag)['data']('kendoGrid');try{grid['thead']['find']('[data-field=Image]>.k-header-column-menu')['remove']();}catch(e){}if(fnPostPopulationCallback)fnPostPopulationCallback(iTotalRecordCount);},sGridName=sDivTag+'-Grid';if(TriSysApex['Forms']['EntityForm']['isGridPopulated'](sFormName,sDivTag))return;var gridLayoutOptions={'Div':sDivTag,'ID':sGridName,'Title':'Tasks','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':TriSysApex['Pages']['TaskSearchForm']['Columns'],'MobileVisibleColumns':[{'field':'DisplayDescription'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20DisplayDescription\x20#</strong><br\x20/>'+'<i>#:\x20TaskType\x20#</i></td>','KeyColumnName':'TaskId','DrillDownFunction':function(rowData){if(gridOptions&&gridOptions['DrillDownClickCallback'])gridOptions['DrillDownClickCallback'](rowData['TaskId']);else TriSysApex['ModalDialogue']['Task']['QuickShow'](rowData['TaskId'],bScheduled);},'MultiRowSelect':!![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'PostPopulationCallback':fnHideTaskTypeImageColumnMenu,'HyperlinkedColumns':['TaskType']};if(gridOptions&&gridOptions['SingleClickRowHandler'])gridLayoutOptions['SingleClickRowHandler']=function(rowData){gridOptions['SingleClickRowHandler'](rowData['TaskId']);};if(gridOptions&&gridOptions['HideOpenButton'])gridLayoutOptions['HideOpenButton']=gridOptions['HideOpenButton'];TriSysSDK['Grid']['VirtualMode'](gridLayoutOptions);},'populatedGrids':[{'FormName':'testForm','GridName':'testGrid'}],'isGridPopulated':function(sFormName,sGridName){var populatedGrids=TriSysApex['Forms']['EntityForm']['populatedGrids'],gridItem=null;for(var i=0x0;i<populatedGrids['length'];i++){gridItem=populatedGrids[i];if(gridItem['FormName']==sFormName&&gridItem['GridName']==sGridName)return!![];}return gridItem={'FormName':sFormName,'GridName':sGridName},populatedGrids['push'](gridItem),![];},'unPopulateFormGrids':function(sFormName,sGridName){var populatedGrids=TriSysApex['Forms']['EntityForm']['populatedGrids'],gridItem=null;if(populatedGrids['length']>=0x0)for(var i=populatedGrids['length']-0x1;i>=0x0;i--){gridItem=populatedGrids[i];if(gridItem['FormName']==sFormName){var bRemove=!![];if(sGridName){if(gridItem['GridName']!=sGridName)bRemove=![];}bRemove&&populatedGrids['splice'](i,0x1);}}},'SubmitDeletion':function(sEntityName,lRecordId,fnCallback){var CEntityDeleteRequest={'EntityName':sEntityName,'EntityId':lRecordId},payloadObject={};payloadObject['URL']='Entity/DeleteEntity',payloadObject['OutboundDataPacket']=CEntityDeleteRequest,payloadObject['InboundDataFunction']=function(CCreateReadUpdateDeleteOperation){TriSysApex['UI']['HideWait']();if(CCreateReadUpdateDeleteOperation){if(CCreateReadUpdateDeleteOperation['Success'])fnCallback();else TriSysApex['UI']['ShowError']('TriSysApex.Forms.EntityForm.SubmitDeletion\x20Error:\x20'+CCreateReadUpdateDeleteOperation['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Forms.EntityForm.SubmitDeletion\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Forms.EntityForm.SubmitDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20'+sEntityName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DrawMasterDetailTaskGridAndForm':function(options){if(TriSysApex['Forms']['EntityForm']['isGridPopulated'](options['EntityName'],options['TabID'])){ctrlTaskGridMasterDetail['ShowActiveTabKludge'](options);return;}var fnLoad=function(){ctrlTaskGridMasterDetail['Load'](options);},bInDev=TriSysApex['Pages']['Controller']['isDeveloper']()||TriSysApex['Environment']['isDeployedInTestMode']();if(typeof ctrlTaskGridMasterDetail!=TriSysApex['Constants']['Undefined']&&!bInDev)fnLoad();else TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlTaskGridMasterDetail.js',null,fnLoad);},'PopulateMasterDetailTaskGridAndForm':function(populationOptions){ctrlTaskGridMasterDetail['Populate'](populationOptions);},'InjectCustomMandatoryFields':function(sEntityName,mandatoryFields,fieldDescriptions){if(typeof ApexCustomerModule!=TriSysApex['Constants']['Undefined']&&typeof ApexCustomerModule['InjectCustomMandatoryFields']!=TriSysApex['Constants']['Undefined'])try{ApexCustomerModule['InjectCustomMandatoryFields'](sEntityName,mandatoryFields,fieldDescriptions);}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}}},'buttonGoBack':function(){window['history']['back']();},'buttonGoForward':function(){window['history']['forward']();},'enableBackForwardButton':function(sDivTag,sDirection,bEnable){var sClass='m-icon-big-swap'+sDirection+'\x20m-icon-'+(bEnable?'white':'grey');document['getElementById'](sDivTag)['className']=sClass;},'ForwardBackButtonAvailabilityUpdate':function(){var bBackButtonEnabled=![],bForwardButtonEnabled=![],queue=TriSysApex['Forms']['formQueue'];queue['length']>0x0&&(bBackButtonEnabled=TriSysApex['Forms']['currentFormIndex']>0x0,bForwardButtonEnabled=TriSysApex['Forms']['currentFormIndex']<queue['length']-0x1),TriSysApex['Forms']['enableBackForwardButton']('NavBar_BackButton','left',bBackButtonEnabled),TriSysApex['Forms']['enableBackForwardButton']('NavBar_ForwardButton','right',bForwardButtonEnabled);},'pushPageOntoFormQueue':function(sPageURL){var queue=TriSysApex['Forms']['formQueue'],item=null;for(i=queue['length']-0x1;i>=0x0;i--){item=queue[i];if(item['PageURL']=='')queue['splice'](i,0x1);}var iIndexOfItemInQueue=-0x1;for(i=queue['length']-0x1;i>=0x0;i--){item=queue[i];if(item['PageURL']==sPageURL){iIndexOfItemInQueue=i;break;}}iIndexOfItemInQueue<0x0?(item={'PageURL':sPageURL},queue['push'](item),TriSysApex['Forms']['currentFormIndex']=queue['length']-0x1):TriSysApex['Forms']['currentFormIndex']=iIndexOfItemInQueue,TriSysApex['Forms']['ForwardBackButtonAvailabilityUpdate']();},'formQueue':[{'PageURL':''}],'currentFormIndex':0x0,'entityCountersForMainMenu':function(){var payloadObject={};payloadObject['URL']='Counters/EntityCount',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(data){var entityObject=data;return entityObject&&($('#lblContactsCounter')['html'](entityObject['Contacts']),$('#lblCompaniesCounter')['html'](entityObject['Companies']),$('#lblRequirementsCounter')['html'](entityObject['Requirements']),$('#lblPlacementsCounter')['html'](entityObject['Placements']),$('#lblTimesheetsCounter')['html'](entityObject['Timesheets'])),!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('entityCountersForMainMenu:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'FormCloseEvent':function(){var sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20close\x20this\x20form?';return TriSysApex['UI']['questionYesNo'](sMessage,'Close\x20Form','Yes',function(){TriSysApex['Forms']['loadPageProgrammatically']('Dashboard.aspx','menuHome_Dashboard');},'No'),![];},'FormNewEvent':function(){if(TriSysApex['Forms']['bEditingForm']){var sMessage='You\x20are\x20currently\x20editing\x20this\x20form.\x20Save\x20changes?\x20';TriSysApex['UI']['questionYesNo'](sMessage,'New\x20Record','Yes',function(){var bLoadNew=!![];TriSysApex['Forms']['FormSaveEvent'](bLoadNew);},'No');}},'FormSaveAsEvent':function(){TriSysApex['UI']['alert']('Form:\x20SaveAs');},'FormDeleteEvent':function(){TriSysApex['UI']['alert']('Form:\x20Delete');},'doesFieldExistInDOM':function(sFieldID){var element=document['getElementById'](sFieldID);if(typeof element!=TriSysApex['Constants']['Undefined']&&element!=null)return!![];return![];},'bEditingForm':![],'EditMode':function(bEditMode,sMenuTag){$('#dataEntryForm\x20.editable')['editable']('toggleDisabled'),$('#dataEntryFormTabs\x20.editable')['editable']('toggleDisabled'),TriSysApex['Forms']['bEditingForm']=bEditMode,bEditMode?($('#formToolbarMenu_EditModeOn')['hide'](),$('#formToolbarMenu_EditModeOff')['show']()):($('#formToolbarMenu_EditModeOn')['show'](),$('#formToolbarMenu_EditModeOff')['hide']());},'FormDesigner':function(){TriSysApex['UI']['alert']('Form\x20Designer\x20in\x20development.');},'ConfigurationOldMetronic':{'Pages':[{'PageName':'Dashboard.aspx','CaptionIcon':'fa\x20fa-dashboard','CaptionText':'Dashboard','HideMenu':!![]},{'PageName':'Contacts.aspx','CaptionIcon':'fa\x20fa-male','CaptionText':'Contact\x20Lookup'},{'PageName':'Contact.aspx','CaptionIcon':'fa\x20fa-male','CaptionText':'Contact'},{'PageName':'Companies.aspx','CaptionIcon':'fa\x20fa-sitemap','CaptionText':'Company\x20Lookup'},{'PageName':'Company.aspx','CaptionIcon':'fa\x20fa-sitemap','CaptionText':'Company'},{'PageName':'Requirements.aspx','CaptionIcon':'fa\x20fa-ok-sign','CaptionText':'Requirements'},{'PageName':'Requirement.aspx','CaptionIcon':'fa\x20fa-ok-sign','CaptionText':'Requirement'},{'PageName':'Placements.aspx','CaptionIcon':'fa\x20fa-gbp','CaptionText':'Placements'},{'PageName':'Placement.aspx','CaptionIcon':'fa\x20fa-gbp','CaptionText':'Placement'},{'PageName':'TaskSearch.aspx','CaptionIcon':'fa\x20fa-wrench','CaptionText':'Task\x20Search'},{'PageName':'AdministratorConsole.aspx','CaptionIcon':'fa\x20fa-warning-sign','CaptionText':'Administrator\x20Console','HideMenu':!![]},{'PageName':'FileManager.aspx','CaptionIcon':'fa\x20fa-folder-open','CaptionText':'Administrator\x20Console'},{'PageName':'UserOptions.aspx','CaptionIcon':'fa\x20fa-user','CaptionText':'User\x20Options','HideMenu':!![]},{'PageName':'About.aspx','CaptionIcon':'fa\x20fa-tumblr','CaptionText':'About\x20Us','HideMenu':!![]},{'PageName':'WebForm.aspx','CaptionIcon':'fa\x20fa-cloud','CaptionText':'Web\x20Form\x20Placeholder','HideMenu':!![]}],'FormLoading':function(sPage){var iQuestionMarkIndex=sPage['indexOf']('?');if(iQuestionMarkIndex>0x0)sPage=sPage['substring'](0x0,iQuestionMarkIndex);var pages=TriSysApex['Forms']['Configuration']['Pages'];for(var i=0x0;i<pages['length'];i++){var page=pages[i];if(page['ViewName']['toLowerCase']()==sPage['toLowerCase']()){page['CaptionIcon']&&$('#FormIcon')['removeClass']('fa-cog')['addClass'](page['CaptionIcon']);if(page['CaptionText'])$('#FormCaption')['html'](page['CaptionText']);if(page['HideMenu'])$('#FormToolbar')['hide']();}}TriSysApex['Forms']['pushPageOntoFormQueue'](sPage);}},'Lock':{'Enabled':![],'OpenForm':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contact=userCredentials['LoggedInUser']['Contact'];if(contact){var sEMail=contact['WorkEMail'];if(!sEMail){TriSysApex['UI']['ShowMessage']('You\x20must\x20have\x20a\x20work\x20e-mail\x20address\x20in\x20order\x20to\x20lock\x20the\x20application.');return;}}else return;}else return;TriSysSDK['Audio']['PlayAsset']('audio-tag-session-timeout'),TriSysApex['FormsManager']['OpenForm'](TriSysApex['Constants']['LockFormName']);},'CloseAllModalForms':function(){do{TriSysApex['UI']['CloseModalPopup']();}while(TriSysApex['UI']['GetCurrentlyOpenStackedModalDivSuffix']());},'Initialise':function(){TriSysApex['Forms']['Lock']['Enabled']=!![],TriSysApex['Forms']['Lock']['CloseAllModalForms'](),TriSysApex['EntityPreview']['CloseWindow']('Contact'),$('#app-caption-fixed-top')['hide'](),$('#sidebar')['hide'](),$('#unlock-button')['unbind']('click'),$('#unlock-button')['on']('click',TriSysApex['Forms']['Lock']['SubmitButtonClick']);var sFullName=$('#lblLoggedInUserFullName2')['text'](),sCompany=$('#lblLoggedInUserCompanyName')['text'](),sImage=$('#imgLoggedInUserImage2')['attr']('src');$('#loggedin-user-full-name')['text'](sFullName),$('#loggedin-user-company-name')['text'](sCompany),$('#loggedin-user-image')['attr']('src',sImage),$('#lock-password')['val'](''),$('#lock-password')['focus']();var passwordField=$('#lock-password');passwordField['keyup'](function(e){e['keyCode']==0xd&&TriSysApex['Forms']['Lock']['SubmitButtonClick']();}),setTimeout(function(){passwordField['val']('');},0x3e8);TriSysApex['Constants']['WhiteLabelled']&&($('#lock-brand-icon')['attr']('src',TriSysApex['WhiteLabelling']['Overrides']['ProductIcon']),$('#lock-brand-name')['html'](TriSysApex['Copyright']['ShortProductName']),$('#lock-product-name')['html'](TriSysApex['WhiteLabelling']['Overrides']['ProductName']));if(typeof AppStudio!==TriSysApex['Constants']['Undefined'])AppStudio['DesignMode'](![]);},'SubmitButtonClick':function(){var sPassword=$('#lock-password')['val'](),sError=TriSysApex['LoginCredentials']['ValidatePassword'](sPassword);if(sError){var sMessageTitle='Unlock\x20'+TriSysApex['Copyright']['ShortProductName'];TriSysApex['UI']['ShowMessage'](sError,sMessageTitle);return;}var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){contact=userCredentials['LoggedInUser']['Contact'];if(contact){var sEMail=userCredentials['LoggedInUser']['FullName'];TriSysApex['Forms']['Lock']['ValidateCredentials'](sEMail,sPassword);}}},'ValidateCredentials':function(sEMail,sPassword){var dataPacket={'EMail':sEMail,'Password':sPassword},payloadObject={};payloadObject['URL']='Security/VerifyCredentials',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(objCompleted){TriSysApex['UI']['HideWait']();if(objCompleted){if(objCompleted['Success']){ctrlEnableTwoFactorAuthentication['isEnabled'](!![],function(bEnabled,bLocked,bHasAuthenticatedPreviously,sAuthenticatorAppName){if(bEnabled){var options={'Unlock':!![],'AuthenticatorAppName':sAuthenticatorAppName};ctrlEnableTwoFactorAuthentication['PromptForTwoFactorAuthentication'](options,function(bAuthenticated){if(bAuthenticated)TriSysApex['Forms']['Lock']['ValidatedPasswordCallback']();else{var fnFailed2FA=function(){TriSysApex['UI']['ShowMessage']('You\x20must\x20pass\x20the\x202FA\x20check\x20before\x20unlocking\x20this\x20application.');};setTimeout(fnFailed2FA,0xa),TriSysApex['UI']['CloseModalPopup']();}});}else TriSysApex['Forms']['Lock']['ValidatedPasswordCallback']();});return;}}TriSysApex['UI']['ShowMessage']('Invalid\x20password.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Forms.Lock.ValidateCredentials:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Validating\x20password...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ValidatedPasswordCallback':function(){$('#lock-password')['val'](''),TriSysApex['Forms']['Lock']['Enabled']=![],$('#app-caption-fixed-top')['show'](),$('#sidebar')['show'](),TriSysSDK['Audio']['PlayAsset']('audio-tag-session-unlock'),TriSysApex['Upgrade']['_AppJustUnlockedSoPostponeUpgradeCheck']=!![];var bFormURL=TriSysApex['Pages']['Controller']['isFormSpecifiedInURL']();if(bFormURL)TriSysApex['Pages']['Controller']['RefreshFormUsingLocation']();else TriSysApex['Forms']['Dashboard']['OpenForm']();}},'Dashboard':{'OpenForm':function(){TriSysApex['FormsManager']['OpenForm']('Dashboard');},'Load':function(){}},'LinkedIn':{'Show':function(){TriSysApex['FormsManager']['OpenSocialNetworkForm']('LinkedIn');}},'SupportPortal':function(){var sURL='https://support.trisys.co.uk';TriSysSDK['Browser']['OpenURL'](sURL);},'Daxtra':{'ContactMatchToRequirements':function(){TriSysApex['Forms']['Daxtra']['CallWebAPIToGetURL']('match_candidate_to_vacancies',TriSysApex['Pages']['ContactForm']['ContactId'],TriSysSDK['Browser']['OpenURL']);},'ContactMatchToCandidates':function(){TriSysApex['Forms']['Daxtra']['CallWebAPIToGetURL']('match_candidate_to_candidates',TriSysApex['Pages']['ContactForm']['ContactId'],TriSysSDK['Browser']['OpenURL']);},'RequirementMatchCandidates':function(){TriSysApex['Forms']['Daxtra']['CallWebAPIToGetURL']('match_vacancy_to_candidates',TriSysApex['Pages']['RequirementForm']['RequirementId'],TriSysSDK['Browser']['OpenURL']);},'Search':function(){TriSysApex['Forms']['Daxtra']['CallWebAPIToGetURL'](null,null,TriSysSDK['Browser']['OpenURL']);},'CallWebAPIToGetURL':function(sFunction,lEntityId,fnCallback){var sSystemSetting='Daxtra\x20Enabled\x20Search\x20URL',sDaxtraURLPrefix=TriSysApex['Cache']['SystemSettingManager']['GetValue'](sSystemSetting);if(!sDaxtraURLPrefix||sDaxtraURLPrefix==''){TriSysApex['UI']['ShowMessage']('Daxtra\x20is\x20not\x20enabled.');return;}var sDataServicesKey=TriSysAPI['Session']['DataServicesKey'](),userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();lUserId=userCredentials['LoggedInUser']['UserId'];var sArguments='?user_id='+lUserId;if(sFunction)sArguments+='&dxtraction='+sFunction;if(lEntityId)sArguments+='&entity_id='+lEntityId;sArguments+='&token='+sDataServicesKey,TriSysApex['Forms']['Daxtra']['SynchroniseDataServicesKey'](function(){fnCallback(sDaxtraURLPrefix+sArguments);});},'SynchroniseDataServicesKey':function(fnCallback){var payloadObject={};payloadObject['URL']='Housekeeping/SynchroniseDataServicesKey',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(data){if(data['Success']&&fnCallback)fnCallback();},payloadObject['ErrorHandlerFunction']=function(request,status,error){},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}}},'Actions':{'testActionFromGrid':function(sGridDivTag){var sDisplay='',item=TriSysSDK['Grid']['getSelectedGridRowKeys'](sGridDivTag);if(!item)return;for(var i=0x0;i<item['SelectedRows']['length'];i++){var iRowIndex=item['SelectedRows'][i];sDisplay+=iRowIndex+'\x20';}TriSysApex['UI']['alert']('testActionFromGrid:\x20'+sGridDivTag+':\x20'+sDisplay);}},'LoginCredentials':{'isProjectInDevelopment':function(sPasswordID,fnLoginButtonFunction){var bDebuggingMode=!![];if(bDebuggingMode&&(TriSysApex['Environment']['isLocalhost']()||TriSysApex['Environment']['isDeployedInTestMode']()))try{var sPassword=$('#'+sPasswordID)['val']();fnLoginButtonFunction&&(sPassword=TriSysAPI['Session']['Password'](),sPassword&&($('#'+sPasswordID)['val'](sPassword),fnLoginButtonFunction()));}catch(ex){alert('isProjectInDevelopment\x20exception:\x20'+ex['message']);}},'ForgottenPasswordRequest':function(sEMail,callbackFunction){var dataPacket={'EMail':sEMail,'WhiteLabelled':TriSysApex['Constants']['WhiteLabelled'],'URL':TriSysApex['Constants']['URL']},payloadObject={};payloadObject['URL']='Security/ForgottenPasswordRequest',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var objCompleted=data,sDisplay=JSON['stringify'](data);if(objCompleted){if(objCompleted['Success']){TriSysApex['UI']['ShowMessage']('You\x20have\x20been\x20sent\x20an\x20e-mail\x20to:\x20'+sEMail+'\x20with\x20instructions\x20on\x20how\x20to\x20recover/reset\x20your\x20password.','Request/Reset\x20Password',callbackFunction,'OK');return;}else{TriSysApex['UI']['ShowMessage'](objCompleted['ErrorMessage']);return;}}TriSysApex['UI']['ShowMessage']('Unrecognised\x20e-mail\x20address:\x20'+sEMail+TriSysApex['LoginCredentials']['EMailSupportMessageHTML']());},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ForgottenPasswordRequest:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Requesting\x20password\x20reset...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ValidationMessageTitle':'TriSys\x20Login\x20Credentials','Validate':function(validateOptions){var sMessageTitle=TriSysApex['LoginCredentials']['ValidationMessageTitle'];if(!validateOptions['SocialNetworkLoginParameters']){var sError=null,iMinLoginNameChars=0x3,iMinCompanyNameChars=0x3;if(!validateOptions['LoginEMail']||validateOptions['LoginEMail']['length']<iMinLoginNameChars)sError='Login\x20name/e-mail\x20must\x20be\x20at\x20least\x20'+iMinLoginNameChars+'\x20characters.';else{if(!validateOptions['Company']||validateOptions['Company']['length']<iMinCompanyNameChars){var bValidEMail=TriSysApex['LoginCredentials']['validateEmail'](validateOptions['LoginEMail']);if(!bValidEMail)sError='Company\x20name\x20must\x20be\x20at\x20least\x20'+iMinLoginNameChars+'\x20characters.';}else sError=TriSysApex['LoginCredentials']['ValidatePassword'](validateOptions['Password']);}if(!sError){if(!TriSysApex['LoginCredentials']['isDomainAllowed'](validateOptions['LoginEMail']))sError='You\x20are\x20not\x20permitted\x20to\x20login\x20with\x20these\x20credentials.';}if(sError){TriSysApex['UI']['ShowMessage'](sError,sMessageTitle);if(TriSysApex['Device']['PhoneGapEnabled']())TriSysPhoneGap['HideSplashScreen']();return![];}}var CSecurityControllerAuthenticateTriSysCRMCredentials={'FullName':validateOptions['LoginEMail'],'CompanyName':validateOptions['Company'],'Password':validateOptions['Password'],'SocialNetworkLoginParameters':validateOptions['SocialNetworkLoginParameters'],'URL':validateOptions['URL']};if(TriSysApex['Constants']['WhiteLabelled']&&TriSysApex['Constants']['WhiteLabelCustomFolder']){if(!TriSysAPI['Operators']['isEmpty'](TriSysApex['Constants']['WhiteLabelAccountType'])){if(!validateOptions['RecruiterCommandLine'])CSecurityControllerAuthenticateTriSysCRMCredentials['AccountType']=TriSysApex['Constants']['WhiteLabelAccountType'];}else{var TriSysCRMCredentialAccountTypeEnum_Customer=0x7;CSecurityControllerAuthenticateTriSysCRMCredentials['AccountType']=TriSysCRMCredentialAccountTypeEnum_Customer;}CSecurityControllerAuthenticateTriSysCRMCredentials['CustomFolder']=TriSysApex['Constants']['WhiteLabelCustomFolder'];}var fnValidateLogin=function(){TriSysApex['LoginCredentials']['ValidateViaWebService'](CSecurityControllerAuthenticateTriSysCRMCredentials,validateOptions['RememberMe'],validateOptions['AfterRecruiterUserAuthentication']);};return TriSysApex['LoadBalancer']['IdentifyWebAPI'](fnValidateLogin,{'email':CSecurityControllerAuthenticateTriSysCRMCredentials['FullName']}),!![];},'isDomainAllowed':function(sEMail){if(!sEMail)return![];if(sEMail['indexOf']('@')<0x0)return![];var emailParts=sEMail['split']('@'),sEMailDomain=emailParts[0x1];emailParts=sEMailDomain['split']('.'),sEMailDomain=emailParts[0x0]['toLowerCase']();if(TriSysApex['Constants']['TriSysHostedCRM']){var sURL=window['location']['href'],sSitePartsDots=sURL['split']('.');if(sSitePartsDots['length']>0x1){var sSubDomain=sSitePartsDots[0x0]['toLowerCase']();sSubDomain=sSubDomain['replace']('http://',''),sSubDomain=sSubDomain['replace']('https://','');var allowedSubDomains=TriSysApex['Constants']['WhiteLabelAllowedSubDomains'];if(allowedSubDomains['indexOf'](sSubDomain)<0x0){var sCompanySubDomain=sSubDomain;if(sSubDomain=='www'&&TriSysApex['Constants']['WhiteLabelCustomFolder'])sCompanySubDomain=TriSysApex['Constants']['WhiteLabelCustomFolder']['toLowerCase']();var partner=TriSysApex['WhiteLabelling']['Partner'](sCompanySubDomain);if(partner){allowedSubDomains=partner['AllowedSubDomains'];if(!allowedSubDomains)allowedSubDomains=[sCompanySubDomain];if(allowedSubDomains['indexOf'](sEMailDomain)<0x0)return![];}}}}return!![];},'ValidatePassword':function(sPassword){var sError=null;if(!sPassword||sPassword['length']<TriSysApex['Constants']['iMinimumPasswordLength'])sError='Password\x20must\x20be\x20at\x20least\x20'+TriSysApex['Constants']['iMinimumPasswordLength']+'\x20characters.';return sError;},'ValidateViaWebService':function(CSecurityControllerAuthenticateTriSysCRMCredentials,bRememberMe,validateCallbackFunction,sIncorrectMessage,additionalInstructions){if(!TriSysPhoneGap['isConnectedToComms'](!![],'login')){if(TriSysApex['Device']['PhoneGapEnabled']())TriSysPhoneGap['HideSplashScreen']();return![];}var sMessageTitle=TriSysApex['LoginCredentials']['ValidationMessageTitle'],bShowVisuals=!![],fnOnError=null;if(additionalInstructions){if(additionalInstructions['SuppressPopups'])bShowVisuals=![];if(additionalInstructions['IncorrectCredentialsCallback'])fnOnError=additionalInstructions['IncorrectCredentialsCallback'];}CSecurityControllerAuthenticateTriSysCRMCredentials['ApplicationName']=TriSysApex['Constants']['ApplicationName'];var payloadObject={};payloadObject['URL']='Security/Authenticate',payloadObject['OutboundDataPacket']=CSecurityControllerAuthenticateTriSysCRMCredentials,payloadObject['InboundDataFunction']=function(CSecurityControllerAuthenticateResponse){if(bShowVisuals)TriSysApex['UI']['HideWait']();if(CSecurityControllerAuthenticateResponse){if(CSecurityControllerAuthenticateResponse['Success']){var sDataServicesKey=CSecurityControllerAuthenticateResponse['DataServicesKey'];if(CSecurityControllerAuthenticateTriSysCRMCredentials['AccountType'])TriSysApex['Constants']['AccountType']=CSecurityControllerAuthenticateTriSysCRMCredentials['AccountType'];var onPremiseWebAPIRedirection=TriSysApex['LoginCredentials']['ParseOnPremiseWebAPIRedirection'](sDataServicesKey);if(onPremiseWebAPIRedirection){TriSysAPI['Constants']['SecureURL']=onPremiseWebAPIRedirection['URL'],TriSysApex['Constants']['DeveloperSiteKey']=onPremiseWebAPIRedirection['WebAPIKey'],TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']);var fnRedirect=function(){TriSysApex['LoginCredentials']['ValidateViaWebService'](CSecurityControllerAuthenticateTriSysCRMCredentials,bRememberMe,validateCallbackFunction,sIncorrectMessage,additionalInstructions);};setTimeout(fnRedirect,0xa);return;}TriSysAPI['Session']['SetDataServicesKey'](sDataServicesKey);if(bRememberMe)TriSysWeb['Security']['CacheLoginCredentialsAsCookies']();return validateCallbackFunction(sDataServicesKey),!![];}else{if(TriSysApex['Device']['PhoneGapEnabled']())TriSysPhoneGap['HideSplashScreen']();if(TriSysAPI['Operators']['isEmpty'](sIncorrectMessage))sIncorrectMessage='Incorrect\x20login\x20credentials.'+TriSysApex['LoginCredentials']['EMailSupportMessageHTML']();if(sIncorrectMessage&&sIncorrectMessage['indexOf']('##EMail##')>=0x0)sIncorrectMessage=sIncorrectMessage['replace'](/##EMail##/g,TriSysApex['Constants']['SupportEMail']);if(CSecurityControllerAuthenticateResponse['CredentialsCorrectButSomethingElsePreventsLogin'])sIncorrectMessage=CSecurityControllerAuthenticateResponse['ErrorMessage'];if(!fnOnError)TriSysApex['UI']['ShowMessage'](sIncorrectMessage,sMessageTitle);else fnOnError(sIncorrectMessage);return![];}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(bShowVisuals)TriSysApex['UI']['HideWait']();var sError='TriSysApex.LoginCredentials.ValidateViaWebService:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'];if(!fnOnError)TriSysApex['UI']['errorAlert'](sError);else fnOnError(sError);};if(bShowVisuals)TriSysApex['UI']['ShowWait'](null,'Authenticating\x20Credentials...');return TriSysAPI['Data']['PostToWebAPI'](payloadObject),!![];},'ParseOnPremiseWebAPIRedirection':function(sDataServicesKey){if(!sDataServicesKey)return;try{if(sDataServicesKey['indexOf']('WebAPIKey')>0x0&&sDataServicesKey['indexOf']('URL')>0x0){var onPremiseWebAPIRedirection=JSON['parse'](sDataServicesKey);return onPremiseWebAPIRedirection;}}catch(e){}},'ValidateSignUp':function(sFullName,sCompany,sEMail,sTelNo,sStreet,sCity,sCounty,sPostCode,sCountry,sPassword,sVerifyPassword,bAgreeToTermsAndConditions,bAgreeToPrivacyPolicy,bPasswordMandatory){var sError=null,iMinFullNameChars=0x5,iMinCompanyNameChars=0x3;if(!sCompany)sCompany='Unknown';if(!sCountry)sCountry=TriSysSDK['Countries']['DefaultCountryName'];!sCounty&&(sCounty='-');if(!sFullName||sFullName['length']<iMinFullNameChars)sError='Full\x20name\x20must\x20be\x20at\x20least\x20'+iMinFullNameChars+'\x20characters.';else{if(sFullName['indexOf']('\x20')<=0x0)sError='Full\x20name\x20must\x20include\x20a\x20forename\x20and\x20a\x20surname,\x20separated\x20by\x20a\x20space.';else{if(!sCompany||sCompany['length']<iMinCompanyNameChars)sError='Company\x20name\x20must\x20be\x20at\x20least\x20'+iMinCompanyNameChars+'\x20characters.';else{if(!TriSysApex['LoginCredentials']['validateEmail'](sEMail))sError='E-Mail\x20address\x20must\x20be\x20completed.';else{if(!sTelNo)sError='Work\x20Telephone\x20number\x20must\x20be\x20completed.';else{if(!sStreet)sError='Street\x20address\x20is\x20required.';else{if(!sCity)sError='City/Town\x20is\x20required.';else{if(!sCounty)sError='County/State\x20is\x20required.';else{if(!sPostCode)sError='Post/Zip\x20Code\x20is\x20required.';else{if(!sCountry)sError='Country\x20is\x20required.';else{if(bPasswordMandatory&&(!sPassword||sPassword['length']<TriSysApex['Constants']['iMinimumPasswordLength']))sError='Password\x20must\x20be\x20at\x20least\x20'+TriSysApex['Constants']['iMinimumPasswordLength']+'\x20characters.';else{if(bPasswordMandatory&&sPassword!=sVerifyPassword)sError='Passwords\x20must\x20match.';else{if(!bAgreeToTermsAndConditions)sError='You\x20must\x20agree\x20to\x20our\x20terms\x20and\x20conditions.';else{if(!bAgreeToPrivacyPolicy)sError='You\x20must\x20agree\x20to\x20our\x20privacy\x20policy.';}}}}}}}}}}}}}if(sError)return TriSysApex['UI']['ShowMessage'](sError,TriSysApex['Copyright']['ShortProductName']+'\x20Sign-Up'),![];return!![];},'SignUpRequest':function(CNewCustomerSignUpRequest,callbackFunction){var sEMail=CNewCustomerSignUpRequest['EMail'],payloadObject={};payloadObject['URL']='Security/RegisterAccount',payloadObject['OutboundDataPacket']=CNewCustomerSignUpRequest,payloadObject['InboundDataFunction']=function(CNewCustomerSignUpResponse){TriSysApex['UI']['HideWait']();var sDisplay=JSON['stringify'](CNewCustomerSignUpResponse);if(CNewCustomerSignUpResponse){if(CNewCustomerSignUpResponse['Success']){callbackFunction(CNewCustomerSignUpResponse);return;}else{var sError=CNewCustomerSignUpResponse['ErrorMessage'];if(sError&&sError['indexOf']('E-Mail\x20address\x20is\x20already\x20found')>=0x0){TriSysApex['LoginCredentials']['DuplicateEMailAddressOnSignUp'](CNewCustomerSignUpResponse['EMail']);return;}else{TriSysApex['UI']['errorAlert'](CNewCustomerSignUpResponse['ErrorMessage']);return;}}}TriSysApex['UI']['errorAlert'](payloadObject['URL']+'\x20API\x20Error.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.SignUpRequest:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Signing\x20Up.\x20Please\x20wait...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DuplicateEMailAddressOnSignUp':function(sEMail){var fnSendLoginRequest=function(){return TriSysApex['LoginCredentials']['RegisterExistingCustomerForFreeTrial'](sEMail),!![];},sMessage='Your\x20e-mail\x20address\x20'+sEMail+'\x20already\x20exists\x20in\x20our\x20database.'+'<br\x20/>'+'Would\x20you\x20like\x20us\x20to\x20send\x20you\x20an\x20automated\x20e-mail\x20to\x20login?';TriSysApex['UI']['questionYesNo'](sMessage,'Duplicate\x20E-Mail\x20Address','Yes',fnSendLoginRequest,'No');},'RegisterExistingCustomerForFreeTrial':function(sEMail){var CRequestFreeTrialAccountRequest={'EMail':sEMail},payloadObject={};payloadObject['URL']='Security/RequestFreeTrialAccount',payloadObject['OutboundDataPacket']=CRequestFreeTrialAccountRequest,payloadObject['InboundDataFunction']=function(CRequestFreeTrialAccountResponse){TriSysApex['UI']['HideWait']();if(CRequestFreeTrialAccountResponse){if(CRequestFreeTrialAccountResponse['Success']){Registration['PostRegistrationVisuals']();return;}else{TriSysApex['UI']['errorAlert'](CRequestFreeTrialAccountResponse['ErrorMessage']);return;}}TriSysApex['UI']['errorAlert'](payloadObject['URL']+'\x20API\x20Error.');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.LoginCredentials.RegisterExistingCustomerForFreeTrial:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Signing\x20Up.\x20Please\x20wait...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'validateEmail':function(email){var re=/\S+@\S+\.\S+/,bValid=re['test'](email);if(bValid){if(email['indexOf']('\x20')>=0x0)bValid=![];}return bValid;},'ReadLoggedInUserSettings':function(fnOnCompletion,bCache,bNoVisualError){if(TriSysAPI['Operators']['isEmpty'](bCache))bCache=!![];var payloadObject={};payloadObject['URL']='Security/PostLoginCRMCredentials',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(CDataConnectionKey){if(CDataConnectionKey)bCache&&TriSysApex['LoginCredentials']['UserCredentials'](CDataConnectionKey),fnOnCompletion(CDataConnectionKey);else{}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(bNoVisualError){var sError='TriSysApex.LoginCredentials.ReadLoggedInUserSettings:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText'],sSiteKey=TriSysAPI['Cookies']['getCookie']('TriSysBrowserExtension-DeveloperSiteKey'),sDataServicesKey=TriSysAPI['Cookies']['getCookie']('TriSysBrowserExtension-DataServicesKey');sError+='.\x20SiteKey='+sSiteKey+',\x20DataServicesKey='+sDataServicesKey+'.',TriSysApex['ErrorHandling']['SendErrorToWebAPI'](sError);}else TriSysApex['UI']['ErrorHandlerRedirector']('ReadLoggedInUserSettings:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'CacheStandingData':function(CDataConnectionKey,fnOnCompletion){var payloadObject={};payloadObject['URL']='Cache/StandingData',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(CCachedStandingDataWithBOLObjects){if(CCachedStandingDataWithBOLObjects)TriSysApex['Cache']['SetStandingData'](CCachedStandingDataWithBOLObjects),fnOnCompletion(CDataConnectionKey,CCachedStandingDataWithBOLObjects);else{}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('CacheStandingData:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'LogoffWithPrompt':function(){TriSysApex['LoginCredentials']['Logoff'](!![]);},'Logoff':function(bPromptUser,sLoginFormName){var bCustomerCredentialsAreValid=TriSysApex['LoginCredentials']['areCustomerCredentialsValid'](),bUserCredentialsAreValid=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(!bUserCredentialsAreValid&&!bCustomerCredentialsAreValid){if(!TriSysApex['Environment']['RefreshCachedApplication']()){var sMessage=TriSysSDK['Resources']['Message']('TriSysApex.LoginCredentials.Logoff.NotLoggedIn');if(!sLoginFormName)sLoginFormName='Login';TriSysApex['FormsManager']['OpenForm'](sLoginFormName,0x0,![]);return;}}if(!bPromptUser){TriSysApex['LoginCredentials']['ConfirmedLogoff']();return;}var sLogoffMessage=TriSysSDK['Resources']['Message']('TriSysApex.LoginCredentials.Logoff.LogoffMessage');TriSysApex['UI']['questionYesNo'](sLogoffMessage,'Logoff\x20'+TriSysApex['Copyright']['ShortProductName'],'Yes',TriSysApex['LoginCredentials']['ConfirmedLogoff'],'No');},'ConfirmedLogoff':function(){var fnLogoffAfterLogging=function(){if(TriSysApex['SignalR']['Communication']['SocketIO'])TriSysApex['SignalR']['Communication']['SocketIO']['Disconnect']();TriSysApex['EntityPreview']['CloseContactPreviewPopupBrowser'](),TriSysApex['LoginCredentials']['ClearCachedCredentials'](),TriSysApex['Cache']['Clear'](),TriSysApex['Pages']['Index']['PostLoginVisuals'](![]),TriSysApex['Forms']['formQueue']['length']=0x0;var bForceClose=!![];TriSysApex['FormsManager']['CloseAllForms'](bForceClose),TriSysApex['LoginCredentials']['LogoffWebService'](),TriSysApex['Pages']['Index']['ShowAlarms'](![]),TriSysApex['Pages']['Index']['ShowProfileCentreDropDown'](![]),TriSysApex['NavigationBar']['PostLoginEvent'](![],![],![],![]),TriSysWeb['Security']['WritePersistedLoginCredentials'](null),TriSysWeb['Security']['ShowLoginStatus'](![]);var sMessage=TriSysSDK['Resources']['Message']('fnClearKeysAndShowLogin');TriSysApex['Toasters']['Info'](sMessage),$('#divFormContentRow')['attr']('background-color','transparent'),TriSysAPI['Cookies']['Clear'](),TriSysAPI['Session']['Memory']['Clear'](),TriSysFlexiva['Variables']['Unload'](),TriSysFlexiva['LoggingOff'](),TriSysApex['LoginCredentials']['ForceRefresh']();},sURL=window['location']['href'],sApp=TriSysApex['Copyright']['ShortProductName'],fnCreateMessage=function(sIPAddress,sVersion,sEMail){var sMessage='User:\x20'+sEMail+'\x20logged\x20off\x20'+sApp+'\x20version:\x20'+sVersion+'\x20via\x20URL:\x20'+sURL;return setTimeout(fnLogoffAfterLogging,0x1f4),sMessage;};TriSysApex['DebugLogging']['LoggedInUserMessage'](sApp,'Logoff',fnCreateMessage);},'ForceRefresh':function(){var sURL=window['location']['href'],iIndex=sURL['indexOf']('/?');if(iIndex>0x0){sURL=sURL['substring'](0x0,iIndex);if(TriSysApex['Constants']['WhiteLabelled']){if(TriSysApex['Constants']['TriSysHostedCRM']){var lstNonRecruiterSites=[];TriSysApex['Constants']['WhiteLabelAllowedSubDomains']['forEach'](function(sSubDomain){lstNonRecruiterSites['push']('https://'+sSubDomain+'.trisys.co.uk');});var bAppendRecruiter=!![];lstNonRecruiterSites['forEach'](function(s){if(sURL['indexOf'](s)===0x0)bAppendRecruiter=![];});if(bAppendRecruiter)sURL+='/?recruiter';}}window['location']['href']=sURL;return;}var bForceReCacheFromServer=!![];location['reload'](bForceReCacheFromServer);},'LogoffWebService':function(){var fnClearKeysAndShowLogin=function(){TriSysApex['UI']['HideWait'](),TriSysAPI['Session']['SetDataServicesKey']('');};TriSysApex['UI']['ShowWait'](null,'Logging\x20Off...'),TriSysApex['LoginCredentials']['LogoffWebServiceWithCallback'](fnClearKeysAndShowLogin);},'LogoffWebServiceWithCallback':function(fnCallback){var payloadObject={};payloadObject['URL']='Security/Logoff',payloadObject['OutboundDataPacket']=null,payloadObject['InboundDataFunction']=function(data){fnCallback();},payloadObject['ErrorHandlerFunction']=function(request,status,error){fnCallback();},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'UserCredentials':function(optionalSetObject){var sStringifiedJSON=null;if(optionalSetObject)TriSysApex['LoginCredentials']['userCredentialsCache']=optionalSetObject,TriSysApex['DebugLogging']['LoggedIn'](TriSysApex['Copyright']['ShortProductName']);else return TriSysApex['LoginCredentials']['userCredentialsCache'];},'ClearCachedCredentials':function(){TriSysApex['LoginCredentials']['userCredentialsCache']=null;},'userCredentialsCache':null,'areUserCredentialsValid':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials){if(userCredentials['LoggedInUser']){if(userCredentials['LoggedInUser']['UserId']>0x0)return!![];}}return![];},'areCustomerCredentialsValid':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials){if(userCredentials['LoggedInUser']){if(userCredentials['LoggedInUser']['UserId']==0x0&&userCredentials['LoggedInUser']['CRMContact'])return!![];}}return![];},'EMailSupportMessageHTML':function(){var callbackURL='https://www.trisys.co.uk/contact',projectIssueURL='https://support.trisys.co.uk',supportEMail='support@trisys.co.uk',msg='<br\x20/><br\x20/>'+'Please\x20e-mail\x20<a\x20href=\x22mailto:'+supportEMail+'\x22>'+supportEMail+'</a>'+',\x20or\x20<a\x20href=\x22'+projectIssueURL+'\x22\x20target=\x22_blank\x22>log\x20a\x20support\x20issue</a>'+',\x20or\x20<a\x20href=\x22'+callbackURL+'\x22\x20target=\x22_blank\x22>request\x20a\x20callback</a>'+'\x20if\x20you\x20need\x20help\x20connecting\x20to\x20our\x20service.';if(TriSysApex['WhiteLabelling']['Overrides']['EMailSupportMessageHTML'])msg=TriSysApex['WhiteLabelling']['Overrides']['EMailSupportMessageHTML'];return msg;},'isLoggedInToSpecificCompanyAsRecruiter':function(sCRMCompanyName,sOptionalCRMContactFullName){var bMatch=![];if(TriSysApex['LoginCredentials']){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contactCRM=userCredentials['LoggedInUser']['CRMContact'];if(contactCRM){sCompanyName=contactCRM['CompanyName'],sUserFullName=contactCRM['FullName'];if(sCompanyName['toLowerCase']()==sCRMCompanyName['toLowerCase']()){if(sOptionalCRMContactFullName)bMatch=sUserFullName['toLowerCase']()==sOptionalCRMContactFullName['toLowerCase']();else bMatch=!![];}}}}return bMatch;}},'UserOptions':{'RetainFormInMemory':function(){if(TriSysApex['Constants']['TriSysHostedCRM'])return TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',![]),![]);},'SQLTopNRecords':function(){return 0x400;},'DefaultRecordsPerPage':0xa,'RecordsPerPage':function(){var iRecordsPerPage=parseInt(TriSysApex['Cache']['UserSettingManager']['GetValue']('Apex.RecordsPerPage',TriSysApex['UserOptions']['DefaultRecordsPerPage'])),MaximumRecordsPerPage=0x64;if(iRecordsPerPage>MaximumRecordsPerPage)iRecordsPerPage=MaximumRecordsPerPage;return iRecordsPerPage;},'Theme':function(sSetTheme,bWriteToServer){var cookieName=TriSysApex['Constants']['CookieAndUserSetting_Theme'];if(TriSysApex['LoginCredentials']['areUserCredentialsValid']()){if(sSetTheme){if(bWriteToServer)TriSysApex['Cache']['UserSettingManager']['SetValue'](cookieName,sSetTheme);TriSysAPI['Cookies']['setCookie'](cookieName,sSetTheme);}else return TriSysApex['Cache']['UserSettingManager']['GetValue'](cookieName);}else return TriSysAPI['Cookies']['getCookie'](cookieName);},'PageStyle':function(sPageStyle){var cookieName=TriSysApex['Constants']['CookieAndUserSetting_PageStyle'],userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){if(sPageStyle)TriSysApex['Cache']['UserSettingManager']['SetValue'](cookieName,sPageStyle),TriSysAPI['Cookies']['setCookie'](cookieName,sPageStyle);else return TriSysApex['Cache']['UserSettingManager']['GetValue'](cookieName);}else return TriSysAPI['Cookies']['getCookie'](cookieName);},'PhoneDialingVendor':function(){return TriSysApex['Cache']['UserSettingManager']['GetValue']('PhoneDialingVendor');},'GridGrouping':function(){return TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('GridGrouping'));},'GridPosition':function(){return TriSysApex['Cache']['UserSettingManager']['GetValue']('GridPagerPosition','bottom');},'Load':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){if(parseInt(TriSysApex['Cache']['UserSettingManager']['GetValue']('Apex.RecordsPerPage',TriSysApex['UserOptions']['DefaultRecordsPerPage']))<=0x0)TriSysApex['Cache']['UserSettingManager']['SetValue']('Apex.RecordsPerPage',TriSysApex['UserOptions']['DefaultRecordsPerPage']);if(!TriSysApex['Cache']['UserSettingManager']['GetValue']('EMailSendingApplication',null))TriSysApex['Cache']['UserSettingManager']['SetValue']('EMailSendingApplication','Google\x20Mail');TriSysSDK['CShowForm']['SetCheckBoxValue']('load-dashboard-after-login',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('Dashboard',!![]))),TriSysSDK['CShowForm']['SetCheckBoxValue']('retain-form-in-memory',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',!![]))),TriSysSDK['CShowForm']['SetCheckBoxValue']('append-recordid-to-caption',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('AppendRecordIdToCaption',![]))),TriSysSDK['CShowForm']['SetCheckBoxValue']('popup-task-alarm-notifications',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('PopupTaskAlarms',![]))),TriSysSDK['CShowForm']['SetCheckBoxValue']('tour-guide-reminder',!TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('TourGuideOffAfterLogin',![]))),TriSysSDK['CShowForm']['SetCheckBoxValue']('ai-chatbot-show',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('ShowAIChatbot',![])));var bAutomaticLogin=TriSysWeb['Security']['AreLoginCredentialsPersisted']();TriSysSDK['CShowForm']['SetCheckBoxValue']('automatic-login',bAutomaticLogin);if(!bAutomaticLogin)$('#automatic-login')['attr']('disabled','disabled');TriSysSDK['CShowForm']['SetCheckBoxValue']('limit-grid-rows',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('LimitGridRows',!![]))),$('#limit-grid-row-count')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('MaxGridRows',0xa))['trigger']('change'),$('#records-per-page')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('Apex.RecordsPerPage',TriSysApex['UserOptions']['DefaultRecordsPerPage']))['trigger']('change'),TriSysSDK['CShowForm']['SetCheckBoxValue']('grid-grouping',TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('GridGrouping',![]))),TriSysSDK['CShowForm']['SetValueInCombo']('grid-pager-position',TriSysApex['Cache']['UserSettingManager']['GetValue']('GridPagerPosition','bottom')),$('#email-sending-application')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('EMailSendingApplication',null))['trigger']('change'),$('#smtp-server-address')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('SMTPServerAddress',null)),$('#smtp-server-login')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('SMTPServerLogin',null)),$('#smtp-server-password')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('SMTPServerPassword',null));var mailSync=TriSysApex['Cache']['UserSettingManager']['GetValue']('MailSync'),bMailSyncEnabled=![];if(mailSync){mailSync=JSON['parse'](mailSync),bMailSyncEnabled=mailSync['Enabled'],TriSysSDK['CShowForm']['SetIndexInCombo']('email-service-provider',mailSync['SyncType']-0x1),$('#sync-services-email-server')['val'](mailSync['MailServer']),$('#sync-services-email-login')['val'](mailSync['Username']),$('#sync-services-email-password')['val'](mailSync['Password']),TriSysSDK['CShowForm']['setDateTimePickerValue']('sync-services-StartDateTime',mailSync['ExportChangesAfter']),TriSysSDK['Controls']['NumericSpinner']['SetValue']('sync-services-diary-weeks',mailSync['AppointmentSyncWindow']),TriSysSDK['CShowForm']['SetTextInCombo']('sync-services-timezone',mailSync['TimeZoneDisplayName']),TriSysSDK['CShowForm']['SetCheckBoxValue']('enabled-sync-email',mailSync['SyncEMail']),TriSysSDK['CShowForm']['SetCheckBoxValue']('enabled-sync-diary',mailSync['SyncAppointment']),$('#enabled-sync-last-status')['html'](mailSync['LastResult']);var bAllowDiarySync=mailSync['SyncType']==0x1,elemDiaryRow=$('#synch-services-row6');bAllowDiarySync?elemDiaryRow['show']():elemDiaryRow['hide']();}TriSysSDK['CShowForm']['SetCheckBoxValue']('enabled-sync-services',bMailSyncEnabled),ctrlUserOptions['EnableSyncCheckBoxClick'](null,'enabled-sync-services'),$('#phone-dialing-vendor')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('PhoneDialingVendor',null))['trigger']('change'),$('#requirement-prefix')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RequirementReferencePrefix',null)),$('#placement-prefix')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('PlacementReferencePrefix',null)),$('#iprofile-username')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('iProfile_Username',null)),$('#iprofile-recruiter-email')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('iProfile_RecruiterEMail',null)),$('#iprofile-password')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('iProfile_Password',null)),$('#broadbean-login-name')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanLoginName',null)),$('#broadbean-password')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('BroadbeanPassword',null)),$('#logicmelon-username')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonLoginName',null)),$('#logicmelon-password')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('LogicMelonPassword',null)),$('#buffer-email')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('BufferEMail',null)),$('#twitter-url')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('TwitterURL',null)),$('#facebook-url')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('FacebookURL',null)),$('#linkedin-url')['val'](TriSysApex['Cache']['UserSettingManager']['GetValue']('LinkedInURL',null));var bRecruitmentDatabase=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RecruitmentDatabase',![]));!bRecruitmentDatabase&&($('#useroptions-form-tab-recruitment-defaults')['hide'](),$('#useroptions-form-tab-job-posting')['hide']());}$('#load-dashboard-after-login')['click'](function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('Dashboard',$(this)['is'](':checked'));}),$('#retain-form-in-memory')['click'](function(){var bRetainFormInMemory=$(this)['is'](':checked');TriSysApex['Cache']['UserSettingManager']['SetValue']('RetainFormInMemory',bRetainFormInMemory);if(!bRetainFormInMemory)TriSysApex['FormsManager']['CloseAllOpenFormsExceptCurrent']();}),$('#append-recordid-to-caption')['click'](function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('AppendRecordIdToCaption',$(this)['is'](':checked'));}),$('#popup-task-alarm-notifications')['click'](function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('PopupTaskAlarms',$(this)['is'](':checked'));}),$('#tour-guide-reminder')['click'](function(){var bTourGuideReminderOn=$(this)['is'](':checked');TriSysApex['Cache']['UserSettingManager']['SetValue']('TourGuideOffAfterLogin',!bTourGuideReminderOn);}),$('#ai-chatbot-show')['click'](function(){var bShowAIChatbot=$(this)['is'](':checked');TriSysApex['Cache']['UserSettingManager']['SetValue']('ShowAIChatbot',bShowAIChatbot),TriSysApex['AI']['ChatBOT']['Show'](bShowAIChatbot);}),$('#automatic-login')['click'](function(){var sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Automatic\x20Login',sMessage='Are\x20you\x20sure\x20that\x20your\x20login\x20credentials\x20should\x20be\x20',sDevice='\x20on\x20this\x20device\x20',bAutomaticLogin=$(this)['is'](':checked'),fnYes=null,fnNo=function(){return TriSysSDK['CShowForm']['SetCheckBoxValue']('automatic-login',!bAutomaticLogin),!![];};if(bAutomaticLogin)return;else sMessage+='removed'+sDevice+'\x20preventing\x20automatic\x20login?'+'<br\x20/>You\x20will\x20not\x20be\x20able\x20to\x20persist\x20these\x20credentials\x20again\x20until\x20next\x20time\x20you\x20login.',fnYes=function(){TriSysWeb['Security']['WritePersistedLoginCredentials'](null),$('#automatic-login')['attr']('disabled','disabled');};TriSysApex['UI']['questionYesNo'](sMessage,sTitle,'Yes',fnYes,'No',fnNo);}),$('#limit-grid-rows')['click'](function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('LimitGridRows',$(this)['is'](':checked'));}),$('#limit-grid-row-count')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('MaxGridRows',this['value']);}),$('#records-per-page')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('Apex.RecordsPerPage',this['value']);}),$('#grid-grouping')['click'](function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('GridGrouping',$(this)['is'](':checked'));}),$('#grid-pager-position')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('GridPagerPosition',this['value']);}),$('#email-sending-application')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('EMailSendingApplication',this['value']);}),$('#smtp-server-address')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('SMTPServerAddress',$(this)['val']());}),$('#smtp-server-login')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('SMTPServerLogin',$(this)['val']());}),$('#smtp-server-password')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('SMTPServerPassword',$(this)['val']());}),$('#phone-dialing-vendor')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('PhoneDialingVendor',this['value']);}),$('#requirement-prefix')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('RequirementReferencePrefix',$(this)['val']());}),$('#placement-prefix')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('PlacementReferencePrefix',$(this)['val']());}),$('#iprofile-username')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('iProfile_Username',$(this)['val']());}),$('#iprofile-recruiter-email')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('iProfile_RecruiterEMail',$(this)['val']());}),$('#iprofile-password')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('iProfile_Password',$(this)['val']());}),$('#broadbean-login-name')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('BroadbeanLoginName',$(this)['val']());}),$('#broadbean-password')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('BroadbeanPassword',$(this)['val']());}),$('#logicmelon-username')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('LogicMelonLoginName',$(this)['val']());}),$('#logicmelon-password')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('LogicMelonPassword',$(this)['val']());}),$('#buffer-email')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('BufferEMail',$(this)['val']());}),$('#twitter-url')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('TwitterURL',$(this)['val']());}),$('#facebook-url')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('FacebookURL',$(this)['val']());}),$('#linkedin-url')['change'](function(e){TriSysApex['Cache']['UserSettingManager']['SetValue']('LinkedInURL',$(this)['val']());});},'ReadLoggedInUserSetting':function(sFieldName,fnCallbackRegardless,bSynchronous){var CReadUsrCfgSettingRequest={'Name':sFieldName},setting=null,payloadObject={};payloadObject['URL']='User/ReadUsrCfgSetting',payloadObject['OutboundDataPacket']=CReadUsrCfgSettingRequest,payloadObject['InboundDataFunction']=function(CReadUsrCfgSettingResponse){if(CReadUsrCfgSettingResponse){if(CReadUsrCfgSettingResponse['Success'])setting=CReadUsrCfgSettingResponse['Setting'];}if(fnCallbackRegardless)fnCallbackRegardless(setting);},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(fnCallbackRegardless)fnCallbackRegardless(setting);};if(bSynchronous)payloadObject['Asynchronous']=![];TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'WriteSetting':function(lUserId,item,objValue){!lUserId&&(lUserId=0x0);var CWriteUserSettingsRequest={'UserId':lUserId,'Setting':{'Category':item['Category'],'Name':item['Name']?item['Name']:item['FName'],'Value':objValue,'FType':item['FType']}},payloadObject={};payloadObject['URL']='User/WriteSetting',payloadObject['OutboundDataPacket']=CWriteUserSettingsRequest,payloadObject['InboundDataFunction']=function(CWriteUserSettingsResponse){if(CWriteUserSettingsResponse){if(CWriteUserSettingsResponse['Success']){if(CWriteUserSettingsResponse['LoggedInUserSetting'])TriSysApex['Cache']['ApplicationSettingsManager']['OverwiteSetting'](CWriteUserSettingsResponse['LoggedInUserSetting']);}else TriSysApex['UI']['ShowError'](CWriteUserSettingsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.UserOptions.WriteSetting:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteSetting':function(lUserId,securityItem){var CDeleteUserSettingsRequest={'UserId':lUserId,'Prefix':securityItem['Prefix']},payloadObject={};payloadObject['URL']='User/DeleteSettings',payloadObject['OutboundDataPacket']=CDeleteUserSettingsRequest,payloadObject['InboundDataFunction']=function(CDeleteUserSettingsResponse){},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.UserOptions.DeleteSetting:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'MaskPublicResourcePath':function(sResource){var trisysglobaldotcom='.trisysglobal.com';if(sResource){sResource=sResource['replace'](trisysglobaldotcom,'');if(sResource)sResource=sResource['replace']('\x5c\x5c','');}return sResource;},'SystemSettings':function(fnCallback){var sVersion=null,sIPAddress=null,fnAfterVersionGetIPAddress=function(s){sVersion=s,TriSysAPI['Data']['IPAddress'](!![],null,function(s){sIPAddress=s,fnGatherAll();});};TriSysAPI['Data']['Version'](fnAfterVersionGetIPAddress);var fnPart=TriSysApex['UserOptions']['SystemSettingTablePart'],bShowUserCredentials=!![],fnGatherAll=function(){var sText='<table\x20style=\x22width:100%;\x20line-height:\x2020px;\x22\x20border=\x220\x22>'+fnPart(!![],TriSysApex['Constants']['ApplicationName']+'\x20Version')+fnPart(![],TriSysApex['Application']['Version']())+fnPart(!![],'Web\x20API\x20Version')+fnPart(![],sVersion)+fnPart(!![],'IP\x20Address')+fnPart(![],sIPAddress)+fnPart(!![],'Application\x20URL')+fnPart(![],window['location']['href'])+fnPart(!![],'Browser\x20Engine')+fnPart(![],TriSysSDK['Browser']['Version']())+fnPart(!![],'Browser\x20Name')+fnPart(![],TriSysSDK['Browser']['Detection']['getBrowserName']())+fnPart(!![],'Height')+fnPart(![],document['body']['offsetHeight'])+fnPart(!![],'Width')+fnPart(![],document['body']['offsetWidth'])+fnPart(!![],'Device\x20Type')+fnPart(![],TriSysApex['Device']['Description']());TriSysApex['Device']['PhoneGapEnabled']()&&(sText+=fnPart(!![],'<hr\x20/>')+fnPart(!![],'Device\x20Model')+fnPart(![],TriSysPhoneGap['Model']())+fnPart(!![],'Device\x20Platform')+fnPart(![],TriSysPhoneGap['Platform']())+fnPart(!![],'Device\x20Version')+fnPart(![],TriSysPhoneGap['Version']())+fnPart(!![],'Device\x20Manufacturer')+fnPart(![],TriSysPhoneGap['Manufacturer']())+fnPart(![],'<hr\x20/>'));var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var sSQLServer=TriSysApex['UserOptions']['MaskPublicResourcePath'](userCredentials['SQLServer']),sNAS=TriSysApex['UserOptions']['MaskPublicResourcePath'](userCredentials['GDrivePath']),sSQLServerVersion=userCredentials['SQLServerVersion'],sSQLServerName=userCredentials['SQLServerName'];sText+=fnPart(!![],'SQL\x20Server')+fnPart(![],sSQLServer)+fnPart(!![],'SQL\x20Server\x20Name')+fnPart(![],sSQLServerName)+fnPart(!![],'SQL\x20Server\x20Version')+fnPart(![],sSQLServerVersion)+fnPart(!![],'Database')+fnPart(![],userCredentials['Database'])+fnPart(!![],'G:\x5c\x20Drive\x20Path')+fnPart(![],sNAS)+fnPart(!![],'Web\x20API\x20Endpoint')+fnPart(![],TriSysAPI['Constants']['SecureURL']);if(TriSysApex['SignalR']['Communication']['SocketIO'])sText+=fnPart(!![],'Socket.IO\x20Hub')+fnPart(![],TriSysApex['SignalR']['Communication']['SocketIO']['ServerURL'],null);sText+=fnPart(!![],'SignalR\x20Handle')+fnPart(![],TriSysApex['SignalR']['Communication']['FullLoggedInSenderAndRecipientAddress']());var bInDev=TriSysApex['Pages']['Controller']['isDeveloper']()||TriSysApex['Environment']['isDeployedInTestMode']();if(bInDev){sText+=fnPart(!![],'DeveloperSiteKey')+fnPart(![],TriSysAPI['Session']['DeveloperSiteKey']())+fnPart(!![],'DataServicesKey')+fnPart(![],TriSysAPI['Session']['DataServicesKey']())+fnPart(!![],'WhiteLabelled')+fnPart(![],TriSysApex['Constants']['WhiteLabelled'])+fnPart(!![],'WhiteLabelCustomFolder')+fnPart(![],TriSysApex['Constants']['WhiteLabelCustomFolder']);var sCustomForms='';TriSysApex['CustomFormsAndComponents']['debugCustomFormList'](function(sForm){sCustomForms+=sForm;}),sText+=fnPart(!![],'CustomForms')+fnPart(![],sCustomForms);}sText+=fnPart(!![],'<hr\x20/>')+fnPart(![],'<hr\x20/>');const sAccountType=TriSysApex['Constants']['AccountType']+':\x20'+TriSysApex['AccountTypes']['LoginTypeDescription'](TriSysApex['Constants']['AccountType']),sApplicationName=TriSysApex['Constants']['_Data']['CDataConnectionKey']['ApplicationName'];sText+=fnPart(!![],'Account\x20Type')+fnPart(![],sAccountType)+fnPart(!![],'Application\x20Name')+fnPart(![],sApplicationName),sText+=fnPart(!![],'<hr\x20/>')+fnPart(![],'<hr\x20/>'),sText+=fnPart(!![],'User\x20Id')+fnPart(![],userCredentials['LoggedInUser']['UserId'])+fnPart(!![],'TriSys\x20Login\x20Name')+fnPart(![],userCredentials['LoggedInUser']['LoginName'])+fnPart(!![],'Apex\x20E-Mail\x20Login')+fnPart(![],userCredentials['LoggedInUser']['FullName'])+fnPart(!![],'Forename/Surname')+fnPart(![],userCredentials['LoggedInUser']['ForenameAndSurname']);var contact=null,contactCRM=null;bShowUserCredentials?(contact=userCredentials['LoggedInUser']['Contact'],contactCRM=userCredentials['LoggedInUser']['CRMContact']):contact=clientOrCandidateDataConnectionKey['LoggedInAgencyContact'],contact&&(sText+=fnPart(!![],'<hr\x20/>')+fnPart(![],'<hr\x20/>'),sText+=fnPart(!![],'ContactId')+fnPart(![],contact['ContactId'])+fnPart(!![],'FullName')+fnPart(![],contact['FullName'])+fnPart(!![],'Forenames')+fnPart(![],contact['Forenames'])+fnPart(!![],'Surname')+fnPart(![],contact['Surname'])+fnPart(!![],'CompanyId')+fnPart(![],contact['CompanyId'])+fnPart(!![],'CompanyName')+fnPart(![],contact['CompanyName'])+fnPart(!![],'CompanyAddressStreet')+fnPart(![],contact['CompanyAddressStreet'])+fnPart(!![],'CompanyAddressCity')+fnPart(![],contact['CompanyAddressCity'])+fnPart(!![],'Title')+fnPart(![],contact['Title'])+fnPart(!![],'WorkTelNo')+fnPart(![],contact['WorkTelNo'])+fnPart(!![],'MobileTelNo')+fnPart(![],contact['MobileTelNo'])+fnPart(!![],'JobTitle')+fnPart(![],contact['JobTitle'])+fnPart(!![],'ContactType')+fnPart(![],contact['ContactType'])+fnPart(!![],'Priority')+fnPart(![],contact['Priority'])+fnPart(!![],'HomeAddressStreet')+fnPart(![],contact['HomeAddressStreet'])+fnPart(!![],'HomeAddressCity')+fnPart(![],contact['HomeAddressCity'])+fnPart(!![],'HomeAddressTelNo')+fnPart(![],contact['HomeAddressTelNo'])+fnPart(!![],'WorkEMail')+fnPart(![],contact['WorkEMail'])+fnPart(!![],'PersonalEMail')+fnPart(![],contact['PersonalEMail'])+fnPart(!![],'ContactPhoto')+fnPart(![],contact['ContactPhoto'])),contactCRM&&(sText+=fnPart(!![],'<hr\x20/>')+fnPart(![],'<hr\x20/>'),sText+=fnPart(!![],'CRM\x20ContactId')+fnPart(![],contactCRM['ContactId'])+fnPart(!![],'CRM\x20FullName')+fnPart(![],contactCRM['FullName'])+fnPart(!![],'CRM\x20Forenames')+fnPart(![],contactCRM['Forenames'])+fnPart(!![],'CRM\x20Surname')+fnPart(![],contactCRM['Surname'])+fnPart(!![],'CRM\x20CompanyName')+fnPart(![],contactCRM['CompanyName'],'crm-company-name')+fnPart(!![],'CRM\x20CompanyAddressStreet')+fnPart(![],contactCRM['CompanyAddressStreet'])+fnPart(!![],'CRM\x20CompanyAddressCity')+fnPart(![],contactCRM['CompanyAddressCity'])+fnPart(!![],'CRM\x20Title')+fnPart(![],contactCRM['Title'])+fnPart(!![],'CRM\x20WorkTelNo')+fnPart(![],contactCRM['WorkTelNo'])+fnPart(!![],'CRM\x20WorkMobileTelNo')+fnPart(![],contactCRM['WorkMobileTelNo'])+fnPart(!![],'CRM\x20JobTitle')+fnPart(![],contactCRM['JobTitle'])+fnPart(!![],'CRM\x20WorkEMail')+fnPart(![],contactCRM['WorkEMail']),contactCRM['Subscriber']&&(sText+=fnPart(!![],'CRM\x20ASP\x20User\x20Type')+fnPart(![],contactCRM['Subscriber']['ASPUserType'])+fnPart(!![],'CRM\x20ASP\x20Db\x20Name')+fnPart(![],contactCRM['Subscriber']['ASPdbName'])));}sText+='</table>',fnCallback(sText);};},'SystemSettingTablePart':function(bLabel,sValue,sValueSpanTagID,sHyperlinkFunction){var sTableText='';if(bLabel)sTableText='<tr><td\x20style=\x22width:175px;\x20vertical-align:\x20top;\x22>'+sValue+'</td>';else{var sPreValue='',sPostValue='';sValueSpanTagID&&(sPreValue='<span\x20id=\x22'+sValueSpanTagID+'\x22>',sPostValue='</span>'),sHyperlinkFunction&&(sPreValue+='<a\x20style=\x22cursor:\x20pointer;\x22\x20onclick=\x22'+sHyperlinkFunction+'\x22>',sPostValue='</a>'+sPostValue),sTableText='<td\x20style=\x22vertical-align:\x20top;\x22>'+sPreValue+(sValue!==null?sValue:'')+sPostValue+'</td></tr>';}return sTableText;},'OpenLoggedInUserContactRecord':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var bWebJobsMode=!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID'];if(bWebJobsMode)return;var contact=userCredentials['LoggedInUser']['Contact'];if(contact)TriSysApex['FormsManager']['OpenForm']('Contact',contact['ContactId']);else{var contactCRM=userCredentials['LoggedInUser']['CRMContact'];if(contactCRM){var sView='EditProfile';TriSysApex['FormsManager']['OpenCustomFileInContentRegion'](sView+'.html',sView);}}}},'SynchroniseOptions':function(){var sMessage='Please\x20contact\x20our\x20support\x20department\x20to\x20arrange\x20for\x20diary\x20and\x20e-mail\x20synchronisation.';TriSysApex['UI']['ShowMessage'](sMessage);},'OpenLoggedInUserCompanyRecord':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contact=userCredentials['LoggedInUser']['Contact'];if(contact)TriSysApex['FormsManager']['OpenForm']('Company',contact['CompanyId']);else{var contactCRM=userCredentials['LoggedInUser']['CRMContact'];if(contactCRM)TriSysApex['UserOptions']['OpenLoggedInUserContactRecord']();}}},'ShowForm':function(){if(TriSysApex['LoginCredentials']['areCustomerCredentialsValid']())TriSysApex['UserOptions']['OpenLoggedInUserContactRecord']();else TriSysApex['FormsManager']['OpenForm']('UserOptions');}},'Environment':{'ensureHTTPSinProduction':function(){if(TriSysApex['Environment']['isDeployedInProduction']()){if(location['protocol']['toLowerCase']()!=='https:'){var sSecureURL='https://'+window['location']['href']['substring'](window['location']['protocol']['length'],window['location']['href']['length']);return window['location']['replace'](sSecureURL),![];}}return!![];},'isLocalhost':function(){var sThisURL=window['location']['href'];return sThisURL['indexOf']('http://localhost')==0x0;},'isDeployedInTestMode':function(){var sThisURL=window['location']['href'];if(sThisURL){sThisURL=sThisURL['toLowerCase']();var bOEM=![];try{TriSysLoad['ApexFramework']['Constants']['OEMTestURLList']['forEach'](function(sURLPart){var bFound=sThisURL['indexOf'](sURLPart)>=0x0;if(bFound)bOEM=!![];});}catch(e){}return bOEM;}},'isDeployedInProduction':function(){var sThisURL=window['location']['href']['toLowerCase']();return sThisURL['indexOf']('https://')==0x0;},'RefreshCachedApplication':function(){var bRefresh=TriSysApex['Upgrade']['UpgradePending']();if(bRefresh){var bForceReCacheFromServer=!![];location['reload'](bForceReCacheFromServer);}return bRefresh;},'isChromeStandaloneApp':function(){var bInChromeAppMode=![],elem=$('#TriSys-Chrome-App');if(elem&&elem['length']>0x0)bInChromeAppMode=!![];return bInChromeAppMode;},'isWindowsStoreApp':function(){if(typeof Windows!==TriSysApex['Constants']['Undefined']&&typeof Windows['UI']!==TriSysApex['Constants']['Undefined']&&typeof Windows['UI']['Notifications']!==TriSysApex['Constants']['Undefined'])return!![];},'WindowsStoreApp':function(){if(typeof Windows!==TriSysApex['Constants']['Undefined']&&typeof Windows['UI']!==TriSysApex['Constants']['Undefined']&&typeof Windows['UI']['Notifications']!==TriSysApex['Constants']['Undefined']){var bInDev=TriSysApex['Pages']['Controller']['isDeveloper']();if(bInDev)TriSysApex['Toasters']['Info']('Windows\x20Store\x20App');var head=document['getElementsByTagName']('head')[0x0],script=document['createElement']('script');script['type']='text/javascript',script['src']='/javascript/base.min.js',script['onload']=function(){if(bInDev)TriSysApex['Toasters']['Info']('script.onload');var app=WinJS['Application'],activation=Windows['ApplicationModel']['Activation'],ViewManagement=Windows['UI']['ViewManagement'],ApplicationViewWindowingMode=ViewManagement['ApplicationViewWindowingMode'],ApplicationView=ViewManagement['ApplicationView'];app['onactivated']=function(args){if(bInDev)TriSysApex['Toasters']['Info']('app.onactivated');args['detail']['kind']===activation['ActivationKind']['launch']&&(args['setPromise'](WinJS['UI']['processAll']()),ApplicationView['preferredLaunchWindowingMode']=ApplicationViewWindowingMode['fullScreen']);};if(bInDev)TriSysApex['Toasters']['Info']('app.start');app['start']();var fnDelay=function(){if(bInDev)TriSysApex['Toasters']['Info']('fnDelay');if(bInDev)TriSysApex['Toasters']['Info']('args.detail.kind\x20===\x20activation.ActivationKind.launch');ApplicationView['preferredLaunchWindowingMode']=ApplicationViewWindowingMode['fullScreen'];};setTimeout(fnDelay,0x3e8);},head['appendChild'](script);}},'isDebuggerEnabled':function(){var startTime=new Date(),endTime=new Date();return endTime-startTime>0x64;},'doesFileExist':function(sFileURL){var bFoundFile=![],s404='-\x20404</title>';return $['ajax']({'cache':![],'async':![],'url':sFileURL,'success':function(data){if(data){bFoundFile=!![];if(typeof data==='string'){if(data['indexOf'](s404)>=0x0)bFoundFile=![];}}},'error':function(data){}}),bFoundFile;}},'Cache':{'cookieName':'CachedStandingData','cachedStandingDataInMemory':null,'isCached':function(){var standingData=TriSysApex['Cache']['GetStandingData'](),bStandingDataExists=!TriSysAPI['Operators']['isEmpty'](standingData);return bStandingDataExists;},'Clear':function(){TriSysApex['Cache']['cachedStandingDataInMemory']=null,TriSysApex['Cache']['populateFormFieldDescriptions']=null;},'SetStandingData':function(setObject){TriSysApex['Cache']['cachedStandingDataInMemory']=setObject,TriSysSDK['CShowForm']['CustomFieldsTab']['Data']['Initialise'](setObject['CustomTabFields']);},'GetStandingData':function(){if(TriSysApex['Cache']['cachedStandingDataInMemory'])return TriSysApex['Cache']['cachedStandingDataInMemory'];},'UserSettings':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['UserSettings'];},'Users':function(bNotLocked){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData){var lstUser=standingData['Users'];if(bNotLocked){var lst=[];$['each'](lstUser,function(index,user){var bAddToList=!user['Locked'];if(bAddToList)lst['push'](user);}),lstUser=lst;}return lstUser;}},'UserGroups':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['UserGroups'];},'Skills':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['Skills'];},'SystemSettings':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['SystemSettings'];},'EntityTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['EntityTypes'];},'JobTitles':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['JobTitles'];},'ContactTitles':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['ContactTitles'];},'Currencies':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['Currencies'];},'ConsultancyPeriods':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['ConsultancyPeriods'];},'ContactPriorities':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['ContactPriorities'];},'Industries':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['Industries'];},'AddressTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['AddressTypes'];},'FieldDescriptions':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['FieldDescriptions'];},'FieldTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['FieldTypes'];},'TaskTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['TaskTypes'];},'SkillCategories':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['SkillCategories'];},'CompanyRelationshipTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['CompanyRelationshipTypes'];},'ContactRelationshipTypes':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['ContactRelationshipTypes'];},'InternationalTimeZones':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['InternationalTimeZones'];},'populateFormFieldDescriptions':null,'UserSettingManager':{'GetValue':function(sUserSetting,objDefault){var userSettings=TriSysApex['Cache']['UserSettings']();if(userSettings){var foundUserSettingValue=null,bFound=![];userSettings['forEach'](function(userSetting){userSetting['FName']==sUserSetting&&(foundUserSettingValue=userSetting['FValue'],bFound=!![]);});if(bFound)return foundUserSettingValue;}return objDefault;},'GetValueBoolean':function(sUserSetting,bDefault){var bValue=TriSysApex['Cache']['UserSettingManager']['GetValue'](sUserSetting,bDefault);return TriSysAPI['Operators']['stringToBoolean'](bValue,![]);},'SetValue':function(sUserSetting,objValue,sFType){var userSettings=TriSysApex['Cache']['UserSettings']();if(userSettings){var foundUserSetting=null;userSettings['forEach'](function(userSetting){userSetting['FName']==sUserSetting&&(userSetting['FValue']=objValue,foundUserSetting=userSetting);});if(!foundUserSetting){if(!sFType)sFType='S';foundUserSetting={'FName':sUserSetting,'FType':sFType,'FValue':objValue,'Persistable':!![]},userSettings['push'](foundUserSetting);}TriSysApex['UserOptions']['WriteSetting'](0x0,foundUserSetting,objValue);}},'SetValueBoolean':function(sUserSetting,objValue){TriSysApex['Cache']['UserSettingManager']['SetValue'](sUserSetting,objValue,'B');}},'SystemSettingManager':{'Set':function(recachedSettings){TriSysApex['Cache']['cachedStandingDataInMemory']['SystemSettings']=recachedSettings;},'GetValue':function(sSystemSetting,objDefault){var systemSettings=TriSysApex['Cache']['SystemSettings']();if(systemSettings)for(var i=0x0;i<systemSettings['length'];i++){var systemSetting=systemSettings[i];if(systemSetting['Name']==sSystemSetting)return systemSetting['Value'];}return objDefault;},'SetValue':function(sSystemSetting,sValue){var systemSettings=TriSysApex['Cache']['SystemSettings']();if(systemSettings)for(var i=0x0;i<systemSettings['length'];i++){var systemSetting=systemSettings[i];if(systemSetting['Name']==sSystemSetting){systemSetting['Value']=sValue;var CUpdateSystemSettingRequest={'SystemSetting':systemSetting},payloadObject={};payloadObject['URL']='SystemSetting/Update',payloadObject['OutboundDataPacket']=CUpdateSystemSettingRequest,payloadObject['InboundDataFunction']=function(CUpdateSystemSettingResponse){if(CUpdateSystemSettingResponse){if(CUpdateSystemSettingResponse['Success'])return;else TriSysApex['UI']['ShowMessage'](CUpdateSkillResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('TriSysApex.Cache.SystemSettingManager.SetValue:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);return;}}},'Get':function(lSystemSettingId){var systemSettings=TriSysApex['Cache']['SystemSettings']();if(systemSettings)for(var i=0x0;i<systemSettings['length'];i++){var systemSetting=systemSettings[i];if(systemSetting['SystemSettingId']==lSystemSettingId)return systemSetting;}},'isDuplicate':function(systemSetting){var systemSettings=TriSysApex['Cache']['SystemSettings']();if(systemSettings)for(var i=0x0;i<systemSettings['length'];i++){var existingSystemSetting=systemSettings[i];if(existingSystemSetting['Name']==systemSetting['Name']&&existingSystemSetting['SystemSettingId']!=systemSetting['SystemSettingId'])return!![];}return![];},'GeneralSkillCategories':function(){var sSystemSetting='Ignore\x20General\x20Skill\x20Categories',sCategoriesToIgnore=TriSysApex['Cache']['SystemSettingManager']['GetValue'](sSystemSetting),sIgnoreHardCoded='Gender';if(!sCategoriesToIgnore)sCategoriesToIgnore=sIgnoreHardCoded;else sCategoriesToIgnore+=','+sIgnoreHardCoded;var generalCategories=[],arrayIgnoreCategories=sCategoriesToIgnore['split'](','),trimmedIgnoreCategories=[];$['each'](arrayIgnoreCategories,function(index,sIgnore){sIgnore=sIgnore['trim'](),trimmedIgnoreCategories['push'](sIgnore);});var categories=TriSysApex['Cache']['SkillCategories']();for(var i=0x0;i<categories['length'];i++){var category=categories[i],bFound=$['inArray'](category['Category'],trimmedIgnoreCategories)>=0x0;category['FieldId']==0x0&&!bFound&&generalCategories['push'](category);}return generalCategories;},'SkillComboCategoriesToIgnore':function(addCategories){var sSystemSetting='Ignore\x20General\x20Skill\x20Categories',sCategories=TriSysApex['Cache']['SystemSettingManager']['GetValue'](sSystemSetting);if(!sCategories)sCategories='';var skillCategories=[];addCategories&&$['each'](addCategories,function(index,sCategory){skillCategories['push'](sCategory);});var comboCategories=sCategories['split'](',');return comboCategories&&comboCategories['length']>0x0&&($['each'](comboCategories,function(index,sCategory){sCategory=sCategory['trim'](),skillCategories['push'](sCategory);}),skillCategories['sort'](function(a,b){return a['localeCompare'](b);})),skillCategories;},'SkillComboCategories':function(addCategories,ignoreCategories){var lstSkillCategories=[],lstAllCategories=TriSysApex['Cache']['SkillCategories'](),lstIgnore=TriSysApex['Cache']['SystemSettingManager']['SkillComboCategoriesToIgnore'](ignoreCategories);return lstAllCategories['forEach'](function(skillCategory){var bAdd=!(skillCategory['FieldId']>0x0);bAdd&&lstIgnore&&lstIgnore['forEach'](function(sIgnoredSkillCategory){if(sIgnoredSkillCategory==skillCategory['Category'])bAdd=![];});!bAdd&&addCategories&&addCategories['forEach'](function(sAddkillCategory){if(sAddkillCategory==skillCategory['Category'])bAdd=!![];});if(bAdd)lstSkillCategories['push'](skillCategory);}),lstSkillCategories;},'FormattedCVFields':function(){var lstFormattedCVFields=[],sSystemSetting='CV\x20SEND:\x20Formatted\x20CV\x20Fields',sSystemSettingValue=TriSysApex['Cache']['SystemSettingManager']['GetValue'](sSystemSetting);if(sSystemSettingValue){var fields=sSystemSettingValue['split'](',');$['each'](fields,function(index,sField){sField=sField['trim'](),lstFormattedCVFields['push'](sField);});}return lstFormattedCVFields;}},'UsersManager':{'Photo':function(lUserId,sUserName){var sUserPhoto=TriSysApex['Constants']['DefaultContactImage'];return $['each'](TriSysApex['Cache']['Users'](),function(index,user){var bUserIdMatch=user['UserId']==lUserId,bUserNameMatch=user['FullName']==sUserName;if((bUserIdMatch||bUserNameMatch)&&user['Photo'])sUserPhoto=user['Photo'];}),sUserPhoto;},'FullName':function(lUserId){var sName='',user=TriSysApex['Cache']['UsersManager']['UserFromId'](lUserId);if(user)sName=user['FullName'];return sName;},'UserFromFullName':function(sFullName){var foundUser=null;return $['each'](TriSysApex['Cache']['Users'](),function(index,user){if(user['FullName']==sFullName)foundUser=user;}),foundUser;},'UserFromLoginName':function(sLoginName){var foundUser=null;return sLoginName&&$['each'](TriSysApex['Cache']['Users'](),function(index,user){if(user['LoginName']['toLowerCase']()==sLoginName['toLowerCase']())foundUser=user;}),foundUser;},'UserFromId':function(lUserId){var lstUser=TriSysApex['Cache']['Users']();if(!lstUser)return null;var foundUser=null;return $['each'](lstUser,function(index,user){if(user['UserId']==lUserId)foundUser=user;}),foundUser;}},'UserGroupManager':{'GroupFromId':function(lUserGroupId){var foundUserGroup=null;return $['each'](TriSysApex['Cache']['UserGroups'](),function(index,userGroup){if(userGroup['UserGroupId']==lUserGroupId)foundUserGroup=userGroup;}),foundUserGroup;},'isDuplicate':function(group){var userGroups=TriSysApex['Cache']['UserGroups']();for(var g=0x0;g<userGroups['length'];g++){var findGroup=userGroups[g];if(findGroup['UserGroupId']!=group['UserGroupId']&&findGroup['Name']==group['Name'])return!![];}return![];},'GroupByName':function(sName){var userGroups=TriSysApex['Cache']['UserGroups']();for(var g=0x0;g<userGroups['length'];g++){var findGroup=userGroups[g];if(findGroup['Name']==sName)return findGroup;}},'UserInGroup':function(sGroupName,lUserId){if(TriSysAPI['Operators']['isEmpty'](lUserId)){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser'])lUserId=userCredentials['LoggedInUser']['UserId'];}var userGroup=TriSysApex['Cache']['UserGroupManager']['GroupByName'](sGroupName);if(userGroup){if(userGroup['UserIdList']){if(userGroup['UserIdList']['indexOf'](lUserId)>=0x0)return!![];}}},'SystemAdministrator':function(lUserId){if(TriSysAPI['Operators']['isEmpty'](lUserId)){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser'])lUserId=userCredentials['LoggedInUser']['UserId'];}var SysAdminGroup='System\x20Administration',bInGroup=TriSysApex['Cache']['UserGroupManager']['UserInGroup'](SysAdminGroup,lUserId);return bInGroup;}},'SkillCategoriesManager':{'CategoryFromId':function(lSkillCategoryId){var foundSkillCategory=null;return $['each'](TriSysApex['Cache']['SkillCategories'](),function(index,skillCategory){if(skillCategory['SkillCategoryId']==lSkillCategoryId)foundSkillCategory=skillCategory;}),foundSkillCategory;},'CategoryFromName':function(sCategory){var foundSkillCategory=null;return $['each'](TriSysApex['Cache']['SkillCategories'](),function(index,skillCategory){if(skillCategory['Category']==sCategory)foundSkillCategory=skillCategory;}),foundSkillCategory;},'isDuplicate':function(group){var userGroups=TriSysApex['Cache']['UserGroups']();for(var g=0x0;g<userGroups['length'];g++){var findGroup=userGroups[g];if(findGroup['UserGroupId']!=group['UserGroupId']&&findGroup['Name']==group['Name'])return!![];}return![];},'hasLockedSkills':function(skillCategory){var bLockedSkills=![];return $['each'](TriSysApex['Cache']['Skills'](),function(index,skill){if(skill['SkillCategoryId']==skillCategory['SkillCategoryId']){if(skill['Locked'])return bLockedSkills=!![],![];}}),bLockedSkills;}},'SkillManager':{'SkillFromId':function(lSkillId){var foundSkill=null;return $['each'](TriSysApex['Cache']['Skills'](),function(index,skill){if(skill['SkillId']==lSkillId)foundSkill=skill;}),foundSkill;},'isDuplicate':function(skill){var skills=TriSysApex['Cache']['Skills']();for(var g=0x0;g<skills['length'];g++){var findSkill=skills[g];if(findSkill['SkillId']!=skill['SkillId']&&findSkill['Skill']==skill['Skill']&&findSkill['SkillCategoryId']==skill['SkillCategoryId'])return!![];}return![];},'SkillsInCategory':function(sCategory){var categorySkills=[],skills=TriSysApex['Cache']['Skills']();for(var g=0x0;g<skills['length'];g++){var skill=skills[g];if(skill['Category']==sCategory)categorySkills['push'](skill);}return categorySkills;}},'EntityTypesManager':{'EntityTypeFromName':function(sEntityName,sName){var entityTypes=TriSysApex['Cache']['EntityTypes']();for(var i=0x0;i<entityTypes['length'];i++){var entityType=entityTypes[i];if(entityType['EntityName']==sEntityName&&entityType['Name']==sName)return entityType;}},'EntityTypeFromId':function(iEntityTypeId){var entityTypes=TriSysApex['Cache']['EntityTypes']();for(var i=0x0;i<entityTypes['length'];i++){var entityType=entityTypes[i];if(entityType['EntityTypeId']==iEntityTypeId)return entityType;}}},'ContactPrioritiesManager':{'PriorityFromName':function(sPriority){var priorities=TriSysApex['Cache']['ContactPriorities']();for(var i=0x0;i<priorities['length'];i++){var priority=priorities[i];if(priority['ContactPriority']==sPriority)return priority;}},'PriorityFromId':function(iContactPriorityId){var priorities=TriSysApex['Cache']['ContactPriorities']();for(var i=0x0;i<priorities['length'];i++){var priority=priorities[i];if(priority['ContactPriorityId']==iContactPriorityId)return priority;}}},'JobTitleManager':{'JobTitleFromJobTitle':function(sJobTitle){var jobTitles=TriSysApex['Cache']['JobTitles']();if(jobTitles&&jobTitles['length']>0x0)for(var i=0x0;i<jobTitles['length'];i++){var jobTitle=jobTitles[i];if(jobTitle['JobTitle']==sJobTitle)return jobTitle;}else{var dataPacket={'JobTitle':sJobTitle},jobTitleResponse=TriSysWeb['Data']['SynchronousMethod']('Lookup/JobTitle',dataPacket);if(jobTitleResponse)return jobTitleResponse['JobTitle'];}},'JobTitleFromId':function(iJobTitleId){var jobTitles=TriSysApex['Cache']['JobTitles']();if(jobTitles&&jobTitles['length']>0x0)for(var i=0x0;i<jobTitles['length'];i++){var jobTitle=jobTitles[i];if(jobTitle['JobTitleId']==iJobTitleId)return jobTitle;}else{var dataPacket={'JobTitleId':iJobTitleId},jobTitleResponse=TriSysWeb['Data']['SynchronousMethod']('Lookup/JobTitle',dataPacket);if(jobTitleResponse)return jobTitleResponse['JobTitle'];}}},'IndustryManager':{'IndustryFromName':function(sIndustry){var industries=TriSysApex['Cache']['Industries']();for(var i=0x0;i<industries['length'];i++){var industry=industries[i];if(industry['Name']==sIndustry)return industry;}},'IndustryFromId':function(iIndustryId){var industries=TriSysApex['Cache']['Industries']();for(var i=0x0;i<industries['length'];i++){var industry=industries[i];if(industry['IndustryId']==iIndustryId)return industry;}}},'ContactTitleManager':{'ContactTitleFromId':function(iContactTitleId){var contactTitles=TriSysApex['Cache']['ContactTitles']();for(var i=0x0;i<contactTitles['length'];i++){var contactTitle=contactTitles[i];if(contactTitle['ContactTitleId']==iContactTitleId)return contactTitle;}}},'CurrenciesManager':{'CurrencyFromId':function(iCurrencyId){var currencies=TriSysApex['Cache']['Currencies']();for(var i=0x0;i<currencies['length'];i++){var currency=currencies[i];if(currency['CurrencyId']==iCurrencyId)return currency;}}},'TaskTypesManager':{'TaskTypeFromId':function(iTaskTypeId){var taskTypes=TriSysApex['Cache']['TaskTypes']();for(var i=0x0;i<taskTypes['length'];i++){var taskType=taskTypes[i];if(taskType['TaskTypeId']==iTaskTypeId)return taskType;}},'TaskTypeFromName':function(sTaskType){var taskTypes=TriSysApex['Cache']['TaskTypes']();for(var i=0x0;i<taskTypes['length'];i++){var taskType=taskTypes[i];if(taskType['Name']==sTaskType)return taskType;}}},'Relationships':{'RelationshipFromId':function(iRelationshipId,sEntityName){var relationshipFound=null;try{switch(sEntityName){case'Company':TriSysApex['Cache']['CompanyRelationshipTypes']()['forEach'](function(relationship){if(relationship['CompanyRelationshipTypeId']==iRelationshipId)relationshipFound=relationship;});break;case'Contact':TriSysApex['Cache']['ContactRelationshipTypes']()['forEach'](function(relationship){if(relationship['ContactRelationshipTypeId']==iRelationshipId)relationshipFound=relationship;});break;}}catch(e){}return relationshipFound;}},'AddressTypesManager':{'AddressTypeFromId':function(iAddressTypeId){var addressTypes=TriSysApex['Cache']['AddressTypes']();for(var i=0x0;i<addressTypes['length'];i++){var addressType=addressTypes[i];if(addressType['AddressTypeId']==iAddressTypeId)return addressType;}}},'ApplicationSettingsManager':{'List':function(){var standingData=TriSysApex['Cache']['GetStandingData']();if(standingData)return standingData['ApplicationSettings'];},'GetValue':function(sCategory,sName,objDefault){var applicationSettings=TriSysApex['Cache']['ApplicationSettingsManager']['List']();if(applicationSettings)for(var i=0x0;i<applicationSettings['length'];i++){var applicationSetting=applicationSettings[i];if(applicationSetting['Category']==sCategory&&applicationSetting['Name']==sName)return applicationSetting['Value'];}return objDefault;},'OverwiteSetting':function(userSetting){var applicationSettings=TriSysApex['Cache']['ApplicationSettingsManager']['List']();if(applicationSettings){for(var i=0x0;i<applicationSettings['length'];i++){var applicationSetting=applicationSettings[i];if(applicationSetting['Category']==userSetting['Category']&&applicationSetting['Name']==userSetting['Name']){applicationSetting['Value']=userSetting['Value'];return;}}applicationSettings['push'](userSetting);}},'Security':{'Objects':function(bReCache){if(!TriSysApex['Cache']['ApplicationSettingsManager']['Security']['_CachedSecurityObjectsJson']||bReCache){var sFile='security-objects.json';TriSysApex['Cache']['ApplicationSettingsManager']['Security']['_CachedSecurityObjectsJson']=TriSysApex['Forms']['Configuration']['JsonFileData'](sFile,![]),sFile='custom-security-objects.json';var sJSONFilePath=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sFile);if(sJSONFilePath){var jsonData=TriSysApex['Forms']['Configuration']['GetJSONFromFileUsingAjax'](sJSONFilePath);if(jsonData){var securityItems=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['_CachedSecurityObjectsJson']['SecurityItems'];securityItems=securityItems['concat'](jsonData['SecurityItems']),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['_CachedSecurityObjectsJson']['SecurityItems']=securityItems;}}}return TriSysApex['Cache']['ApplicationSettingsManager']['Security']['_CachedSecurityObjectsJson'];},'_CachedSecurityObjectsJson':null,'SecurityItem':function(sCategory,sName){var objects=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Objects']();if(objects){var securityItems=objects['SecurityItems'];if(securityItems)for(var i=0x0;i<securityItems['length'];i++){var securityItem=securityItems[i];if(securityItem['Category']==sCategory&&securityItem['Name']==sName)return securityItem;}}},'ReadValueByItem':function(securityItem){return TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue'](securityItem['Category'],securityItem['Name']);},'ReadValue':function(sCategory,sName){var securityItem=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['SecurityItem'](sCategory,sName);if(securityItem){var sValue=TriSysApex['Cache']['ApplicationSettingsManager']['GetValue'](sCategory,sName,securityItem['Default']);switch(securityItem['Type']){case'Boolean':var b=TriSysAPI['Operators']['stringToBoolean'](sValue,![]);return b;}return sValue;}},'Actions':{'SaveSettingsButton':function(){return TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Actions','SaveSettingsButton');}},'Tasks':{'DeleteButton':function(){return TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Task','Delete');}},'Apply':{'PostLogin':function(sCompanyName,bPostLoginSecurityOnly){var bLoggedInAsUser=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(!bLoggedInAsUser||!TriSysApex['Constants']['TriSysHostedCRM'])return;var objects=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Objects']();if(objects){var securityItems=objects['SecurityItems'];if(securityItems)for(var i=0x0;i<securityItems['length'];i++){var securityItem=securityItems[i];if(securityItem['TriSysHostedCRM']){if(!TriSysApex['Constants']['TriSysHostedCRM'])securityItem['Hidden']=!![];}if(!securityItem['Hidden']&&securityItem['Title']=='Visible'){if(securityItem['DOMidList']){var bVisible=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValueByItem'](securityItem);$['each'](securityItem['DOMidList'],function(index,item){var elem=$('#'+item);bVisible?elem['show']():elem['hide']();});}TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['GridColumn'](securityItem);}}}TriSysSDK['Fonts']['PostLogin'](),TriSysApex['Resourcer']['ApplyFormSecurity'](),TriSysApex['WhiteLabelling']['ApplyPartnerCSS']();if(!bPostLoginSecurityOnly)return;TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['GridColumns'](objects),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['DefaultNavBarGroup'](),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLoginForm']();},'GridColumns':function(objects){if(objects){var securityItems=objects['SecurityItems'];if(securityItems)for(var i=0x0;i<securityItems['length'];i++){var securityItem=securityItems[i];TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['GridColumn'](securityItem);}}},'GridColumn':function(securityItem){if(securityItem['GridColumns']&&securityItem['Grid']){var sList=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValueByItem'](securityItem);if(sList){var lstColumns=sList['split'](',\x20');if(!TriSysApex['Pages']['Index']['HideGridColumns'])TriSysApex['Pages']['Index']['HideGridColumns']=[];else for(var i=0x0;i<TriSysApex['Pages']['Index']['HideGridColumns']['length'];i++){var gridColumnsCached=TriSysApex['Pages']['Index']['HideGridColumns'][i];if(gridColumnsCached['Grid']==securityItem['Grid']){gridColumnsCached['Columns']=lstColumns;return;}}var gridColumns={'Grid':securityItem['Grid'],'Columns':lstColumns};TriSysApex['Pages']['Index']['HideGridColumns']['push'](gridColumns);}}},'DefaultNavBarGroup':function(){return;var sDefaultNavBarGroup=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('NavBar','DefaultGroup');sDefaultNavBarGroup&&setTimeout(function(){var elemHelp=$('#navBar-Help');elemHelp['hide'](),elemHelp=elemHelp['prev'](),elemHelp['removeClass']()['addClass']('sidebar-nav-menu');var elem=$('#'+sDefaultNavBarGroup);elem['show'](),elem=elem['prev'](),elem['addClass']('sidebar-nav-menu\x20open');},0x64);},'PostLoginForm':function(){var sPostLoginForm=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('PostLogin','Form');sPostLoginForm&&setTimeout(function(){TriSysApex['FormsManager']['OpenForm'](sPostLoginForm);},0x96);}}}}},'Pages':{'Controller':{'OpenLoginForm':function(){setTimeout(function(){TriSysApex['FormsManager']['OpenForm']('Login',0x0,![]);},0xfa);},'isDeveloper':function(){var bApexDeveloper=![];if(TriSysApex['LoginCredentials']){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials)try{bApexDeveloper=userCredentials['LoggedInUser']['CRMContact']['ApexDeveloper'];}catch(e){}}var bInDev=bApexDeveloper;return bInDev;},'isDesigner':function(){var bDesigner=![];if(TriSysApex['LoginCredentials']){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser'])try{sCompanyName=userCredentials['LoggedInUser']['Contact']['CompanyName'],sUserName=userCredentials['LoggedInUser']['FullName'];var opus='Opus\x20Laboris\x20Recruitment',users=['josie.musto@opuslaboris.com','upwork.contractor@opuslaboris.com','katarina.rado@upwork.com'];bDesigner=sCompanyName==opus&&users['indexOf'](sUserName['toLowerCase']())>=0x0;}catch(e){}}return bDesigner;},'validTriSysDeveloperIPAddresses':null,'ReadValidatedIPAddresses':function(bSupressError,fnCallback){var payloadObject={};payloadObject['URL']='Start/ValidatedIPAddresses',payloadObject['Asynchronous']=fnCallback?!![]:![];var IPAddresses=null;return payloadObject['InboundDataFunction']=function(data){IPAddresses=data;if(fnCallback)fnCallback(IPAddresses);},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(TriSysAPI['Operators']['isEmpty'](bSupressError))alert('TriSysApex.Pages.Controller.ReadValidatedIPAddresses:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject),IPAddresses;},'IsClientADeveloperIPAddress':function(fnCallback){var sSiteKey=TriSysApex['Constants']['DeveloperSiteKey'];TriSysAPI['Session']['SetDeveloperSiteKey'](sSiteKey);var fnAfterGettingIPAddress=function(sIPAddress){var bFound=$['inArray'](sIPAddress,TriSysApex['Pages']['Controller']['validTriSysDeveloperIPAddresses'])>=0x0;if(bFound)fnCallback();},fnAfterGettingValidatedIPAddresses=function(IPaddresses){if(IPaddresses)TriSysApex['Pages']['Controller']['validTriSysDeveloperIPAddresses']=IPaddresses;TriSysAPI['Data']['IPAddress'](!![],null,fnAfterGettingIPAddress);};if(!TriSysApex['Pages']['Controller']['validTriSysDeveloperIPAddresses'])TriSysApex['Pages']['Controller']['ReadValidatedIPAddresses'](!![],fnAfterGettingValidatedIPAddresses);else fnAfterGettingValidatedIPAddresses();},'isFormSpecifiedInURL':function(){var sURL=window['location']['href'],iIndex=sURL['indexOf']('/?'),bForm=iIndex>0x0;return bForm;},'ParseURLParts':function(sURL){var sURL=window['location']['href'],bUserCredentialsValid=TriSysApex['LoginCredentials']['areUserCredentialsValid'](),bCustomerCredentialsValid=TriSysApex['LoginCredentials']['areCustomerCredentialsValid']();if(!bUserCredentialsValid&&!bCustomerCredentialsValid){var sSitePartsDots=sURL['split']('.');if(sSitePartsDots['length']>0x1){var sSubDomain=sSitePartsDots[0x0]['replace']('http://','')['replace']('https://',''),sDomain=sSitePartsDots[0x1];sSubDomain!='www'&&sSubDomain!='apex'&&sDomain=='trisys'&&TriSysApex['WhiteLabelling']['Configure'](sSubDomain);}}var sSiteParts=sURL['split']('?');if(sSiteParts['length']>0x1){var sSubURL=sSiteParts[0x1],sParts=sSubURL['split']('/'),sFormName='',sParameters='';sParts['length']==0x1?sFormName=sParts[0x0]:(sFormName=sParts[0x0],sParameters=sParts[0x1]);if(sParts['length']>=0x1){var sCustomerID=null,sWhiteLabelCustomerID=null;sURL=sURL['toLowerCase']();if(sParts['length']==0x1){var sParameterPair=sParts[0x0];if(sParameterPair['indexOf']('=')>0x0){var sAgency=TriSysApex['URL']['Parser'](sURL)['getParam']('agency');if(sAgency)sCustomerID=sAgency,sFormName=TriSysWebJobs['Constants']['CandidateVacancySearchForm'],sWhiteLabelCustomerID=sAgency,TriSysApex['WhiteLabelling']['Configure'](sWhiteLabelCustomerID);else{sCustomerID=TriSysApex['URL']['Parser'](sURL)['getParam']('webjobs');if(sCustomerID)sFormName=TriSysWebJobs['Constants']['CandidateVacancySearchForm'];else parts=sParameterPair['split']('&'),sFormName=parts[0x0];sWhiteLabelCustomerID=TriSysApex['URL']['Parser'](sURL)['getParam']('oem');if(sWhiteLabelCustomerID){sFormName=TriSysApex['Constants']['LoginForm'],TriSysApex['WhiteLabelling']['Configure'](sWhiteLabelCustomerID);var bHashURL=sURL['indexOf']('#')>0x0;if(TriSysApex['Constants']['WhiteLabelStartupForm']&&!bHashURL)sFormName=TriSysApex['Constants']['WhiteLabelStartupForm'];}}}}else{if(sParts['length']==0x3)sCustomerID=sParts[0x2];}if(sCustomerID){var iAmpersand=sCustomerID['indexOf']('&');if(iAmpersand>0x0)sCustomerID=sCustomerID['substring'](0x0,iAmpersand);TriSysApex['Constants']['TriSysHostedCRM']=![];var bInitialised=TriSysWebJobs['Agency']['CustomerID']!=null;!bInitialised&&(TriSysWebJobs['Agency']['CustomerID']=sCustomerID,$('#product-name')['html']('Web\x20Jobs'),TriSysAPI['Session']['SetDataServicesKey'](null)),TriSysWebJobs['Routing']['ParseURLParameters'](sParameters,sFormName);}}switch(sFormName){case'Login':var sParts=sParameters['split']('=');if(sParts&&sParts['length']==0x2){var sOperation=sParts[0x0],sGUID=sParts[0x1];switch(sOperation){case'reset':TriSysApex['Forms']['Login']['ValidateResetPassword'](sGUID);break;}}break;}var formParts={'FormName':sFormName,'RecordId':sParameters};return formParts;}return null;},'ParseLoadRecordURLParameter':function(sParameters,iIndex,bParseInt){if(sParameters)try{if($['isNumeric'](sParameters)&&bParseInt&&iIndex==0x0)return sParameters;var iSlash=sParameters['indexOf']('/');if(iSlash<0x0&&iIndex==0x0)return sParameters;if(iSlash>=0x0){var parts=sParameters['split']('/'),value=parts[iIndex];if(value&&$['isNumeric'](value)&&bParseInt)return parseInt(value);else return value;}}catch(e){}},'PreventBrowserBackButton':function(){window['onbeforeunload']=function(event){var bLoggedIn=TriSysApex['LoginCredentials']['areUserCredentialsValid'](),bUpgradePending=TriSysApex['Upgrade']['UpgradePending']();if(!bLoggedIn||bUpgradePending)return;if(TriSysApex['Forms']['Lock']['Enabled']||TriSysApex['UI']['isModalOpen']()){event['preventDefault']();return;}if(!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID'])return;var sURL=window['location']['href'];if(sURL&&sURL['indexOf']('?UserOptions')>0x0){event['preventDefault']();return;}var sMessage='You\x20will\x20be\x20logged\x20out\x20of\x20'+TriSysApex['Copyright']['ShortProductName'];return sMessage;},window['onpopstate']=function(event){var bWebJobsURL=![],sURL=location['href']['toLowerCase']();if(sURL['indexOf']('webjobs=')>0x0)bWebJobsURL=!![];if(TriSysApex['Forms']['Lock']['Enabled']||TriSysApex['UI']['isModalOpen']()||bWebJobsURL)return event['preventDefault'](),![];TriSysApex['Pages']['Controller']['RefreshFormUsingLocation']();};},'RefreshFormUsingLocation':function(){var sURL=location['pathname'];TriSysApex['Pages']['Controller']['LoadFormByParsingURL'](sURL);},'LoadFormByParsingURL':function(sURL){if(sURL){var formParts=TriSysApex['Pages']['Controller']['ParseURLParts'](sURL);if(!formParts)return;var sFormName=formParts['FormName'],lRecordId=formParts['RecordId'],bAddToBrowserHistoryStack=![];TriSysApex['FormsManager']['OpenForm'](sFormName,lRecordId,bAddToBrowserHistoryStack);}}},'Index':{'documentReady':function(sMobileMenuDiv,scrollNavBarDiv){if(TriSysApex['Router']['WhiteLabelRedirectorCheck']())return;if(!TriSysApex['Environment']['ensureHTTPSinProduction']())return;if(TriSysApex['ComingSoon']['PreLaunchPhase']())return;if(TriSysApex['Upgrade']['StartupRedirect']())return;TriSysApex['ErrorHandling']['CatchAll'](),TriSysApex['Environment']['WindowsStoreApp'](),TriSysApex['Device']['ZoomOnStartup'](),TriSysApex['UI']['AllocateMultiStackedModalDialogues']();if(!TriSysApex['Pages']['Index']['BrowserCompatibilityCheck']())return;TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']),TriSysAPI['Session']['SetDataServicesKey'](null);var redirectURL=TriSysApex['Router']['Redirect404'](),bIntelligentRouting=![];if(TriSysApex['Constants']['TriSysHostedCRM']&&!TriSysWebJobs['Agency']['CustomerID'])TriSysProUI['DisplayAppNameInStartupAnimation'](TriSysApex['Copyright']['ShortProductName']);TriSysApex['Forms']['Configuration']['Initialise']();if(TriSysApex['Environment']['RefreshCachedApplication']())return;TriSysSDK['Browser']['CORSProxyJavascriptLoad'](),TriSysSDK['Countries']['CurrentCountryName'](),TriSysApex['NavigationBar']['Draw'](scrollNavBarDiv),TriSysApex['Pages']['Controller']['PreventBrowserBackButton'](),TriSysSDK['Fonts']['ApplyFontChange'](TriSysApex['Constants']['DefaultFont'],!![]);if(!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID'])TriSysWebJobs['Frame']['Configure'](TriSysWebJobs['Agency']['CustomerID']);TriSysProUI['DisplayApplicationLayoutAfterStartupAnimation'](),TriSysWeb['Constants']['Cookie_Prefix']=TriSysApex['Constants']['Cookie_Prefix'];var bAutomaticLoginCredentialsComplete=TriSysWeb['Pages']['Login']['AutomaticLoginCredentialsComplete']();TriSysApex['DebugLogging']['InitialiseApplication'](TriSysApex['Copyright']['ShortProductName']);try{ApexIndexPage['SetupHelpToolbarButton']();}catch(ex){}TriSysApex['TourGuide']['Load']();if(bIntelligentRouting)return;if(TriSysApex['Constants']['TriSysHostedCRM']||bAutomaticLoginCredentialsComplete){var sURL=window['location']['href'],bHashURL=sURL['indexOf']('#')>0x0;(!TriSysApex['Constants']['WhiteLabelStartupForm']||bHashURL)&&TriSysApex['FormsManager']['OpenForm']('Login',0x0,![]);if(!TriSysApex['Constants']['WhiteLabelled']){var helpVideoButtonGroup=$('#help-video-group');helpVideoButtonGroup['show']();}}},'BrowserCompatibilityCheck':function(){var bCompatible=TriSysSDK['Browser']['Supported']();return!bCompatible&&TriSysApex['UI']['errorAlert']('Your\x20web\x20browser\x20is\x20not\x20supported.\x20Please\x20upgrade\x20to\x20a\x20modern\x20browser.'),bCompatible;},'PostLoginVisuals':function(bLoggedIn,CDataConnectionKey){var sUserName='',sCompanyName='',sImage=TriSysApex['Constants']['DefaultContactImage'],sLoginStatus='You\x20are\x20not\x20logged\x20in',bRecruiterLogin=!![],bCustomerLogin=![],sLoginEMail=null;if(bLoggedIn){if(CDataConnectionKey['LoggedInAgencyContact']){sLoginStatus='You\x20are\x20logged\x20in';var contact=CDataConnectionKey['LoggedInAgencyContact'];sCompanyName=contact['CompanyName'],sUserName=contact['FullName'];if(contact['ContactPhoto'])sImage=contact['ContactPhotoURL'];bRecruiterLogin=![];}else{var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){sCompanyName=userCredentials['LoggedInUser']['CompanyName'],sUserName=userCredentials['LoggedInUser']['FullName'],sLoginEMail=userCredentials['LoggedInUser']['FullName'],sLoginStatus='You\x20are\x20logged\x20in';var contact=userCredentials['LoggedInUser']['Contact'];if(contact){sCompanyName=contact['CompanyName'],sUserName=contact['FullName'];if(contact['ContactPhoto'])sImage=contact['ContactPhoto'];TriSysApex['Constants']['TrialMode']=CDataConnectionKey['TrialAccount'],TriSysApex['Constants']['ShowDummyDashboardData']=CDataConnectionKey['ShowDummyDashboardData'];var bSystemsAdministrator=TriSysApex['Cache']['UserGroupManager']['SystemAdministrator'](userCredentials['LoggedInUser']['UserId']);TriSysApex['Constants']['TrialMode']||!bSystemsAdministrator?TriSysApex['NavigationBar']['ApplySecurityAfterLogin']():TriSysApex['ModalDialogue']['WelcomeWizard']['Show'](!![]);TriSysApex['TourGuide']['AfterLoginEvent'](),TriSysApex['Advertising']['AfterLoginEvent']();var iAgendaMaximumDays=parseInt(TriSysApex['Cache']['UserSettingManager']['GetValue']('DiaryManager_AgendaMaximumDays',0x7));if(iAgendaMaximumDays>0x0)TriSysSDK['Scheduler']['AgendaViewDayCount']=iAgendaMaximumDays;TriSysApex['Pages']['Index']['PostLoginSubscriberGridColumnTemplates']();}else{var crmContact=userCredentials['LoggedInUser']['CRMContact'];if(crmContact){bCustomerLogin=!![],bRecruiterLogin=![],sUserName=crmContact['FullName'],sCompanyName=crmContact['CompanyName'];if(crmContact['ContactPhoto'])sImage=crmContact['ContactPhoto'];}}}}if(bRecruiterLogin){$('#LoggedInUserDropDownMenu')['show'](),$('#proUI-Right-SideBar-Demo')['show'](),$('#nav-bar-activities-title')['show'](),$('#nav-bar-activities')['show']();if(!TriSysApex['Constants']['WhiteLabelPreventThemeChange'])TriSysProUI['InitialiseThemesAfterLogin'](!![]);TriSysApex['BrowserHistory']['Menu']['PopulateAfterLogin'](),$('#new-record-drop-down-menu')['show'](),$('#search-textbox-group')['show'](),ApexIndexPage['SetupFontSizeToolbarButtons'](),TriSysApex['InterprocessCommunication']['LoadMaster'](sLoginEMail),TriSysApex['OfficeAddIn']['PostLogin']();if(TriSysApex['Device']['PhoneGapEnabled']())TriSysPhoneGap['HideSplashScreen']();var helpVideoButtonGroup=$('#help-video-group');helpVideoButtonGroup['hide'](),TriSysApex['Resourcer']['PostLogin']();}else bCustomerLogin&&($('#LoggedInUserDropDownMenu')['show'](),$('#proUI-Right-SideBar-Demo')['show'](),TriSysProUI['InitialiseThemesAfterLogin'](!![]),$('#LoggedInUserDropDownMenu-ActivityHeader')['hide'](),$('#LoggedInUserDropDownMenu-Alarms')['hide'](),$('#LoggedInUserDropDownMenu-Divider-Tasks')['hide'](),$('#LoggedInUserDropDownMenu-Tasks')['hide'](),$('#sidebar-user-link-help')['hide'](),$('#sidebar-user-link-lock')['hide'](),$('#LoggedInUserDropDownMenu-Lock')['hide']());if(TriSysApex['Device']['isPhone']())TriSysApex['Pages']['Index']['HideItemsOnPhoneAfterLogin']();else{if(TriSysApex['Device']['isTablet']())TriSysApex['Pages']['Index']['HideItemsOnTabletAfterLogin']();else $('#logged-in-user-navbar-photo-panel')['show']();}TriSysApex['WhiteLabelling']['ApplyPartnerCSS']();}else $('#LoggedInUserDropDownMenu')['hide'](),$('#proUI-Right-SideBar-Demo')['hide'](),$('#nav-bar-activities-title')['hide'](),$('#nav-bar-activities')['hide'](),$('#history-drop-down-menu')['hide'](),$('#new-record-drop-down-menu')['hide'](),$('#search-textbox-group')['hide'](),$('#logged-in-user-navbar-photo-panel')['hide'](),$('#show-contextual-help')['hide']();if(bRecruiterLogin||bCustomerLogin)$('#lblLoggedInUserCompanyName')['text'](sCompanyName);else{if(sCompanyName)sUserName+='<br\x20/>'+sCompanyName;}$('#lblLoggedInUserFullName')['html'](sUserName);var iLoginNameFontSize=0x0;if(sUserName['length']>0xf)iLoginNameFontSize=0xa;else{if(sUserName['length']>0xc)iLoginNameFontSize=0xc;else{if(sUserName['length']>0xa)iLoginNameFontSize=0xe;}}if(iLoginNameFontSize>0x0)$('.sidebar-user-name')['css']('font-size',iLoginNameFontSize+'px');(bRecruiterLogin||bCustomerLogin)&&($('#lblLoggedInUserCompanyName2')['text'](sCompanyName),$('#lblLoggedInUserFullName2')['text'](sUserName),$('#lblLoggedInStatus')['text'](sLoginStatus));TriSysApex['Pages']['Index']['ShowLoggedInAvatar'](sImage);var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bRecruiterLogin){TriSysApex['Pages']['Index']['ShowAlarms'](!![]),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](sCompanyName,!![]);if(bLoggedIn){var fnConnectToSignalR=function(){TriSysApex['SignalR']['Communication']['Connect'](),!bWeAreTheRemoteBrowserPopup&&(setTimeout(TriSysApex['Alarms']['Start'],0x1388),TriSysApex['SessionManager']['Start']());};TriSysApex['SignalR']['ReadUserConnectionDetails'](fnConnectToSignalR);}else TriSysApex['Alarms']['Stop'](),TriSysApex['SessionManager']['Stop']();TriSysApex['Trial']['PostLoginStatus']();}if(bLoggedIn&&!bWeAreTheRemoteBrowserPopup){if(TriSysApex['CustomFormsAndComponents']['getCustomFormURL']('search-criteria-entity-fields.json'))TriSysApex['Constants']['CustomSearchCriteriaEntityFields']=!![];TriSysApex['CustomFormsAndComponents']['AfterLogin'](CDataConnectionKey);}},'PostLoginSubscriberGridColumnTemplates':function(){var sContactTypeColumn='Contact_ContactType',valueColours=TriSysApex['Pages']['Index']['ContactTypeColourMappings'],lstContactTypeColumns=['DynamicColumn_ContactType','Contact_ContactType'];lstContactTypeColumns['forEach'](function(sColumn){TriSysSDK['Grid']['CustomGridColumnTemplates']['AddColumnTemplate'](sColumn,TriSysSDK['Grid']['CustomGridColumnTemplates']['FormatColourByColumnValue'](sColumn,valueColours));}),TriSysSDK['Grid']['CustomGridColumnTemplates']['AddGridColumnTemplate']('adminConsoleForm-UserGrid','Name',TriSysSDK['Grid']['CustomGridColumnTemplates']['ShowContactUserPhoto']('Name','UserId'));},'ContactTypeColourMappings':[{'value':'Client','cssClass':'info'},{'value':'Candidate','cssClass':'danger'},{'value':'ClientCandidate','cssClass':'warning'},{'value':'User','cssClass':'success'},{'value':'Referee','cssClass':'default'},{'value':'Customer','cssClass':'info'}],'ShowProfileCentreDropDown':function(bShow){TriSysApex['Pages']['Index']['ShowAlarmButton']('profileCentre',bShow);},'ShowAlarms':function(bShow){TriSysApex['Pages']['Index']['ShowAlarmButton']('userNotificationPostItNotes',bShow),TriSysApex['Pages']['Index']['ShowAlarmButton']('userNotificationTaskAlarms',bShow);},'ShowAlarmButton':function(sButtonDiv,bShow){if(bShow)$('#'+sButtonDiv)['show']();else $('#'+sButtonDiv)['hide']();},'ShowLoggedInAvatar':function(sImage){if(!sImage)sImage=TriSysApex['Constants']['DefaultContactImage'];sImage&&($('#imgLoggedInUserImage')['attr']('src',sImage),$('#imgLoggedInUserImage2')['attr']('src',sImage));},'ShowImageThumbnail':function(sImage,sDivTag,iHeight,iWidth){$('#'+sDivTag)['attr']('src',sImage),$('#'+sDivTag)['jqthumb']({'classname':'jqthumb','width':iWidth,'height':iHeight,'classname':'picCircular','showoncomplete':!![]});},'WindowsResizeEvents':function(){window['onresize']=function(event){TriSysApex['Pages']['Index']['onWindowResize']();},TriSysApex['Pages']['Index']['onWindowResize']();},'onWindowResize':function(){},'NavBarWidth':function(){var lWidth=0x0;if(TriSysApex['Pages']['Index']['isNavBarVisible']()){var sDiv='#sidebar';lWidth=$(sDiv)['width']();}return lWidth;},'FormHeight':function(){var iTODOCalculateCaptionAndLogoHeight=0x37,iDocumentHeight=$(document)['height'](),lHeight=iDocumentHeight-iTODOCalculateCaptionAndLogoHeight;return lHeight;},'FormWidth':function(){var iDeprecatedCalculateWideMargins=0x0,lWidth=$(document)['width']()-TriSysApex['Pages']['Index']['NavBarWidth']()-iDeprecatedCalculateWideMargins;return lWidth;},'ToggleNavBarVisibility':function(){TriSysApex['Pages']['Index']['NavBarVisible'](!TriSysApex['Pages']['Index']['isNavBarVisible']());},'NavBarVisible':function(bVisible){var sDiv='#sidebar',bHidden=document['getElementById']('sidebar')['offsetWidth'];if(bHidden==0x0){}else App['sidebar']('toggle-sidebar');},'isNavBarVisible':function(){var sDiv='#sidebar',lWidth=$(sDiv)['width']();return lWidth>0x0;var bHidden=$(sDiv)['is'](':hidden');return!bHidden;},'ToggleSubMenu':function(sMenuName){$('#'+sMenuName)['toggle']('show');},'ToggleSubMenuIfLoggedIn':function(sMenuName){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials)TriSysApex['Pages']['Index']['ToggleSubMenu'](sMenuName);},'TemporaryCompanyName':null,'HideGridColumns':null,'HideItemsOnPhoneAfterLogin':function(){var elemLoggedInUserDropDownMenu=$('#LoggedInUserDropDownMenu');elemLoggedInUserDropDownMenu['attr']('onmouseover',''),elemLoggedInUserDropDownMenu['attr']('onmouseout','');var elemHistoryDropDownMenu=$('#history-drop-down-menu');elemHistoryDropDownMenu['attr']('onmouseover',''),elemHistoryDropDownMenu['attr']('onmouseout','');var elemNewRecordDropDownMenu=$('#new-record-drop-down-menu');elemNewRecordDropDownMenu['attr']('onmouseover',''),elemNewRecordDropDownMenu['attr']('onmouseout','');var subscribeButtonGroup=$('#subscribe-group');subscribeButtonGroup['remove']();var helpVideoButtonGroup=$('#help-video-group');helpVideoButtonGroup['remove']();var fWidthFactor=0xfa,iWidth=$(window)['width']()-fWidthFactor;$('#trisys-search')['width'](iWidth),$('.toolbar-search-box\x20input')['css']('min-width',iWidth+'px');var iDropDownWidth=$(window)['width']()-0x46;$('#search-drop-down-results-block')['width'](iDropDownWidth),$('#search-drop-down-results-block')['css']('min-width',iDropDownWidth+'px'),$('#history-drop-down-caption')['html'](''),$('#history-drop-down-menu-block')['addClass']('pull-right'),$('#history-drop-down-menu-block')['css']('margin-right','-115px'),$('#new-record-drop-down-caption')['html'](''),$('#new-record-drop-down-menu-block')['addClass']('pull-right'),$('#history-add-button-menu-separator')['hide']();var btnFontSmaller=$('#font-smaller'),btnFontLarger=$('#font-larger'),helpButton=$('#show-contextual-help');btnFontSmaller['hide'](),btnFontLarger['hide'](),helpButton['hide'](),$('#CVAutoRecognition-MenuItem')['hide'](),$('#HelpChat-MenuItem')['hide'](),$('#AdminConsole-MenuItem')['hide'](),$('#new-record-cvar-divider')['hide'](),$('#new-record-cvar')['hide'](),$('#new-record-timesheet')['hide']();var lHeight=$(window)['height']()-0x32;$('.navbar-fixed-top\x20.dropdown-menu')['css']('max-height',lHeight+'px');},'HideItemsOnTabletAfterLogin':function(){var iWidth=0xc8;$('#trisys-search')['width'](iWidth);}},'DashboardForm':{'populateTestCharts':function(sDivTag){$('#'+sDivTag)['html']('<b>Populating\x20charts...</b>'),$('#'+sDivTag)['hide']();}},'ContactsForm':{'SearchCriteria':{'Forenames':'','Surname':'','Company':'','Wildcard':''},'isEmptySearchCriteria':function(){var criteria=TriSysApex['Pages']['ContactsForm']['SearchCriteria'];return criteria['Forenames']==''&&criteria['Surname']==''&&criteria['Company']==''&&criteria['Wildcard']=='';},'Columns':[{'field':'Contact_ContactId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Contact_Christian','title':'Forename(s)','type':'string'},{'field':'Contact_Surname','title':'Surname','type':'string'},{'field':'Contact_Company','title':'Company','type':'string'},{'field':'Contact_EMail','title':'Work\x20E-Mail','type':'string'},{'field':'Contact_HomeEMail','title':'Home\x20E-Mail','type':'string'},{'field':'Contact_WorkTelNo','title':'Work\x20Tel.\x20No','type':'string'},{'field':'Contact_MobileTelNo','title':'Personal\x20Mobile','type':'string'},{'field':'Contact_WorkMobile','title':'Work\x20Mobile','type':'string','hidden':!![]},{'field':'Contact_HomeAddressTelNo','title':'Home\x20Tel.\x20No','type':'string'},{'field':'Contact_DateOfBirth','title':'Date\x20of\x20Birth','hidden':!![],'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'Contact_Title','title':'Title','type':'string','hidden':!![]},{'field':'Contact_OwnerUser','title':'Owner\x20User','type':'string','hidden':!![]},{'field':'Contact_CompanyAddressStreet','title':'Company\x20Street\x20Address','type':'string','hidden':!![]},{'field':'Contact_CompanyAddressCity','title':'Company\x20Street\x20City','type':'string','hidden':!![]},{'field':'Contact_CompanyAddressCounty','title':'Company\x20Street\x20County','type':'string','hidden':!![]},{'field':'Contact_CompanyAddressPostCode','title':'Company\x20Street\x20Post/ZIP\x20Code','type':'string','hidden':!![]},{'field':'Contact_CompanyAddressCountry','title':'Company\x20Street\x20Country','type':'string','hidden':!![]},{'field':'Contact_HomeAddressStreet','title':'Home\x20Street\x20Address','type':'string','hidden':!![]},{'field':'Contact_HomeAddressCity','title':'Home\x20Street\x20City','type':'string','hidden':!![]},{'field':'Contact_HomeAddressCounty','title':'Home\x20Street\x20County','type':'string','hidden':!![]},{'field':'Contact_HomeAddressPostCode','title':'Home\x20Street\x20Post/ZIP\x20Code','type':'string','hidden':!![]},{'field':'Contact_HomeAddressCountry','title':'Home\x20Street\x20Country','type':'string','hidden':!![]},{'field':'Contact_ContactType','title':'Contact\x20Type','type':'string','hidden':!![]},{'field':'Contact_JobTitle','title':'Job\x20Title','type':'string','hidden':!![]},{'field':'Contact_AvailabilityDate','title':'Availability\x20Date','hidden':!![],'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'Contact_ContactSource','title':'Source','type':'string','hidden':!![]},{'field':'Contact_Status','title':'Status','type':'string','hidden':!![]},{'field':'Contact_DateLastUpdated','title':'Date\x20Last\x20Updated','hidden':!![],'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'Contact_AddedByName','title':'Added\x20By','type':'string','hidden':!![]}]},'ContactForm':{'ContactId':0x0,'LoadRecord':function(lContactId){TriSysApex['Pages']['ContactForm']['ContactId']=lContactId;var fnLoadEntityFormData=function(){setTimeout(function(){TriSysSDK['CShowForm']['readEntityFormDataFromServer']('Contact',lContactId,TriSysApex['Pages']['ContactForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['FormLoadDataDelay']),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('contact-form-attributes');};fnLoadEntityFormData();},'NewRecord':function(lContactId){var bCompanyFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Company';if(bCompanyFormOpen){TriSysApex['Pages']['CompanyForm']['NewContact']();return;}if(TriSysAPI['Operators']['isEmpty'](lContactId))lContactId=0x0;TriSysApex['FormsManager']['OpenForm']('Contact',lContactId),setTimeout(function(){TriSysApex['Pages']['ContactForm']['ContactId']=0x0,TriSysSDK['CShowForm']['clearFormFields']('Contact',TriSysApex['Pages']['ContactForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['NewRecordFormDelay']);},'CanSaveOrDeleteContactRecords':function(lContactId,bDelete){var bSuperUserOrStandardUser=lContactId==0x1||lContactId==0x2;if(bSuperUserOrStandardUser){if(!TriSysApex['Cache']['UserGroupManager']['SystemAdministrator']()){var sMessage='You\x20are\x20not\x20permitted\x20to\x20update\x20or\x20delete\x20this\x20contact\x20record.';return TriSysApex['UI']['ShowMessage'](sMessage),![];}else{if(bDelete){var sMessage='You\x20are\x20not\x20permitted\x20to\x20delete\x20this\x20contact\x20record.';return TriSysApex['UI']['ShowMessage'](sMessage),![];}}}return!![];},'SaveRecord':function(){if(!TriSysSDK['Miscellaneous']['PreventButtonDoubleClick']())return;var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(!TriSysApex['Pages']['ContactForm']['CanSaveOrDeleteContactRecords'](lContactId))return;var fnBeforeSaveFieldDescriptions=function(fieldDescriptions){for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'];switch(sDivID){case'Contact_Users':fieldDescription['Value']=TriSysSDK['CShowForm']['GetSelectedSkillsFromList'](sDivID);break;case'Contact_OwnerUser':fieldDescription['Value']=TriSysSDK['CShowForm']['GetTextFromCombo'](sDivID);break;case'Contact_Age':contactForm['CalculateAge']('Contact_DateOfBirth');break;}}var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);return fieldDescriptionsInDOM;},fnAfterSaveRecord=function(lRecordId,fieldDescriptions){TriSysApex['Pages']['ContactForm']['ContactId']=lRecordId,TriSysApex['Forms']['EntityForm']['AfterSaveConfirmation']('Contact',lRecordId);var sContactName=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']();TriSysApex['BrowserHistory']['Menu']['Add']('Contact',lRecordId,sContactName);var fdContactType=TriSysSDK['CShowForm']['getFieldDescriptionFromCollection'](fieldDescriptions,'Contact','Type'),sContactType=TriSysSDK['CShowForm']['getFieldDescriptionValue'](fdContactType);TriSysApex['FormsManager']['ShowRecordIdInCaption']('Contact',lRecordId,sContactName,{'ContactTypePrefix':!![],'ContactTypeName':sContactType}),TriSysSDK['Attributes']['SaveEntitySkills']('Contact',lRecordId,'contact-form-attributes'),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Contact',lRecordId);var bNewContact=lContactId<=0x0;if(bNewContact)try{contactForm['LoadPrivacyAndGDPR']();}catch(ex){}},mandatoryFields=[{'Name':'Contact_Forenames','Caption':'Forename(s)'},{'Name':'Contact_Surname','Caption':'Surname'}];TriSysApex['Forms']['EntityForm']['SaveEvent']('Contact',lContactId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields);},'DeleteRecord':function(lContactId,sFullName,fnCallback){!lContactId&&(lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],sFullName=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']());if(!lContactId||lContactId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20an\x20existing\x20contact\x20record\x20to\x20delete.');return;}if(!TriSysApex['Pages']['ContactForm']['CanSaveOrDeleteContactRecords'](lContactId,!![]))return;var fnYesReassign=function(){var fnSelectContact=function(selectedRow){if(!selectedRow)return;var lReassignToContactId=selectedRow['Contact_ContactId'];return TriSysApex['Pages']['CompanyForm']['SubmitCompanyContactDeletion'](0x0,lContactId,lReassignToContactId,fnCallback),!![];};TriSysApex['ModalDialogue']['Contacts']['Select'](fnSelectContact);},fnYesNoReassign=function(){TriSysApex['Pages']['CompanyForm']['SubmitCompanyContactDeletion'](0x0,lContactId,0x0,fnCallback);},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20contact:\x20<b>'+sFullName+'</b>\x20?'+'<br\x20/><br\x20/>'+'You\x20can\x20choose\x20to\x20re-assign\x20links\x20such\x20as\x20requirements,\x20placements\x20etc..\x20to\x20another\x20contact\x20record,\x20'+'or\x20delete\x20the\x20contact\x20and\x20all\x20linked\x20records,\x20'+'or\x20cancel\x20this\x20deletion\x20request.';TriSysApex['UI']['questionYesNoCancel'](sMessage,'Delete\x20Contact','Yes,\x20and\x20Re-Assign\x20Links',fnYesReassign,'Yes',fnYesNoReassign,'No/Cancel');},'OpenFindDialogue':function(fnCallback){var fnSelectedContact=function(selectedRow){if(!selectedRow)return;var lContactId=selectedRow['Contact_ContactId'];if(lContactId>0x0){if(fnCallback)fnCallback(lContactId);else TriSysApex['Pages']['ContactForm']['LoadRecord'](lContactId);return!![];}};TriSysApex['ModalDialogue']['Contacts']['Select'](fnSelectedContact);},'AfterFormDataLoaded':function(lContactId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Contact');var sContactName=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']();lContactId>0x0&&(TriSysApex['BrowserHistory']['Menu']['Add']('Contact',lContactId,sContactName),TriSysApex['Pages']['ContactForm']['AsynchronousEntityUpdateConfig'](lContactId));var fdContactType=TriSysSDK['CShowForm']['getFieldDescriptionFromCollection'](fieldDescriptions,'Contact','Type'),sContactType=TriSysSDK['CShowForm']['getFieldDescriptionValue'](fdContactType);TriSysApex['FormsManager']['ShowRecordIdInCaption']('Contact',lContactId,sContactName,{'ContactTypePrefix':!![],'ContactTypeName':sContactType});var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);for(var i=0x0;i<fieldDescriptionsInDOM['length'];i++){var fieldDescription=fieldDescriptionsInDOM[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],objValue=fieldDescription['Value'],sReadonlyField='#'+sDivID+'-readonly';$(sReadonlyField)['text'](objValue);switch(sDivID){case'Contact_JobTitle':TriSysSDK['CShowForm']['SetTextInCombo'](sDivID,objValue);break;case'Contact_Priority':if(objValue)TriSysSDK['CShowForm']['SetTextInCombo'](sDivID,objValue);break;case'Contact_HomeAddressCountry':if(!objValue||objValue=='')objValue=TriSysSDK['Countries']['DefaultCountryName'];TriSysSDK['CShowForm']['SetTextInCombo'](sDivID,objValue);break;case'ContactConfigFields_CVFileRef':case'ContactConfigFields_FormattedCVFileRef1':case'ContactConfigFields_FormattedCVFileRef2':case'ContactConfigFields_FormattedCVFileRef3':case'ContactConfigFields_FormattedCVFileRef4':TriSysSDK['Controls']['CVManager']['SetCVPath'](sDivID,objValue),TriSysSDK['Controls']['CVManager']['ShowCVPath'](sDivID);break;case'ContactConfigFields_IdentificationComments':TriSysSDK['Controls']['TextBoxDropDown']['SetText'](sDivID,objValue),fieldDescription['FieldTypeId']=TriSysSDK['Controls']['FieldTypes']['TextDropDown'];break;case'Contact_OwnerUser':var sUserName=TriSysApex['Pages']['ContactForm']['GetUserNameFromID'](objValue);TriSysSDK['CShowForm']['SetTextInCombo'](sDivID,sUserName);break;case'Contact_Users':var sUserList=objValue;TriSysSDK['CShowForm']['SetSkillsInList'](sDivID,sUserList);break;case'ContactConfigFields_ContactPhoto':TriSysSDK['Images']['AfterFileReferenceDelete'](sDivID+'-Thumbnail',sDivID+'-Thumbnail2',TriSysApex['Constants']['DefaultContactImage']);var sPhotoPath=objValue;if(sPhotoPath)TriSysSDK['Images']['ShowServerPathInImageTag'](sPhotoPath,sDivID+'-Thumbnail',sDivID+'-Thumbnail2');break;case'Contact_Forenames':var sFullName=objValue+'\x20'+$('#Contact_FullName-readonly')['text']();$('#Contact_FullName-readonly')['text'](sFullName);break;case'Contact_Surname':var sFullNameReadOnly=$('#Contact_FullName-readonly')['text']()+'\x20'+objValue;$('#Contact_FullName-readonly')['text'](sFullNameReadOnly);break;case'Contact_EMail':if(objValue){var sHyperlink='mailto:'+objValue;TriSysSDK['DocumentObjectModel']['SetHyperlinkProperties'](sReadonlyField,sHyperlink,objValue);}break;case'Contact_Age':contactForm['CalculateAge']('Contact_DateOfBirth');break;case'ContactConfigFields_UmbrellaReference':contactForm['UmbrellaReferenceChange'](objValue);break;}}try{contactForm['PostLoadRecord'](lContactId);}catch(e){}TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad']('Contact',lContactId,fieldDescriptions);},'GetUserNameFromID':function(objValue){var lUserId=parseInt(objValue),sUserName=null;return $['each'](TriSysApex['Cache']['Users'](),function(index,user){if(user['UserId']==lUserId)sUserName=user['FullName'];}),sUserName;},'LoadRequirementsGrid':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Contact',sDivTag))return;var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnPopulationByFunction={'API':'Requirements/List','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}};TriSysApex['Pages']['RequirementsForm']['EntityFormLoadRequirementsGrid'](sDivTag,fnPopulationByFunction,fnPostPopulationCallback);},'LoadRequirementsOnDemand':function(element,sDivTag){var fnLoadRequirements=function(sDivTag){TriSysSDK['Controls']['Animations']['StartWaitingSpinner'](sDivTag,'Loading\x20requirements');var fnPostPopulationCallback=function(lRecordCount){TriSysSDK['Controls']['Animations']['StopWaitingSpinner'](sDivTag);};TriSysApex['Pages']['ContactForm']['LoadRequirementsGrid'](sDivTag,fnPostPopulationCallback);};TriSysSDK['Controls']['Animations']['AccordionGroupClick'](element,sDivTag,fnLoadRequirements);},'LoadPlacementsGrid':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Contact',sDivTag))return;var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnPopulationByFunction={'API':'Placements/List','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}};TriSysApex['Pages']['PlacementsForm']['EntityFormLoadPlacementsGrid'](sDivTag,fnPopulationByFunction,fnPostPopulationCallback);},'LoadPlacementsOnDemand':function(element,sDivTag){var fnLoadPlacements=function(sDivTag){TriSysSDK['Controls']['Animations']['StartWaitingSpinner'](sDivTag,'Loading\x20placements');var fnPostPopulationCallback=function(lRecordCount){TriSysSDK['Controls']['Animations']['StopWaitingSpinner'](sDivTag);};TriSysApex['Pages']['ContactForm']['LoadPlacementsGrid'](sDivTag,fnPostPopulationCallback);};TriSysSDK['Controls']['Animations']['AccordionGroupClick'](element,sDivTag,fnLoadPlacements);},'LoadTimesheetsGrid':function(sGrid){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnPopulationByFunction={'API':'Timesheets/List','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}};TriSysWeb['Pages']['Timesheets']['PopulateGrid'](sGrid,'grdTimesheets','Timesheets',fnPopulationByFunction);},'AddRequirement':function(){TriSysApex['UI']['ShowMessage']('Add\x20a\x20new\x20requirement/vacancy');},'AddPlacement':function(){TriSysApex['UI']['ShowMessage']('Add\x20a\x20new\x20placement');},'LoadNotesHistoryGrid':function(sDivTag,fnPostPopulationCallback){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnParameters=function(request){request['ContactId']=lContactId,request['IncludeFullTaskDescriptionField']=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Contact','Contact\x20Tasks\x20Export',![]);},bScheduled=![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Contact',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadScheduledTasksGrid':function(sDivTag,fnPostPopulationCallback){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnParameters=function(request){request['ContactId']=lContactId,request['IncludeFullTaskDescriptionField']=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Contact','Contact\x20Tasks\x20Export',![]);},bScheduled=!![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Contact',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadEducationHistory':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Contact',sDivTag))return;var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnPopulationByFunction={'API':'Contact/EducationHistory','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}},columns=[{'field':'ContactEducationHistoryId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Dates','title':'Dates','type':'string'},{'field':'School','title':'School/College','type':'string'},{'field':'Location','title':'Location','type':'string'},{'field':'Qualifications','title':'Qualifications','type':'string'},{'field':'Comments','title':'Comments','type':'string'}];TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':'grdEducationHistory','Title':'Education\x20History','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':columns,'MobileVisibleColumns':[{'field':'Qualifications'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20Qualifications\x20#</strong><br\x20/>'+'<i>#:\x20School\x20#</i></td>','KeyColumnName':'ContactEducationHistoryId','DrillDownFunction':function(rowData){TriSysApex['ModalDialogue']['ContactEducationHistory']['Show'](rowData['ContactEducationHistoryId']);},'MultiRowSelect':!![],'PostPopulationCallback':fnPostPopulationCallback,'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':![],'OpenButtonCaption':'Edit','HyperlinkedColumns':['School']});},'LoadWorkHistory':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Contact',sDivTag))return;var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],fnPopulationByFunction={'API':'Contact/WorkHistory','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}},sSQL='Select\x20*\x20From\x20ContactWorkHistory\x20Where\x20ContactId\x20=\x20'+lContactId,columns=[{'field':'ContactWorkHistoryId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Dates','title':'Dates','type':'string'},{'field':'Employer','title':'Employer','type':'string'},{'field':'Location','title':'Location','type':'string'},{'field':'JobTitle','title':'Job\x20Title','type':'string'},{'field':'Department','title':'Department','type':'string'},{'field':'Description','title':'Description','type':'string'}];TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':'grdWorkHistory','Title':'Work\x20History','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':columns,'MobileVisibleColumns':[{'field':'JobTitle'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20JobTitle\x20#</strong><br\x20/>'+'<i>#:\x20Employer\x20#</i></td>','KeyColumnName':'ContactWorkHistoryId','DrillDownFunction':function(rowData){TriSysApex['ModalDialogue']['ContactWorkHistory']['Show'](rowData['ContactWorkHistoryId']);},'MultiRowSelect':!![],'PostPopulationCallback':fnPostPopulationCallback,'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':![],'OpenButtonCaption':'Edit','HyperlinkedColumns':['Employer']});},'OpenCompanyLink':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(lContactId){var fnPopulationByFunction={'API':'Contact/CompanyId','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){var lCompanyId=response['CompanyId'];if(lCompanyId)TriSysApex['FormsManager']['OpenForm']('Company',lCompanyId);}};TriSysSDK['Database']['GetDataSetFromFunction'](fnPopulationByFunction);}},'ClearCompanyLink':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(lContactId)return TriSysApex['Pages']['ContactForm']['SubmitAssignCompany'](lContactId,0x0,0x0,!![]),!![];},'OpenCompanyMap':function(sDiv){var sAddress=$('#'+sDiv)['val']();if(sAddress){sAddress=sAddress['replace'](/\r?\n|\r/g,'+');var iTel=sAddress['indexOf']('Tel:');if(iTel>=0x0)sAddress=sAddress['substring'](0x0,iTel);var sURL='https://www.google.co.uk/maps/search/'+sAddress;TriSysSDK['Browser']['OpenURL'](sURL);}},'SelectCompany':function(options){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],bAllowNoContact=![];if(options)bAllowNoContact=options['AllowNoContact'];if(!bAllowNoContact&&(!lContactId||lContactId<=0x0))return;var fnPopulationByFunction={'API':'Companies/List','DataTableFunction':function(response){return response['List'];}},sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20Company',sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=[{'field':'Company_CompanyId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Company_Name','title':'Company','type':'string'}];var fnSelectCompany=function(selectedRow){if(!selectedRow)return;var lCompanyId=selectedRow['Company_CompanyId'],sCompanyName=selectedRow['Company_Name'];return options&&options['Callback']?options['Callback'](lCompanyId,sCompanyName):TriSysApex['Pages']['ContactForm']['SubmitAssignCompany'](lContactId,lCompanyId,0x0),!![];};sqlParameters['CallbackFunction']=fnSelectCompany,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'SelectCompanyAddress':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],sCompany=$('#Contact_CompanyName')['val']();if(!lContactId||lContactId<=0x0||!sCompany)return;var fnSelectAddress=function(selectedRow){if(!selectedRow)return;var lAddressId=selectedRow['AddressId'],lCompanyId=selectedRow['CompanyId'],sStreet=selectedRow['Street'];return TriSysApex['Pages']['ContactForm']['SubmitAssignCompany'](lContactId,lCompanyId,lAddressId),!![];};TriSysApex['ModalDialogue']['CompanyAddresses']['Select'](0x0,sCompany,lContactId,0x0,fnSelectAddress);},'SubmitAssignCompany':function(lContactId,lCompanyId,lAddressId,bClearCompany){var iOperation=0x1;if(bClearCompany)iOperation=0x2;var CContactAssignCompanyRequest={'ContactId':lContactId,'CompanyId':lCompanyId,'AddressId':lAddressId,'Operation':iOperation},payloadObject={};payloadObject['URL']='Contact/AssignCompany',payloadObject['OutboundDataPacket']=CContactAssignCompanyRequest,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CContactAssignCompanyResponse=data;if(CContactAssignCompanyResponse){if(CContactAssignCompanyResponse['Success'])TriSysApex['Pages']['ContactForm']['PostSubmitAssignCompany'](CContactAssignCompanyResponse['CompanyName'],CContactAssignCompanyResponse['Address']);else TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitAssignCompany\x20Error:\x20'+CContactAssignCompanyResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitAssignCompany\x20Error:\x20null\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitAssignCompany:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Assigning...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PostSubmitAssignCompany':function(sCompanyName,address){var sAddress=null;if(address){sAddress=address['Street'];if(address['City'])sAddress+='\x0d\x0a'+address['City'];if(address['County'])sAddress+='\x0d\x0a'+address['County'];if(address['PostCode'])sAddress+='\x0d\x0a'+address['PostCode'];if(address['Country'])sAddress+='\x0d\x0a'+address['Country'];}$('#Contact_CompanyName')['val'](sCompanyName),$('#Contact_CompanyAddress')['val'](sAddress);},'NewCompanyAddress':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'],sCompany=$('#Contact_CompanyName')['val']();if(!lContactId||lContactId<=0x0||!sCompany)return;TriSysApex['ModalDialogue']['NewCompanyAddress']['Popup'](0x0,sCompany,0x0,lContactId,TriSysApex['Pages']['ContactForm']['SubmitNewCompanyAddress']);},'SubmitNewCompanyAddress':function(lCompanyId,lContactId,address){var CCompanyAddAddressRequest={'CompanyId':lCompanyId,'ContactId':lContactId,'Address':address},payloadObject={};payloadObject['URL']='Company/AddAddress',payloadObject['OutboundDataPacket']=CCompanyAddAddressRequest,payloadObject['InboundDataFunction']=function(CCompanyAddAddressResponse){TriSysApex['UI']['HideWait']();if(CCompanyAddAddressResponse){if(CCompanyAddAddressResponse['Success']){TriSysApex['UI']['CloseModalPopup']();if(lContactId>0x0)TriSysApex['Pages']['ContactForm']['PostSubmitAssignCompany'](CCompanyAddAddressResponse['CompanyName'],CCompanyAddAddressResponse['Address']);else TriSysApex['Pages']['CompanyForm']['AfterChangeToCompanyAddressesOrContacts']();}else TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitNewCompanyAddress\x20Error:\x20'+CCompanyAddAddressResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitNewCompanyAddress\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitNewCompanyAddress:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Address...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'NewCompany':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(!lContactId||lContactId<=0x0)return;var bNewCompany=!![];TriSysApex['ModalDialogue']['NewCompanyAddress']['Popup'](0x0,null,0x0,lContactId,TriSysApex['Pages']['ContactForm']['SubmitNewCompany'],bNewCompany);},'SubmitNewCompany':function(lCompanyId,lContactId,address,company){var CCompanyAddRequest={'CompanyName':company['CompanyName'],'ContactId':lContactId,'Address':address},payloadObject={};return payloadObject['URL']='Company/Add',payloadObject['OutboundDataPacket']=CCompanyAddRequest,payloadObject['InboundDataFunction']=function(CCompanyAddResponse){TriSysApex['UI']['HideWait']();if(CCompanyAddResponse){if(CCompanyAddResponse['Success'])TriSysApex['UI']['CloseModalPopup'](),lContactId>0x0&&TriSysApex['Pages']['ContactForm']['PostSubmitAssignCompany'](company['CompanyName'],address),company['EditAfterSave']&&(lCompanyId=CCompanyAddResponse['CompanyId'],TriSysApex['FormsManager']['OpenForm']('Company',lCompanyId));else TriSysApex['Toasters']['Error'](CCompanyAddResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitNewCompany\x20Error:\x20No\x20response\x20from\x20Web\x20API');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitNewCompany:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Company...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject),![];},'AsynchronousEntityUpdateConfig':function(lContactId){var taskGridSpecification=new TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecification']();taskGridSpecification['UniqueID']='ContactForm.TaskGrids',taskGridSpecification['EntityName']='Task',taskGridSpecification['CallOnRecordIdChangeOnly']=![],taskGridSpecification['UpdateCallbackFunction']=function(lTaskId){var sGrid='contactForm-NotesHistoryGrid';$('#'+sGrid)['length']>0x0&&(TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Contact',sGrid),TriSysApex['Pages']['ContactForm']['LoadNotesHistoryGrid'](sGrid,null),sGrid='contactForm-ScheduledTasksGrid',TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Contact',sGrid),TriSysApex['Pages']['ContactForm']['LoadScheduledTasksGrid'](sGrid,null));},TriSysApex['FormsManager']['EntityUpdateController']['RegisterFormWidgetSpecification'](taskGridSpecification);},'AutoSaveNow':function(){var bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']==='Contact';if(bContactFormOpen)TriSysApex['Pages']['ContactForm']['SaveRecord']();}},'CompaniesForm':{'Columns':[{'field':'Company_CompanyId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Company_Name','title':'Company\x20Name','type':'string'},{'field':'Company_WebPage','title':'Web\x20Page','type':'string'},{'field':'Company_MainTelNo','title':'Main\x20Tel\x20No','type':'string'},{'field':'Company_Industry','title':'Industry','type':'string'},{'field':'Company_Comments','title':'Comments','type':'string'}]},'CompanyForm':{'CompanyId':0x0,'LoadRecord':function(lCompanyId){TriSysApex['Pages']['CompanyForm']['CompanyId']=lCompanyId;var fnLoadEntityFormData=function(){setTimeout(function(){TriSysSDK['CShowForm']['readEntityFormDataFromServer']('Company',lCompanyId,TriSysApex['Pages']['CompanyForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['FormLoadDataDelay']);};fnLoadEntityFormData();},'AfterFormDataLoaded':function(lCompanyId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Company');var sTabLi='company-form-tab-addresses';if(!TriSysSDK['EntityFormTabs']['isTabSelected'](sTabLi))TriSysSDK['Controls']['Button']['Click'](sTabLi);else companyForm['TabButtonCallback']('company-form-panel-addresses');var sCompanyName=$('#Company_Name')['val']();lCompanyId>0x0&&(TriSysApex['BrowserHistory']['Menu']['Add']('Company',lCompanyId,sCompanyName),TriSysApex['Pages']['CompanyForm']['AsynchronousEntityUpdateConfig'](lCompanyId));TriSysApex['FormsManager']['ShowRecordIdInCaption']('Company',lCompanyId,sCompanyName),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('company-form-attributes'),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('company-form-organogram');var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);for(var i=0x0;i<fieldDescriptionsInDOM['length'];i++){var fieldDescription=fieldDescriptionsInDOM[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],objValue=fieldDescription['Value'],sReadonlyField='#'+sDivID+'-readonly';$(sReadonlyField)['text'](objValue);switch(sDivID){case'Company_IndustryId':$(sReadonlyField)['text'](objValue);break;case'Company_WebPage':if(objValue){var sDisplay=objValue;if(objValue['toLowerCase']()['indexOf']('http')<0x0)objValue='http://'+objValue;var iColon=sDisplay['indexOf']('://');if(iColon>0x0)sDisplay=sDisplay['substring'](iColon+0x3);TriSysSDK['DocumentObjectModel']['SetHyperlinkProperties'](sReadonlyField,objValue,sDisplay);}break;case'Company_EMail':if(objValue){var sHyperlink='mailto:'+objValue;TriSysSDK['DocumentObjectModel']['SetHyperlinkProperties'](sReadonlyField,sHyperlink,objValue);}break;case'Company_MainTelNo':if(objValue){var sTelNo=objValue['replace'](/ /g,''),sHyperlink='tel:'+sTelNo;TriSysSDK['DocumentObjectModel']['SetHyperlinkProperties'](sReadonlyField,sHyperlink,objValue);}break;case'CompanyConfigFields_CompanyLogo':var sPhotoPath=objValue;if(sPhotoPath)TriSysSDK['Images']['ShowServerPathInImageTag'](sPhotoPath,sDivID+'-Thumbnail',sDivID+'-Thumbnail2');else TriSysSDK['Images']['AfterFileReferenceDelete'](sDivID+'-Thumbnail',sDivID+'-Thumbnail2',TriSysApex['Constants']['DefaultCompanyImage']);break;}}TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad']('Company',lCompanyId,fieldDescriptions);},'NewRecord':function(lCompanyId){if(TriSysAPI['Operators']['isEmpty'](lCompanyId))lCompanyId=0x0;TriSysApex['FormsManager']['OpenForm']('Company',lCompanyId),setTimeout(function(){TriSysApex['Pages']['CompanyForm']['CompanyId']=0x0,TriSysSDK['CShowForm']['clearFormFields']('Company',TriSysApex['Pages']['CompanyForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['NewRecordFormDelay']);},'SaveRecord':function(){if(!TriSysSDK['Miscellaneous']['PreventButtonDoubleClick']())return;var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(lCompanyId==0x517e){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){if(userCredentials['Database']=='OpusNet'){var sMessage='This\x20is\x20a\x20demonstration\x20database,\x20and\x20you\x20are\x20not\x20permitted\x20to\x20update\x20this\x20particular\x20company\x20record.';TriSysApex['UI']['ShowMessage'](sMessage);return;}}}var fnBeforeSaveFieldDescriptions=function(fieldDescriptions){for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i];switch(fieldDescription['TableFieldName']){case'Company_IndustryId':break;}}var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);return fieldDescriptionsInDOM;},sCompanyName=$('#Company_Name')['val'](),fnAfterSaveRecord=function(lRecordId){TriSysApex['Pages']['CompanyForm']['CompanyId']=lRecordId,TriSysApex['Forms']['EntityForm']['AfterSaveConfirmation']('Company',lRecordId),TriSysApex['BrowserHistory']['Menu']['Add']('Company',lRecordId,sCompanyName),TriSysApex['FormsManager']['ShowRecordIdInCaption']('Company',lRecordId,sCompanyName),TriSysSDK['Attributes']['SaveEntitySkills']('Company',lRecordId,'company-form-attributes'),TriSysSDK['CompanyOrganogram']['Save'](lRecordId,'company-form-organogram'),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Company',lRecordId);},mandatoryFields=[{'Name':'Company_Name','Caption':'Name'}];TriSysApex['Forms']['EntityForm']['SaveEvent']('Company',lCompanyId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields);},'OpenFindDialogue':function(fnCallback){var fnSelectedCompany=function(selectedRow){if(!selectedRow)return;var lCompanyId=selectedRow['Company_CompanyId'];if(lCompanyId>0x0){if(fnCallback)fnCallback(lCompanyId);else TriSysApex['Pages']['CompanyForm']['LoadRecord'](lCompanyId);return!![];}};TriSysApex['ModalDialogue']['Companies']['Select'](fnSelectedCompany);},'LoadAddressesAndContactsGrid':function(sDivTag,fnPostPopulationCallback,bForceRefresh){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Company',sDivTag)&&!bForceRefresh)return;var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'],fnPopulationByFunction={'API':'Company/ListAddressesAndContacts','Parameters':function(request){request['CompanyId']=lCompanyId;},'DataTableFunction':function(response){return response['List'];}};TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sDivTag+'-Grid','Title':'Addresses/Contacts','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':TriSysApex['Pages']['CompanyForm']['AddressesAndContacts']['Columns'],'KeyColumnName':'ContactId','DrillDownFunction':function(rowData){var lContactId=rowData['ContactId'],lAddressId=rowData['AddressId'];if(lContactId>0x0)TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);else TriSysApex['Pages']['CompanyForm']['EditAddress'](lAddressId);},'MultiRowSelect':!![],'PostPopulationCallback':fnPostPopulationCallback,'PreviewButtonFunction':function(rowData){var lContactId=rowData['ContactId'];TriSysApex['EntityPreview']['Contact']['Open'](lContactId);},'PreviewButtonTooltip':'Contact\x20Preview','LinkedInButtonColumn':{'enabled':!![],'contactIdField':'ContactId'},'HyperlinkedColumns':['Contact'],'HyperlinkedEntities':{'EntityName':'Contact','Columns':[{'field':'WorkEMail','linkType':'Function','fnCallback':function(row){TriSysSDK['Grid']['HyperlinkedColumns']['SpecialFields']['DrillDown'](row,'E-Mail','WorkEMail');}},{'field':'PersonalEMail','linkType':'Function','fnCallback':function(row){TriSysSDK['Grid']['HyperlinkedColumns']['SpecialFields']['DrillDown'](row,'E-Mail','PersonalEMail');}},{'field':'WorkTelNo','linkType':'Function','fnCallback':function(row){TriSysSDK['Grid']['HyperlinkedColumns']['SpecialFields']['DrillDown'](row,'Phone','WorkTelNo');}},{'field':'WorkMobile','linkType':'Function','fnCallback':function(row){TriSysSDK['Grid']['HyperlinkedColumns']['SpecialFields']['DrillDown'](row,'Phone','WorkMobile');}},{'field':'PersonalMobile','linkType':'Function','fnCallback':function(row){TriSysSDK['Grid']['HyperlinkedColumns']['SpecialFields']['DrillDown'](row,'Phone','PersonalMobile');}}]},'MobileVisibleColumns':[{'field':'Contact'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20Contact\x20#</strong><br\x20/>'+'<i>#:\x20CompanyAddress\x20#</i></td>'});},'LoadRequirementsGrid':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Company',sDivTag))return;var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'],fnPopulationByFunction={'API':'Requirements/List','Parameters':function(request){request['CompanyId']=lCompanyId;},'DataTableFunction':function(response){return response['List'];}};TriSysApex['Pages']['RequirementsForm']['EntityFormLoadRequirementsGrid'](sDivTag,fnPopulationByFunction,fnPostPopulationCallback);},'LoadPlacementsGrid':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Company',sDivTag))return;var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'],fnPopulationByFunction={'API':'Placements/List','Parameters':function(request){request['CompanyId']=lCompanyId;},'DataTableFunction':function(response){return response['List'];}};TriSysApex['Pages']['PlacementsForm']['EntityFormLoadPlacementsGrid'](sDivTag,fnPopulationByFunction,fnPostPopulationCallback);},'LoadNotesHistoryGrid':function(sDivTag,fnPostPopulationCallback){var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'],fnParameters=function(request){request['CompanyId']=lCompanyId,request['IncludeFullTaskDescriptionField']=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Company','Company\x20Tasks\x20Export',![]);},bScheduled=![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Company',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadScheduledTasksGrid':function(sDivTag,fnPostPopulationCallback){var lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'],fnParameters=function(request){request['CompanyId']=lCompanyId,request['IncludeFullTaskDescriptionField']=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue']('Company','Company\x20Tasks\x20Export',![]);},bScheduled=!![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Company',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'AddressesAndContacts':{'Columns':[{'field':'AddressId','title':'AddressID','type':'number','width':0x78,'hidden':!![]},{'field':'ContactId','title':'ContactID','type':'number','width':0x78,'hidden':!![]},{'field':'CompanyAddress','title':'Address','type':'string','width':0x12c},{'field':'AddressType','title':'Type','type':'string','width':0x96},{'field':'Contact','title':'Contact','type':'string','width':0xc8,'sticky':!![],'lockable':!![]},{'field':'Contact_ContactType','title':'Contact\x20Type','type':'string','hidden':![],'width':0x64},{'field':'JobTitle','title':'Job\x20Title','type':'string','width':0xc8},{'field':'WorkTelNo','title':'Work\x20Tel\x20No','type':'string','width':0x96},{'field':'WorkMobile','title':'Work\x20Mobile','type':'string','width':0x96},{'field':'PersonalMobile','title':'Personal\x20Mobile','type':'string','hidden':!![],'width':0x96},{'field':'WorkEMail','title':'Work\x20E-Mail','type':'string','width':0xfa},{'field':'PersonalEMail','title':'Personal\x20E-Mail','type':'string','hidden':!![],'width':0xfa}]},'NewAddress':function(){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;TriSysApex['ModalDialogue']['NewCompanyAddress']['Popup'](lCompanyId,sCompany,0x0,0x0,TriSysApex['Pages']['ContactForm']['SubmitNewCompanyAddress']);},'EditAddress':function(lAddressId){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;if(TriSysAPI['Operators']['isEmpty'](lAddressId)||lAddressId==0x0){lAddressId=0x0;var selectedRows=TriSysSDK['Grid']['GetCheckedRows']('companyForm-AddressesGrid');if(selectedRows&&selectedRows['length']==0x1)lAddressId=selectedRows[0x0]['AddressId'];if(lAddressId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20address\x20to\x20edit.');return;}}TriSysApex['ModalDialogue']['NewCompanyAddress']['Popup'](lCompanyId,sCompany,lAddressId,0x0,TriSysApex['Pages']['ContactForm']['SubmitNewCompanyAddress']);},'DeleteAddress':function(){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;var lAddressId=0x0,selectedRows=TriSysSDK['Grid']['GetCheckedRows']('companyForm-AddressesGrid');if(selectedRows&&selectedRows['length']==0x1)lAddressId=selectedRows[0x0]['AddressId'];if(lAddressId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20address\x20to\x20delete.');return;}var fnYes=function(){var fnSelectAddress=function(selectedRow){if(!selectedRow)return;var lReassignToAddressId=selectedRow['AddressId'];if(lReassignToAddressId==lAddressId){TriSysApex['UI']['ShowMessage']('Please\x20choose\x20a\x20different\x20address.');return;}return TriSysApex['Pages']['CompanyForm']['SubmitCompanyAddressDeletion'](lCompanyId,lAddressId,lReassignToAddressId),!![];};TriSysApex['ModalDialogue']['CompanyAddresses']['Select'](lCompanyId,sCompany,0x0,lAddressId,fnSelectAddress);},sAddress=selectedRows[0x0]['CompanyAddress'],sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20company\x20address:\x20<br\x20/>'+sAddress+'<br\x20/><br\x20/>'+'All\x20contacts\x20will\x20need\x20to\x20be\x20assigned\x20to\x20a\x20different\x20company\x20address?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Company\x20Address','Yes',fnYes,'No');},'AfterChangeToCompanyAddressesOrContacts':function(){TriSysApex['Pages']['CompanyForm']['LoadAddressesAndContactsGrid']('companyForm-AddressesGrid',null,!![]);},'SubmitCompanyAddressDeletion':function(lCompanyId,lAddressId,lReassignToAddressId){var CCompanyDeleteAddressRequest={'CompanyId':lCompanyId,'DeleteAddressId':lAddressId,'ReassignToAddressId':lReassignToAddressId},payloadObject={};payloadObject['URL']='Company/DeleteAddress',payloadObject['OutboundDataPacket']=CCompanyDeleteAddressRequest,payloadObject['InboundDataFunction']=function(CCompanyDeleteAddressResponse){TriSysApex['UI']['HideWait']();if(CCompanyDeleteAddressResponse){if(CCompanyDeleteAddressResponse['Success'])TriSysApex['UI']['CloseModalPopup'](),TriSysApex['Pages']['CompanyForm']['AfterChangeToCompanyAddressesOrContacts']();else TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitCompanyAddressDeletion\x20Error:\x20'+CCompanyDeleteAddressResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitCompanyAddressDeletion\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitCompanyAddressDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Address...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenContact':function(){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;var lContactId=0x0,selectedRows=TriSysSDK['Grid']['GetCheckedRows']('companyForm-AddressesGrid');if(selectedRows&&selectedRows['length']==0x1)lContactId=selectedRows[0x0]['ContactId'];if(lContactId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20contact\x20to\x20open.');return;}TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);},'NewContact':function(){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;TriSysApex['ModalDialogue']['NewCompanyContact']['Popup']({'CompanyId':lCompanyId,'Company':sCompany},TriSysApex['Pages']['CompanyForm']['SubmitNewCompanyContact']);},'SubmitNewCompanyContact':function(lCompanyId,contact,lAddressId,bEditAfterSave,options){var CCompanyAddContactRequest={'CompanyId':lCompanyId,'Contact':contact,'AddressId':lAddressId},payloadObject={};payloadObject['URL']='Company/AddContact',payloadObject['OutboundDataPacket']=CCompanyAddContactRequest,payloadObject['InboundDataFunction']=function(CCompanyAddContactResponse){TriSysApex['UI']['HideWait']();if(CCompanyAddContactResponse){if(CCompanyAddContactResponse['Success']){TriSysApex['UI']['CloseModalPopup']();if(options){if(options['Callback'])options['Callback'](CCompanyAddContactResponse['ContactId'],contact);}else{TriSysApex['Pages']['CompanyForm']['AfterChangeToCompanyAddressesOrContacts']();if(bEditAfterSave)TriSysApex['FormsManager']['OpenForm']('Contact',CCompanyAddContactResponse['ContactId']);}}else TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitNewCompanyContact\x20Error:\x20'+CCompanyAddContactResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitNewCompanyContact\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitNewCompanyContact:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Contact...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteContact':function(){var sCompany=$('#Company_Name')['val'](),lCompanyId=TriSysApex['Pages']['CompanyForm']['CompanyId'];if(!lCompanyId||lCompanyId<=0x0||!sCompany)return;var lContactId=0x0,selectedRows=TriSysSDK['Grid']['GetCheckedRows']('companyForm-AddressesGrid');if(selectedRows&&selectedRows['length']==0x1)lContactId=selectedRows[0x0]['ContactId'];if(lContactId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20a\x20single\x20contact\x20to\x20delete.');return;}var fnYes=function(){var fnSelectCompanyContact=function(selectedRow){if(!selectedRow)return;var lReassignToContactId=selectedRow['ContactId'];return TriSysApex['Pages']['CompanyForm']['SubmitCompanyContactDeletion'](lCompanyId,lContactId,lReassignToContactId),!![];};TriSysApex['ModalDialogue']['CompanyContacts']['Select'](lCompanyId,sCompany,lContactId,fnSelectCompanyContact);},sContact=selectedRows[0x0]['Contact'],sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20contact:\x20<br\x20/>'+sContact+'<br\x20/>'+'All\x20linked\x20records\x20such\x20as\x20requirements,\x20placements\x20etc..\x20\x20will\x20need\x20to\x20be\x20assigned\x20to\x20a\x20different\x20company\x20contact?';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Company\x20Contact','Yes',fnYes,'No');},'SubmitCompanyContactDeletion':function(lCompanyId,lContactId,lReassignToContactId,fnCallback,options){var CContactDeleteRequest={'DeleteContactId':lContactId,'ReassignToContactId':lReassignToContactId};if(options)CContactDeleteRequest['RemoveRequirementCandidateLinks']=options['RemoveRequirementCandidateLinks'];var payloadObject={};payloadObject['URL']='Contact/Delete',payloadObject['OutboundDataPacket']=CContactDeleteRequest,payloadObject['InboundDataFunction']=function(CContactDeleteResponse){TriSysApex['UI']['HideWait']();if(CContactDeleteResponse){if(CContactDeleteResponse['Success']){TriSysApex['UI']['CloseModalPopup']();if(lCompanyId>0x0)TriSysApex['Pages']['CompanyForm']['AfterChangeToCompanyAddressesOrContacts']();else{if(fnCallback)fnCallback();else TriSysApex['Pages']['ContactForm']['NewRecord']();}}else{if(CContactDeleteResponse['ReferentialIntegrityError']){var sWarningMessage=CContactDeleteResponse['ReferentialIntegrityError']['replace'](/\r\n/g,'<br\x20/>');if(CContactDeleteResponse['ReferentialIntegrityRequirementCandidateOnly']){var fnDeleteAnyway=function(){var options={'RemoveRequirementCandidateLinks':!![]};return setTimeout(function(){TriSysApex['Pages']['CompanyForm']['SubmitCompanyContactDeletion'](lCompanyId,lContactId,lReassignToContactId,fnCallback,options);},0xa),!![];};sWarningMessage+='<br\x20/><br\x20/>'+'However,\x20you\x20can\x20remove\x20this\x20candidate\x20from\x20these\x20requirements\x20before\x20deletion.',TriSysApex['UI']['questionYesNo'](sWarningMessage,'Delete\x20Candidate','Delete\x20Anyway',fnDeleteAnyway,'Cancel');}else TriSysApex['UI']['ShowMessage'](sWarningMessage);}else TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitCompanyContactDeletion\x20Error:\x20'+CContactDeleteResponse['ErrorMessage']);}return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.ContactForm.SubmitCompanyContactDeletion\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.ContactForm.SubmitCompanyContactDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Contact...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'AsynchronousEntityUpdateConfig':function(lContactId){var taskGridSpecification=new TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecification']();taskGridSpecification['UniqueID']='CompanyForm.TaskGrid',taskGridSpecification['EntityName']='Task',taskGridSpecification['CallOnRecordIdChangeOnly']=![],taskGridSpecification['UpdateCallbackFunction']=function(lTaskId){var sGrid='companyForm-NotesHistoryGrid';$('#'+sGrid)['length']>0x0&&(TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Company',sGrid),TriSysApex['Pages']['CompanyForm']['LoadNotesHistoryGrid'](sGrid,null),sGrid='companyForm-ScheduledTasksGrid',TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Company',sGrid),TriSysApex['Pages']['CompanyForm']['LoadScheduledTasksGrid'](sGrid,null));},TriSysApex['FormsManager']['EntityUpdateController']['RegisterFormWidgetSpecification'](taskGridSpecification);},'DeleteRecord':function(lCompanyId,sCompanyName,fnCallback){if(!lCompanyId||lCompanyId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20an\x20existing\x20company\x20record\x20to\x20delete.');return;}var fnYesReassign=function(){var fnSelectCompany=function(selectedRow){if(!selectedRow)return;var lReassignToCompanyId=selectedRow['Company_CompanyId'];return TriSysApex['Pages']['CompanyForm']['SubmitCompanyDeletion'](lCompanyId,lReassignToCompanyId,fnCallback),!![];};return setTimeout(function(){TriSysApex['ModalDialogue']['Companies']['Select'](fnSelectCompany);},0x64),!![];},fnYesNoReassign=function(){return TriSysApex['Pages']['CompanyForm']['SubmitCompanyDeletion'](lCompanyId,0x0,fnCallback),!![];},sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20re-assign\x20all\x20associated\x20client\x20contacts,\x20addresses,\x20requirements,\x20tasks\x20etc..\x20for\x20company:\x20<b>'+sCompanyName+'</b>'+'<br\x20/>to\x20another\x20company\x20before\x20deletion?';TriSysApex['UI']['questionYesNoCancel'](sMessage,'Delete\x20Company','Yes,\x20and\x20Re-Assign\x20Company',fnYesReassign,'No/Cancel');},'SubmitCompanyDeletion':function(lCompanyId,lReassignToCompanyId,fnCallback){var CCompanyDeleteRequest={'DeleteCompanyId':lCompanyId,'ReassignToCompanyId':lReassignToCompanyId},payloadObject={};payloadObject['URL']='Company/Delete',payloadObject['OutboundDataPacket']=CCompanyDeleteRequest,payloadObject['InboundDataFunction']=function(CCompanyDeleteResponse){TriSysApex['UI']['HideWait']();if(CCompanyDeleteResponse){if(CCompanyDeleteResponse['Success']){if(fnCallback)fnCallback();}else TriSysApex['UI']['ShowError']('TriSysApex.Pages.CompanyForm.SubmitCompanyDeletion\x20Error:\x20'+CCompanyDeleteResponse['ErrorMessage']);return;}TriSysApex['UI']['ShowError']('TriSysApex.Pages.CompanyForm.SubmitCompanyDeletion\x20Error:\x20NULL\x20response');},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.Pages.CompanyForm.SubmitCompanyDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Company...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'RequirementsForm':{'Columns':[{'field':'Requirement_RequirementId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Requirement_RequirementReference','title':'Reference','type':'string'},{'field':'Requirement_RequirementEntityType','title':'Type','type':'string'},{'field':'Requirement_JobTitle','title':'Job\x20Title','type':'string'},{'field':'RequirementCompany_Name','title':'Company','type':'string'},{'field':'RequirementContact_FullName','title':'Contact','type':'string'},{'field':'Requirement_RequirementStatus','title':'Status','type':'string'},{'field':'Requirement_DateInitiated','title':'Initiated','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'Requirement_EarliestStartDate','title':'Earliest\x20Start','type':'date','format':'{0:dd\x20MMM\x20yyyy}'},{'field':'Requirement_Fee','title':'Fee','hidden':!![],'type':'string'},{'field':'Requirement_SiteAddress','title':'Site\x20Address','hidden':!![],'type':'string'},{'field':'Requirement_UserName','title':'Consultant','hidden':!![],'type':'string'},{'field':'Requirement_Comments','title':'Comments','hidden':!![],'type':'string'},{'field':'Requirement_CVSentCount','title':'CV\x20Sent\x20Count','hidden':!![],'type':'number','width':0x96},{'field':'Requirement_InterviewCount','title':'Interview\x20Count','hidden':!![],'type':'number','width':0x96}],'MobileVisibleColumns':[{'field':'Requirement_RequirementReference','title':'Job\x20Details'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20Requirement_RequirementReference\x20#\x20(#:\x20Requirement_RequirementEntityType\x20#)</strong><br\x20/>#:\x20Requirement_JobTitle\x20#<br\x20/>'+'#:\x20Requirement_Fee\x20#<br\x20/>Start\x20Date:\x20#:\x20kendo.format(\x22{0:dd\x20MMM\x20yyyy}\x22,\x20Requirement_EarliestStartDate)\x20#<hr></td>','EntityFormLoadRequirementsGrid':function(sDivTag,fnPopulationByFunction,fnPostPopulationCallback){TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':'grdRequirements','Title':'Requirements','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':TriSysApex['Pages']['RequirementsForm']['Columns'],'MobileVisibleColumns':TriSysApex['Pages']['RequirementsForm']['MobileVisibleColumns'],'MobileRowTemplate':TriSysApex['Pages']['RequirementsForm']['MobileRowTemplate'],'KeyColumnName':'Requirement_RequirementId','DrillDownFunction':function(rowData){TriSysApex['FormsManager']['OpenForm']('Requirement',rowData['Requirement_RequirementId']);},'MultiRowSelect':!![],'PostPopulationCallback':fnPostPopulationCallback,'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'HyperlinkedColumns':['Requirement_RequirementReference'],'HyperlinkedEntities':{'EntityName':'Requirement','Columns':[{'field':'RequirementCompany_Name','linkType':'Company'},{'field':'RequirementContact_FullName','linkType':'Client\x20Contact'}]}});}},'RequirementForm':{'RequirementId':0x0,'ContactId':0x0,'CompanyId':0x0,'UserId':0x0,'AddressId':0x0,'LoadRecord':function(lRequirementId){TriSysApex['Pages']['RequirementForm']['RequirementId']=lRequirementId;var fnLoadEntityFormData=function(){setTimeout(function(){TriSysSDK['CShowForm']['readEntityFormDataFromServer']('Requirement',lRequirementId,TriSysApex['Pages']['RequirementForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['FormLoadDataDelay']),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('requirement-form-attributes');};fnLoadEntityFormData();},'AfterFormDataLoaded':function(lRequirementId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Requirement');var sHistory=$('#RequirementConfigFields_RequirementReference')['val']()+':\x20'+TriSysSDK['CShowForm']['GetJobTitleFromField']('RequirementConfigFields_JobTitle');if(lRequirementId>0x0)TriSysApex['BrowserHistory']['Menu']['Add']('Requirement',lRequirementId,sHistory),TriSysApex['Pages']['RequirementForm']['AsynchronousEntityUpdateConfig'](lRequirementId);else{$('#requirememt-form-find-contact-button-gap-td')['show'](),$('#requirememt-form-find-contact-button-td')['show'](),TriSysSDK['CShowForm']['setDatePickerValue']('RequirementConfigFields_DateInitiated',new Date()),TriSysSDK['Controls']['NumericSpinner']['SetValue']('RequirementConfigFields_NumberRequired',0x1);var sDefaultRequirementType=TriSysApex['Cache']['SystemSettingManager']['GetValue']('Requirement:\x20Default\x20Type');if(sDefaultRequirementType)TriSysSDK['CShowForm']['SetTextInCombo']('Requirement_Type',sDefaultRequirementType);}TriSysApex['FormsManager']['ShowRecordIdInCaption']('Requirement',lRequirementId,sHistory);var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);for(var i=0x0;i<fieldDescriptionsInDOM['length'];i++){var fieldDescription=fieldDescriptionsInDOM[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],objValue=fieldDescription['Value'],sDisplayValue=fieldDescription['DisplayValue'];switch(sDivID){case'Requirement_UserId':var lUserId=objValue;if(lUserId<=0x0){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();lUserId=userCredentials['LoggedInUser']['UserId'];}TriSysApex['Pages']['RequirementForm']['UserId']=lUserId;var sUserName=TriSysApex['Pages']['ContactForm']['GetUserNameFromID'](lUserId);$('#'+sDivID)['val'](sUserName);break;case'Requirement_AddressId':TriSysApex['Pages']['RequirementForm']['AddressId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'Requirement_ContactId':TriSysApex['Pages']['RequirementForm']['ContactId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'Requirement_CompanyId':TriSysApex['Pages']['RequirementForm']['CompanyId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'RequirementConfigFields_SiteAddressId':break;case'RequirementConfigFields_WebText':break;}}var sType=TriSysSDK['CShowForm']['GetTextFromCombo']('Requirement_Type'),bPermanent=sType=='Permanent';TriSysApex['Pages']['RequirementForm']['DisplayTypeControls'](bPermanent);var bRequirement=!![];ctrlPermanentSalary['Initialise'](bRequirement),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad']('Requirement',lRequirementId,fieldDescriptions);if(lRequirementId>0x0)TriSysSDK['Controls']['Button']['Click']('requirement-form-tab-shortlist-li');},'DisplayTypeControls':function(bPermanent){var sTabVisible='requirement-form-tab-'+(bPermanent?'permanent':'contract')+'-li',sTabInvisible='requirement-form-tab-'+(!bPermanent?'permanent':'contract')+'-li';$('#'+sTabVisible)['show'](),$('#'+sTabInvisible)['hide'](),TriSysSDK['Controls']['Button']['Click'](sTabVisible);if(bPermanent)ctrlPermanentSalary['RequirementCalculationEngine']();},'AssignContactLink':function(){var fnSelectContact=function(selectedRow){if(!selectedRow)return;var lContactId=selectedRow['ContactId'],lCompanyId=selectedRow['CompanyId'],lAddressId=selectedRow['AddressId'],sContactName=selectedRow['Christian']+'\x20'+selectedRow['Surname'],sCompany=selectedRow['Name'],sAddress=selectedRow['Street']+'\x0a'+selectedRow['City']+'\x0a'+selectedRow['County']+'\x0a'+selectedRow['PostCode'];$('#Requirement_ContactId')['val'](sContactName),$('#Requirement_CompanyId')['val'](sCompany),$('#Requirement_AddressId')['val'](sAddress),TriSysApex['Pages']['RequirementForm']['ContactId']=lContactId,TriSysApex['Pages']['RequirementForm']['CompanyId']=lCompanyId,TriSysApex['Pages']['RequirementForm']['AddressId']=lAddressId;var values={'ContactId':lContactId,'CompanyId':lCompanyId,'AddressId':lAddressId};return TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLinkChange']('Requirement',TriSysApex['Pages']['RequirementForm']['RequirementId'],values),!![];};TriSysApex['ModalDialogue']['ClientContacts']['Select'](fnSelectContact);},'AddContactLink':function(lContactId){var CReadContactRequest={'ContactRecord':{'ContactId':lContactId}},payloadObject={};payloadObject['URL']='Contacts/ReadContact',payloadObject['OutboundDataPacket']=CReadContactRequest,payloadObject['InboundDataFunction']=function(CReadContactResponse){if(CReadContactResponse){if(CReadContactResponse['Success']){var contact=CReadContactResponse['ContactRecord'],lContactId=contact['ContactId'],lCompanyId=contact['CompanyId'],lAddressId=contact['CompanyAddressId'],sContactName=contact['FullName'],sCompany=contact['CompanyName'],sAddress=contact['CompanyAddressStreet']+'\x0a'+contact['CompanyAddressCity']+'\x0a'+contact['CompanyAddressCounty']+'\x0a'+contact['CompanyAddressPostCode'];$('#Requirement_ContactId')['val'](sContactName),$('#Requirement_CompanyId')['val'](sCompany),$('#Requirement_AddressId')['val'](sAddress),TriSysApex['Pages']['RequirementForm']['ContactId']=lContactId,TriSysApex['Pages']['RequirementForm']['CompanyId']=lCompanyId,TriSysApex['Pages']['RequirementForm']['AddressId']=lAddressId;var values={'ContactId':lContactId,'CompanyId':lCompanyId,'AddressId':lAddressId};TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLinkChange']('Requirement',TriSysApex['Pages']['RequirementForm']['RequirementId'],values);return;}else TriSysApex['UI']['ShowMessage'](CReadContactResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('ctrlContactPreview.ReadFromWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenContactLink':function(){var lContactId=TriSysApex['Pages']['RequirementForm']['ContactId'];if(lContactId>0x0&&TriSysApex['Pages']['RequirementForm']['RequirementId']==0x0){TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);return;}if(TriSysApex['Pages']['RequirementForm']['RequirementId']>0x0){var sContactName=$('#Requirement_ContactId')['val'](),lCompanyId=TriSysApex['Pages']['RequirementForm']['CompanyId'],sCompanyName=$('#Requirement_CompanyId')['val'](),fnOpenContact=function(){return setTimeout(function(){TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);},0x32),!![];},fnReassign=function(){var fnSelectCompanyContact=function(selectedRow){if(!selectedRow)return;var lReassignToContactId=selectedRow['ContactId'];sContactName=selectedRow['Contact'];var sCompanyAddress=selectedRow['CompanyAddress'],fnUpdated=function(){TriSysApex['Pages']['RequirementForm']['ContactId']=lReassignToContactId,$('#Requirement_ContactId')['val'](sContactName);if(sCompanyAddress)sCompanyAddress=sCompanyAddress['replace'](/, /g,'\x0a');$('#Requirement_AddressId')['val'](sCompanyAddress);};return ctrlRequirementForm['ReAssignClientContactViaWebService'](TriSysApex['Pages']['RequirementForm']['RequirementId'],lReassignToContactId,fnUpdated),!![];};return setTimeout(function(){TriSysApex['ModalDialogue']['CompanyContacts']['Select'](lCompanyId,sCompanyName,lContactId,fnSelectCompanyContact);},0x32),!![];},sMessage='Open\x20or\x20re-assign\x20client\x20contact?';TriSysApex['UI']['questionYesNoCancel'](sMessage,'Requirement\x20Client\x20Contact','Open\x20'+sContactName,fnOpenContact,'Re-Assign\x20Contact',fnReassign,'Cancel');}},'OpenCompanyLink':function(){var lCompanyId=TriSysApex['Pages']['RequirementForm']['CompanyId'];if(lCompanyId>0x0)TriSysApex['FormsManager']['OpenForm']('Company',lCompanyId);},'LoadPlacementsGrid':function(sDivTag,fnPostPopulationCallback){if(TriSysApex['Forms']['EntityForm']['isGridPopulated']('Requirement',sDivTag))return;var lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],fnPopulationByFunction={'API':'Placements/List','Parameters':function(request){request['RequirementId']=lRequirementId;},'DataTableFunction':function(response){return response['List'];}};TriSysApex['Pages']['PlacementsForm']['EntityFormLoadPlacementsGrid'](sDivTag,fnPopulationByFunction,fnPostPopulationCallback);},'LoadNotesHistoryGrid':function(sDivTag,fnPostPopulationCallback){var lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],fnParameters=function(request){request['RequirementId']=lRequirementId;},bScheduled=![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Requirement',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadScheduledTasksGrid':function(sDivTag,fnPostPopulationCallback){var lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],fnParameters=function(request){request['RequirementId']=lRequirementId;},bScheduled=!![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Requirement',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'AsynchronousEntityUpdateConfig':function(lRequirementId){var taskGridSpecification=new TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecification']();taskGridSpecification['UniqueID']='RequirementForm.TaskGrid',taskGridSpecification['EntityName']='Task',taskGridSpecification['CallOnRecordIdChangeOnly']=![],taskGridSpecification['UpdateCallbackFunction']=function(lTaskId){var sGrid='requirementForm-NotesHistoryGrid';$('#'+sGrid)['length']>0x0&&(TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Requirement',sGrid),TriSysApex['Pages']['RequirementForm']['LoadNotesHistoryGrid'](sGrid,null),sGrid='requirementForm-ScheduledTasksGrid',TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Requirement',sGrid),TriSysApex['Pages']['RequirementForm']['LoadScheduledTasksGrid'](sGrid,null));},TriSysApex['FormsManager']['EntityUpdateController']['RegisterFormWidgetSpecification'](taskGridSpecification);},'ChooseSiteAddress':function(){if(TriSysApex['Pages']['RequirementForm']['CompanyId']>0x0){var fnSelectAddress=function(selectedRow){if(!selectedRow)return;var lAddressId=selectedRow['AddressId'],lCompanyId=selectedRow['CompanyId'],sStreet=selectedRow['Street'],sCity=selectedRow['City']?'\x0a'+selectedRow['City']:'',sCounty=selectedRow['County']?'\x0a'+selectedRow['County']:'',sPostCode=selectedRow['PostCode']?'\x0a'+selectedRow['PostCode']:'',sCountry=selectedRow['Country']?'\x0a'+selectedRow['Country']:'';if(!sStreet)sStreet='';var sAddress=sStreet['replace'](/, /g,'\x0a')+sCity+sCounty+sPostCode+sCountry;return $('#RequirementConfigFields_SiteAddress')['val'](sAddress),TriSysApex['Pages']['RequirementForm']['UpdateSiteAddressViaAPI'](TriSysApex['Pages']['RequirementForm']['RequirementId'],lAddressId,sAddress),!![];},sCompany=$('#Requirement_CompanyId')['val']();TriSysApex['ModalDialogue']['CompanyAddresses']['Select'](TriSysApex['Pages']['RequirementForm']['CompanyId'],sCompany,0x0,0x0,fnSelectAddress);}},'UpdateSiteAddressViaAPI':function(lRequirementId,lSiteAddressId,sSiteAddress){var CSetSiteAddressRequest={'RequirementId':lRequirementId,'SiteAddressId':lSiteAddressId,'SiteAddress':sSiteAddress},payloadObject={};payloadObject['URL']='Vacancy/SetSiteAddress',payloadObject['OutboundDataPacket']=CSetSiteAddressRequest,payloadObject['InboundDataFunction']=function(CSetSiteAddressResponse){return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('TriSysApex.Pages.RequirementForm.UpdateSiteAddressViaAPI:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ViewJobOnTriSysWeb':function(){if(TriSysApex['Pages']['RequirementForm']['RequirementId']>0x0){var sWebURL=null;TriSysApex['Pages']['RequirementForm']['OpenJobViaWebAPI'](TriSysApex['Pages']['RequirementForm']['RequirementId']);}},'OpenJobViaWebAPI':function(lRequirementId){if(lRequirementId<=0x0)return;var payloadObject={};payloadObject['URL']='Requirement/JobURL',payloadObject['OutboundDataPacket']={'RequirementId':lRequirementId},payloadObject['InboundDataFunction']=function(CJobURLResponse){if(CJobURLResponse){if(CJobURLResponse['Success']){var sPopupURL=CJobURLResponse['URL'];if(sPopupURL)setTimeout(function(){TriSysSDK['Browser']['OpenURL'](sPopupURL,{'Prompt':![]});},0x64);}else TriSysApex['UI']['ShowMessage'](CJobURLResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.Pages.RequirementForm.OpenJobViaWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenFindDialogue':function(fnCallback){var fnSelectedRequirement=function(selectedRow){if(!selectedRow)return;var lRequirementId=selectedRow['Requirement_RequirementId'];if(lRequirementId>0x0){if(fnCallback)fnCallback(lRequirementId);else TriSysApex['Pages']['RequirementForm']['LoadRecord'](lRequirementId);return!![];}};TriSysApex['ModalDialogue']['Requirements']['Select'](fnSelectedRequirement);},'NewRecord':function(lContactId){var bCompanyFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Company';if(bCompanyFormOpen&&!lContactId)try{companyForm['RequirementGridFileMenuCallback']('file-new');return;}catch(e){}var bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Contact';if(bContactFormOpen&&!lContactId)try{contactForm['RequirementGridFileMenuCallback']('file-new');return;}catch(e){}var fnAfterLoadingForm=function(){TriSysApex['Pages']['RequirementForm']['RequirementId']=0x0,TriSysSDK['CShowForm']['clearFormFields']('Requirement',TriSysApex['Pages']['RequirementForm']['AfterFormDataLoaded']);if(lContactId>0x0)TriSysApex['Pages']['RequirementForm']['AddContactLink'](lContactId);};TriSysApex['FormsManager']['OpenForm']('Requirement',0x0),setTimeout(function(){fnAfterLoadingForm();},TriSysApex['Constants']['NewRecordFormDelay']);},'SaveRecord':function(fnAfterSavingRecord){if(!TriSysSDK['Miscellaneous']['PreventButtonDoubleClick']())return;var lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],bNewRecord=lRequirementId<=0x0,fnBeforeSaveFieldDescriptions=function(fieldDescriptions){for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i];switch(fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']){case'Requirement_UserId':fieldDescription['Value']=TriSysApex['Pages']['RequirementForm']['UserId'];break;case'Requirement_AddressId':fieldDescription['Value']=TriSysApex['Pages']['RequirementForm']['AddressId'];break;case'Requirement_ContactId':fieldDescription['Value']=TriSysApex['Pages']['RequirementForm']['ContactId'];break;case'Requirement_CompanyId':fieldDescription['Value']=TriSysApex['Pages']['RequirementForm']['CompanyId'];break;}}var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);return fieldDescriptionsInDOM;},fnAfterSaveRecord=function(lRecordId){TriSysApex['Pages']['RequirementForm']['RequirementId']=lRecordId,TriSysApex['Forms']['EntityForm']['AfterSaveConfirmation']('Requirement',lRecordId);var sReference=$('#RequirementConfigFields_RequirementReference')['val'](),sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField']('RequirementConfigFields_JobTitle');TriSysApex['BrowserHistory']['Menu']['Add']('Requirement',lRecordId,sReference+':\x20'+sJobTitle),TriSysApex['FormsManager']['ShowRecordIdInCaption']('Requirement',lRecordId,sReference+':\x20'+sJobTitle),TriSysSDK['Attributes']['SaveEntitySkills']('Requirement',lRecordId,'requirement-form-attributes');if(fnAfterSavingRecord)fnAfterSavingRecord(lRecordId);bNewRecord&&TriSysApex['FormsManager']['OpenForm']('Requirement',lRecordId),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Requirement',lRecordId);},mandatoryFields=[{'Name':'Requirement_ContactId','Caption':'Client\x20Contact'},{'Name':'Requirement_CompanyId','Caption':'Company'},{'Name':'Requirement_UserId','Caption':'User'},{'Name':'RequirementConfigFields_EarliestStartDate','Caption':'Earliest\x20Start\x20Date'},{'Name':'RequirementConfigFields_JobTitle','Caption':'Job\x20Title','InvalidValues':['-']}];TriSysApex['Forms']['EntityForm']['SaveEvent']('Requirement',lRequirementId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields);},'DeleteRecord':function(lRequirementId,sReference,sCompany,sJobTitle,fnCallback){!lRequirementId&&(lRequirementId=TriSysApex['Pages']['RequirementForm']['RequirementId'],sReference=$('#RequirementConfigFields_RequirementReference')['val'](),sCompany=$('#Requirement_CompanyId')['val'](),sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField']('RequirementConfigFields_JobTitle'));if(!lRequirementId||lRequirementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20an\x20existing\x20requirement\x20record\x20to\x20delete.');return;}var fnYesDelete=function(){TriSysApex['Pages']['RequirementForm']['SubmitDeletion'](lRequirementId,fnCallback);},sJobSummary=sReference+':\x20'+sJobTitle+'\x20at\x20'+sCompany,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20requirement:'+'<br\x20/><br\x20/>'+'<b>'+sJobSummary+'</b>\x20?'+'<br\x20/><br\x20/>'+'(Warning:\x20All\x20links\x20to\x20this\x20record\x20will\x20also\x20be\x20removed)';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Requirement','Yes',fnYesDelete,'No');},'SubmitDeletion':function(lRequirementId,fnCallback){var fnDeletionComplete=function(){TriSysApex['UI']['CloseModalPopup']();if(fnCallback)fnCallback();else TriSysApex['Pages']['RequirementForm']['NewRecord']();};TriSysApex['Forms']['EntityForm']['SubmitDeletion']('Requirement',lRequirementId,fnDeletionComplete);}},'PlacementsForm':{'Columns':[{'field':'Placement_PlacementId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Placement_Reference','title':'Reference','type':'string'},{'field':'Placement_PlacementEntityType','title':'Type','type':'string'},{'field':'Placement_JobTitle','title':'Job\x20Title','type':'string'},{'field':'CandidateContact_FullName','title':'Candidate','type':'string'},{'field':'Placement_PlacementStatus','title':'Status','type':'string'},{'field':'PlacementCompany_Name','title':'Company','type':'string'},{'field':'PlacementContact_FullName','title':'Client\x20Contact','type':'string'},{'field':'Placement_DateInitiated','title':'Initiated','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'},{'field':'Placement_StartDate','title':'Start\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy}'},{'field':'Placement_EndDate','title':'End\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy}'},{'field':'Placement_Fee','title':'Fee','hidden':!![],'type':'string'},{'field':'Placement_Salary','title':'Salary','hidden':!![],'type':'string'},{'field':'Placement_UserName','title':'Consultant','hidden':!![],'type':'string'}],'MobileVisibleColumns':[{'field':'Placement_Reference','title':'Job\x20Details'}],'MobileRowTemplate':'<td\x20colspan=\x221\x22><strong>#:\x20Placement_Reference\x20#\x20(#:\x20Placement_PlacementEntityType\x20#:\x20#:\x20Placement_PlacementStatus\x20#)</strong><br\x20/>'+'<i>#:\x20Placement_JobTitle\x20#</i><br\x20/>#:\x20PlacementCompany_Name\x20#<br\x20/>'+'Start\x20Date:\x20#:\x20kendo.format(\x22{0:dd\x20MMM\x20yyyy}\x22,\x20Placement_StartDate)\x20#<hr></td>','EntityFormLoadPlacementsGrid':function(sDivTag,fnPopulationByFunction,fnPostPopulationCallback){TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':'grdPlacements','Title':'Placements','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByFunction':fnPopulationByFunction,'Columns':TriSysApex['Pages']['PlacementsForm']['Columns'],'MobileVisibleColumns':TriSysApex['Pages']['PlacementsForm']['MobileVisibleColumns'],'KeyColumnName':'Placement_PlacementId','DrillDownFunction':function(rowData){TriSysApex['FormsManager']['OpenForm']('Placement',rowData['Placement_PlacementId']);},'MultiRowSelect':!![],'PostPopulationCallback':fnPostPopulationCallback,'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'HyperlinkedColumns':['Placement_Reference'],'HyperlinkedEntities':{'EntityName':'Placement','Columns':[{'field':'PlacementCompany_Name','linkType':'Company'},{'field':'PlacementContact_FullName','linkType':'Client\x20Contact'},{'field':'CandidateContact_FullName','linkType':'Candidate\x20Contact'}]}});}},'PlacementForm':{'PlacementId':0x0,'ContactId':0x0,'CompanyId':0x0,'CandidateId':0x0,'RequirementId':0x0,'UserId':0x0,'LoadRecord':function(lPlacementId){TriSysApex['Pages']['PlacementForm']['PlacementId']=lPlacementId;var fnLoadEntityFormData=function(){setTimeout(function(){TriSysSDK['CShowForm']['readEntityFormDataFromServer']('Placement',lPlacementId,TriSysApex['Pages']['PlacementForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['FormLoadDataDelay']),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('placement-form-attributes');};fnLoadEntityFormData();},'AfterFormDataLoaded':function(lPlacementId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Placement');var sHistory=$('#PlacementConfigFields_Reference')['val']()+':\x20'+TriSysSDK['CShowForm']['GetJobTitleFromField']('PlacementConfigFields_JobTitle');lPlacementId>0x0?(TriSysApex['BrowserHistory']['Menu']['Add']('Placement',lPlacementId,sHistory),TriSysApex['Pages']['PlacementForm']['AsynchronousEntityUpdateConfig'](lPlacementId)):($('#placememt-form-find-contact-button-gap-td')['show'](),$('#placememt-form-find-contact-button-td')['show'](),$('#placememt-form-find-candidate-button-gap-td')['show'](),$('#placememt-form-find-candidate-button-td')['show'](),TriSysSDK['CShowForm']['setDatePickerValue']('PlacementConfigFields_DateInitiated',new Date()));TriSysApex['FormsManager']['ShowRecordIdInCaption']('Placement',lPlacementId,sHistory);var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);for(var i=0x0;i<fieldDescriptionsInDOM['length'];i++){var fieldDescription=fieldDescriptionsInDOM[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],objValue=fieldDescription['Value'],sDisplayValue=fieldDescription['DisplayValue'];switch(sDivID){case'Placement_UserId':var lUserId=objValue;if(lUserId<=0x0){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();lUserId=userCredentials['LoggedInUser']['UserId'];}TriSysApex['Pages']['PlacementForm']['UserId']=lUserId;var sUserName=TriSysApex['Pages']['ContactForm']['GetUserNameFromID'](lUserId);$('#'+sDivID)['val'](sUserName);break;case'Placement_AddressId':TriSysApex['Pages']['PlacementForm']['AddressId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'Placement_ContactId':TriSysApex['Pages']['PlacementForm']['ContactId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'Placement_CompanyId':TriSysApex['Pages']['PlacementForm']['CompanyId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'PlacementConfigFields_Candidate':TriSysApex['Pages']['PlacementForm']['CandidateId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;case'Placement_RequirementId':TriSysApex['Pages']['PlacementForm']['RequirementId']=objValue,$('#'+sDivID)['val'](sDisplayValue);break;}}var sType=TriSysSDK['CShowForm']['GetTextFromCombo']('Placement_Type'),bPermanent=sType=='Permanent';TriSysApex['Pages']['PlacementForm']['DisplayTypeControls'](bPermanent);var bRequirement=![];ctrlPermanentSalary['Initialise'](bRequirement),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad']('Placement',lPlacementId,fieldDescriptions);},'DisplayTypeControls':function(bPermanent){var sTabVisible='placement-form-tab-'+(bPermanent?'permanent':'contract')+'-li',sTabInvisible='placement-form-tab-'+(!bPermanent?'permanent':'contract')+'-li';$('#'+sTabVisible)['show'](),$('#'+sTabInvisible)['hide'](),TriSysSDK['Controls']['Button']['Click'](sTabVisible);if(bPermanent)ctrlPermanentSalary['PlacementCalculationEngine']();else ctrlPlacementForm['TabButtonCallback']('placement-form-panel-contract');},'AssignContactLink':function(){var fnSelectContact=function(selectedRow){if(!selectedRow)return;var lContactId=selectedRow['ContactId'],lCompanyId=selectedRow['CompanyId'],lAddressId=selectedRow['AddressId'],sContactName=selectedRow['Christian']+'\x20'+selectedRow['Surname'],sCompany=selectedRow['Name'],sAddress=selectedRow['Street']+'\x0a'+selectedRow['City']+'\x0a'+selectedRow['County']+'\x0a'+selectedRow['PostCode'];return $('#Placement_ContactId')['val'](sContactName),$('#Placement_CompanyId')['val'](sCompany),$('#Placement_AddressId')['val'](sAddress),TriSysApex['Pages']['PlacementForm']['ContactId']=lContactId,TriSysApex['Pages']['PlacementForm']['CompanyId']=lCompanyId,TriSysApex['Pages']['PlacementForm']['AddressId']=lAddressId,!![];};TriSysApex['ModalDialogue']['ClientContacts']['Select'](fnSelectContact);},'OpenContactLink':function(){var lContactId=TriSysApex['Pages']['PlacementForm']['ContactId'];if(lContactId>0x0)TriSysApex['FormsManager']['OpenForm']('Contact',lContactId);},'OpenCompanyLink':function(){var lCompanyId=TriSysApex['Pages']['PlacementForm']['CompanyId'];if(lCompanyId>0x0)TriSysApex['FormsManager']['OpenForm']('Company',lCompanyId);},'AssignCandidateLink':function(){var fnSelectCandidate=function(selectedRow){if(!selectedRow)return;var lCandidateId=selectedRow['ContactId'],lAddressId=selectedRow['AddressId'],sContactName=selectedRow['Christian']+'\x20'+selectedRow['Surname'],sAddress=selectedRow['Street']+'\x0a'+selectedRow['City']+'\x0a'+selectedRow['County']+'\x0a'+selectedRow['PostCode'];return $('#PlacementConfigFields_Candidate')['val'](sContactName),$('#PlacementConfigFields_CandidateAddress')['val'](sAddress),TriSysApex['Pages']['PlacementForm']['CandidateId']=lCandidateId,!![];};TriSysApex['ModalDialogue']['CandidateContacts']['Select'](fnSelectCandidate);},'OpenCandidateLink':function(){var lCandidateId=TriSysApex['Pages']['PlacementForm']['CandidateId'];if(lCandidateId>0x0)TriSysApex['FormsManager']['OpenForm']('Contact',lCandidateId);},'OpenRequirementLink':function(){var lRequirementId=TriSysApex['Pages']['PlacementForm']['RequirementId'];if(lRequirementId>0x0)TriSysApex['FormsManager']['OpenForm']('Requirement',lRequirementId);},'LoadNotesHistoryGrid':function(sDivTag,fnPostPopulationCallback){var lPlacementId=TriSysApex['Pages']['PlacementForm']['PlacementId'],fnParameters=function(request){request['PlacementId']=lPlacementId;},bScheduled=![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Placement',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadScheduledTasksGrid':function(sDivTag,fnPostPopulationCallback){var lPlacementId=TriSysApex['Pages']['PlacementForm']['PlacementId'],fnParameters=function(request){request['PlacementId']=lPlacementId;},bScheduled=!![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Placement',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadTimesheetGrid':function(sGrid){var fnPopulationByFunction={'API':'Timesheets/List','Parameters':function(request){request['PlacementId']=TriSysApex['Pages']['PlacementForm']['PlacementId'];},'DataTableFunction':function(response){return response['List'];}};TriSysWeb['Pages']['Timesheets']['PopulateGrid'](sGrid,'grdTimesheets','Timesheets',fnPopulationByFunction);},'AsynchronousEntityUpdateConfig':function(lPlacementId){var taskGridSpecification=new TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecification']();taskGridSpecification['UniqueID']='PlacementForm.TaskGrid',taskGridSpecification['EntityName']='Task',taskGridSpecification['CallOnRecordIdChangeOnly']=![],taskGridSpecification['UpdateCallbackFunction']=function(lTaskId){var sGrid='placementForm-NotesHistoryGrid';$('#'+sGrid)['length']>0x0&&(TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Placement',sGrid),TriSysApex['Pages']['PlacementForm']['LoadNotesHistoryGrid'](sGrid,null),sGrid='placementForm-ScheduledTasksGrid',TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Placement',sGrid),TriSysApex['Pages']['PlacementForm']['LoadScheduledTasksGrid'](sGrid,null));},TriSysApex['FormsManager']['EntityUpdateController']['RegisterFormWidgetSpecification'](taskGridSpecification);},'OpenFindDialogue':function(fnCallback){var fnSelectedPlacement=function(selectedRow){if(!selectedRow)return;var lPlacementId=selectedRow['Placement_PlacementId'];if(lPlacementId>0x0){if(fnCallback)fnCallback(lPlacementId);else TriSysApex['Pages']['PlacementForm']['LoadRecord'](lPlacementId);return!![];}};TriSysApex['ModalDialogue']['Placements']['Select'](fnSelectedPlacement);},'NewRecord':function(lContactId){var bCompanyFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Company';if(bCompanyFormOpen&&!lContactId)try{companyForm['PlacementGridFileMenuCallback']('file-new');return;}catch(e){}var bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Contact';if(bContactFormOpen&&!lContactId)try{contactForm['PlacementGridFileMenuCallback']('file-new');return;}catch(e){}TriSysApex['FormsManager']['OpenForm']('Placement',0x0),setTimeout(function(){TriSysApex['Pages']['PlacementForm']['PlacementId']=0x0,TriSysSDK['CShowForm']['clearFormFields']('Placement',TriSysApex['Pages']['PlacementForm']['AfterFormDataLoaded']);if(lContactId>0x0)TriSysApex['Pages']['PlacementForm']['AddContactLink'](lContactId);},TriSysApex['Constants']['NewRecordFormDelay']);},'SaveRecord':function(fnAfterSavingRecord){if(!TriSysSDK['Miscellaneous']['PreventButtonDoubleClick']())return;var lPlacementId=TriSysApex['Pages']['PlacementForm']['PlacementId'],bNewRecord=lPlacementId<=0x0,fnBeforeSaveFieldDescriptions=function(fieldDescriptions){for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i];switch(fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']){case'Placement_UserId':fieldDescription['Value']=TriSysApex['Pages']['PlacementForm']['UserId'];break;case'Placement_AddressId':fieldDescription['Value']=TriSysApex['Pages']['PlacementForm']['AddressId'];break;case'Placement_ContactId':fieldDescription['Value']=TriSysApex['Pages']['PlacementForm']['ContactId'];break;case'Placement_CompanyId':fieldDescription['Value']=TriSysApex['Pages']['PlacementForm']['CompanyId'];break;case'PlacementConfigFields_Candidate':fieldDescription['Value']=TriSysApex['Pages']['PlacementForm']['CandidateId'];break;}}var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);return fieldDescriptionsInDOM;},fnAfterSaveRecord=function(lRecordId){TriSysApex['Pages']['PlacementForm']['PlacementId']=lRecordId,TriSysApex['Forms']['EntityForm']['AfterSaveConfirmation']('Placement',lRecordId);var sReference=$('#PlacementConfigFields_Reference')['val'](),sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField']('PlacementConfigFields_JobTitle');TriSysApex['BrowserHistory']['Menu']['Add']('Placement',lRecordId,sReference+':\x20'+sJobTitle),TriSysApex['FormsManager']['ShowRecordIdInCaption']('Placement',lRecordId,sReference+':\x20'+sJobTitle),TriSysSDK['Attributes']['SaveEntitySkills']('Placement',lRecordId,'placement-form-attributes');if(fnAfterSavingRecord)fnAfterSavingRecord(lRecordId);bNewRecord&&TriSysApex['FormsManager']['OpenForm']('Placement',lRecordId),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Placement',lRecordId);},mandatoryFields=[{'Name':'Placement_ContactId','Caption':'Client\x20Contact'},{'Name':'Placement_CompanyId','Caption':'Company'},{'Name':'Placement_UserId','Caption':'User'},{'Name':'PlacementConfigFields_JobTitle','Caption':'Job\x20Title','InvalidValues':['-']},{'Name':'PlacementConfigFields_Candidate','Caption':'Candidate'},{'Name':'PlacementConfigFields_StartDate','Caption':'Start\x20Date'}],sType=TriSysSDK['CShowForm']['GetTextFromCombo']('Placement_Type'),bPermanent=sType=='Permanent';if(!bPermanent){var bException=TriSysApex['LoginCredentials']['isLoggedInToSpecificCompanyAsRecruiter']('TQS\x20Blu\x20Limited');if(!bException)mandatoryFields['push']({'Name':'PlacementConfigFields_EndDate','Caption':'End\x20Date'});}TriSysApex['Forms']['EntityForm']['SaveEvent']('Placement',lPlacementId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields);},'DeleteRecord':function(lPlacementId,sReference,sCompany,sCandidate,sJobTitle,fnCallback){!lPlacementId&&(lPlacementId=TriSysApex['Pages']['PlacementForm']['PlacementId'],sReference=$('#PlacementConfigFields_Reference')['val'](),sCompany=$('#Placement_CompanyId')['val'](),sCandidate=$('#PlacementConfigFields_Candidate')['val'](),sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField']('PlacementConfigFields_JobTitle'));if(!lPlacementId||lPlacementId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20select\x20an\x20existing\x20placement\x20record\x20to\x20delete.');return;}var fnYesDelete=function(){TriSysApex['Pages']['PlacementForm']['SubmitDeletion'](lPlacementId,fnCallback);},sJobSummary=sReference+':\x20'+sJobTitle+',\x20'+sCandidate+'\x20at\x20'+sCompany,sMessage='Are\x20you\x20sure\x20that\x20you\x20wish\x20to\x20delete\x20the\x20placement:'+'<br\x20/><br\x20/>'+'<b>'+sJobSummary+'</b>\x20?'+'<br\x20/><br\x20/>'+'(Warning:\x20All\x20links\x20to\x20this\x20record\x20will\x20also\x20be\x20removed)';TriSysApex['UI']['questionYesNo'](sMessage,'Delete\x20Placement','Yes',fnYesDelete,'No');},'SubmitDeletion':function(lPlacementId,fnCallback){var fnDeletionComplete=function(){TriSysApex['UI']['CloseModalPopup']();if(fnCallback)fnCallback();else TriSysApex['Pages']['PlacementForm']['NewRecord']();};TriSysApex['Forms']['EntityForm']['SubmitDeletion']('Placement',lPlacementId,fnDeletionComplete);},'AddContactLink':function(lContactId){var CReadContactRequest={'ContactRecord':{'ContactId':lContactId}},payloadObject={};payloadObject['URL']='Contacts/ReadContact',payloadObject['OutboundDataPacket']=CReadContactRequest,payloadObject['InboundDataFunction']=function(CReadContactResponse){if(CReadContactResponse){if(CReadContactResponse['Success']){var contact=CReadContactResponse['ContactRecord'],lContactId=contact['ContactId'],lCompanyId=contact['CompanyId'],lAddressId=contact['CompanyAddressId'],sContactName=contact['FullName'],sCompany=contact['CompanyName'],sAddress=contact['CompanyAddressStreet']+'\x0a'+contact['CompanyAddressCity']+'\x0a'+contact['CompanyAddressCounty']+'\x0a'+contact['CompanyAddressPostCode'];$('#Placement_ContactId')['val'](sContactName),$('#Placement_CompanyId')['val'](sCompany),$('#Placement_AddressId')['val'](sAddress),TriSysApex['Pages']['PlacementForm']['ContactId']=lContactId,TriSysApex['Pages']['PlacementForm']['CompanyId']=lCompanyId,TriSysApex['Pages']['PlacementForm']['AddressId']=lAddressId;return;}else TriSysApex['UI']['ShowMessage'](CReadContactResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.Pages.PlacementForm.AddContactLink:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'TimesheetForm':{'TimesheetId':0x0,'PlacementId':0x0,'CandidateId':0x0,'LoadRecord':function(lTimesheetId){TriSysApex['Pages']['TimesheetForm']['TimesheetId']=lTimesheetId;var fnLoadEntityFormData=function(){setTimeout(function(){TriSysSDK['CShowForm']['readEntityFormDataFromServer']('Timesheet',lTimesheetId,TriSysApex['Pages']['TimesheetForm']['AfterFormDataLoaded']);},TriSysApex['Constants']['FormLoadDataDelay']),TriSysApex['ControlPopulationDirty']['ClearPopulationAndDirtyStatus']('timesheet-form-attributes');};fnLoadEntityFormData();},'AfterFormDataLoaded':function(lTimesheetId,fieldDescriptions){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Timesheet');var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);for(var i=0x0;i<fieldDescriptionsInDOM['length'];i++){var fieldDescription=fieldDescriptionsInDOM[i],sDivID=fieldDescription['TableName']+'_'+fieldDescription['TableFieldName'],objValue=fieldDescription['Value'],sDisplayValue=fieldDescription['DisplayValue'];switch(sDivID){case'Timesheet_PlacementId':lTimesheetId>0x0&&(TriSysApex['Pages']['TimesheetForm']['PlacementId']=objValue,$('#'+sDivID)['val'](sDisplayValue));break;case'Timesheet_Candidate':lTimesheetId>0x0&&(TriSysApex['Pages']['TimesheetForm']['CandidateId']=objValue,$('#'+sDivID)['val'](sDisplayValue));break;}}var sHistory=lTimesheetId+':\x20'+$('#Timesheet_PlacementId')['val']();lTimesheetId>0x0?(TriSysApex['BrowserHistory']['Menu']['Add']('Timesheet',lTimesheetId,sHistory),TriSysApex['Pages']['TimesheetForm']['AsynchronousEntityUpdateConfig'](lTimesheetId)):($('#timesheet-form-find-contact-button-gap-td')['show'](),$('#timesheet-form-find-contact-button-td')['show'](),$('#timesheet-form-find-candidate-button-gap-td')['show'](),$('#timesheet-form-find-candidate-button-td')['show'](),TriSysSDK['CShowForm']['setDatePickerValue']('PlacementConfigFields_DateInitiated',new Date()));TriSysApex['FormsManager']['ShowRecordIdInCaption']('Timesheet',lTimesheetId,sHistory);lTimesheetId>0x0&&ctrlTimesheetForm['ShowTimesheetSummary'](lTimesheetId,TriSysApex['Pages']['TimesheetForm']['PlacementId']);var sTabLi='timesheet-form-tab-hours';if(!TriSysSDK['EntityFormTabs']['isTabSelected'](sTabLi))TriSysSDK['Controls']['Button']['Click'](sTabLi);TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityLoad']('Timesheet',lTimesheetId,fieldDescriptions);},'AsynchronousEntityUpdateConfig':function(lTimesheetId){var taskGridSpecification=new TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecification']();taskGridSpecification['UniqueID']='TimesheetForm.TaskGrid',taskGridSpecification['EntityName']='Task',taskGridSpecification['CallOnRecordIdChangeOnly']=![],taskGridSpecification['UpdateCallbackFunction']=function(lTaskId){var sGrid='timesheetForm-NotesHistoryGrid';$('#'+sGrid)['length']>0x0&&(TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Timesheet',sGrid),TriSysApex['Pages']['TimesheetForm']['LoadNotesHistoryGrid'](sGrid,null),sGrid='timesheetForm-ScheduledTasksGrid',TriSysApex['Forms']['EntityForm']['unPopulateFormGrids']('Timesheet',sGrid),TriSysApex['Pages']['TimesheetForm']['LoadScheduledTasksGrid'](sGrid,null));},TriSysApex['FormsManager']['EntityUpdateController']['RegisterFormWidgetSpecification'](taskGridSpecification);},'LoadNotesHistoryGrid':function(sDivTag,fnPostPopulationCallback){var lTimesheetId=TriSysApex['Pages']['TimesheetForm']['TimesheetId'],fnParameters=function(request){request['TimesheetId']=lTimesheetId;},bScheduled=![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Timesheet',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'LoadScheduledTasksGrid':function(sDivTag,fnPostPopulationCallback){var lTimesheetId=TriSysApex['Pages']['TimesheetForm']['TimesheetId'],fnParameters=function(request){request['TimesheetId']=lTimesheetId;},bScheduled=!![];TriSysApex['Forms']['EntityForm']['LoadTaskGrid']('Timesheet',sDivTag,fnParameters,bScheduled,fnPostPopulationCallback);},'OpenPlacementLink':function(){TriSysApex['FormsManager']['OpenForm']('Placement',TriSysApex['Pages']['TimesheetForm']['PlacementId']);},'OpenCandidateLink':function(){TriSysApex['FormsManager']['OpenForm']('Contact',TriSysApex['Pages']['TimesheetForm']['CandidateId']);},'NewRecord':function(){var lUsePlacementId=0x0,lUseCandidateId=0x0,bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Contact';if(bContactFormOpen){lUseCandidateId=TriSysApex['Pages']['ContactForm']['ContactId'];var fnSelectedPlacement=function(lPlacementId){TriSysApex['FormsManager']['OpenForm']('Timesheet',-0x1),setTimeout(function(){TriSysApex['Pages']['TimesheetForm']['TimesheetId']=0x0,TriSysApex['Pages']['TimesheetForm']['PlacementId']=lPlacementId,TriSysApex['Pages']['TimesheetForm']['CandidateId']=lUseCandidateId,TriSysApex['FormsManager']['ShowRecordIdInCaption']('Timesheet',0x0,null),ctrlTimesheetForm['ShowTimesheetSummary'](0x0,lPlacementId);},TriSysApex['Constants']['NewRecordFormDelay']);};TriSysApex['ModalDialogue']['CandidatePlacementSelection'](lUseCandidateId,fnSelectedPlacement);return;}var bPlacementFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Placement';if(bPlacementFormOpen)lUsePlacementId=TriSysApex['Pages']['PlacementForm']['PlacementId'];var bTimesheetFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Timesheet';if(bTimesheetFormOpen)lUsePlacementId=TriSysApex['Pages']['TimesheetForm']['PlacementId'];if(!bTimesheetFormOpen)TriSysApex['FormsManager']['OpenForm']('Timesheet',0x0);setTimeout(function(){TriSysApex['Pages']['TimesheetForm']['TimesheetId']=0x0,TriSysApex['Pages']['TimesheetForm']['PlacementId']=lUsePlacementId,TriSysApex['Pages']['TimesheetForm']['CandidateId']=lUseCandidateId,TriSysApex['FormsManager']['ShowRecordIdInCaption']('Timesheet',0x0,null),ctrlTimesheetForm['ShowTimesheetSummary'](0x0,TriSysApex['Pages']['TimesheetForm']['PlacementId']);},TriSysApex['Constants']['NewRecordFormDelay']);},'SaveRecord':function(){if(!TriSysSDK['Miscellaneous']['PreventButtonDoubleClick']())return;var lTimesheetId=TriSysApex['Pages']['TimesheetForm']['TimesheetId'],bNewRecord=lTimesheetId<=0x0,fnBeforeSaveFieldDescriptions=function(fieldDescriptions){var fdPeriod=null;for(var i=0x0;i<fieldDescriptions['length'];i++){var fieldDescription=fieldDescriptions[i];switch(fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']){case'Timesheet_PlacementId':fieldDescription['Value']=TriSysApex['Pages']['TimesheetForm']['PlacementId'];break;case'Timesheet_TimesheetPeriodId':fieldDescription['Value']=TriSysSDK['CShowForm']['GetTextFromCombo']('Timesheet_Period'),fdPeriod=fieldDescription;break;}}var fieldDescriptionsInDOM=TriSysSDK['CShowForm']['filterOnlyFieldDescriptionsInDOM'](fieldDescriptions);return fieldDescriptionsInDOM['push'](fdPeriod),fieldDescriptionsInDOM;},fnAfterSaveRecord=function(lRecordId){TriSysApex['Pages']['TimesheetForm']['TimesheetId']=lRecordId,TriSysApex['Forms']['EntityForm']['AfterSaveConfirmation']('Timesheet',lRecordId);var sHistory=lRecordId+':\x20'+$('#Timesheet_PlacementId')['val']();TriSysApex['BrowserHistory']['Menu']['Add']('Timesheet',lRecordId,sHistory),TriSysApex['FormsManager']['ShowRecordIdInCaption']('Timesheet',lRecordId,sHistory),TriSysSDK['Attributes']['SaveEntitySkills']('Timesheet',lRecordId,'timesheet-form-attributes');if(bNewRecord){var sPeriodID='Timesheet_Period';TriSysSDK['CShowForm']['ComboEnabled'](sPeriodID,![]);}ctrlTimesheetForm['SaveTimesheetHours'](TriSysApex['Pages']['TimesheetForm']['TimesheetId'],TriSysApex['Pages']['TimesheetForm']['PlacementId']),TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Timesheet',lRecordId);},mandatoryFields=[{'Name':'Timesheet_Candidate','Caption':'Candidate'},{'Name':'Timesheet_PlacementId','Caption':'Placement'}];TriSysApex['Forms']['EntityForm']['SaveEvent']('Timesheet',lTimesheetId,fnBeforeSaveFieldDescriptions,fnAfterSaveRecord,mandatoryFields);}},'TaskSearchForm':{'Columns':[{'field':'TaskId','title':'TaskId','type':'number','hidden':!![]},{'field':'Image','title':'\x20','template':'<img\x20src=\x22images/trisys/16x16/tasktype/#=\x20TaskType\x20#.png?ts=201801201234\x22\x20style=\x22width:\x2024px;\x20height:\x2024px;\x22\x20alt=\x22#=\x20TaskType\x20#\x22>','width':0x2d,'filterable':![],'sortable':![],'attributes':{'style':'text-overflow:\x20clip;'}},{'field':'TaskType','title':'Task\x20Type','type':'string','width':0xfa},{'field':'StartDate','title':'Start\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x96},{'field':'EndDate','title':'End\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x96},{'field':'Scheduled','title':'Scheduled','type':'boolean','template':'#=\x20Scheduled\x20?\x20\x27Yes\x27\x20:\x20\x27No\x27\x20#','hidden':!![]},{'field':'DisplayDescription','title':'Description','type':'string'},{'field':'LoginName','title':'Owner','type':'string','width':0x96},{'field':'TaskContacts','title':'Contacts','type':'string','hidden':!![]},{'field':'TaskUsers','title':'Users','type':'string','hidden':!![]},{'field':'Attributes','title':'Attributes','type':'string','hidden':!![],'width':0xc8},{'field':'Description','title':'Full\x20Description','type':'string','hidden':!![]}]},'FileManagerForm':{'startFolderPopulation':function(sTreeViewDiv){var bRecursive=!![],dataPacket={'RootFolder':null,'Recursion':bRecursive},payloadObject={};payloadObject['URL']='Folders/SubFolders',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var JSONdataset=data;return TriSysApex['Pages']['FileManagerForm']['populateFoldersAfterWebServiceCall'](sTreeViewDiv,JSONdataset),!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManagerForm.startFolderPopulation:\x20',request,status,error);},TriSysApex['UI']['ShowWait'](null,'Traversing\x20file\x20system...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'populateFoldersAfterWebServiceCall':function(sTreeViewDiv,folderHierarchy){var gDriveFolderHierarchy={'Success':!![],'Folders':[{'Name':'G:\x5c','FullPath':'G:\x5c','SubFolders':{'Folders':[]}}]};folderHierarchy['Folders']['forEach'](function(folder){gDriveFolderHierarchy['Folders'][0x0]['SubFolders']['Folders']['push'](folder);});var treeData=TriSysApex['Pages']['FileManagerForm']['recurseTreeSubFolders'](gDriveFolderHierarchy);treeData['forEach'](function(item){item['expanded']=!![];}),$('#'+sTreeViewDiv)['kendoTreeView']({'dataSource':treeData,'select':TriSysApex['Pages']['FileManagerForm']['onFolderSelect']});},'recurseTreeSubFolders':function(subFolders){if(subFolders){var treeData=[];for(var i=0x0;i<subFolders['Folders']['length'];i++){var folder=subFolders['Folders'][i],folderItems=TriSysApex['Pages']['FileManagerForm']['recurseTreeSubFolders'](folder['SubFolders']),item={'text':folder['Name'],'expanded':![],'spriteCssClass':'folder','FullPath':folder['FullPath'],'items':folderItems};treeData['push'](item);}return treeData;}},'onFolderSelect':function(e,fnCallback){var dataItem=this['dataItem'](e['node']);if(!dataItem)return;var sFullPath=dataItem['FullPath'];if(fnCallback)fnCallback(sFullPath);},'startFolderFilesPopulation':function(sFullPath,sGridID){var gridLayout={'Div':sGridID},dataPacket={'Folder':sFullPath},payloadObject={};payloadObject['URL']='Files/Files',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysSDK['Grid']['WaitSpinnerMode'](gridLayout,![]);var JSONdataset=data;return TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImage'](JSONdataset['Files']),TriSysApex['Pages']['FileManagerForm']['PopulateFilesGrid'](sGridID,JSONdataset['Files']),!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysSDK['Grid']['WaitSpinnerMode'](gridLayout,![]),TriSysApex['UI']['ErrorHandlerRedirector']('FileManagerForm.startFolderFilesPopulation:\x20',request,status,error);},TriSysSDK['Grid']['WaitSpinnerMode'](gridLayout,!![]),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DetermineFileTypeForImage':function(Files){if(!Files)return;Files['forEach'](function(file){var sFileType=TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImageFromFilePath'](file['FullPath']);file['ImagePath']=TriSysApex['Pages']['FileManagerForm']['ImagePathForFileType'](sFileType);});},'ImagePathForFileType':function(sFileType){var sImagePath='images/trisys/file-manager/'+sFileType+'.png?ts=201809041121';return sImagePath;},'DetermineFileTypeForImageFromFilePath':function(sFullPath){if(!sFullPath)return;var sFileType='unknown',sSuffix=TriSysApex['Pages']['FileManagerForm']['FileSuffix'](sFullPath);if(sSuffix)switch(sSuffix['toLowerCase']()){case'doc':case'docx':case'rtf':sFileType='word';break;case'xls':case'xlsx':case'csv':sFileType='excel';break;case'pdf':sFileType='acrobat';break;case'js':case'json':sFileType='code';break;case'html':case'htm':case'mht':sFileType='html';break;case'xml':sFileType='xml';break;case'avi':case'mov':case'mpg':case'wmv':sFileType='movie';break;case'wav':case'mp3':sFileType='music';break;case'psd':sFileType='photoshop';break;case'ppt':case'pptx':sFileType='powerpoint';break;case'txt':case'log':case'ini':sFileType='text';break;case'gif':case'png':case'jpg':case'jpeg':case'tiff':case'tif':case'ico':case'bmp':case'webp':sFileType='image';break;case'vsd':sFileType='visio';break;case'msg':case'eml':sFileType='email';break;}else var sFileWithNoSuffix=sFullPath;return sFileType;},'PopulateFilesGrid':function(sDivTag,Files){var sGridName='grdFiles';TriSysSDK['Grid']['VirtualMode']({'Div':sDivTag,'ID':sGridName,'Title':'Files','RecordsPerPage':FileManager['FilesPerPage'](),'PopulationByObject':Files,'Columns':[{'field':'Image','title':'\x20','template':'<img\x20src=\x22#=\x20ImagePath\x20#\x22\x20style=\x22width:\x2024px;\x20height:\x2024px;\x22\x20alt=\x22File\x20Image\x22>','width':0x2d,'filterable':![],'sortable':![],'attributes':{'style':'text-overflow:\x20clip;'}},{'field':'FullPath','title':'Full\x20Path','type':'string','hidden':!![]},{'field':'Name','title':'File\x20Name','type':'string'},{'field':'Size','title':'Size','type':'string','width':0x64,'filterable':![],'sortable':![]},{'field':'DateModified','title':'Date\x20Modified','type':'datetime','width':0x8c,'filterable':![],'template':'#=\x20kendo.toString(kendo.parseDate(DateModified),\x20\x27dd\x20MMM\x20yyyy\x20HH:mm\x27)\x20#'}],'Grouping':![],'MultiRowSelect':!![],'RecordType':'files','KeyColumnName':'FullPath','DrillDownFunction':function(rowData){TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown']('G:\x5c'+rowData['FullPath']);}});},'FileOpenDrillDown':function(sFullPath,bOpenInOriginalApp){var payloadObject={},bApexDocumentEditor=![],sFileType=TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImageFromFilePath'](sFullPath);switch(sFileType){case'word':case'excel':bApexDocumentEditor=!![];break;case'email':if(!bOpenInOriginalApp){TriSysApex['ModalDialogue']['EMailViewer']['Open'](sFullPath);return;}break;}var bWebJobs=TriSysWebJobs['Constants']['LoggedInAsCandidate']||TriSysWebJobs['Constants']['LoggedInAsClient'],sURL=window['location']['href'],bTriSysDotCoDotUK=sURL['indexOf']('.trisys.co.uk')>0x0||TriSysLoad['ApexFramework']['isDeployedInTestMode']();if(!bTriSysDotCoDotUK)bApexDocumentEditor=![];if(bApexDocumentEditor){payloadObject['URL']='Files/FileReferenceInternalToExternalPath',payloadObject['OutboundDataPacket']={'FolderFilePath':sFullPath,'PreserveUNC':!![]},payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();if(data['Success']){var sURL=data['URL'],sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sURL);TriSysApex['Pages']['FileManagerForm']['OpenApexDocumentViewer'](sURL,sName,sFullPath);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManagerForm.FileOpenDrillDown:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFullPath);TriSysApex['UI']['ShowWait'](null,'Opening\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);return;}payloadObject['URL']='Files/GetFileURL',payloadObject['OutboundDataPacket']={'FilePath':sFullPath},payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();if(data['Success']){var sURL=data['URL'],sName=data['FileName'];TriSysApex['Pages']['FileManagerForm']['OpenDocumentViewer'](sURL,sName,sFileType);}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['ErrorHandlerRedirector']('FileManagerForm.FileOpenDrillDown:\x20',request,status,error);};var sName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFullPath);TriSysApex['UI']['ShowWait'](null,'Opening\x20'+sName+'...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenApexDocumentViewer':function(sURL,sName,sFullPath){var sEditor=null,sFileType=TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImageFromFilePath'](sURL);switch(sFileType){case'word':sEditor='WordProcessor';break;case'excel':sEditor='Spreadsheet';break;}var sEditURL=sURL;if(sEditor){var sBase64FilePath=$['base64']['encode'](sURL),sUser=TriSysApex['SignalR']['Communication']['FullLoggedInSenderAndRecipientAddress'](),sBase64UserId=$['base64']['encode'](sUser);sEditURL=TriSysAPI['Constants']['SecureURL']+'apexfilemanager/'+sEditor+'.aspx?file='+sBase64FilePath+'&user='+sBase64UserId,sEditURL+=TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](null,'&');}return TriSysApex['ModalDialogue']['DocumentEditor']['Show'](sName,sEditURL,sFullPath),!![];},'OpenDocumentViewer':function(sURL,sName,sFileType){switch(sFileType){case'image':TriSysSDK['Controls']['FileManager']['OpenDocumentViewer'](sName,sURL,sName);return;case'acrobat':case'code':case'html':case'xml':case'text':TriSysApex['ModalDialogue']['DocumentEditor']['Show'](sName,sURL);return;}TriSysSDK['Browser']['OpenURL'](sURL);},'FileSuffix':function(sFile){if(!sFile)return;var n=sFile['split']('.');if(n){if(n['length']>0x1){var sSuffix=n[n['length']-0x1],iQuestionMark=sSuffix['indexOf']('?');return iQuestionMark>0x0&&(n=sSuffix['split']('?'),sSuffix=n[0x0]),sSuffix;}}},'FileNameFromPath':function(sFile,sFolderSeparator){if(sFile){if(!sFolderSeparator)sFolderSeparator='/';if(sFile['indexOf'](sFolderSeparator)>=0x0){var n=sFile['split'](sFolderSeparator);n&&(n['length']>0x0&&(sFile=n[n['length']-0x1]));}}return sFile;},'FileNameWithoutSuffix':function(sFile,sFolderSeparator){sFile=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFile,sFolderSeparator);if(sFile){var sSuffix=TriSysApex['Pages']['FileManagerForm']['FileSuffix'](sFile);sSuffix&&(sFile=sFile['substring'](0x0,sFile['length']-sSuffix['length']-0x1));}return sFile;},'FileUpdateEvent':function(sFilePath){var sCurrentForm=TriSysApex['FormsManager']['SelectedFormName'];switch(sCurrentForm){case'Contact':contactForm['FileUpdated'](sFilePath);break;case'CVAutoRecognition':CVAutoRecognitionForm['FileUpdated'](sFilePath);break;case'FileManager':FileManager['FileUpdated'](sFilePath);break;}}},'AdminConsoleForm':{'populatedGrids':[{'GridName':'test'}],'isGridPopulated':function(sGridName){var populatedGrids=TriSysApex['Pages']['AdminConsoleForm']['populatedGrids'],gridItem=null;for(var i=0x0;i<populatedGrids['length'];i++){gridItem=populatedGrids[i];if(gridItem['GridName']==sGridName)return!![];}return gridItem={'GridName':sGridName},populatedGrids['push'](gridItem),![];},'PopulateUsersGrid':function(sDivTag,Users){var sGridName='grdUsers';TriSysSDK['Grid']['Initialise']({'Div':sDivTag,'ID':sGridName,'Title':'Users','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':Users,'Columns':[{'Caption':'','Checkable':!![]},{'Caption':'UserId','ColumnName':'UserId'},{'Caption':'Full\x20Name','ColumnName':'FullName'},{'Caption':'Login\x20Name','ColumnName':'LoginName'}],'KeyColumnName':'UserId','DrillDownFunction':'TriSysApex.Pages.UserForm.userRecordDrillDown'});},'PopulateSkillsGrid':function(sDivTag,Skills){var sGridName='grdSkills';if(TriSysApex['Pages']['AdminConsoleForm']['isGridPopulated'](sGridName))return;var Skills=TriSysApex['Cache']['Skills']();TriSysSDK['Grid']['Initialise']({'Div':sDivTag,'ID':sGridName,'Title':'Attributes/Lookups','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':Skills,'Columns':[{'Caption':'','Checkable':!![]},{'Caption':'SkillId','ColumnName':'SkillId'},{'Caption':'Attribute/Skill\x20Name','ColumnName':'Skill'},{'Caption':'Description','ColumnName':'Description'},{'Caption':'Category','ColumnName':'Category'}],'KeyColumnName':'SkillId','DrillDownFunction':'TriSysApex.Pages.SkillForm.skillRecordDrillDown'});},'PopulateSystemSettingsGrid':function(sDivTag,SystemSettings){var sGridName='grdSystemSettings';if(TriSysApex['Pages']['AdminConsoleForm']['isGridPopulated'](sGridName))return;var SystemSettings=TriSysApex['Cache']['SystemSettings']();TriSysSDK['Grid']['Initialise']({'Div':sDivTag,'ID':sGridName,'Title':'System\x20Settings','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':SystemSettings,'Columns':[{'Caption':'','Checkable':!![]},{'Caption':'SystemSettingId','ColumnName':'SystemSettingId','Visible':![]},{'Caption':'Name','ColumnName':'Name'},{'Caption':'Value','ColumnName':'Value'},{'Caption':'Description','ColumnName':'Description'}],'KeyColumnName':'SystemSettingsId','DrillDownFunction':'TriSysApex.Pages.SystemSettingsForm.systemSettingRecordDrillDown'});},'PopulateFieldDescriptionsGrid':function(sDivTag,FieldDescriptions){var sGridName='grdFieldDescriptions';if(TriSysApex['Pages']['AdminConsoleForm']['isGridPopulated'](sGridName))return;var FieldDescriptions=TriSysApex['Cache']['FieldDescriptions']();TriSysSDK['Grid']['Initialise']({'Div':sDivTag,'ID':sGridName,'Title':'Field\x20Descriptions','RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'PopulationByObject':FieldDescriptions,'Columns':[{'Caption':'','Checkable':!![]},{'Caption':'FieldId','ColumnName':'FieldId','Visible':![]},{'Caption':'Table\x20Name','ColumnName':'TableName'},{'Caption':'Table\x20Field\x20Name','ColumnName':'TableFieldName'},{'Caption':'Field\x20Type','ColumnName':'FieldTypeId'},{'Caption':'Lookup','ColumnName':'Lookup'}],'KeyColumnName':'FieldId','DrillDownFunction':'TriSysApex.Pages.FieldDescriptionsForm.fieldDescriptionRecordDrillDown'});}}},'FormsManager':{'OpenForm':function(sFormName,lRecordId,bAddToBrowserHistoryStack,options){if(options){if(options['OnlyOpenEntityRecordIfAlreadyLoaded']){if(sFormName=='Contact'&&lRecordId!=TriSysApex['Pages']['ContactForm']['ContactId'])return;}}TriSysApex['TourGuide']['StopTourForCurrentForm']();if(!TriSysPhoneGap['isConnectedToComms'](!![],'open\x20form:\x20'+sFormName))return;if(sFormName!=TriSysApex['Constants']['LockFormName']){if(TriSysApex['Upgrade']['OpenFormUpgradeCheck']())return;}var pageConfig=TriSysApex['FormsManager']['getPageConfig'](sFormName);if(!pageConfig){TriSysApex['UI']['errorAlert']('Unable\x20to\x20find\x20form:\x20<strong>'+sFormName+'</strong>'+'\x20in\x20the\x20application\x20configuration.'+'<br>'+'Please\x20add\x20this\x20form\x20to\x20the\x20navigation\x20bar\x20as\x20an\x20invisible\x20item\x20to\x20enable\x20it\x20to\x20be\x20opened.');return;}if(TriSysApex['Device']['PhoneGapEnabled']()||TriSysApex['Device']['isPhone']()||TriSysApex['Device']['isTablet']()){TriSysApex['Pages']['Index']['NavBarVisible'](![]);if(!TriSysAPI['Operators']['isEmpty'](pageConfig['ShowMobileBackButton'])){var backButton=$('#mobile-back-button');pageConfig['ShowMobileBackButton']?backButton['show']():backButton['hide']();}}setTimeout(function(){TriSysApex['ErrorHandling']['SendScreenshot'](sFormName,{'OpenForm':!![]});},0xbb8),TriSysApex['FormsManager']['ShowEntityFormInNavBar'](sFormName,pageConfig);var formInstance=TriSysApex['FormsManager']['FormInstances']['GetForm'](sFormName),bDoesFormExist=formInstance?!![]:![];if(bDoesFormExist)TriSysApex['FormsManager']['OpenFormUsingView'](pageConfig,lRecordId,bAddToBrowserHistoryStack,null,options),TriSysApex['Logging']['LogMessage']('Form\x20\x22'+sFormName+'\x22\x20is\x20already\x20open\x20in\x20the\x20framework,\x20so\x20focus\x20on\x20it\x20and\x20its\x20tab.');else{if(TriSysApex['NavigationBar']['MustBeLoggedIn'](pageConfig)){if(!TriSysApex['LoginCredentials']['areUserCredentialsValid']()&&!TriSysApex['LoginCredentials']['areCustomerCredentialsValid']()){var bLoginFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Login';if(bLoginFormOpen)TriSysApex['UI']['ShowMessage']('Please\x20login\x20to\x20access\x20this\x20function.');else{var sLoginFormName=pageConfig['LoginFormName']?pageConfig['LoginFormName']:'Login';if(!pageConfig['LoginFormName']&&pageConfig['FormName']){if(pageConfig['FormName']['toLowerCase']()['indexOf']('candidate')>=0x0)sLoginFormName=TriSysWebJobs['Constants']['CandidateLoginForm'];else{if(pageConfig['FormName']['toLowerCase']()['indexOf']('client')>=0x0)sLoginFormName=TriSysWebJobs['Constants']['ClientLoginForm'];}}TriSysApex['LoginCredentials']['Logoff'](![],sLoginFormName);}return;}}if(pageConfig['DeveloperOnly']){var bIndev=TriSysApex['Pages']['Controller']['isDeveloper']();if(!bIndev){TriSysApex['UI']['ShowMessage']('You\x20must\x20be\x20logged\x20in\x20as\x20a\x20developer\x20to\x20access\x20this\x20function.');return;}}if(pageConfig['SQLLogin']){var sDataServicesKey=TriSysAPI['Session']['DataServicesKey'](),bIsConnected=sDataServicesKey!=null;if(bIsConnected)bIsConnected=TriSysAPI['Data']['VerifyDataServicesKey']();if(!bIsConnected){TriSysWebJobs['APIKeys']['Initialise'](pageConfig,lRecordId);return;}}if(pageConfig['Function']){var fn=TriSysApex['DynamicClasses']['GetObject'](pageConfig['Function']);if(fn){typeof fn==='function'&&fn();return;}}if(!TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',![]),![]))TriSysApex['FormsManager']['FormInstances']['Clear']();TriSysApex['FormsManager']['FormInstances']['AddForm'](pageConfig,lRecordId);if(!options)options={};options['OpeningNewInstanceOfForm']=!![],TriSysApex['FormsManager']['OpenFormUsingView'](pageConfig,lRecordId,bAddToBrowserHistoryStack,null,options);}},'ShowEntityFormInNavBar':function(sFormName,pageConfig){TriSysApex['Forms']['Configuration']['Pages']&&(TriSysApex['FormsManager']['HideEntityFormsInNavBar'](),TriSysApex['Forms']['Configuration']['Pages']['forEach'](function(page){if(page['FormName']==sFormName){const sID=TriSysSDK['Miscellaneous']['EscapeDOMid'](page['FormName'])+'-MenuItem';$('#'+sID)['show']();return;}}));},'HideEntityFormsInNavBar':function(){TriSysApex['Forms']['Configuration']['Pages']&&TriSysApex['Forms']['Configuration']['Pages']['forEach'](function(page){if(page['EntityForm']){const sID=TriSysSDK['Miscellaneous']['EscapeDOMid'](page['FormName'])+'-MenuItem';$('#'+sID)['hide']();}});},'OpenFormUsingView':function(pageConfig,lRecordId,bAddToBrowserHistoryStack,fnAfterLoadingForm,options){var bCheckViewNameAlternativeInPhoneGap=!![];if(options){if(!TriSysAPI['Operators']['isEmpty'](options['IgnorePhoneGap'])){if(options['IgnorePhoneGap'])bCheckViewNameAlternativeInPhoneGap=![];}}var sViewName=pageConfig['ViewName'];if(bCheckViewNameAlternativeInPhoneGap&&TriSysApex['Device']['isPhone']()){if(pageConfig['ViewNamePhone'])sViewName=pageConfig['ViewNamePhone'];}var sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sViewName),bFoundCustomForm=sFileURL!=null;!bFoundCustomForm&&(sFileURL=sViewName);var bDoesFormExist=!![];if(options&&!TriSysAPI['Operators']['isEmpty'](options['OpeningNewInstanceOfForm']))bDoesFormExist=!options['OpeningNewInstanceOfForm'];!bDoesFormExist&&pageConfig['FormName']==pageConfig['EntityName']&&TriSysSDK['CShowForm']['InitialiseFormFields']['MarkFormAsLoaded'](pageConfig['FormName'],![]);if(!sFileURL){TriSysApex['UI']['errorAlert']('Unable\x20to\x20locate\x20suitable\x20form\x20for\x20view:\x20'+pageConfig['FormName']);return;}TriSysApex['FormsManager']['OpenFileInContentRegion'](sFileURL,pageConfig['FormName'],function(){var fnLoadEntityFormData=function(){TriSysWeb['Security']['IsUserLoggedIn']()&&TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null);TriSysApex['FormsManager']['OpenRecordCallback'](pageConfig,lRecordId,bAddToBrowserHistoryStack,options);if(fnAfterLoadingForm)fnAfterLoadingForm();TriSysApex['WhiteLabelling']['AfterOpeningForm'](pageConfig['FormName']);};if(options&&options['PostLoadCallbackFunction']){options['PostLoadCallbackFunction']();return;}if(pageConfig['FormName']==pageConfig['EntityName']){TriSysSDK['CShowForm']['InitialiseFormFields']['WaitUntilFormLoaded'](pageConfig['FormName'],fnLoadEntityFormData);if(pageConfig['ViewNamePhone']&&TriSysApex['Device']['isPhone']())TriSysSDK['CShowForm']['InitialiseFormFields']['MarkFormAsLoaded'](pageConfig['FormName'],!![]);}else fnLoadEntityFormData();});},'OpenFileInContentRegion':function(sFile,sFormName,fnCallback){TriSysApex['FormsManager']['loadPageIntoContentDiv'](sFile,sFormName,function(){if(fnCallback)fnCallback();});},'OpenCustomFileInContentRegion':function(sFileName,sFormName,fnCallback){var sFilePathURL=TriSysApex['CustomFormsAndComponents']['CustomCodeFolderURL']()+sFileName;TriSysApex['FormsManager']['OpenFileInContentRegion'](sFilePathURL,sFormName,fnCallback),TriSysApex['NavigationBar']['HighlightMenuItem'](sFormName);},'OpenRecordCallback':function(pageConfig,lRecordId,bAddToBrowserHistoryStack,options){TriSysApex['FormsManager']['Captions']['SetCaption'](pageConfig['Caption'],pageConfig['ImagePath']),TriSysApex['NavigationBar']['HighlightMenuItem'](pageConfig['FormName']),TriSysApex['Pages']['Index']['onWindowResize'](),TriSysApex['FormsManager']['SelectedFormName']=pageConfig['FormName'],TriSysApex['TourGuide']['ShowTourIfEnabled']();var bOpenRecord=!![];if(lRecordId==-0x1)bOpenRecord=![];bOpenRecord&&TriSysApex['FormsManager']['OpenRecord'](pageConfig,lRecordId,options);var sDocumentTitle=TriSysSDK['Miscellaneous']['CamelCaseToMultipleWords'](TriSysApex['Copyright']['ShortProductNameBrowserTabText']()+'\x20'+pageConfig['FormName']);document['title']=sDocumentTitle;if(TriSysAPI['Operators']['isEmpty'](bAddToBrowserHistoryStack))bAddToBrowserHistoryStack=!![];bAddToBrowserHistoryStack&&TriSysApex['BrowserHistory']['Add'](pageConfig['FormName'],lRecordId),setTimeout(TriSysProUI['kendoUI_Overrides'],0x3e8);},'isFormOpen':function(sFormName){var formInstance=TriSysApex['FormsManager']['FormInstances']['GetForm'](sFormName),bDoesFormExist=formInstance?!![]:![];return bDoesFormExist;},'getPageConfig':function(sFormName){var pageConfig=null;try{pageConfig=TriSysApex['Forms']['Configuration']['GetPage'](sFormName);}catch(ex){}return pageConfig;},'PostLoginFormName':function(){var sCachedPostLoginFormName=TriSysWebJobs['Security']['CachedPostLoginFormName']();if(sCachedPostLoginFormName)return TriSysWebJobs['Security']['CachePostLoginFormName'](''),sCachedPostLoginFormName;for(var i=0x0;i<TriSysApex['Forms']['Configuration']['Pages']['length'];i++){var page=TriSysApex['Forms']['Configuration']['Pages'][i];if(TriSysWebJobs['Constants']['LoggedInAsCandidate']||TriSysWebJobs['Constants']['LoggedInAsClient']){if(TriSysWebJobs['Constants']['LoggedInAsClient']){if(page['PostLoginPageForClient'])return page['FormName'];}else{if(page['PostLoginPageForCandidate'])return page['FormName'];}}else{if(TriSysWeb['Security']['IsUserLoggedIn']()){if(page['PostLoginPageForUser']){var sURL=window['location']['href'],bDashboardVisible=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('Dashboard',!![]));if(page['FormName']=='Dashboard'&&!bDashboardVisible)return null;else{var SupportLoginPrefix='#supportlogin~';if(sURL['toLowerCase']()['indexOf'](SupportLoginPrefix)>0x0){var sBase64=sURL['split'](SupportLoginPrefix)[0x1],eMailAndPassword=TriSysWeb['Security']['DecryptBase64Credentials'](sBase64);if(eMailAndPassword){if(eMailAndPassword['FormName'])return eMailAndPassword['FormName'];}}var iQuestionMark=sURL['indexOf']('?'),bDebugURL=sURL['indexOf']('debug=')>0x0;if(!bDebugURL){if(iQuestionMark>0x0&&sURL['toLowerCase']()['indexOf']('?login')<0x0&&sURL['toLowerCase']()['indexOf']('?recruiter')<0x0)return null;}}return page['FormName'];}}}}},'OpenRecord':function(pageConfig,lRecordId,options){var bCheckLoadRecordAlternativeInPhoneGap=!![];if(options){if(!TriSysAPI['Operators']['isEmpty'](options['IgnorePhoneGap'])){if(options['IgnorePhoneGap'])bCheckLoadRecordAlternativeInPhoneGap=![];}}var sLoadRecordFunction=pageConfig['LoadRecord'];if(bCheckLoadRecordAlternativeInPhoneGap&&TriSysApex['Device']['isPhone']()){if(pageConfig['LoadRecordPhone'])sLoadRecordFunction=pageConfig['LoadRecordPhone'];}if(sLoadRecordFunction){TriSysApex['Forms']['EntityForm']['unPopulateFormGrids'](sLoadRecordFunction);var fnCallFunction=function(){var fn=null;try{fn=TriSysApex['DynamicClasses']['GetObject'](sLoadRecordFunction);}catch(e){}if(!fn)window['setTimeout'](fnCallFunction,0x64);else typeof fn==='function'&&(fn(lRecordId),pageConfig['RecordId']=lRecordId);};fnCallFunction();}if(TriSysApex['FormsManager']['isFlexivaForm'](pageConfig))TriSysFlexiva['Forms']['Events']['RunTime']['LoadRecord'](pageConfig,lRecordId,options);},'CloseForm':function(sPageName,bTabAlreadyClosed){TriSysApex['FormsManager']['FormInstances']['DeleteForm'](sPageName);var sFormDivID=TriSysApex['FormsManager']['ContentDivPrefix']+sPageName;sFormDivID=sFormDivID['toLowerCase']();var existingDiv=document['getElementById'](sFormDivID);if(existingDiv){existingDiv['parentNode']['removeChild'](existingDiv);var pageConfig=TriSysApex['Forms']['Configuration']['GetPage'](sPageName);pageConfig['RecordId']=0x0;!bTabAlreadyClosed&&TriSysApex['FormsManager']['FormInstances']['DeleteForm'](sPageName);if(!TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',![]),![]))TriSysApex['FormsManager']['FormInstances']['RemoveKendoUILeftovers']();}TriSysApex['FormsManager']['SelectedFormName']=null;},'CloseCurrentForm':function(){var sFormName=TriSysApex['FormsManager']['SelectedFormName'];if(sFormName!=''){var formInstance=TriSysApex['FormsManager']['FormInstances']['GetForm'](sFormName);formInstance&&(TriSysApex['FormsManager']['FormInstances']['CanFormInstanceBeClosed'](formInstance)&&(TriSysApex['FormsManager']['CloseForm'](sFormName,![]),TriSysApex['FormsManager']['OpenAppropriateOpenFormInstanceFollowingFormClose']()));}},'CloseAllForms':function(bForceClose,bCloseLoginForm){for(var i=TriSysApex['FormsManager']['FormInstances']['FormArray']['length']-0x1;i>=0x0;i--){var formInstance=TriSysApex['FormsManager']['FormInstances']['FormArray'][i];if(formInstance['PageConfiguration']['CloseWhenCloseAll']||bForceClose){if(TriSysApex['FormsManager']['FormInstances']['CanFormInstanceBeClosed'](formInstance)||bCloseLoginForm){var bTabAlreadyClosed=![];TriSysApex['FormsManager']['CloseForm'](formInstance['PageConfiguration']['FormName'],bTabAlreadyClosed);}}}if(!bCloseLoginForm)TriSysApex['FormsManager']['OpenAppropriateOpenFormInstanceFollowingFormClose']();},'CloseAllOpenFormsExceptCurrent':function(){var sSelectedFormName=TriSysApex['FormsManager']['SelectedFormName'];for(var i=TriSysApex['FormsManager']['FormInstances']['FormArray']['length']-0x1;i>=0x0;i--){var formInstance=TriSysApex['FormsManager']['FormInstances']['FormArray'][i];if(formInstance['PageConfiguration']['FormName']!=sSelectedFormName){var bTabAlreadyClosed=![];TriSysApex['FormsManager']['CloseForm'](formInstance['PageConfiguration']['FormName'],bTabAlreadyClosed);}}},'OpenAppropriateOpenFormInstanceFollowingFormClose':function(){TriSysApex['FormsManager']['Captions']['SetCaption'](null,null);var firstFormInstance=TriSysApex['FormsManager']['FormInstances']['GetFirstInstance']();if(firstFormInstance)TriSysApex['FormsManager']['OpenForm'](firstFormInstance['PageConfiguration']['FormName']);},'sPageLoading':null,'ContentDivPrefix':'div-apex-content-','SelectedFormName':null,'loadPageIntoContentDiv':function(sPageFileName,sPageName,fnCallback){var visibleContentRow=document['getElementById']('divFormContentRow'),hiddenContent=document['getElementById']('divHiddenFormContentDivArray');if(visibleContentRow){var children=visibleContentRow['childNodes'];if(children)for(var i=0x0;i<children['length'];i++){var containerDiv=children[i];if(TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('RetainFormInMemory',![]),![])&&hiddenContent)hiddenContent['appendChild'](containerDiv);else visibleContentRow['removeChild'](containerDiv);}$('#divFormContentRow')['empty']();}var partsOfPath=sPageFileName['split']('/'),sPageFileNameOnly=partsOfPath[partsOfPath['length']-0x1],sFormDivID=TriSysApex['FormsManager']['ContentDivPrefix']+sPageFileNameOnly['replace'](/ /g,'');sFormDivID=sFormDivID['toLowerCase'](),sFormDivID=sFormDivID['replace']('.html','')['replace']('.json','');var existingDiv=document['getElementById'](sFormDivID);if(existingDiv)visibleContentRow['appendChild'](existingDiv),fnCallback&&fnCallback();else{var newDiv=document['createElement']('div');newDiv['setAttribute']('id',sFormDivID);var sOpening=TriSysSDK['Resources']['Message']('TriSysApex.FormsManager.loadPageIntoContentDiv');sOpening=sOpening['replace']('##PageName##',sPageName['replace'](/ /g,'')),visibleContentRow['appendChild'](newDiv),$['ajaxSetup']({'cache':![],'beforeSend':function(xhr){var sSiteKey=TriSysAPI['Session']['DeveloperSiteKey']();xhr['setRequestHeader']('SiteKey',sSiteKey);var sDataServicesKey=TriSysAPI['Session']['DataServicesKey']();if(!TriSysAPI['Operators']['isEmpty'](sDataServicesKey))xhr['setRequestHeader']('DataServicesKey',sDataServicesKey);},'error':function(request,status,error){var sFunction='TriSysApex.FormsManager.loadPageIntoContentDiv:\x20'+sPageFileName;}}),TriSysApex['FormsManager']['sPageLoading']=sPageFileName;const sFormsFolder='forms/',bJSONFile=sPageFileName['indexOf']('.json')>0x0;if(bJSONFile){const bFullPath=sPageFileName['indexOf']('https://')==0x0||sPageFileName['indexOf']('http://')==0x0;if(!bFullPath)sPageFileName=TriSysApex['CustomFormsAndComponents']['CustomCodeFolderURL']()+sFormsFolder+sPageFileName;}else{if(sPageFileName['indexOf']('/')<0x0)sPageFileName=sFormsFolder+sPageFileName;if(sPageFileName['indexOf']('.html')<0x0)sPageFileName+='.html';}TriSysApex['FormsManager']['loadPageIntoDiv'](sFormDivID,sPageFileName,fnCallback);}},'loadPageIntoDiv':function(sDivTag,sPagePath,fnCallback){if(!fnCallback)fnCallback=TriSysApex['FormsManager']['pageLoaded'];var sTemplateHTML=TriSysApex['FormsManager']['getControlTemplateHTML'](sPagePath);if(sTemplateHTML){$('#'+sDivTag)['html'](sTemplateHTML),fnCallback();return;}try{if(!TriSysApex['Environment']['doesFileExist'](sPagePath))TriSysApex['UI']['errorAlert']('File\x20does\x20not\x20exist:\x20'+sPagePath,'Error');else{const bJSONFile=sPagePath['indexOf']('.json')>0x0;if(bJSONFile)TriSysFlexiva['Forms']['Renderer']['OpenURL'](sPagePath,sDivTag,fnCallback);else{const sTimestampedPath=sPagePath+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache']();$('#'+sDivTag)['load'](sTimestampedPath,fnCallback);}}}catch(e){var sError=TriSysApex['Logging']['CatchVariableToText'](e);TriSysApex['UI']['errorAlert'](sError,'Error');}},'loadControlIntoDiv':function(sDivTag,sControlFile,fnCallback){var sTemplateHTML=TriSysApex['FormsManager']['getControlTemplateHTML'](sControlFile);if(sTemplateHTML){$('#'+sDivTag)['html'](sTemplateHTML),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null);if(fnCallback)fnCallback();return;}var bHTTPpath=sControlFile['indexOf']('http')==0x0,bInDev=TriSysApex['Environment']['isDeployedInTestMode'](),sPrefix='',sPagePath=sControlFile;if(!bHTTPpath)sPagePath=sPrefix+TriSysApex['Constants']['UserControlFolder']+sPagePath;$('#'+sDivTag)['load'](sPagePath+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),function(){TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null);if(fnCallback)fnCallback();});},'getControlTemplateHTML':function(sControlFile){var sTemplateFile=sControlFile,parts=sControlFile['split']('/');if(parts['length']>0x1)sTemplateFile=parts[parts['length']-0x1];var sTemplateId='#'+sTemplateFile['replace']('.html','-html'),sTemplateHTML=null;try{sTemplateHTML=$(sTemplateId)['html']();}catch(ex){}return sTemplateHTML;},'loadControlReplacingDiv':function(sDivTag,sControlFile,fnCallback){var sTemplateHTML=TriSysApex['FormsManager']['getControlTemplateHTML'](sControlFile);if(sTemplateHTML){$('#'+sDivTag)['html'](sTemplateHTML),$('#'+sDivTag)['children'](':first')['unwrap'](),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null);if(fnCallback)fnCallback();return;}var sPagePath=sControlFile;if(sPagePath['indexOf']('https://')<0x0)sPagePath=TriSysApex['CustomFormsAndComponents']['UserControlPath'](sControlFile);$('#'+sDivTag)['load'](sPagePath+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),function(){$(this)['children'](':first')['unwrap'](),TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Apply']['PostLogin'](null);if(fnCallback)fnCallback();});},'pageURLTimestampArgumentsToForceNoCache':function(sURL,sArgSeparator){if(!sArgSeparator)sArgSeparator='?';if(sURL){if(sURL['indexOf']('?')>0x0)sArgSeparator='&';}var dt=new Date(),sMonth=(dt['getMonth']()+0x1<0xa?'0':'')+(dt['getMonth']()+0x1),sDay=(dt['getDate']()<0xa?'0':'')+dt['getDate'](),sHour=(dt['getHours']()<0xa?'0':'')+dt['getHours'](),sMinutes=(dt['getMinutes']()<0xa?'0':'')+dt['getMinutes'](),sSeconds=(dt['getSeconds']()<0xa?'0':'')+dt['getSeconds'](),sArgsToForceLoad=sArgSeparator+'datetime='+dt['getFullYear']()+sMonth+sDay+sHour+sMinutes+sSeconds+'-'+dt['getMilliseconds']();return sArgsToForceLoad;},'pageLoaded':function(response,status,xhr){if(status=='error'){var msg='Error\x20loading\x20'+TriSysApex['FormsManager']['sPageLoading']+'<br\x20/>';TriSysApex['Toasters']['Error'](msg+xhr['status']+'\x20'+xhr['statusText']);}},'FormInstances':{'FormArray':[],'Count':function(){return TriSysApex['FormsManager']['FormInstances']['FormArray']['length'];},'Clear':function(){TriSysApex['FormsManager']['FormInstances']['FormArray']=[],TriSysApex['FormsManager']['FormInstances']['RemoveKendoUILeftovers'](),TriSysSDK['CShowForm']['InitialiseFormFields']['Clear']();},'RemoveKendoUILeftovers':function(){$('.k-list-container.k-popup.k-group.k-reset')['remove'](),$('.k-calendar-container.k-popup.k-group.k-reset')['remove'](),$('.k-animation-container')['remove']();},'AddForm':function(pageConfig,lRecordId){var formInstance={'RecordId':lRecordId,'PageConfiguration':pageConfig};TriSysApex['FormsManager']['FormInstances']['FormArray']['push'](formInstance);},'DeleteForm':function(sFormName){for(var i=0x0;i<TriSysApex['FormsManager']['FormInstances']['FormArray']['length'];i++){var formInstance=TriSysApex['FormsManager']['FormInstances']['FormArray'][i];if(formInstance['PageConfiguration']['FormName']==sFormName){TriSysApex['FormsManager']['FormInstances']['FormArray']['splice'](i,0x1);return;}}},'GetForm':function(sFormName){if(!TriSysApex['FormsManager']['FormInstances']['FormArray'])return null;if(TriSysApex['FormsManager']['FormInstances']['FormArray']['length']==0x0)return null;for(var i=0x0;i<TriSysApex['FormsManager']['FormInstances']['FormArray']['length'];i++){var formInstance=TriSysApex['FormsManager']['FormInstances']['FormArray'][i];if(formInstance['PageConfiguration']['FormName']==sFormName)return formInstance;}return null;},'GetFirstInstance':function(){if(TriSysApex['FormsManager']['FormInstances']['FormArray']['length']>0x0)return TriSysApex['FormsManager']['FormInstances']['FormArray'][0x0];return null;},'CanFormInstanceBeClosed':function(formInstance){return!![];}},'Captions':{'SetCaption':function(sCaption,sImage){if(!sImage)sImage='//apex.trisys.co.uk/legacy/images/trisys/16x16/TriSys-16x16.ico';$('#TriSysFormCaptionText')['html'](sCaption),$('#TriSysFormCaptionIcon')['attr']('src',sImage);}},'FormContentRowHeight':function(){return $('#divFormContentRow')['height']();},'ShowRecordIdInCaption':function(sEntityName,lRecordId,sDisplayText,options){var bAppendRecordIdToCaption=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('AppendRecordIdToCaption',![]));if(bAppendRecordIdToCaption){var sID=sEntityName['toLowerCase']()+'Form-caption',sEntityHTML='<span\x20class=\x22label\x20themed-background\x22>'+sEntityName+'</span>\x20';if(lRecordId>0x0&&options&&options['ContactTypePrefix']&&options['ContactTypeName']){var valueColours=TriSysApex['Pages']['Index']['ContactTypeColourMappings'],fnFormat=TriSysSDK['Grid']['CustomGridColumnTemplates']['FormatColourByColumnValue']('ContactType',valueColours);sEntityHTML=fnFormat({'ContactType':options['ContactTypeName']},'\x20'+sEntityName)+'\x20';}var sCaption=sEntityHTML+'<strong>'+sDisplayText+'</strong>'+(lRecordId>0x0?'\x20('+lRecordId+')':'');if(lRecordId==0x0)sCaption='New\x20'+sEntityHTML;$('#'+sID)['html'](sCaption);}},'isFlexivaForm':function(pageConfig){if(pageConfig){if(pageConfig['ViewName']){if(pageConfig['ViewName']['indexOf']('.json')>0x0)return!![];}}return![];},'EntityUpdateController':{'FormWidgetSpecification':function(){this['UniqueID']=null,this['EntityName']=null,this['RecordId']=0x0,this['LoadCallbackFunction']=null,this['BeforeUpdateCallbackFunction']=null,this['UpdateCallbackFunction']=null,this['CallOnRecordIdChangeOnly']=!![],this['AfterEntityLinkChangeFunction']=null,this['AfterTabClickFunction']=null,this['ActionFormLoadedFunction']=null,this['ActionCreateNoteHistoryClickFunction']=null;},'FormWidgetSpecificationList':[],'RegisterFormWidgetSpecification':function(formWidgetSpecification){var existingFormWidgetSpecification=null;for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['UniqueID']==formWidgetSpecification['UniqueID']){existingFormWidgetSpecification['EntityName']=formWidgetSpecification['EntityName'],existingFormWidgetSpecification['RecordId']=formWidgetSpecification['RecordId'],existingFormWidgetSpecification['LoadCallbackFunction']=formWidgetSpecification['LoadCallbackFunction'],existingFormWidgetSpecification['BeforeUpdateCallbackFunction']=formWidgetSpecification['BeforeUpdateCallbackFunction'],existingFormWidgetSpecification['UpdateCallbackFunction']=formWidgetSpecification['UpdateCallbackFunction'],existingFormWidgetSpecification['CallOnRecordIdChangeOnly']=formWidgetSpecification['CallOnRecordIdChangeOnly'],existingFormWidgetSpecification['AfterEntityLinkChangeFunction']=formWidgetSpecification['AfterEntityLinkChangeFunction'],existingFormWidgetSpecification['AfterTabClickFunction']=formWidgetSpecification['AfterTabClickFunction'],existingFormWidgetSpecification['ActionFormLoadedFunction']=formWidgetSpecification['ActionFormLoadedFunction'],existingFormWidgetSpecification['ActionCreateNoteHistoryClickFunction']=formWidgetSpecification['ActionCreateNoteHistoryClickFunction'];break;}else existingFormWidgetSpecification=null;}if(!existingFormWidgetSpecification)TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['push'](formWidgetSpecification);},'AsynchronousEntityLoad':function(sEntityName,lRecordId,fieldDescriptions){TriSysApex['FormsManager']['CustomRules']['Event']('FormRecordLoad',sEntityName,fieldDescriptions);for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['EntityName']==sEntityName){var bCall=!![];if(existingFormWidgetSpecification['CallOnRecordIdChangeOnly']&&existingFormWidgetSpecification['RecordId']!=lRecordId)bCall=![];if(bCall&&existingFormWidgetSpecification['LoadCallbackFunction'])existingFormWidgetSpecification['LoadCallbackFunction'](lRecordId,fieldDescriptions);}}},'AsynchronousEntityBeforeUpdate':function(sEntityName,lRecordId){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['EntityName']==sEntityName){var bCall=!![];if(existingFormWidgetSpecification['CallOnRecordIdChangeOnly']&&existingFormWidgetSpecification['RecordId']!=lRecordId)bCall=![];if(bCall&&existingFormWidgetSpecification['BeforeUpdateCallbackFunction'])return existingFormWidgetSpecification['BeforeUpdateCallbackFunction'](lRecordId);}}return!![];},'AsynchronousEntityUpdate':function(sEntityName,lRecordId){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['EntityName']==sEntityName){var bCall=!![];if(existingFormWidgetSpecification['CallOnRecordIdChangeOnly']&&existingFormWidgetSpecification['RecordId']!=lRecordId)bCall=![];if(bCall&&existingFormWidgetSpecification['UpdateCallbackFunction'])existingFormWidgetSpecification['UpdateCallbackFunction'](lRecordId);}}},'AsynchronousEntityLinkChange':function(sEntityName,lRecordId,entityValues){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['EntityName']==sEntityName){if(existingFormWidgetSpecification['AfterEntityLinkChangeFunction'])existingFormWidgetSpecification['AfterEntityLinkChangeFunction'](lRecordId,entityValues);}}},'AsynchronousFormTabClick':function(sTabPaneId){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['AfterTabClickFunction'])existingFormWidgetSpecification['AfterTabClickFunction'](sTabPaneId);}},'AsynchronousActionFormLoaded':function(action){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['ActionFormLoadedFunction'])existingFormWidgetSpecification['ActionFormLoadedFunction'](action);}},'AsynchronousActionCreateNoteHistoryClick':function(bCreateNoteHistory){for(var i=0x0;i<TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList']['length'];i++){var existingFormWidgetSpecification=TriSysApex['FormsManager']['EntityUpdateController']['FormWidgetSpecificationList'][i];if(existingFormWidgetSpecification['ActionCreateNoteHistoryClickFunction'])existingFormWidgetSpecification['ActionCreateNoteHistoryClickFunction'](bCreateNoteHistory);}}},'CustomRules':{'Event':function(sEvent,sEntityName,fieldDescriptions){var sFile='form-rules.json',sJSONFilePath=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sFile);if(sJSONFilePath){var jsonData=TriSysApex['Forms']['Configuration']['GetJSONFromFileUsingAjax'](sJSONFilePath);if(jsonData){var rules=jsonData['Rules'];rules&&rules['forEach'](function(rule){var bMatchedFormEvent=rule['FormName']==sEntityName&&rule['Event']==sEvent;bMatchedFormEvent&&fieldDescriptions&&rule['Fields']&&fieldDescriptions['forEach'](function(fieldDescription){rule['Fields']['forEach'](function(field){fieldDescription['TableName']+'_'+fieldDescription['TableFieldName']==field['Name']&&TriSysApex['FormsManager']['CustomRules']['ApplyFieldRule'](fieldDescription,field['Rule']);});});});}}},'ApplyFieldRule':function(fieldDescription,rule){switch(rule['Type']){case'Editable-Only-When-User-Security-Permission-True':var bEnabled=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['ReadValue'](rule['SecurityItemCategory'],rule['SecurityItemName']),bReadOnly=!bEnabled;TriSysSDK['CShowForm']['TriSysFieldReadOnly'](fieldDescription,bReadOnly);break;}}}},'NavigationBar':{'ConfigurationFileJSON':null,'Draw':function(sDiv,bCustomConfiguration,drawOptions){TriSysApex['NavigationBar']['ConfigurationFileJSON']=TriSysApex['NavigationBar']['NavBarFile'](bCustomConfiguration);drawOptions&&($('#'+sDiv)['empty'](),TriSysApex['NavigationBar']['ConfigurationFileJSON']=drawOptions['NavigationBarConfiguration'],TriSysApex['Forms']['Configuration']['Pages']=drawOptions['PagesConfiguration']);if(!TriSysApex['NavigationBar']['ConfigurationFileJSON'])return;var sNavBarHTML=TriSysApex['NavigationBar']['MenuLevel1Template'](),sSubMenuHTML=TriSysApex['NavigationBar']['MenuLevel2Template'](),bInDev=TriSysApex['Pages']['Controller']['isDeveloper']();if(bCustomConfiguration&&!drawOptions){var customFormsPages=TriSysApex['Forms']['Configuration']['PagesFile'](bCustomConfiguration);if(customFormsPages)TriSysApex['Forms']['Configuration']['Pages']=customFormsPages;}if(TriSysApex['Device']['isPhone']()){if(TriSysApex['NavigationBar']['ConfigurationFileJSON'])for(var iNavBar=TriSysApex['NavigationBar']['ConfigurationFileJSON']['length']-0x1;iNavBar>=0x0;iNavBar--){var navBarItem=TriSysApex['NavigationBar']['ConfigurationFileJSON'][iNavBar];if(!TriSysAPI['Operators']['isEmpty'](navBarItem['Phone'])&&!navBarItem['Phone'])TriSysApex['NavigationBar']['ConfigurationFileJSON']['splice'](iNavBar,0x1);}if(TriSysApex['Forms']['Configuration']['Pages'])for(var iPage=TriSysApex['Forms']['Configuration']['Pages']['length']-0x1;iPage>=0x0;iPage--){var page=TriSysApex['Forms']['Configuration']['Pages'][iPage];if(!TriSysAPI['Operators']['isEmpty'](page['Phone'])&&!page['Phone'])TriSysApex['Forms']['Configuration']['Pages']['splice'](iPage,0x1);}}var sHTMLNavBar='';if(TriSysApex['NavigationBar']['ConfigurationFileJSON'])for(var iNavBar=0x0;iNavBar<TriSysApex['NavigationBar']['ConfigurationFileJSON']['length'];iNavBar++){var navBarItem=TriSysApex['NavigationBar']['ConfigurationFileJSON'][iNavBar],sImage=navBarItem['ImagePath'];if(sImage)sImage=TriSysApex['ModalDialogue']['IconPicker']['DisplayIcon'](sImage);var sItem=sNavBarHTML;navBarItem['GroupID']=navBarItem['ID']+'-GroupID';sItem&&(sItem=sItem['replace'](/##ID##/g,navBarItem['GroupID']),sItem=sItem['replace'](/##subMenuName##/g,navBarItem['ID']),sItem=sItem['replace'](/##image##/g,sImage),sItem=sItem['replace'](/##caption##/g,navBarItem['Caption']),sItem=sItem['replace'](/##ID-a##/g,navBarItem['GroupID']+'-a'));var sDisplay='none',sDisplaySubMenu='none',sOpen='';(navBarItem['Visible']||navBarItem['VisibleIfNotCRM']&&!TriSysApex['Constants']['TriSysHostedCRM']||bInDev&&navBarItem['VisibleInDev'])&&(sDisplay='block',navBarItem['Open']&&(sDisplaySubMenu='block',sOpen='\x20open'));sItem&&(sItem=sItem['replace'](/##groupVisibility##/g,sDisplay),sItem=sItem['replace'](/##display##/g,sDisplay),sItem=sItem['replace'](/##displaySubMenu##/g,sDisplaySubMenu),sItem=sItem['replace'](/##open##/g,sOpen));var sMenuItems='';if(TriSysApex['Forms']['Configuration']['Pages'])for(var iPage=0x0;iPage<TriSysApex['Forms']['Configuration']['Pages']['length'];iPage++){var page=TriSysApex['Forms']['Configuration']['Pages'][iPage];if(page['ParentNavBarMenuID']==navBarItem['ID']){var bDrawMenuItem=!![];if(!TriSysAPI['Operators']['isEmpty'](page['Visible']))bDrawMenuItem=page['Visible'];var sPageStyle=page['Style'];if(!bDrawMenuItem)sPageStyle=sPageStyle?sPageStyle+';':''+'display:none;';if(bDrawMenuItem)sPageStyle=(sPageStyle?sPageStyle+'\x20':'')+'cursor:\x20pointer;';var sLiStyle=sPageStyle?'style=\x22'+sPageStyle+'\x22':'',sMenuItem=sSubMenuHTML,sID=TriSysSDK['Miscellaneous']['EscapeDOMid'](page['FormName'])+'-MenuItem';sMenuItem&&(sMenuItem=sMenuItem['replace'](/##ID##/g,sID),sMenuItem=sMenuItem['replace'](/##page##/g,page['FormName']),sMenuItem=sMenuItem['replace'](/##image##/g,page['ImagePath']),sMenuItem=sMenuItem['replace'](/##caption##/g,page['Caption']),sMenuItem=sMenuItem['replace'](/##style##/g,sLiStyle),sMenuItems+=sMenuItem);}}if(sItem)sItem=sItem['replace'](/##subMenuItems##/g,sMenuItems);sHTMLNavBar+=sItem;}$('#'+sDiv)['prepend'](sHTMLNavBar),TriSysProUI['handleNav'](),bCustomConfiguration?TriSysApex['NavigationBar']['ApplySecurityAfterLogin']():TriSysApex['NavigationBar']['PostLoginEvent'](![]),TriSysApex['FormsManager']['HideEntityFormsInNavBar']();},'ApplySecurityAfterLogin':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var bSystemsAdministrator=TriSysApex['Cache']['UserGroupManager']['SystemAdministrator'](userCredentials['LoggedInUser']['UserId']);(TriSysApex['Constants']['TrialMode']||!bSystemsAdministrator)&&$('#AdminConsole-MenuItem')['hide']();}},'PostLoginEvent':function(bLoggedIn,bRecruiter,bClient,bCandidate){if(!TriSysApex['NavigationBar']['ConfigurationFileJSON'])return;if(bLoggedIn)TriSysApex['NavigationBar']['PostLoginEventCustomNavBarInitialisation']();TriSysApex['NavigationBar']['ApplyVisibility'](bLoggedIn);},'ApplyVisibility':function(bLoggedIn){var bInDev=TriSysApex['Pages']['Controller']['isDeveloper'](),bShow=![];if(TriSysApex['NavigationBar']['ConfigurationFileJSON'])for(var iNavBar=0x0;iNavBar<TriSysApex['NavigationBar']['ConfigurationFileJSON']['length'];iNavBar++){var navBarItem=TriSysApex['NavigationBar']['ConfigurationFileJSON'][iNavBar];if(bLoggedIn){bShow=navBarItem['Visible'];if(bShow){$('#'+navBarItem['GroupID'])['show']();if(navBarItem['Open'])$('#'+navBarItem['ID'])['show']();}else $('#'+navBarItem['GroupID'])['hide'](),$('#'+navBarItem['ID'])['hide']();}else{var bInvisible=!navBarItem['Visible']&&!(navBarItem['VisibleIfNotCRM']&&!TriSysApex['Constants']['TriSysHostedCRM']);bInvisible&&($('#'+navBarItem['GroupID'])['hide'](),$('#'+navBarItem['ID'])['hide']());}}if(TriSysApex['Forms']['Configuration']['Pages'])for(var iPage=0x0;iPage<TriSysApex['Forms']['Configuration']['Pages']['length'];iPage++){var page=TriSysApex['Forms']['Configuration']['Pages'][iPage],sID=TriSysSDK['Miscellaneous']['EscapeDOMid'](page['FormName'])+'-MenuItem';bShow=!![],bShow=TriSysApex['NavigationBar']['PostLoginNavBarPageVisibility'](page,bLoggedIn);if(bShow)$('#'+sID)['show']();else $('#'+sID)['hide']();}},'PostLoginNavBarPageVisibility':function(page,bLoggedIn){var bVisible=page['Visible'];if(bLoggedIn)switch(page['FormName']){case'Login':case'ForgottenPassword':case'Registration':bVisible=![];break;case'Logoff':bVisible=!![];break;}return bVisible;},'MustBeLoggedIn':function(page){var bMustBeLoggedIn=!![];switch(page['FormName']){case'About':case'Welcome':case'QuickStart':case'UserGuide':case'Training':case'TermsAndConditions':case'PlugIns':case'Login':case'ForgottenPassword':case'Registration':case'ContactUs':case'SupportPortal':bMustBeLoggedIn=![];break;}return bMustBeLoggedIn;},'PostLoginEventCustomNavBarInitialisation':function(){if(TriSysApex['CustomFormsAndComponents']['isCustomForm']('navbar.json')){var drawOptions={'NavigationBarConfiguration':TriSysApex['NavigationBar']['NavBarFile'](!![]),'PagesConfiguration':TriSysApex['Forms']['Configuration']['PagesFile'](!![])};if(drawOptions['NavigationBarConfiguration']&&drawOptions['PagesConfiguration']){TriSysApex['NavigationBar']['Draw']('scrollNavBar',!![],drawOptions);return;}}else{}},'HighlightMenuItem':function(sFormName){for(var iPage=0x0;iPage<TriSysApex['Forms']['Configuration']['Pages']['length'];iPage++){var page=TriSysApex['Forms']['Configuration']['Pages'][iPage],sID=TriSysSDK['Miscellaneous']['EscapeDOMid'](page['FormName'])+'-MenuItem',bHighlight=page['FormName']==sFormName,sClassName=bHighlight?'active':'';$('#'+sID)['attr']('class',sClassName);}},'NavBarFile':function(bCustomConfiguration){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('navbar.json',bCustomConfiguration);return jsonData;},'MenuLevel1Template':function(){var sFile=TriSysApex['CustomFormsAndComponents']['UserControlPath']('MenuLevel1.html'),sTemplateHTML=TriSysApex['NavigationBar']['TemplateFile'](sFile);return sTemplateHTML;},'MenuLevel2Template':function(){var sFile=TriSysApex['CustomFormsAndComponents']['UserControlPath']('MenuLevel2.html'),sTemplateHTML=TriSysApex['NavigationBar']['TemplateFile'](sFile);return sTemplateHTML;},'TemplateFile':function(sFile){var sTemplateHTML=null;return $['ajax']({'type':'GET','url':sFile,'dataType':'html','success':function(data){sTemplateHTML=data;},'error':function(request,status,error){alert('Error:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},'async':![]}),sTemplateHTML;}},'Logging':{'Instantiated':![],'LoggingEnabled':![],'LogMessage':function(sMessage,bSendErrorToServer){!TriSysApex['Logging']['Instantiated']&&(TriSysApex['Logging']['LoggingEnabled']=TriSysApex['Pages']['Controller']['isDeveloper'](),TriSysApex['Logging']['Instantiated']=!![]);if(TriSysApex['Logging']['LoggingEnabled']){var sPrefix='TriSysApex:\x20';try{console['log'](sPrefix+sMessage);}catch(e){if(!TriSysSDK['Browser']['InternetExplorerVersion']()>0x9)alert(sPrefix+sMessage);};}bSendErrorToServer&&TriSysApex['ErrorHandling']['SendErrorToWebAPI'](sMessage);},'CatchVariableToText':function(e){var sMessage=e;if(e&&e['message'])sMessage=e['message'];return sMessage;}},'ErrorHandling':{'CatchAll':function(){window['onerror']=function(errorMsg,url,lineNumber,column,errorObj){var sError='Error:\x20'+errorMsg+'\x0a\x0a\x20Script:\x20'+url+'\x0a\x0a\x20Line:\x20'+lineNumber+'\x0a\x0a\x20Column:\x20'+column;if(errorObj)sError+='\x0a\x0a\x20StackTrace:\x20'+errorObj['stack'];if(TriSysApex['ErrorHandling']['Exceptions']['Handled'](errorMsg,url,lineNumber,column,errorObj))return;var bSentErrorToServer=!![];try{TriSysApex['Logging']['LogMessage'](sError,!![]);}catch(err){bSentErrorToServer=![];}var bIgnoreError=![],filters=['Unexpected\x20token\x20<','Cannot\x20read\x20property\x20\x27groupIndex\x27\x20of\x20undefined','html2canvas.js'];filters['forEach'](function(sErrorPart){var bFound=sError['indexOf'](sErrorPart)>=0x0;if(bFound)bIgnoreError=!![];});if(!bIgnoreError){var sDevice=TriSysApex['Device']['Description'](),botFilters=['Googlebot'];botFilters['forEach'](function(sBotPart){var bFound=sDevice['indexOf'](sBotPart)>=0x0;if(bFound)bIgnoreError=!![];});}if(!bIgnoreError){try{TriSysApex['Toasters']['Error'](sError),setTimeout(function(){TriSysApex['ErrorHandling']['SendScreenshot']('TriSysApex.ErrorHandling.CatchAll',{'ErrorCondition':!![]});},0x1f4);}catch(e){}if(!bSentErrorToServer)try{TriSysApex['ErrorHandling']['SendErrorToWebAPI'](sError,TriSysApex['ErrorHandling']['PostUnhandledErrorHandlingPrompt']);}catch(e){}}var bSuppressErrorAlert=!![];return bSuppressErrorAlert;};},'PostUnhandledErrorHandlingPrompt':function(){var sMessage='An\x20error\x20has\x20occured.\x20Re-start\x20application?',r=confirm(sMessage);r&&TriSysApex['LoginCredentials']['Logoff'](![]);},'SendErrorToWebAPI':function(sErrorMessage,fnCallbackOnSuccess){if(!TriSysPhoneGap['isConnectedToComms']())return![];var sFullName='',sCompanyName='',sEMail='',sBrowser=TriSysSDK['Browser']['Version'](),sURL=window['location']['href'],userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){sFullName=userCredentials['LoggedInUser']['ForenameAndSurname'];var contact=userCredentials['LoggedInUser']['Contact'];contact&&(sCompanyName=contact['CompanyName']),sEMail=userCredentials['LoggedInUser']['FullName'];}var CErrorLogRequest={'APIKey':TriSysApex['Constants']['DeveloperSiteKey'],'VersionNumber':TriSysApex['Copyright']['ShortProductName']+'\x20'+TriSysApex['Application']['Version'](),'UserName':sFullName,'Company':sCompanyName,'EMail':sEMail,'URL':sURL,'Browser':sBrowser,'Device':TriSysApex['Device']['Description'](),'ErrorMessage':sErrorMessage},payloadObject={};payloadObject['URL']='ErrorLogging/LogError',payloadObject['OutboundDataPacket']=CErrorLogRequest,payloadObject['InboundDataFunction']=function(data){var CErrorLogResponse=data;if(CErrorLogResponse){if(CErrorLogResponse['Success']){if(fnCallbackOnSuccess)fnCallbackOnSuccess();}else TriSysApex['Logging']['LogMessage'](CErrorLogResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('TriSysApex.ErrorHandling.SendErrorToWebAPI:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SendScreenshot':function(sForm,cause){if(!cause)return;if(cause['MessageBox'])return;if(cause['OpenForm'])return;if(cause['TabClick'])return;if(sForm=='Login')return;var bLoggedIn=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(!bLoggedIn)return;else{var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),user=userCredentials['LoggedInUser'],crmContact=user['CRMContact'];if(!crmContact)return;}var fnSend=function(sURL){var CApexScreenshotRequest={'ImageBase64':sURL,'Commentary':sForm},payloadObject={};payloadObject['URL']='ErrorLogging/ApexScreenshot',payloadObject['OutboundDataPacket']=CApexScreenshotRequest,payloadObject['InboundDataFunction']=function(CApexScreenshotResponse){return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},fnScreenshot=function(){try{$('body')['html2canvas']({'onrendered':function(canvas){var sURL=canvas['toDataURL']('image/png');if(sURL)fnSend(sURL);}});}catch(e){TriSysApex['ErrorHandling']['SendErrorToWebAPI']('TriSysApex.ErrorHandling.SendScreenshot:\x20Form='+sForm+'.\x20Error='+TriSysApex['Logging']['CatchVariableToText'](e));}};setTimeout(fnScreenshot,0x32);},'Exceptions':{'_Functions':[],'AddFunction':function(sFunctionName,fn){const functions=TriSysApex['ErrorHandling']['Exceptions']['_Functions'];for(i=functions['length']-0x1;i>=0x0;i--){const funBlock=functions[i];if(funBlock['FunctionName']==sFunctionName)functions['splice'](i,0x1);}functions['push']({'FunctionName':sFunctionName,'Function':fn});},'Handled':function(errorMsg,url,lineNumber,column,errorObj){return TriSysApex['ErrorHandling']['Exceptions']['_Functions']['some'](function(functionBlock){return functionBlock['Function'](errorMsg,url,lineNumber,column,errorObj);});}}},'DynamicClasses':{'GetObject':function(sFullNamespacePathOfObject){var sParts=sFullNamespacePathOfObject['split']('.');if(sParts['length']==0x0)return null;var obj=null;for(var i=0x0;i<sParts['length'];i++){var sPart=sParts[i];if(i==0x0)obj=window[sPart];else obj=obj[sPart];}return obj;},'CallFunction':function(sFunction,argument1,argument2,argument3,argument4,argument5){var fn=TriSysApex['DynamicClasses']['GetObject'](sFunction);if(fn){if(typeof fn==='function')try{fn(argument1,argument2,argument3,argument4,argument5);}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}return;}},'CallFunctionAsync':async function(sFunction,argument1,argument2,argument3,argument4,argument5){var fn=TriSysApex['DynamicClasses']['GetObject'](sFunction);if(fn){if(typeof fn==='function')try{const result=await fn(argument1,argument2,argument3,argument4,argument5);return result;}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}}return null;}},'URL':{'Parser':function(u){var path='',query='',hash='',params;u['indexOf']('#')>0x0&&(hash=u['substr'](u['indexOf']('#')+0x1),u=u['substr'](0x0,u['indexOf']('#')));if(u['indexOf']('?')>0x0)path=u['substr'](0x0,u['indexOf']('?')),query=u['substr'](u['indexOf']('?')+0x1),params=query['split']('&');else path=u;return{'getHost':function(){var hostexp=/\/\/([\w.-]*)/,match=hostexp['exec'](path);if(match!=null&&match['length']>0x1)return match[0x1];return'';},'getPath':function(){var pathexp=/\/\/[\w.-]*(?:\/([^?]*))/,match=pathexp['exec'](path);if(match!=null&&match['length']>0x1)return match[0x1];return'';},'getHash':function(){return hash;},'getParams':function(){return params;},'getQuery':function(){return query;},'setHash':function(value){if(query['length']>0x0)query='?'+query;if(value['length']>0x0)query=query+'#'+value;return path+query;},'setParam':function(name,value){!params&&(params=new Array());params['push'](name+'='+value);for(var i=0x0;i<params['length'];i++){if(query['length']>0x0)query+='&';query+=params[i];}if(query['length']>0x0)query='?'+query;if(hash['length']>0x0)query=query+'#'+hash;return path+query;},'getParam':function(name){if(params)for(var i=0x0;i<params['length'];i++){var pair=params[i]['split']('=');if(decodeURIComponent(pair[0x0])==name)return decodeURIComponent(pair[0x1]);}console['log']('Query\x20variable\x20%s\x20not\x20found',name);},'hasParam':function(name){if(params)for(var i=0x0;i<params['length'];i++){var pair=params[i]['split']('=');if(decodeURIComponent(pair[0x0])==name)return!![];}console['log']('Query\x20variable\x20%s\x20not\x20found',name);},'removeParam':function(name){query='';if(params){var newparams=new Array();for(var i=0x0;i<params['length'];i++){var pair=params[i]['split']('=');if(decodeURIComponent(pair[0x0])!=name)newparams['push'](params[i]);}params=newparams;for(var i=0x0;i<params['length'];i++){if(query['length']>0x0)query+='&';query+=params[i];}}if(query['length']>0x0)query='?'+query;if(hash['length']>0x0)query=query+'#'+hash;return path+query;}};}},'Toasters':{'_From':'top','_Amount':0x73,'Show':function(sType,sMessage){$['bootstrapGrowl'](sMessage,{'type':sType,'delay':0x9c4,'allow_dismiss':!![],'offset':{'from':TriSysApex['Toasters']['_From'],'amount':TriSysApex['Toasters']['_Amount']}}),$('.bootstrap-growl')['css']('z-index','1999999')['css']('border-radius','8px');},'SetOptions':function(sFrom,iAmount){TriSysApex['Toasters']['_From']=sFrom,TriSysApex['Toasters']['_Amount']=iAmount;},'Info':function(sMessage){TriSysApex['Toasters']['Show']('info',sMessage);},'Information':function(sMessage){TriSysApex['Toasters']['Show']('info',sMessage);},'Success':function(sMessage){TriSysApex['Toasters']['Show']('success',sMessage);},'Warning':function(sMessage){TriSysApex['Toasters']['Show']('warning',sMessage);},'Error':function(sMessage){if(!TriSysApex['Toasters']['isErrorIgnored'](sMessage))TriSysApex['Toasters']['Show']('danger',sMessage);},'ErrorValidatingField':function(sField){return TriSysApex['Toasters']['ErrorValidatingMessage']('Please\x20enter\x20a\x20value\x20for\x20'+sField);},'ErrorValidatingList':function(sEntityName){return TriSysApex['Toasters']['ErrorValidatingMessage']('Please\x20add\x20one\x20or\x20more\x20'+sEntityName+'\x20records');},'ErrorValidatingMessage':function(sMessage){return TriSysApex['Toasters']['Error'](sMessage),!![];},'_FilterOutErrors':['kendoui/js'],'isErrorIgnored':function(sMessage){var bIgnore=![];if(!sMessage)bIgnore=!![];else $['each'](TriSysApex['Toasters']['_FilterOutErrors'],function(index,sError){bIgnore=sMessage['indexOf'](sError)>=0x0;});return bIgnore;}},'Device':{'Desktop':'Desktop','Tablet':'Tablet','Phone':'Phone','GetType':function(){var iMaxPhoneWidth=0x19e,iMaxTabletWidth=0x400,iWidth=document['body']['offsetWidth'];if(iWidth<=iMaxPhoneWidth)return TriSysApex['Device']['Phone'];else{if(iWidth<=iMaxTabletWidth)return TriSysApex['Device']['Tablet'];else return TriSysApex['Device']['Desktop'];}},'isDesktop':function(){return TriSysApex['Device']['GetType']()==TriSysApex['Device']['Desktop'];},'isTablet':function(){return TriSysApex['Device']['GetType']()==TriSysApex['Device']['Tablet'];},'isPhone':function(){return TriSysApex['Device']['GetType']()==TriSysApex['Device']['Phone'];},'isTouch':function(){return'ontouchstart'in window||'onmsgesturechange'in window;var bIsTouchDevice='ontouchstart'in document['documentElement'];return bIsTouchDevice;return'ontouchstart'in window||navigator['MaxTouchPoints']>0x0||navigator['msMaxTouchPoints']>0x0;},'hasMouse':function(){return'onmousedown'in window&&'onmouseup'in window&&'onmousemove'in window&&'onclick'in window&&'ondblclick'in window&&'onmousemove'in window&&'onmouseover'in window&&'onmouseout'in window&&'oncontextmenu'in window;},'Model':{'Android':function(){return navigator['userAgent']['match'](/Android/i);},'BlackBerry':function(){return navigator['userAgent']['match'](/BlackBerry/i);},'iOS':function(){return navigator['userAgent']['match'](/iPhone|iPad|iPod/i);},'Opera':function(){return navigator['userAgent']['match'](/Opera Mini/i);},'Windows':function(){return navigator['userAgent']['match'](/IEMobile/i);},'Any':function(){return TriSysApex['Device']['Model']['Android']()||TriSysApex['Device']['Model']['BlackBerry']()||TriSysApex['Device']['Model']['iOS']()||TriSysApex['Device']['Model']['Opera']()||TriSysApex['Device']['Model']['Windows']();},'Name':function(){if(TriSysApex['Device']['Model']['Android']())return'Android';else{if(TriSysApex['Device']['Model']['BlackBerry']())return'BlackBerry';else{if(TriSysApex['Device']['Model']['iOS']())return'iOS';else{if(TriSysApex['Device']['Model']['Opera']())return'Opera';else{if(TriSysApex['Device']['Model']['Windows']())return'Windows';else return'Unknown';}}}}}},'Description':function(){var sDescription='Unknown';if(TriSysApex['Device']['isDesktop']())sDescription=TriSysApex['Device']['Desktop'];else{if(TriSysApex['Device']['isTablet']())sDescription=TriSysApex['Device']['Tablet'];else{if(TriSysApex['Device']['isPhone']())sDescription=TriSysApex['Device']['Phone'];}}if(TriSysApex['Device']['isTouch']())sDescription+='\x20(touch)';if(TriSysApex['Device']['hasMouse']())sDescription+='\x20(mouse)';return sDescription+='\x20['+navigator['userAgent']+']',sDescription+='\x20{'+TriSysApex['Device']['Model']['Name']()+'}',sDescription;},'ZoomOnStartup':function(){return;var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('device-zoom-factors.json');if(!jsonData)return;var iWidth=document['body']['offsetWidth'],sizes=jsonData['Sizes'],fZoomFactor=0x1;for(var i=0x0;i<sizes['length'];i++){var size=sizes[i];if(size['Minimum']<=iWidth&&size['Maximum']>=iWidth){fZoomFactor=size['ZoomFactor'];break;}}fZoomFactor!=0x1&&TriSysApex['Device']['ApplyZoomFactor'](fZoomFactor);},'ApplyZoomFactor':function(fZoomFactor){var fPercentage=fZoomFactor*0x64;$('body')['css']('zoom','\x20'+fPercentage+'%'),TriSysApex['Device']['CurrentZoomFactor']=fZoomFactor;return;var elements=['pleaseWaitDiv','trisys-modal-regular','page-container'];for(var i=0x0;i<elements['length'];i++){var element=elements[i],elem=$('#'+element);elem['css']('zoom',fZoomFactor),TriSysApex['Device']['CurrentZoomFactor']=fZoomFactor;}},'CurrentZoomFactor':0x1,'FixTextEllipsesHack':function(sStyle){var fnModifyTextWidth=function(){var iImagePlusRightChevron=0xd2,iScreenWidth=$(window)['width'](),iWidth=iScreenWidth-iImagePlusRightChevron;$(sStyle)['css']('width',iWidth+'px');};setTimeout(fnModifyTextWidth,0xa);},'PhoneGapEnabled':function(){var bPhoneGapEnabled=![];try{bPhoneGapEnabled=TriSysPhoneGap['Enabled']();}catch(e){}return bPhoneGapEnabled;}},'Activities':{'Launch':function(sWhat){switch(sWhat){case'Task\x20Alarms':TriSysApex['Alarms']['PopupTaskAlarmList']({'IgnoreCache':!![],'OverrideTaskAlarmNotificationUserSetting':!![]});return;case'Post-It\x20Notes':TriSysApex['Alarms']['PopupPostItNoteList']({'IgnoreCache':!![]});return;case'Todays\x20Tasks':TriSysApex['Activities']['TodaysTasks']();return;case'Interviews':TriSysApex['Activities']['Interviews']();return;case'Live\x20Requirements':TriSysApex['Activities']['LiveRequirements']();return;case'Contractors\x20Working':TriSysApex['Activities']['ContractorsWorking']();return;case'Starters':TriSysApex['Activities']['Starters']();return;case'Finishers':TriSysApex['Activities']['Finishers']();return;}TriSysApex['Toasters']['Error'](sWhat);},'TodaysTasks':function(){var bDiaryOpen=TriSysApex['FormsManager']['isFormOpen']('DiaryManager'),iTimeout=bDiaryOpen?0x64:0x2ee;TriSysApex['FormsManager']['OpenForm']('DiaryManager'),setTimeout(function(){var now=new Date(),dtNow=now;TriSysSDK['Scheduler']['SetView']('agenda'),TriSysSDK['Scheduler']['SetDate'](dtNow,{'LoggedInUserOnly':!![]});},iTimeout);},'Interviews':function(){var now=moment()['format']('YYYY-MM-DD'),CInterviewsRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Task/Interviews',payloadObject['OutboundDataPacket']=CInterviewsRequest,payloadObject['InboundDataFunction']=function(CInterviewsResponse){TriSysApex['UI']['HideWait']();if(CInterviewsResponse){if(CInterviewsResponse['Success']){TriSysApex['Activities']['ShowInterviews'](CInterviewsResponse['Interviews']);return;}else TriSysApex['Logging']['LogMessage'](CInterviewsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.Activities.Interviews:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Interviews...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'TaskSummaryGridColumns':[{'field':'TaskId','title':'TaskId','type':'number','hidden':!![]},{'field':'Image','title':'\x20','template':'<img\x20src=\x22images/trisys/16x16/tasktype/#=\x20TaskType\x20#.png\x22\x20style=\x22width:\x2024px;\x20height:\x2024px;\x22\x20alt=\x22#=\x20TaskType\x20#\x22>','width':0x2d,'filterable':![],'sortable':![],'attributes':{'style':'text-overflow:\x20clip;'}},{'field':'TaskType','title':'Task\x20Type','width':0xc8},{'field':'StartDate','title':'Start\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}','width':0x78},{'field':'DisplayDescription','title':'Display\x20Description','type':'string'}],'ShowInterviews':function(interviews,sTitle){var fnPopulateButtons=function(parametersObject,sGridDivID){parametersObject['ButtonLeftVisible']=![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],parametersObject['CloseTopRightButton']=!![];},fnPopulateGrid=function(sGridID){TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':'grdInterviews','RecordsPerPage':0xa,'PopulationByObject':interviews,'Columns':TriSysApex['Activities']['TaskSummaryGridColumns'],'KeyColumnName':'TaskId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['ModalDialogue']['Task']['QuickShow'](rowData['TaskId']);},'MultiRowSelect':![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![]});};if(!sTitle)sTitle='Interviews';TriSysApex['ModalDialogue']['Grid']['Show'](sTitle,null,fnPopulateButtons,fnPopulateGrid);},'LiveRequirements':function(){var now=moment()['format']('YYYY-MM-DD'),CLiveRequirementsRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Vacancies/LiveRequirements',payloadObject['OutboundDataPacket']=CLiveRequirementsRequest,payloadObject['InboundDataFunction']=function(CLiveRequirementsResponse){TriSysApex['UI']['HideWait']();if(CLiveRequirementsResponse){if(CLiveRequirementsResponse['Success']){TriSysApex['Activities']['ShowLiveRequirements'](CLiveRequirementsResponse['Requirements']);return;}else TriSysApex['Logging']['LogMessage'](CLiveRequirementsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.Activities.LiveRequirements:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Live\x20Requirements...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowLiveRequirements':function(requirements,sTitle){var fnPopulateButtons=function(parametersObject,sGridDivID){parametersObject['ButtonLeftVisible']=![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],parametersObject['CloseTopRightButton']=!![];},columns=[{'field':'RequirementId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Reference','title':'Reference','type':'string'},{'field':'Type','title':'Type','type':'string'},{'field':'JobTitle','title':'Job\x20Title','type':'string'},{'field':'EarliestStartDate','title':'Earliest\x20Start','type':'date','format':'{0:dd\x20MMM\x20yyyy}'},{'field':'CompanyName','title':'Company','type':'string'},{'field':'ClientName','title':'Client\x20Contact','type':'string','hidden':!![]},{'field':'Location','title':'Location','type':'string'},{'field':'Salary','title':'Salary/Rate','type':'string'},{'field':'Status','title':'Status','type':'string','hidden':!![]},{'field':'CVSentCount','title':'CV\x20Sent\x20Count','type':'number','hidden':!![]},{'field':'TotalShortlisted','title':'Total\x20Shortlisted','type':'number','hidden':!![]},{'field':'InterviewCount','title':'Interview\x20Count','type':'number','hidden':!![]}],fnPopulateGrid=function(sGridID){TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':'grdRequirements','RecordsPerPage':0xa,'PopulationByObject':requirements,'Columns':columns,'MobileVisibleColumns':[{'field':'Reference'},{'field':'JobTitle'},{'field':'CompanyName'}],'KeyColumnName':'RequirementId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['FormsManager']['OpenForm']('Requirement',rowData['RequirementId']);},'MultiRowSelect':![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![]});};if(!sTitle)sTitle='Live\x20Requirements';TriSysApex['ModalDialogue']['Grid']['Show'](sTitle,null,fnPopulateButtons,fnPopulateGrid);},'ContractorsWorking':function(){var now=moment()['format']('YYYY-MM-DD'),CContractorsWorkingRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Placements/ContractorsWorking',payloadObject['OutboundDataPacket']=CContractorsWorkingRequest,payloadObject['InboundDataFunction']=function(CContractorsWorkingResponse){TriSysApex['UI']['HideWait']();if(CContractorsWorkingResponse){if(CContractorsWorkingResponse['Success']){TriSysApex['Activities']['ShowContractorsWorking'](CContractorsWorkingResponse['Placements']);return;}else TriSysApex['Logging']['LogMessage'](CContractorsWorkingResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.Activities.ContractorsWorking:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Contractors...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowContractorsWorking':function(placements){TriSysApex['Activities']['ShowPlacementsInModalGrid']('Contractors\x20Working',placements);},'PlacementArrayColumns':[{'field':'PlacementId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'Reference','title':'Reference','type':'string'},{'field':'Type','title':'Type','type':'string'},{'field':'JobTitle','title':'Job\x20Title','type':'string'},{'field':'CandidateName','title':'Candidate','type':'string'},{'field':'StartDate','title':'Start\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy}'},{'field':'EndDate','title':'End\x20Date','type':'date','format':'{0:dd\x20MMM\x20yyyy}','hidden':!![]},{'field':'CompanyName','title':'Company','type':'string'},{'field':'ClientName','title':'Client\x20Contact','type':'string','hidden':!![]},{'field':'Location','title':'Location','type':'string','hidden':!![]},{'field':'Salary','title':'Salary','type':'string','hidden':!![]},{'field':'ChargeRate','title':'Charge\x20Rate','type':'string','hidden':!![]},{'field':'PayRate','title':'Pay\x20Rate','type':'string','hidden':!![]},{'field':'Status','title':'Status','type':'string','hidden':!![]}],'ShowPlacementsInModalGrid':function(sTitle,placements){var fnPopulateButtons=function(parametersObject,sGridDivID){parametersObject['ButtonLeftVisible']=![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],parametersObject['CloseTopRightButton']=!![];},fnPopulateGrid=function(sGridID){TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':'grdPlacements','RecordsPerPage':0xa,'PopulationByObject':placements,'Columns':TriSysApex['Activities']['PlacementArrayColumns'],'KeyColumnName':'PlacementId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['FormsManager']['OpenForm']('Placement',rowData['PlacementId']);},'MultiRowSelect':![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![]});};TriSysApex['ModalDialogue']['Grid']['Show'](sTitle,null,fnPopulateButtons,fnPopulateGrid);},'Starters':function(){var now=moment()['format']('YYYY-MM-DD'),CStartersRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Placements/Starters',payloadObject['OutboundDataPacket']=CStartersRequest,payloadObject['InboundDataFunction']=function(CStartersResponse){TriSysApex['UI']['HideWait']();if(CStartersResponse){if(CStartersResponse['Success']){TriSysApex['Activities']['ShowStarters'](CStartersResponse['Placements']);return;}else TriSysApex['Logging']['LogMessage'](CStartersResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.Activities.Starters:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Starters...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowStarters':function(placements){TriSysApex['Activities']['ShowPlacementsInModalGrid']('Starters',placements);},'Finishers':function(){var now=moment()['format']('YYYY-MM-DD'),CFinishersRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Placements/Finishers',payloadObject['OutboundDataPacket']=CFinishersRequest,payloadObject['InboundDataFunction']=function(CFinishersResponse){TriSysApex['UI']['HideWait']();if(CFinishersResponse){if(CFinishersResponse['Success']){TriSysApex['Activities']['ShowFinishers'](CFinishersResponse['Placements']);return;}else TriSysApex['Logging']['LogMessage'](CFinishersResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.Activities.Finishers:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Finishers...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ShowFinishers':function(placements){TriSysApex['Activities']['ShowPlacementsInModalGrid']('Finishers',placements);}},'ComingSoon':{'PreLaunchPhase':function(){if(TriSysApex['Device']['PhoneGapEnabled']())return![];var dtStartOfService=new Date(TriSysApex['ComingSoon']['StartOfServiceDate']()),dtNow=new Date();if(dtNow<dtStartOfService){if(TriSysApex['Pages']['Controller']['isDeveloper']()){var sMessage='Proceed\x20in\x20development/test\x20mode\x20(OK)\x20or\x20public\x20access\x20mode\x20(Cancel)?',bDevMode=confirm(sMessage);if(bDevMode)return![];}return window['location']['replace']('comingsoon.html'),!![];}else return![];},'Initialise':function(){var dtStartOfService=TriSysApex['ComingSoon']['StartOfServiceDate']();$('#countdown-to-launch')['countdown'](dtStartOfService)['on']('update.countdown',function(event){$(this)['html'](event['strftime']('<div\x20class=\x22row\x22>'+'<div\x20class=\x22col-xs-6\x20col-sm-3\x20countdown-con\x22><div\x20class=\x22countdown-num\x22>%-D</div><div\x20class=\x22countdown-info\x22>DAYS</div></div>'+'<div\x20class=\x22col-xs-6\x20col-sm-3\x20countdown-con\x22><div\x20class=\x22countdown-num\x22>%H</div><div\x20class=\x22countdown-info\x22>HOURS</div></div>'+'<div\x20class=\x22col-xs-6\x20col-sm-3\x20countdown-con\x22><div\x20class=\x22countdown-num\x22>%M</div><div\x20class=\x22countdown-info\x22>MINUTES</div></div>'+'<div\x20class=\x22col-xs-6\x20col-sm-3\x20countdown-con\x22><div\x20class=\x22countdown-num\x22>%S</div><div\x20class=\x22countdown-info\x22>SECONDS</div></div>'+'</div>'));})['on']('finish.countdown',function(){window['location']['replace']('upgrading.html');}),$('#coming-soon-button')['click'](function(){TriSysApex['ComingSoon']['Submit']();});var sSiteKey=TriSysApex['Constants']['DeveloperSiteKey'];TriSysAPI['Session']['SetDeveloperSiteKey'](sSiteKey);},'StartOfServiceDate':function(){var upgradeStatus=TriSysApex['Upgrade']['File']();if(upgradeStatus)return upgradeStatus['StartOfService'];},'Submit':function(){var sEMail=$('#subscribe-email')['val'](),sError='Please\x20supply\x20a\x20valid\x20e-mail\x20address.';if(sEMail){if(TriSysApex['LoginCredentials']['validateEmail'](sEMail)){TriSysApex['ComingSoon']['SendEMailAddress'](sEMail);return;}}TriSysApex['UI']['ShowMessage'](sError,TriSysApex['Copyright']['ShortProductName']+'\x20Apex\x20Message');},'SendEMailAddress':function(sEMail){var dataPacket={'Fields':[{'Name':'EMail','Value':sEMail},{'Name':'Domain','Value':'apex.trisys.co.uk'}],'TemplateName':'apex-countdown-confirmation-mail.html','TableName':'ComingSoon','TriSysCRM':!![]},payloadObject={};payloadObject['URL']='Enquiry/EnquiryRequest',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var objCompleted=data,sDisplay=JSON['stringify'](data);if(objCompleted){if(objCompleted['Success']){$('#capture-email-row')['hide'](),$('#subscribe-action-message')['html']('<i\x20class=\x22gi\x20gi-check\x22\x20style=\x22margin-top:\x20-8px\x22></i>\x20&nbsp;Thank\x20you\x20for\x20registering');return;}}TriSysApex['UI']['ShowError']('Error:\x20'+objCompleted['ErrorMessage']);},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ComingSoon.SendEMailAddress:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Processing\x20Registration...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'Upgrade':{'Initialise':function(){TriSysApex['Upgrade']['Timer']();},'StartupRedirect':function(){var bUpgrading=TriSysApex['Upgrade']['isUpgrading']();if(bUpgrading)window['location']['replace']('upgrading.html');return bUpgrading;},'Timer':function(){TriSysApex['Upgrade']['isUpgrading']()?setTimeout(TriSysApex['Upgrade']['Timer'],0x3e8):window['location']['replace']('index.html'+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache']());},'isUpgrading':function(){var upgradeStatus=TriSysApex['Upgrade']['File']();if(upgradeStatus)return upgradeStatus['Upgrading'];},'NextVersion':function(){var upgradeStatus=TriSysApex['Upgrade']['File']();if(upgradeStatus)return upgradeStatus['NextVersion'];},'File':function(){var iMaxTriesInCaseWeArePreventedFromReadingFileDuringF5Refresh=0x2,iTries=0x0;while(iTries<iMaxTriesInCaseWeArePreventedFromReadingFileDuringF5Refresh){iTries+=0x1;try{var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('upgrade.json');if(jsonData)return jsonData;}catch(e){TriSysApex['Logging']['LogMessage']('TriSysApex.Upgrade.File():\x20'+TriSysApex['Logging']['CatchVariableToText'](e));}bNetworkAvailability=TriSysPhoneGap['isConnectedToComms']();if(!bNetworkAvailability)return null;}},'ManualCheck':function(){if(!TriSysApex['Environment']['RefreshCachedApplication']())TriSysApex['UI']['ShowMessage']('No\x20software\x20upgrade\x20is\x20pending.');},'UpgradePending':function(){var bUpgradePending=![];bNetworkAvailability=TriSysPhoneGap['isConnectedToComms']();if(!bNetworkAvailability)return bUpgradePending;var sVersion=TriSysApex['Application']['Version']();TriSysApex['Logging']['LogMessage']('TriSysApex.Upgrade.UpgradePending:\x20sVersion='+sVersion);var sNextVersion=TriSysApex['Upgrade']['NextVersion']();return TriSysApex['Logging']['LogMessage']('TriSysApex.Upgrade.UpgradePending:\x20sNextVersion='+sNextVersion),sVersion!==sNextVersion&&sNextVersion&&(bUpgradePending=!![],TriSysApex['Logging']['LogMessage']('TriSysApex.Upgrade.UpgradePending:\x20true...')),bUpgradePending;},'InformUserOfUpgrade':function(bCancel,iRemainingAttempts){var sNextVersion=TriSysApex['Upgrade']['NextVersion'](),sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Software\x20Upgrade',sUpgradeNow='Upgrade\x20Now',sUpgrade='Upgrade\x20<span\x20style=\x22color:\x20red;\x22>(recommended)</span>',sMessage='A\x20new\x20software\x20upgrade\x20to\x20'+sNextVersion+'\x20is\x20available.'+'<br\x20/>The\x20upgrade\x20should\x20only\x20take\x20a\x20few\x20seconds,\x20and\x20will\x20simply\x20refresh\x20this\x20browser\x20application.';bCancel?(sMessage+='<br\x20/>'+sUpgrade+'\x20now,\x20or\x20later?'+'<br\x20/>'+'You\x20should\x20save\x20any\x20work\x20before\x20upgrading\x20and\x20will\x20be\x20prompted\x20only\x20'+iRemainingAttempts+'\x20more\x20time'+(iRemainingAttempts>0x1?'s':'')+'.',TriSysApex['UI']['questionYesNo'](sMessage,sTitle,sUpgradeNow,TriSysApex['Environment']['RefreshCachedApplication'],'Postpone\x20Upgrade',TriSysApex['Upgrade']['CancelUpgradeEvent'])):TriSysApex['UI']['ShowMessage'](sMessage,sTitle,TriSysApex['Environment']['RefreshCachedApplication'],sUpgradeNow);},'_AppJustUnlockedSoPostponeUpgradeCheck':![],'OpenFormUpgradeCheck':function(){if(TriSysApex['Upgrade']['_AppJustUnlockedSoPostponeUpgradeCheck'])return TriSysApex['Upgrade']['_AppJustUnlockedSoPostponeUpgradeCheck']=![],![];if(TriSysApex['Upgrade']['UpgradePending']()){var bLoggedIn=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(bLoggedIn){var iRemainingAttempts=TriSysApex['Upgrade']['MaximumCancels']-TriSysApex['Upgrade']['CancelCounter'],bCanCancel=iRemainingAttempts>0x0;TriSysApex['Upgrade']['InformUserOfUpgrade'](bCanCancel,iRemainingAttempts);}else TriSysApex['Environment']['RefreshCachedApplication']();return!![];}},'CancelUpgradeEvent':function(){return TriSysApex['Upgrade']['CancelCounter']+=0x1,!![];},'CancelCounter':0x0,'MaximumCancels':0x2},'ModalDialogue':{'Current':{'Name':null,'SetName':function(sFile,sTitle){if(sFile){var parts=sFile['split']('/'),sFinalPart=parts[parts['length']-0x1];sFinalPart=sFinalPart['replace']('.html','');var specialControls=['ctrlTriSysMessageBox','ctrlModalGrid','ctrlContractRate','ctrlNewCompanyOrAddress'];if(specialControls['indexOf'](sFinalPart)>=0x0){sFinalPart+='.'+sTitle['replace'](/ /g,'');var iColon=sFinalPart['indexOf'](':');iColon>0x0&&(parts=sFinalPart['split'](':'),sFinalPart=parts[0x0]['trim']());}var bSetName=!![];if(sFinalPart=='ctrlHelpVideo')bSetName=![];bSetName&&(TriSysApex['ModalDialogue']['Current']['Name']=sFinalPart);}},'isKendoUIWindowVisible':function(){var iPostItNotes=TriSysApex['PostItNotes']['CountOpenInstances'](),bContactPreview=$('#Contact'+TriSysApex['EntityPreview']['WindowPrefix'])['length']>0x0;return iPostItNotes>0x0||bContactPreview;}},'Selection':{'SelectionParameters':function(){this['PopulationByFunction']=null,this['ParameterFunction']=null,this['Columns']=null,this['KeyColumnName']=null,this['Title']=null,this['EntityName']=null,this['Filter']=null,this['MultiSelect']=![],this['PopulationByObject']=null,this['CallbackFunction']=null,this['TemplateFile']='ctrlModalSelection.html',this['Div']='divModalSelectionGrid';},'CurrentSelectionParameterObject':null,'AfterLoad':function(fnCallback){var sqlParameters=TriSysApex['ModalDialogue']['Selection']['CurrentSelectionParameterObject'],gridLayout={'Div':sqlParameters['Div'],'ID':'modalSelectionGrid','Title':sqlParameters['Title'],'RecordsPerPage':TriSysApex['UserOptions']['RecordsPerPage'](),'OrderBy':sqlParameters['OrderBy'],'PopulationByFunction':sqlParameters['PopulationByFunction'],'Columns':sqlParameters['Columns'],'PopulationByObject':sqlParameters['PopulationByObject'],'KeyColumnName':sqlParameters['KeyColumnName'],'DrillDownFunction':null,'Height':TriSysApex['Pages']['Index']['FormHeight']()/0x2,'Grouping':TriSysApex['UserOptions']['GridGrouping']()};if(sqlParameters['MultiSelect'])gridLayout['MultiRowSelect']=!![];else gridLayout['SingleRowSelect']=!![],gridLayout['RowDoubleClick']=sqlParameters['CallbackFunction'];if(sqlParameters['Filter'])gridLayout['ColumnFilterText']=sqlParameters['Filter'];TriSysSDK['Grid']['VirtualMode'](gridLayout);},'Show':function(selectionParameters,selectOptions){TriSysApex['ModalDialogue']['Selection']['CurrentSelectionParameterObject']=selectionParameters;!selectionParameters['MultiSelect']&&TriSysSDK['Grid']['RemoveCheckBoxRowSelectorAndCommandDrillDownColumns'](selectionParameters['Columns']);var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=selectionParameters['Title'],parametersObject['Image']='fa-search',parametersObject['Width']=$(window)['width']()*0.8,parametersObject['Height']=$(window)['height']()*0.9,parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath'](selectionParameters['TemplateFile']),parametersObject['OnLoadCallback']=function(){},parametersObject['ButtonLeftText']='Select',parametersObject['ButtonLeftFunction']=function(){var grid=$('#'+selectionParameters['Div'])['data']('kendoGrid');if(!grid)return;if(selectionParameters['MultiSelect']){var lstItems=TriSysSDK['Grid']['GetSelectedMultipleRowsFromGrid'](selectionParameters['Div'],selectionParameters['KeyColumnName']);if(lstItems)return selectionParameters['CallbackFunction'](lstItems),!![];}else{var selectedRow=grid['dataItem'](grid['select']());if(selectedRow&&selectionParameters['CallbackFunction']){var bFunctionValue=selectionParameters['CallbackFunction'](selectedRow);return bFunctionValue;}}},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel';if(selectOptions){if(selectOptions['CancelFunction'])parametersObject['ButtonRightFunction']=selectOptions['CancelFunction'];if(selectOptions['FullScreen'])parametersObject['FullScreen']=!![];if(selectOptions['CloseTopRightButton'])parametersObject['CloseTopRightButton']=!![];}parametersObject['VerticalScrollbar']=!![];if(!parametersObject['FullScreen'])parametersObject['MaximumHeight']=0x258;TriSysApex['UI']['PopupMessage'](parametersObject);}},'NewCompanyAddress':{'CompanyId':null,'AddressId':null,'CompanyName':null,'NewCompany':![],'HideCompanyBlock':![],'Popup':function(lCompanyId,sCompany,lAddressId,lContactId,fnSubmitCallback,bNewCompany,options){TriSysApex['ModalDialogue']['NewCompanyAddress']['CompanyId']=lCompanyId,TriSysApex['ModalDialogue']['NewCompanyAddress']['CompanyName']=sCompany,TriSysApex['ModalDialogue']['NewCompanyAddress']['AddressId']=lAddressId,TriSysApex['ModalDialogue']['NewCompanyAddress']['NewCompany']=bNewCompany,TriSysApex['ModalDialogue']['NewCompanyAddress']['HideCompanyBlock']=![];var parametersObject=new TriSysApex['UI']['ShowMessageParameters'](),sNewOrEdit=(lAddressId>0x0?'Edit':'New')+'\x20',sTitle=sNewOrEdit+(bNewCompany?'Company':'Address:\x20'+sCompany);if(options&&options['Title'])sTitle=options['Title'];if(options&&options['HideCompanyBlock'])TriSysApex['ModalDialogue']['NewCompanyAddress']['HideCompanyBlock']=!![];parametersObject['Title']=sTitle,parametersObject['Image']='fa-building',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlNewCompanyOrAddress.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftFunction']=function(){var sCompanyName=$('#newCompanyOrAddress-CompanyName')['val'](),sAddressType=TriSysSDK['CShowForm']['GetTextFromCombo']('newCompanyOrAddress-AddressType'),sStreet=$('#newCompanyOrAddress-Street')['val'](),sCity=$('#newCompanyOrAddress-City')['val'](),sCounty=$('#newCompanyOrAddress-County')['val'](),sPostCode=$('#newCompanyOrAddress-PostCode')['val'](),sCountry=$('#newCompanyOrAddress-Country')['val'](),sTelNo=$('#newCompanyOrAddress-TelNo')['val'](),bEditAfterSave=TriSysSDK['CShowForm']['CheckBoxValue']('newCompanyOrAddress-edit-company-after-save'),bError=![];if(bNewCompany&&!sCompanyName)bError=TriSysApex['Toasters']['ErrorValidatingField']('Company\x20Name');if(!sStreet)bError=TriSysApex['Toasters']['ErrorValidatingField']('Street');if(!sCity)bError=TriSysApex['Toasters']['ErrorValidatingField']('City');if(bError)return![];var address={'AddressId':lAddressId,'AddressType':sAddressType,'Street':sStreet,'City':sCity,'County':sCounty,'PostCode':sPostCode,'Country':sCountry,'TelNo':sTelNo},company={'CompanyName':sCompanyName,'EditAfterSave':bEditAfterSave};fnSubmitCallback(lCompanyId,lContactId,address,company);},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);}},'NewCompanyContact':{'Options':null,'Popup':function(options,fnSubmitCallback){TriSysApex['ModalDialogue']['NewCompanyContact']['Options']=options;var bBrowserExtension=![];if(options&&options['BrowserExtension'])bBrowserExtension=!![];var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='New\x20'+options['Company']+'\x20Contact',parametersObject['Image']='gi-parents',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlNewCompanyContact.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftFunction']=function(){options['AddressId']=TriSysSDK['CShowForm']['GetValueFromCombo']('newCompanyContact-Address');var sForenames=$('#newCompanyContact-Forenames')['val'](),sSurname=$('#newCompanyContact-Surname')['val'](),sTitle=TriSysSDK['CShowForm']['GetTextFromCombo']('newCompanyContact-Title'),sGender=TriSysSDK['CShowForm']['GetTextFromCombo']('newCompanyContact-Gender'),sJobTitle=TriSysSDK['CShowForm']['GetJobTitleFromField']('newCompanyContact-JobTitle'),sWorkEMail=$('#newCompanyContact-WorkEMail')['val'](),sWorkTelNo=$('#newCompanyContact-WorkTelNo')['val'](),sWorkMobileTelNo=$('#newCompanyContact-WorkMobileTelNo')['val'](),bEditAfterSave=TriSysSDK['CShowForm']['CheckBoxValue']('newCompanyContact-edit-contact-after-save'),bError=![];if(!sTitle)bError=TriSysApex['Toasters']['ErrorValidatingField']('Title');if(!sGender||sGender['length']<=0x1)bError=TriSysApex['Toasters']['ErrorValidatingField']('Gender');if(!sForenames)bError=TriSysApex['Toasters']['ErrorValidatingField']('Forename(s)');if(!sSurname)bError=TriSysApex['Toasters']['ErrorValidatingField']('Surname');if(sJobTitle=='-')bError=TriSysApex['Toasters']['ErrorValidatingField']('Job\x20Title');if(!bBrowserExtension&&(!options['AddressId']||options['AddressId']<=0x0))bError=TriSysApex['Toasters']['ErrorValidatingField']('Address');if(bError)return![];var contact={'Title':sTitle,'Gender':sGender,'Forenames':sForenames,'Surname':sSurname,'JobTitle':sJobTitle,'WorkEMail':sWorkEMail,'WorkTelNo':sWorkTelNo,'WorkMobileTelNo':sWorkMobileTelNo};if(bBrowserExtension&&options){contact['ContactPhotoURL']=options['Contact']['PhotoURL'],options['CompanyId']=ctrlNewCompanyContact['Data']['CompanyId'],options['AddressId']=ctrlNewCompanyContact['Data']['AddressId'];if(!ctrlNewCompanyContact['Data']['ContactType'])ctrlNewCompanyContact['Data']['ContactType']=TriSysSDK['CShowForm']['GetTextFromCombo']('newCompanyContact-Type');if(!ctrlNewCompanyContact['Data']['CompanyName'])ctrlNewCompanyContact['Data']['CompanyName']=$('#newCompanyContact-Company')['val']();contact['ContactType']=ctrlNewCompanyContact['Data']['ContactType'],contact['CompanyName']=ctrlNewCompanyContact['Data']['CompanyName'],contact['LinkedIn']=ctrlNewCompanyContact['Data']['LinkedIn'];}fnSubmitCallback(options['CompanyId'],contact,options['AddressId'],bEditAfterSave);},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);}},'TermsAndConditions':{'Show':function(){var sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Terms\x20&amp;\x20Conditions',sDocumentPath='https://irp.cdn-website.com/f3b4d364/files/uploaded/Service-Agreements-8c7c358f.pdf';TriSysApex['ModalDialogue']['DocumentViewer']['Show'](sTitle,sDocumentPath);return;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=TriSysApex['Copyright']['ShortProductName']+'\x20Terms\x20&amp;\x20Conditions',parametersObject['Image']='gi-more_items',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![];var sURL=TriSysApex['CustomFormsAndComponents']['UserControlPath'](TriSysApex['Constants']['TermsAndConditionsFile']);if(TriSysApex['Constants']['TermsAndConditionsFile']['indexOf']('https://')===0x0)sURL=TriSysApex['Constants']['TermsAndConditionsFile'];parametersObject['ContentURL']=sURL,parametersObject['ButtonRightText']='OK',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);}},'PrivacyPolicy':{'Show':function(){var sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Privacy\x20Policy',sDocumentPath='https://irp-cdn.multiscreensite.com/f3b4d364/files/uploaded/Privacy-Policy.pdf';TriSysApex['ModalDialogue']['DocumentViewer']['Show'](sTitle,sDocumentPath);}},'CompanyAddresses':{'Select':function(lCompanyId,sCompany,lContactId,lIgnoreAddressId,fnSelectedAddress){var fnPopulationByFunction={'API':'Company/ListAddresses','Parameters':function(request){request['CompanyId']=lCompanyId,request['ContactId']=lContactId,request['IgnoreAddressId']=lIgnoreAddressId,request['StreetNewlineSeparator']=',\x20';},'DataTableFunction':function(response){return response['List'];}},sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20'+sCompany+'\x20Address',sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=[{'field':'AddressId','title':'AddressID','type':'number','width':0x46,'hidden':!![]},{'field':'CompanyId','title':'CompanyID','type':'number','width':0x46,'hidden':!![]},{'field':'AddressType','title':'Type','type':'string'},{'field':'Street','title':'Street','type':'string'},{'field':'City','title':'City','type':'string'},{'field':'County','title':'County','type':'string'},{'field':'PostCode','title':'Post\x20Code','type':'string'},{'field':'Country','title':'Country','type':'string'}],sqlParameters['CallbackFunction']=fnSelectedAddress,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'SelectForSmallFormFactorDevices':function(lCompanyId,sCompany,fnSelectedAddress){var fnPopulationByFunction={'API':'Company/ListAddresses','Parameters':function(request){request['CompanyId']=lCompanyId,request['StreetNewlineSeparator']=',\x20',request['SingleAddressField']=!![];},'DataTableFunction':function(response){return response['List'];}},sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20'+sCompany+'\x20Address',sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=[{'field':'AddressId','title':'AddressID','type':'number','width':0x46,'hidden':!![]},{'field':'CompanyId','title':'CompanyID','type':'number','width':0x46,'hidden':!![]},{'field':'AddressType','title':'Type','type':'string'},{'field':'Address','title':'Address','type':'string'}],sqlParameters['CallbackFunction']=fnSelectedAddress,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'PopulateCombo':function(lCompanyId,sComboDiv,fnCallbackAfterPopulation,options){var fnPopulationByFunction={'API':'Company/ListAddresses','Parameters':function(request){request['CompanyId']=lCompanyId;},'DataTableFunction':function(response){return response['List'];}},fnPopulateAddresses=function(dt){var source=[];for(var i=0x0;i<dt['length'];i++){var dr=dt[i],lAddressId=dr['AddressId'],sStreet=dr['Street'],sCity=dr['City'],sCounty=dr['County'],sPostCode=dr['PostCode'],sCountry=dr['Country'],sTelNo=dr['TelNo'],sAddressType=dr['AddressType'],sSeparator=',\x20';if(options&&options['Separator'])sSeparator=options['Separator'];if(sStreet)sStreet=sStreet['replace'](/\r\n/g,sSeparator)+sSeparator;var sAddress=sAddressType+':\x20'+sStreet+(sCity?sSeparator+sCity:'')+(sCounty?sSeparator+sCounty:'')+(sPostCode?sSeparator+sPostCode:'');if(sCountry)sAddress+=sSeparator+sCountry;var sourceStruct={'value':lAddressId,'text':sAddress};source['push'](sourceStruct);}if(source['length']==0x0){TriSysApex['ModalDialogue']['CompanyAddresses']['NoCompanyAddresses']();return;}TriSysSDK['CShowForm']['populateComboFromDataSource'](sComboDiv,source,0x0,null,options);if(fnCallbackAfterPopulation)fnCallbackAfterPopulation();};TriSysSDK['Database']['GetDataSetFromFunction'](fnPopulationByFunction,fnPopulateAddresses);},'NoCompanyAddresses':function(){var fnYes=function(){return setTimeout(function(){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['Pages']['CompanyForm']['NewAddress']();},TriSysApex['Constants']['NewRecordFormDelay']),!![];},fnNo=function(){return setTimeout(function(){TriSysApex['UI']['CloseModalPopup']();},TriSysApex['Constants']['NewRecordFormDelay']),!![];},sMessage='No\x20addresses\x20exist\x20for\x20the\x20company.\x20Create\x20a\x20new\x20one?';TriSysApex['UI']['questionYesNo'](sMessage,'Add\x20Company\x20Contact','Yes',fnYes,'No',fnNo);}},'CompanyContacts':{'Select':function(lCompanyId,sCompany,lContactId,fnSelectedContact){var fnPopulationByFunction={'API':'Company/ListAddressesAndContacts','Parameters':function(request){request['CompanyId']=lCompanyId,request['IgnoreContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}},sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20'+sCompany+'\x20Contact',sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=TriSysApex['Pages']['CompanyForm']['AddressesAndContacts']['Columns'],sqlParameters['CallbackFunction']=fnSelectedContact,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}},'Contacts':{'Select':function(fnSelectedContact,selectOptions){var columns=TriSysSDK['Grid']['HideColumns'](TriSysApex['Pages']['ContactsForm']['Columns'],['Contact_HomeEMail','Contact_WorkTelNo','Contact_MobileTelNo','Contact_HomeAddressTelNo']),sTitle='Select\x20a\x20Contact';if(selectOptions){if(selectOptions['Title'])sTitle=selectOptions['Title'];}var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedContact,sqlParameters['EntityName']='Contact',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid',TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters,selectOptions);}},'ContactsByObject':{'Show':function(sTitle,contacts,bCandidate){var fnPopulateButtons=function(parametersObject,sGridDivID){parametersObject['ButtonLeftVisible']=![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![];},columns=[{'field':'ContactId','title':'ID','type':'number','width':0x46,'hidden':!![]},{'field':'FullName','title':'Full\x20Name','type':'string'},{'field':'Forenames','title':'Forename(s)','type':'string','hidden':!![]},{'field':'Surname','title':'Surname','type':'string','hidden':!![]},{'field':'CompanyName','title':'Company','type':'string','hidden':bCandidate},{'field':'WorkEMail','title':'Work\x20E-Mail','type':'string','hidden':bCandidate},{'field':'PersonalEMail','title':'Home\x20E-Mail','type':'string','hidden':!bCandidate},{'field':'WorkTelNo','title':'Work\x20Tel.\x20No','type':'string','hidden':bCandidate},{'field':'MobileTelNo','title':'Personal\x20Mobile','type':'string'},{'field':'WorkMobileTelNo','title':'Work\x20Mobile','type':'string','hidden':!![]},{'field':'HomeAddressTelNo','title':'Home\x20Tel.\x20No','type':'string','hidden':!bCandidate},{'field':'Title','title':'Title','type':'string','hidden':!![]},{'field':'CompanyAddressStreet','title':'Company\x20Street\x20Address','type':'string','hidden':!![]},{'field':'CompanyAddressCity','title':'Company\x20Street\x20City','type':'string','hidden':!![]},{'field':'CompanyAddressCounty','title':'Company\x20Street\x20County','type':'string','hidden':!![]},{'field':'CompanyAddressPostCode','title':'Company\x20Street\x20Post/ZIP\x20Code','type':'string','hidden':!![]},{'field':'CompanyAddressCountry','title':'Company\x20Street\x20Country','type':'string','hidden':!![]},{'field':'HomeAddressStreet','title':'Home\x20Street\x20Address','type':'string','hidden':!![]},{'field':'HomeAddressCity','title':'Home\x20Street\x20City','type':'string','hidden':!bCandidate},{'field':'HomeAddressCounty','title':'Home\x20Street\x20County','type':'string','hidden':!![]},{'field':'HomeAddressPostCode','title':'Home\x20Street\x20Post/ZIP\x20Code','type':'string','hidden':!![]},{'field':'HomeAddressCountry','title':'Home\x20Street\x20Country','type':'string','hidden':!![]},{'field':'ContactType','title':'Contact\x20Type','type':'string','hidden':!![]},{'field':'JobTitle','title':'Job\x20Title','type':'string','hidden':!![]},{'field':'AvailabilityDate','title':'Availability\x20Date','hidden':!![],'type':'date','format':'{0:dd\x20MMM\x20yyyy\x20}'}],fnPopulateGrid=function(sGridID){TriSysSDK['Grid']['VirtualMode']({'Div':sGridID,'ID':'grdContacts','RecordsPerPage':0xa,'PopulationByObject':contacts,'Columns':columns,'KeyColumnName':'ContactId','DrillDownFunction':function(rowData){TriSysApex['UI']['CloseModalPopup'](),TriSysApex['FormsManager']['OpenForm']('Contact',rowData['ContactId']);},'MultiRowSelect':![],'Grouping':TriSysApex['UserOptions']['GridGrouping'](),'ColumnFilters':!![]});};if(!sTitle)sTitle='Contacts';TriSysApex['ModalDialogue']['Grid']['Show'](sTitle,null,fnPopulateButtons,fnPopulateGrid);}},'ClientContacts':{'Select':function(fnSelectedContact,selectOptions){var fnParameterFunction=function(request){request['ClientContactsOnly']=!![];},columns=[{'field':'ContactId','title':'ContactId','type':'number','width':0x46,'hidden':!![]},{'field':'CompanyId','title':'CompanyId','type':'number','width':0x46,'hidden':!![]},{'field':'AddressId','title':'AddressId','type':'number','width':0x46,'hidden':!![]},{'field':'Christian','title':'Forename(s)','type':'string'},{'field':'Surname','title':'Surname','type':'string'},{'field':'Name','title':'Company','type':'string'},{'field':'Street','title':'Street','type':'string'},{'field':'City','title':'City','type':'string'}],sTitle='Select\x20a\x20Client\x20Contact';if(selectOptions){if(selectOptions['Title'])sTitle=selectOptions['Title'];}var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['ParameterFunction']=fnParameterFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedContact,sqlParameters['EntityName']='Contact',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid',TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters,selectOptions);}},'CandidateContacts':{'Select':function(fnSelectedContact,selectOptions){var fnParameterFunction=function(request){request['CandidateContactsOnly']=!![];},columns=[{'field':'ContactId','title':'ContactId','type':'number','width':0x46,'hidden':!![]},{'field':'AddressId','title':'AddressId','type':'number','width':0x46,'hidden':!![]},{'field':'Christian','title':'Forename(s)','type':'string'},{'field':'Surname','title':'Surname','type':'string'},{'field':'Street','title':'Street','type':'string'},{'field':'City','title':'City','type':'string'},{'field':'County','title':'County','type':'string'},{'field':'PostCode','title':'Post\x20Code','type':'string'}],sTitle='Select\x20a\x20Candidate\x20Contact';if(selectOptions){if(selectOptions['Title'])sTitle=selectOptions['Title'];}var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['ParameterFunction']=fnParameterFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedContact,sqlParameters['EntityName']='Contact',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid',TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters,selectOptions);}},'ContactEMailAddress':{'Select':function(lContactId,fnCallback){var fnPopulationByFunction={'API':'Contact/EMailAddresses','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}},columns=[{'field':'TypeOfEMail','title':'Type','type':'string','width':0xaa},{'field':'EMailAddress','title':'E-Mail\x20Address','type':'string'}],sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Contact\x20E-Mail',sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=function(selectedRow){if(!selectedRow)return;var sTypeOfEMail=selectedRow['TypeOfEMail'],sEMailAddress=selectedRow['EMailAddress'];if(fnCallback)fnCallback(sTypeOfEMail,sEMailAddress);return!![];},TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}},'Companies':{'Select':function(fnSelectedCompany){var columns=TriSysSDK['Grid']['HideColumns'](TriSysApex['Pages']['CompaniesForm']['Columns'],['Company_Comments']),sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Company',sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedCompany,sqlParameters['EntityName']='Company',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid',TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}},'Requirements':{'Select':function(fnSelectedRequirement){var columns=TriSysSDK['Grid']['HideColumns'](TriSysApex['Pages']['RequirementsForm']['Columns'],['Requirement_EarliestStartDate','Requirement_Fee','Requirement_SiteAddress','Requirement_Comments']),sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Requirement',sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedRequirement,sqlParameters['EntityName']='Requirement',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid';var selectOptions={'FullScreen':!![],'CloseTopRightButton':!![]};TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters,selectOptions);}},'Placements':{'Select':function(fnSelectedPlacement){var columns=TriSysSDK['Grid']['HideColumns'](TriSysApex['Pages']['PlacementsForm']['Columns'],['Placement_EndDate','Placement_Fee','Placement_Salary']),sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Placement',sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedPlacement,sqlParameters['EntityName']='Placement',sqlParameters['TemplateFile']='ctrlModalEntitySelection.html',sqlParameters['Div']='divModalEntitySelectionGrid',TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}},'Users':{'Select':function(fnSelectedUser,options){var sTitle='Select\x20a\x20User',bNotLocked=![],bMultiSelect=![];if(options){if(options['Title'])sTitle=options['Title'];if(options['NotLocked'])bNotLocked=!![];if(options['MultiSelect'])bMultiSelect=!![];}var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['PopulationByObject']=TriSysApex['Cache']['Users'](bNotLocked),sqlParameters['Columns']=TriSysApex['ModalDialogue']['Users']['Columns'],sqlParameters['MultiSelect']=bMultiSelect,sqlParameters['CallbackFunction']=fnSelectedUser,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'Columns':[{'field':'UserId','title':'UserId','type':'number','width':0x46,'hidden':!![]},{'field':'FullName','title':'User\x20Name','type':'string'},{'field':'LoginName','title':'Login\x20Name','type':'string'},{'field':'TelNo','title':'Tel.\x20No.','type':'string'}]},'Entity':{'Select':function(fnSelectedEntity){var entities=[{'Entity':'Contact'},{'Entity':'Company'},{'Entity':'Requirement'},{'Entity':'Placement'},{'Entity':'User'}],entityParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();entityParameters['Title']='Select\x20an\x20Entity',entityParameters['PopulationByObject']=entities,entityParameters['Columns']=[{'field':'Entity','title':'Entity\x20Name','type':'string'}],entityParameters['CallbackFunction']=fnSelectedEntity,TriSysApex['ModalDialogue']['Selection']['Show'](entityParameters);}},'EntityRecord':{'Select':function(sEntityName,fnSelectedEntity){switch(sEntityName){case'Contact':var fnSelectContact=function(selectedRow){if(!selectedRow)return;var lContactId=selectedRow['Contact_ContactId'],sName=sEntityName+':\x20'+selectedRow['Contact_Christian']+'\x20'+selectedRow['Contact_Surname'];return fnSelectedEntity(sEntityName,lContactId,sName),!![];};TriSysApex['ModalDialogue']['Contacts']['Select'](fnSelectContact);break;case'Company':var fnSelectedCompany=function(selectedRow){if(!selectedRow)return;var lCompanyId=selectedRow['Company_CompanyId'],sName=sEntityName+':\x20'+selectedRow['Company_Name'];return fnSelectedEntity(sEntityName,lCompanyId,sName),!![];};TriSysApex['ModalDialogue']['Companies']['Select'](fnSelectedCompany);break;case'Requirement':var fnSelectedRequirement=function(selectedRow){if(!selectedRow)return;var lRequirementId=selectedRow['Requirement_RequirementId'],sName=sEntityName+':\x20'+selectedRow['Requirement_RequirementReference']+':\x20'+selectedRow['Requirement_JobTitle']+'\x20at\x20'+selectedRow['RequirementCompany_Name'];return fnSelectedEntity(sEntityName,lRequirementId,sName),!![];};TriSysApex['ModalDialogue']['Requirements']['Select'](fnSelectedRequirement);break;case'Placement':var fnSelectedPlacement=function(selectedRow){if(!selectedRow)return;var lPlacementId=selectedRow['Placement_PlacementId'],sName=sEntityName+':\x20'+selectedRow['Placement_Reference']+':\x20'+selectedRow['CandidateContact_FullName']+',\x20'+selectedRow['Placement_JobTitle']+'\x20at\x20'+selectedRow['PlacementCompany_Name'];return fnSelectedEntity(sEntityName,lPlacementId,sName),!![];};TriSysApex['ModalDialogue']['Placements']['Select'](fnSelectedPlacement);break;case'User':var fnSelectUser=function(selectedRow){if(!selectedRow)return;var lUserId=selectedRow['UserId'];if(!lUserId)return;var user=TriSysApex['Cache']['UsersManager']['UserFromId'](lUserId);if(!user)return;return sName=sEntityName+':\x20'+user['FullName'],fnSelectedEntity(sEntityName,lUserId,sName),!![];};TriSysApex['ModalDialogue']['Users']['Select'](fnSelectUser,{'NotLocked':!![]});break;}}},'PostCode':{'Select':function(addresses,fnSelectedPostCode,columnOverrides){var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Post\x20Code',sqlParameters['PopulationByObject']=addresses,sqlParameters['Columns']=columnOverrides?columnOverrides:TriSysApex['ModalDialogue']['PostCode']['Columns'],sqlParameters['CallbackFunction']=fnSelectedPostCode,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'Columns':[{'field':'AddressId','title':'AddressID','type':'number','width':0x46,'hidden':!![]},{'field':'Street','title':'Street','type':'string'},{'field':'City','title':'City','type':'string'},{'field':'County','title':'County','type':'string'},{'field':'PostCode','title':'Post\x20Code','type':'string'},{'field':'Country','title':'Country','type':'string'}]},'JobTitle':{'Select':function(sJobTitlePrefix,jobTitles,fnSelectedJobTitle){var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Job\x20Title',sqlParameters['PopulationByObject']=jobTitles,sqlParameters['Columns']=TriSysApex['ModalDialogue']['JobTitle']['Columns'],sqlParameters['CallbackFunction']=fnSelectedJobTitle,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'Columns':[{'field':'JobTitle','title':'Job\x20Title','type':'string'}],'SelectMultiple':function(sJobTitlePrefix,fnSelectedJobTitles){var dataPacket={},payloadObject={};payloadObject['URL']='Cache/JobTitles',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(CJobTitlesResponse){if(CJobTitlesResponse){if(CJobTitlesResponse['Success']){var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Select\x20a\x20Job\x20Title',sqlParameters['Filter']=sJobTitlePrefix,sqlParameters['PopulationByObject']=CJobTitlesResponse['JobTitles'],sqlParameters['Columns']=TriSysApex['ModalDialogue']['JobTitle']['Columns'],sqlParameters['MultiSelect']=!![],sqlParameters['KeyColumnName']='JobTitle',sqlParameters['CallbackFunction']=fnSelectedJobTitles,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}else TriSysApex['Toasters']['Error']('No\x20matching\x20job\x20titles\x20found.');}return!![];},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['ErrorHandlerRedirector']('TriSysApex.ModalDialogue.JobTitle.SelectMultiple:\x20',request,status,error);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'DocumentViewer':{'Show':function(sTitle,sDocumentURL,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='gi-file',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlDocumentViewer.html');if(options)parametersObject['ButtonLeftText']=options['ButtonLeftText'],parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=options['ButtonLeftFunction'];else!TriSysSDK['Controls']['FileManager']['isHTMLFile'](sDocumentURL)&&(parametersObject['ButtonLeftText']='Download\x20and\x20Open',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlDocumentViewer['DownloadAndOpenButtonClick'](sTitle,sDocumentURL),!![];});(TriSysSDK['Controls']['FileManager']['isWordFile'](sDocumentURL)||TriSysSDK['Controls']['FileManager']['isHTMLFile'](sDocumentURL))&&(parametersObject['ButtonCentreText']='Open\x20Full\x20Screen',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){return ctrlDocumentViewer['OpenFullScreen'](sTitle),!![];}),TriSysSDK['Controls']['FileManager']['DocumentPath']=sDocumentURL,parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'DownloadAndOpen':function(sTitle,sDocumentURL){TriSysSDK['Controls']['FileManager']['isWordFile'](sDocumentURL)||TriSysSDK['Controls']['FileManager']['isEMLFile'](sDocumentURL)||TriSysSDK['Controls']['FileManager']['isMSGFile'](sDocumentURL)?TriSysSDK['Controls']['FieldHyperlinks']['OpenURLUsingiFrame'](sDocumentURL):setTimeout('window.open(\x27'+sDocumentURL+'\x27,\x27'+sTitle['replace'](/'/g,'-')+'\x27)',0x32);}},'DocumentEditor':{'Show':function(sTitle,sEditorURL,sFullPath,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlDocumentEditor.html');if(!sFullPath)sFullPath=sEditorURL;var sFileType=TriSysApex['Pages']['FileManagerForm']['DetermineFileTypeForImageFromFilePath'](sFullPath),sImage=TriSysApex['Pages']['FileManagerForm']['ImagePathForFileType'](sFileType);parametersObject['Image']=sImage,!![]&&(parametersObject['ButtonLeftText']='Download\x20and\x20Open',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=function(){return ctrlDocumentEditor['DownloadAndOpenButtonClick'](sTitle,sEditorURL,sFullPath),!![];}),!![]&&(parametersObject['ButtonCentreText']='Open\x20Full\x20Screen',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){return ctrlDocumentEditor['OpenFullScreen'](sEditorURL),!![];}),parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightVisible']=!![],parametersObject['OnLoadCallback']=function(){ctrlDocumentEditor['Load'](sEditorURL);},TriSysApex['UI']['PopupMessage'](parametersObject);}},'Task':{'ShowParameters':function(){this['TaskId']=0x0,this['Scheduled']=![],this['Contacts']=[],this['Users']=[],this['Links']=[],this['TaskType']=null,this['StartDate']=null,this['EndDate']=null;},'QuickShow':function(lTaskId,bScheduled,dtStart,dtEnd){var params=new TriSysApex['ModalDialogue']['Task']['ShowParameters']();params['TaskId']=lTaskId;if(bScheduled)params['Scheduled']=bScheduled;dtStart&&dtEnd&&(params['StartDate']=dtStart,params['EndDate']=dtEnd),TriSysApex['ModalDialogue']['Task']['Show'](params);},'ContextualNew':function(bScheduled){var params=new TriSysApex['ModalDialogue']['Task']['ShowParameters']();if(bScheduled)params['Scheduled']=bScheduled;try{var bCompanyFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Company';if(bCompanyFormOpen){if(bScheduled)companyForm['ScheduledTaskGridFileMenuCallback']('file-new');else companyForm['NotesHistoryGridFileMenuCallback']('file-new');return;}var bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Contact';if(bContactFormOpen){if(bScheduled)contactForm['ScheduledTaskGridFileMenuCallback']('file-new');else contactForm['NotesHistoryGridFileMenuCallback']('file-new');return;}var bRequirementFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Requirement';if(bRequirementFormOpen){if(bScheduled)ctrlRequirementForm['ScheduledTaskGridFileMenuCallback']('file-new');else ctrlRequirementForm['NotesHistoryGridFileMenuCallback']('file-new');return;}var bPlacementFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Placement';if(bPlacementFormOpen){if(bScheduled)ctrlPlacementForm['ScheduledTaskGridFileMenuCallback']('file-new');else ctrlPlacementForm['NotesHistoryGridFileMenuCallback']('file-new');return;}var bTimesheetFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Timesheet';if(bTimesheetFormOpen){if(bScheduled)ctrlTimesheetForm['ScheduledTaskGridFileMenuCallback']('file-new');else ctrlTimesheetForm['NotesHistoryGridFileMenuCallback']('file-new');return;}}catch(e){}var contactPreview=TriSysApex['EntityPreview']['Contact']['ContactFromPreview']();if(contactPreview){var params=new TriSysApex['ModalDialogue']['Task']['ShowParameters']();params['Scheduled']=bScheduled;var contact={'ContactId':contactPreview['ContactId'],'FullName':contactPreview['FullName'],'CompanyName':contactPreview['CompanyName'],'JobTitle':contactPreview['JobTitle'],'ContactType':contactPreview['ContactType']};params['Contacts']['push'](contact),TriSysApex['ModalDialogue']['Task']['Show'](params);return;}TriSysApex['ModalDialogue']['Task']['Show'](params);},'GetModalTitleText':function(bScheduled,iTaskId){var sTitle=bScheduled?'Scheduled\x20Task':'Note/History';if(iTaskId){if(iTaskId>0x0)sTitle+='\x20('+TriSysSDK['Numbers']['ThousandsSeparator'](iTaskId)+')';}return sTitle;},'GetModalImage':function(bScheduled){var sImage=bScheduled?'gi-clock':'gi-edit';return sImage;},'Show':function(parameters){TriSysApex['ModalDialogue']['Parameters']=parameters;var parametersObject=new TriSysApex['UI']['ShowMessageParameters'](),sTitle=TriSysApex['ModalDialogue']['Task']['GetModalTitleText'](TriSysApex['ModalDialogue']['Parameters']['Scheduled']);parametersObject['Title']=sTitle,parametersObject['Image']=TriSysApex['ModalDialogue']['Task']['GetModalImage'](TriSysApex['ModalDialogue']['Parameters']['Scheduled']),parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlTask.html');var bCanDeleteTask=TriSysApex['Cache']['ApplicationSettingsManager']['Security']['Tasks']['DeleteButton']();bCanDeleteTask&&(parametersObject['ButtonFarLeftText']='Delete',parametersObject['ButtonFarLeftVisible']=!![],parametersObject['ButtonFarLeftFunction']=TriSysApex['ModalDialogue']['Task']['DeleteButtonClick']);parametersObject['ButtonThirdLeftText']='Save\x20&\x20Close',parametersObject['ButtonThirdLeftVisible']=!![],parametersObject['ButtonThirdLeftFunction']=TriSysApex['ModalDialogue']['Task']['SaveAndCloseButtonClick'],parametersObject['ButtonLeftText']='Save\x20&\x20Clear',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=TriSysApex['ModalDialogue']['Task']['SaveAndClearButtonClick'];var bAddFollowUp=!![];bAddFollowUp&&(parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=TriSysApex['ModalDialogue']['Task']['FollowUpButtonClick'],parametersObject['ButtonCentreText']='Follow-Up'),parametersObject['ButtonRightText']='Cancel\x20&\x20Close',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'Parameters':null,'AllDayTaskCheckBoxChangeEvent':function(e){var bCheckedAllDayTask=$(e)['is'](':checked');if(bCheckedAllDayTask){$('#taskForm-StartTimeLabel')['hide'](),$('#taskForm-EndTimeLabel')['hide'](),$('#taskForm-StartDateTimeSpan')['hide'](),$('#taskForm-EndDateTimeSpan')['hide'](),$('#taskForm-StartDateSpan')['show'](),$('#taskForm-EndDateSpan')['show']();var dtStart=TriSysSDK['CShowForm']['getDateTimePickerValue']('taskForm-StartDateTime'),dtEnd=TriSysSDK['CShowForm']['getDateTimePickerValue']('taskForm-EndDateTime');TriSysSDK['CShowForm']['setDatePickerValue']('taskForm-StartDate',dtStart),TriSysSDK['CShowForm']['setDatePickerValue']('taskForm-EndDate',dtEnd),dtStart=moment(dtStart)['set']('hour',0x0)['set']('minute',0x0),dtEnd=moment(dtEnd)['set']('hour',0x17)['set']('minute',0x3b),TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-StartDateTime',dtStart),TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-EndDateTime',dtEnd);}else $('#taskForm-StartTimeLabel')['show'](),$('#taskForm-EndTimeLabel')['show'](),$('#taskForm-StartDateTimeSpan')['show'](),$('#taskForm-EndDateTimeSpan')['show'](),$('#taskForm-StartDateSpan')['hide'](),$('#taskForm-EndDateSpan')['hide']();},'ScheduledTaskCheckBoxChangeEvent':function(e){var bScheduled=$(e)['is'](':checked'),sTitle=TriSysApex['ModalDialogue']['Task']['GetModalTitleText'](bScheduled),sImage=TriSysApex['ModalDialogue']['Task']['GetModalImage'](bScheduled);TriSysApex['UI']['SetTopmostModalImageAndTitle'](sImage,sTitle);},'Load':function(){var sTaskDescriptionID='taskForm-Description',elemTaskDescription=$('#'+sTaskDescriptionID);ctrlTask['Data']['Clear']();if(TriSysApex['ModalDialogue']['Parameters']['TaskId']>0x0){var dataPacket={'TaskId':TriSysApex['ModalDialogue']['Parameters']['TaskId']},payloadObject={};payloadObject['URL']='Task/Read',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CTaskReadResponse=data;if(CTaskReadResponse){if(CTaskReadResponse['Success']){var task=CTaskReadResponse['Task'];ctrlTask['Data']['SetTask'](task),TriSysSDK['CShowForm']['SetCheckBoxValue']('taskForm-scheduled',task['Scheduled']);var sTitle=TriSysApex['ModalDialogue']['Task']['GetModalTitleText'](task['Scheduled'],task['TaskId']),sImage=TriSysApex['ModalDialogue']['Task']['GetModalImage'](task['Scheduled']);TriSysApex['UI']['SetTopmostModalImageAndTitle'](sImage,sTitle),TriSysSDK['CShowForm']['SetTaskTypeComboValue']('taskForm-TaskType',task['TaskType']),TriSysActions['Forms']['TaskType']['Icon']('taskForm-TaskType','taskForm-selected-TaskType-Image'),elemTaskDescription['val'](task['Description']),elemTaskDescription['focus']();task['Description']&&(document['getElementById'](sTaskDescriptionID)['selectionStart']=0x0,document['getElementById'](sTaskDescriptionID)['selectionEnd']=0x0,elemTaskDescription['scrollTop'](0x0));TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-StartDateTime',task['StartDate']),TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-EndDateTime',task['EndDate']),TriSysSDK['CShowForm']['SetCheckBoxValue']('taskForm-set-alarm',task['Alarmed']);if(task['Alarmed']&&task['LeadTime'])TriSysSDK['Controls']['Duration']['Set']('taskForm-Duration',task['LeadTime']);var elemLeadTimeRow=$('#taskForm-alarm-lead-time-tr');task['Alarmed']?elemLeadTimeRow['show']():elemLeadTimeRow['hide'](),ctrlTask['LoadContactsGrid'](),ctrlTask['LoadUsersGrid'](),ctrlTask['LoadLinksGrid']();if(task['Attachments']){if(task['Attachments']['length']>0x0){var attachment=task['Attachments'][0x0];TriSysSDK['Controls']['FileReference']['SetFile']('taskForm-Attachment-File-Reference',attachment['DocumentPath']);if(attachment['Description'])$('#taskForm-Attachment-Description')['val'](attachment['Description']);}}return;}else TriSysApex['UI']['ShowMessage'](CTaskReadResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.Task.Load:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Task...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}else{TriSysSDK['CShowForm']['SetCheckBoxValue']('taskForm-scheduled',TriSysApex['ModalDialogue']['Parameters']['Scheduled']);var dtStart=TriSysApex['ModalDialogue']['Parameters']['StartDate'],dtEnd=TriSysApex['ModalDialogue']['Parameters']['EndDate'];if(!dtStart||!dtEnd){var dtNow=new Date(),iMinutes=0xf,sPeriod='minutes',sDurationDefault=TriSysApex['Cache']['UserSettingManager']['GetValue']('Task.DurationDefault');if(sDurationDefault){var parts=sDurationDefault['split']('\x20');parts['length']==0x2&&(iMinutes=parseInt(parts[0x0]),sPeriod=parts[0x1]);}if(TriSysApex['ModalDialogue']['Parameters']['Scheduled'])dtStart=TriSysActions['FollowUp']['FollowUpDateTomorrow']();else dtStart=dtNow;dtEnd=new Date(moment(dtStart)['add'](iMinutes,sPeriod));}if(dtStart)TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-StartDateTime',dtStart);if(dtEnd)TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-EndDateTime',dtEnd);ctrlTask['Data']['_Task']['Contacts']=TriSysApex['ModalDialogue']['Parameters']['Contacts'];var bGetFullContactRecord=!![];ctrlTask['LoadContactsGrid'](bGetFullContactRecord);var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),user=userCredentials['LoggedInUser'],contact=user['Contact'],userObject={'UserId':user['UserId'],'FullName':contact['FullName'],'LoginName':user['LoginName'],'TelNo':contact['WorkTelNo']},userList=[userObject];ctrlTask['Data']['_Task']['Users']=userList,ctrlTask['LoadUsersGrid'](),ctrlTask['Data']['_Task']['Links']=TriSysApex['ModalDialogue']['Parameters']['Links'],ctrlTask['LoadLinksGrid'](),elemTaskDescription['focus']();}},'DeleteButtonClick':function(){var lTaskId=TriSysApex['ModalDialogue']['Parameters']['TaskId'];if(lTaskId<=0x0)return;var sMessage='Delete\x20task:\x20'+lTaskId+'?',fnDelete=function(){return TriSysApex['ModalDialogue']['Task']['SubmitTaskDeletion'](lTaskId),TriSysApex['UI']['CloseModalPopup'](),!![];};TriSysApex['UI']['questionYesNo'](sMessage,TriSysApex['Copyright']['ShortProductName'],'Yes',fnDelete,'No');},'SaveAndClearButtonClick':function(fnCallback){TriSysSDK['CShowForm']['SetCheckBoxValue']('taskForm-scheduled',![]),TriSysApex['ModalDialogue']['Task']['SaveAndCloseButtonClick'](fnCallback);},'SaveAndCloseButtonClick':function(fnPostSaveBeforeClose){try{var task={};task['TaskId']=TriSysApex['ModalDialogue']['Parameters']['TaskId'],task['Scheduled']=TriSysSDK['CShowForm']['CheckBoxValue']('taskForm-scheduled'),task['TaskType']=TriSysSDK['CShowForm']['GetTaskTypeFromCombo']('taskForm-TaskType'),task['StartDate']=TriSysSDK['CShowForm']['getDateTimePickerValue']('taskForm-StartDateTime'),task['EndDate']=TriSysSDK['CShowForm']['getDateTimePickerValue']('taskForm-EndDateTime'),task['Description']=$('#taskForm-Description')['val'](),task['Alarmed']=TriSysSDK['CShowForm']['CheckBoxValue']('taskForm-set-alarm'),task['LeadTime']=TriSysSDK['Controls']['Duration']['Get']('taskForm-Duration');if(!task['Scheduled'])task['Alarmed']=![];var contactList=ctrlTask['Data']['Contacts']();if(contactList&&contactList['length']>0x0){var taskContactList=[];for(var i=0x0;i<contactList['length'];i++){var contact=contactList[i],contactSparse={'ContactId':contact['ContactId']};taskContactList['push'](contactSparse);}task['Contacts']=taskContactList;}var userList=ctrlTask['Data']['Users']();if(userList&&userList['length']>0x0){var taskUserList=[];for(var i=0x0;i<userList['length'];i++){var user=userList[i],userSparse={'UserId':user['UserId']};taskUserList['push'](userSparse);}task['Users']=taskUserList;}var entityLinkList=ctrlTask['Data']['Links']();if(entityLinkList){var taskEntityLinkList=[];for(var i=0x0;i<entityLinkList['length'];i++){var link=entityLinkList[i],linkSparse={'Name':link['Name'],'RecordId':link['RecordId']};taskEntityLinkList['push'](linkSparse);}task['Links']=taskEntityLinkList;}task['Skills']=ctrlSkillsTree['ReadSkills']('task-form-attributes');var sFileAttachment=TriSysSDK['Controls']['FileReference']['GetFile']('taskForm-Attachment-File-Reference'),sFileDescription=$('#taskForm-Attachment-Description')['val']();(sFileAttachment||sFileDescription)&&(task['Attachments']=[{'DocumentPath':sFileAttachment,'Description':sFileDescription}]);}catch(e){TriSysApex['UI']['ShowMessage']('SaveAndCloseButtonClick\x20Error:\x20'+TriSysApex['Logging']['CatchVariableToText'](e));}var bError=![];if(!task['Description'])bError=TriSysApex['Toasters']['ErrorValidatingField']('Description');if(!task['StartDate'])bError=TriSysApex['Toasters']['ErrorValidatingField']('Start\x20Date');if(!task['EndDate'])bError=TriSysApex['Toasters']['ErrorValidatingField']('End\x20Date');if(!task['Users']||task['Users']['length']==0x0)bError=TriSysApex['Toasters']['ErrorValidatingList']('User');if(moment(task['StartDate'])>moment(task['EndDate']))bError=TriSysApex['Toasters']['ErrorValidatingField']('Start\x20Date\x20which\x20is\x20earlier\x20than\x20the\x20end\x20date');if(bError)return![];if(ctrlTask['Data']['_Task']['OwnerUserId']>0x0)task['OwnerUserId']=ctrlTask['Data']['_Task']['OwnerUserId'];TriSysApex['ModalDialogue']['Task']['SubmitTaskUpdate'](task,fnPostSaveBeforeClose);},'SubmitTaskUpdate':function(task,fnPostSaveBeforeClose){var dataPacket={'Task':task,'DiaryTask':!![]},payloadObject={};payloadObject['URL']='Task/Write',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CTaskWriteResponse=data;if(CTaskWriteResponse){if(CTaskWriteResponse['Success']){var updatedTask=CTaskWriteResponse['Task'],bCloseTaskDialogue=!![];fnPostSaveBeforeClose&&(fnPostSaveBeforeClose(updatedTask),bCloseTaskDialogue=![]);TriSysApex['ModalDialogue']['Task']['PostTaskUpdate'](updatedTask,bCloseTaskDialogue);return;}else TriSysApex['UI']['ShowMessage'](CTaskWriteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.Task.SubmitTaskUpdate:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Saving\x20Task...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'PostTaskUpdate':function(task,bCloseModalPopup){if(bCloseModalPopup)TriSysApex['UI']['CloseModalPopup']();var bDiaryOpen=TriSysApex['FormsManager']['isFormOpen']('DiaryManager');if(bDiaryOpen)TriSysSDK['Scheduler']['RefreshFromServer']();var lTaskId=0x0;if(task)lTaskId=task['TaskId'];TriSysApex['FormsManager']['EntityUpdateController']['AsynchronousEntityUpdate']('Task',lTaskId);},'DeleteTask':function(lTaskId){var sMessage='Delete\x20task:\x20'+lTaskId+'?',fnDelete=function(){return TriSysApex['ModalDialogue']['Task']['SubmitTaskDeletion'](lTaskId),!![];};TriSysApex['UI']['questionYesNo'](sMessage,TriSysApex['Copyright']['ShortProductName'],'Yes',fnDelete,'No');},'SubmitTaskDeletion':function(lTaskId){var dataPacket={'TaskId':lTaskId},payloadObject={};payloadObject['URL']='Task/Delete',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CTaskDeleteResponse=data;if(CTaskDeleteResponse){if(CTaskDeleteResponse['Success']){var deletedTask={'TaskId':lTaskId};TriSysApex['ModalDialogue']['Task']['PostTaskUpdate'](deletedTask,![]);return;}else TriSysApex['UI']['ShowMessage'](CTaskDeleteResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.Task.SubmitTaskDeletion:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Task...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'GetSelectedSingletonTaskIdFromTaskGrid':function(sGrid){var lTaskId=TriSysSDK['Grid']['GetSelectedSingletonRowRecordIdFromGrid'](sGrid,'TaskId','task');return lTaskId;},'FollowUpButtonClick':function(){var fnPostSaveBeforeClose=function(task){TriSysApex['ModalDialogue']['Parameters']['TaskId']=0x0,TriSysSDK['CShowForm']['SetCheckBoxValue']('taskForm-scheduled',!![]);var dtStart=new Date(moment(new Date())['add'](0x1,'days'));while(dtStart['getMinutes']()%0xf!=0x0)dtStart=new Date(moment(dtStart)['add'](0x1,'minutes'));task['StartDate']=dtStart,task['EndDate']=moment(task['StartDate'])['add'](0x5,'minutes'),task['Description']='Follow-up:\x20'+task['Description'],TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-StartDateTime',task['StartDate']),TriSysSDK['CShowForm']['setDateTimePickerValue']('taskForm-EndDateTime',task['EndDate']);var sTaskDescriptionID='taskForm-Description',elemTaskDescription=$('#'+sTaskDescriptionID);elemTaskDescription['val'](task['Description']),elemTaskDescription['focus'](),task['Description']&&(document['getElementById'](sTaskDescriptionID)['selectionStart']=0x0,document['getElementById'](sTaskDescriptionID)['selectionEnd']=0x0,elemTaskDescription['scrollTop'](0x0));};TriSysApex['ModalDialogue']['Task']['SaveAndClearButtonClick'](fnPostSaveBeforeClose);}},'ContactEducationHistory':{'ContactEducationHistoryId':null,'ContactName':null,'Show':function(lContactEducationHistoryId){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(lContactId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20contact\x20record\x20before\x20adding\x20education\x20history.');return;}TriSysApex['ModalDialogue']['ContactEducationHistory']['ContactEducationHistoryId']=lContactEducationHistoryId,TriSysApex['ModalDialogue']['ContactEducationHistory']['ContactName']=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']();var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=TriSysApex['ModalDialogue']['ContactEducationHistory']['ContactName']+'\x20Education\x20History',parametersObject['Image']='fa-graduation-cap',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlEducationHistory.html'),parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=TriSysApex['ModalDialogue']['ContactEducationHistory']['SaveButtonClick'],TriSysApex['UI']['PopupMessage'](parametersObject);},'SaveButtonClick':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];ctrlEducationHistory['Save'](lContactId);},'Delete':function(lContactEducationHistoryId){var fnDelete=function(){return TriSysApex['ModalDialogue']['ContactEducationHistory']['DeleteRecord'](lContactEducationHistoryId),!![];};TriSysApex['UI']['questionYesNo']('Delete\x20Education\x20History\x20Record?',TriSysApex['Copyright']['ShortProductName'],'Yes',fnDelete,'No');},'DeleteRecord':function(lContactEducationHistoryId){var CDeleteEducationHistoryRequest={};CDeleteEducationHistoryRequest['ContactEducationHistoryId']=lContactEducationHistoryId;var payloadObject={};payloadObject['URL']='Contacts/DeleteEducationHistory',payloadObject['OutboundDataPacket']=CDeleteEducationHistoryRequest,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CDeleteEducationHistoryResponse=data;if(CDeleteEducationHistoryResponse){if(CDeleteEducationHistoryResponse['Success']){var sGrid='contactForm-EducationHistoryGrid';TriSysSDK['Grid']['ClearCheckedRows'](sGrid),TriSysSDK['Grid']['RefreshData'](sGrid);return;}else TriSysApex['UI']['ShowMessage'](CDeleteEducationHistoryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.ContactEducationHistory.DeleteRecord:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Education\x20History...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'ContactWorkHistory':{'ContactWorkHistoryId':null,'ContactName':null,'Show':function(lContactWorkHistoryId){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];if(lContactId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20contact\x20record\x20before\x20adding\x20work\x20history.');return;}TriSysApex['ModalDialogue']['ContactWorkHistory']['ContactWorkHistoryId']=lContactWorkHistoryId,TriSysApex['ModalDialogue']['ContactWorkHistory']['ContactName']=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']();var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=TriSysApex['ModalDialogue']['ContactWorkHistory']['ContactName']+'\x20Work\x20History',parametersObject['Image']='gi-factory',parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlWorkHistory.html'),parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=TriSysApex['ModalDialogue']['ContactWorkHistory']['SaveButtonClick'],TriSysApex['UI']['PopupMessage'](parametersObject);},'SaveButtonClick':function(){var lContactId=TriSysApex['Pages']['ContactForm']['ContactId'];ctrlWorkHistory['Save'](lContactId);},'Delete':function(lContactWorkHistoryId){var fnDelete=function(){return TriSysApex['ModalDialogue']['ContactWorkHistory']['DeleteRecord'](lContactWorkHistoryId),!![];};TriSysApex['UI']['questionYesNo']('Delete\x20Work\x20History\x20Record?',TriSysApex['Copyright']['ShortProductName'],'Yes',fnDelete,'No');},'DeleteRecord':function(lContactWorkHistoryId){var CDeleteWorkHistoryRequest={};CDeleteWorkHistoryRequest['ContactWorkHistoryId']=lContactWorkHistoryId;var payloadObject={};payloadObject['URL']='Contacts/DeleteWorkHistory',payloadObject['OutboundDataPacket']=CDeleteWorkHistoryRequest,payloadObject['InboundDataFunction']=function(data){TriSysApex['UI']['HideWait']();var CDeleteWorkHistoryResponse=data;if(CDeleteWorkHistoryResponse){if(CDeleteWorkHistoryResponse['Success']){var sGrid='contactForm-WorkHistoryGrid';TriSysSDK['Grid']['ClearCheckedRows'](sGrid),TriSysSDK['Grid']['RefreshData'](sGrid);return;}else TriSysApex['UI']['ShowMessage'](CDeleteWorkHistoryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.ContactWorkHistory.DeleteRecord:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Deleting\x20Work\x20History...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'DocumentLibrary':{'Context':{'EntityName':null,'RecordId':null,'Grid':null,'DocumentId':null,'Files':null},'Show':function(sEntityName,lRecordId,sGrid,lDocumentId){if(lRecordId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20'+sEntityName+'\x20record\x20before\x20adding\x20documents.');return;}var context=TriSysApex['ModalDialogue']['DocumentLibrary']['Context'];context['EntityName']=sEntityName,context['RecordId']=lRecordId,context['Grid']=sGrid,context['DocumentId']=lDocumentId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sEntityName+'\x20Library\x20Document',parametersObject['Image']='fa-folder-o',parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlOpenLibraryDocument.html'),parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=TriSysApex['ModalDialogue']['DocumentLibrary']['SaveDocument'],TriSysApex['UI']['PopupMessage'](parametersObject);},'SaveDocument':function(){ctrlOpenLibraryDocument['SaveButtonClick']();}},'ContractRates':{'Context':{'EntityName':null,'RecordId':null,'Grid':null,'RateId':null},'Show':function(sEntityName,lRecordId,sGrid,lRateId){if(lRecordId<=0x0){TriSysApex['UI']['ShowMessage']('Please\x20save\x20the\x20'+sEntityName+'\x20record\x20before\x20adding\x20rates.');return;}var context=TriSysApex['ModalDialogue']['ContractRates']['Context'];context['EntityName']=sEntityName,context['RecordId']=lRecordId,context['Grid']=sGrid,context['RateId']=lRateId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sEntityName+'\x20Pay/Charge\x20Rate(s)',parametersObject['Image']='gi-gbp',parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlContractRate.html'),parametersObject['ButtonLeftText']='Add\x20New',parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftFunction']=TriSysApex['ModalDialogue']['ContractRates']['AddNewRate'],parametersObject['ButtonCentreText']='Apply',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=TriSysApex['ModalDialogue']['ContractRates']['ApplyRates'],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightVisible']=!![],TriSysApex['UI']['PopupMessage'](parametersObject);},'AddNewRate':function(){ctrlContractRate['AddNewButtonClick']();},'ApplyRates':function(){ctrlContractRate['SaveButtonClick']();}},'Skill':{'Select':function(lSkillCategoryId,lSkillId,sTitle,fnSelectedSkill){var fnPopulationByFunction={'API':'Skills/ListByCategory','Parameters':function(request){request['CategoryId']=lSkillCategoryId,request['IgnoreSkillId']=lSkillId;},'DataTableFunction':function(response){return response['Skills'];}},columns=[{'field':'SkillId','title':'SkillId','type':'number','width':0x46,'hidden':!![]},{'field':'Skill','title':'Skill','type':'string'},{'field':'Description','title':'Description','type':'string'}],sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedSkill,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'SelectNonFieldFromAnyCategory':function(lSkillId,sTitle,fnSelectedSkill){var fnPopulationByFunction={'API':'Skills/ListByCategory','Parameters':function(request){request['NonFields']=!![],request['IgnoreSkillId']=lSkillId;},'DataTableFunction':function(response){return response['Skills'];}},columns=[{'field':'SkillId','title':'SkillId','type':'number','width':0x46,'hidden':!![]},{'field':'Category','title':'Category','type':'string'},{'field':'Skill','title':'Skill','type':'string'},{'field':'Description','title':'Description','type':'string'}],sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedSkill,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'SelectAnyCategory':function(lSkillCategoryId,sTitle,fnSelectedSkill){var fnPopulationByFunction={'API':'Skills/ListCategories','Parameters':function(request){request['NonFields']=!![],request['IgnoreSkillCategoryId']=lSkillCategoryId;},'DataTableFunction':function(response){return response['Categories'];}},columns=[{'field':'SkillCategoryId','title':'SkillCategoryId','type':'number','width':0x46,'hidden':!![]},{'field':'Category','title':'Category','type':'string'},{'field':'Description','title':'Description','type':'string'}],sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']=sTitle,sqlParameters['PopulationByFunction']=fnPopulationByFunction,sqlParameters['Columns']=columns,sqlParameters['CallbackFunction']=fnSelectedSkill,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);}},'Grid':{'PopulateGridFunction':null,'Show':function(sTitle,sImage,fnButtons,fnPopulateGrid,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage?sImage:'fa-database',parametersObject['Maximize']=!![];if(options){if(options['CloseTopRightButton'])parametersObject['CloseTopRightButton']=!![];}parametersObject['VerticalScrollbar']=!![],parametersObject['FullScreen']=!![],parametersObject['Draggable']=![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlModalGrid.html'),fnButtons(parametersObject,'divModalGrid'),TriSysApex['ModalDialogue']['Grid']['PopulateGridFunction']=fnPopulateGrid,TriSysApex['UI']['PopupMessage'](parametersObject);}},'New':{'Popup':function(sTitle,sImage,fnSubmitCallback,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlNew.html');var sSaveText='Save';if(options&&options['SaveButtonText'])sSaveText=options['SaveButtonText'];parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sSaveText,parametersObject['ButtonLeftFunction']=function(){var sName=ctrlNew['GetName'](),bError=![],sField='Name';if(options&&options['Label'])sField=options['Label'];if(!sName)bError=TriSysApex['Toasters']['ErrorValidatingField'](sField);if(bError)return![];return fnSubmitCallback(sName);},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel';if(options){parametersObject['OnLoadCallback']=function(){if(options['Label'])$('#ctrlNew-Label')['html'](options['Label']);if(options['Value'])$('#ctrlNew-Name')['val'](options['Value']);options['Instructions']&&($('#ctrlNew-Instructions-tr')['show'](),$('#ctrlNew-Instructions')['html'](options['Instructions'])),$('#ctrlNew-Name')['keyup'](function(e){e['keyCode']==0xd&&(parametersObject['ButtonLeftFunction'](),e['stopPropagation'](),TriSysApex['UI']['CloseModalPopup']());});};if(options['ButtonLabel'])parametersObject['ButtonLeftText']=options['ButtonLabel'];}TriSysApex['UI']['PopupMessage'](parametersObject);}},'NewWithCombo':{'Popup':function(sTitle,sImage,fnSubmitCallback,options){var fnLoadControlHTML=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlNewWithCombo.html'),parametersObject['OnLoadCallback']=function(){ctrlNewWithCombo['Load'](options,fnSubmitCallback);};var sSaveText='Save';if(options&&options['SaveButtonText'])sSaveText=options['SaveButtonText'];parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sSaveText,parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlNewWithCombo['Save']();return bSaved;},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlNewWithCombo.js',null,fnLoadControlHTML);}},'NewWithMultipleFields':{'Popup':function(sTitle,sImage,fnSubmitCallback,options){var fnLoadControlHTML=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlNewWithMultipleFields.html'),parametersObject['OnLoadCallback']=function(){ctrlNewWithMultipleFields['Load'](options,fnSubmitCallback);};var sSaveText='Save';if(options&&options['SaveButtonText'])sSaveText=options['SaveButtonText'];parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sSaveText,parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlNewWithMultipleFields['Save']();return bSaved;},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlNewWithMultipleFields.js',null,fnLoadControlHTML);}},'Combo':{'Popup':function(sTitle,sImage,fnSubmitCallback,options){var fnLoadControlHTML=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlCombo.html'),parametersObject['OnLoadCallback']=function(){ctrlCombo['Load'](options,fnSubmitCallback);};var sSaveText='Save';if(options&&options['SaveButtonText'])sSaveText=options['SaveButtonText'];parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sSaveText,parametersObject['ButtonLeftFunction']=function(){var bSaved=ctrlCombo['Save']();return bSaved;},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlCombo.js',null,fnLoadControlHTML);}},'WelcomeWizard':{'Show':function(bPostLoginInvocation,options){var fnShowWizard=function(){TriSysApex['ModalDialogue']['WelcomeWizard']['Popup']('Welcome\x20Wizard','gi-magic',options);};if(bPostLoginInvocation){var bShowWizardAfterLogin=![],fnCallbackIfWizardCompleted=null;options&&(bShowWizardAfterLogin=options['ShowWelcomeWizard'],fnCallbackIfWizardCompleted=options['CallbackIfWizardCompleted']);if(bShowWizardAfterLogin)TriSysApex['ModalDialogue']['WelcomeWizard']['MandatoryFieldsCheck'](fnShowWizard,fnCallbackIfWizardCompleted);return;}fnShowWizard();},'MandatoryFieldsCheck':function(fnCallback,fnCallbackIfWizardCompleted){var payloadObject={};payloadObject['URL']='Contact/LoggedInUserContactProfileCompleted',payloadObject['InboundDataFunction']=function(CLoggedInUserContactProfileCompletedResponse){if(CLoggedInUserContactProfileCompletedResponse){if(CLoggedInUserContactProfileCompletedResponse['Success']){if(fnCallbackIfWizardCompleted)fnCallbackIfWizardCompleted();return;}}fnCallback();},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('ctrlWelcomeWizard.MandatoryFieldsCheck:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'Popup':function(sTitle,sImage,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlWelcomeWizard.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Previous',parametersObject['ButtonLeftFunction']=function(){ctrlWelcomeWizard['Previous']();},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreText']='Next',parametersObject['ButtonCentreFunction']=function(){ctrlWelcomeWizard['Next']();},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Finish',parametersObject['ButtonRightFunction']=function(){var bSuccess=ctrlWelcomeWizard['Submit']();if(bSuccess&&options){if(options['CallbackOnCompletingWelcomeWizard'])return setTimeout(options['CallbackOnCompletingWelcomeWizard'],0xa),!![];}else bSuccess&&(TriSysApex['FormsManager']['OpenForm']('Welcome'),setTimeout(function(){TriSysApex['TourGuide']['StartTourForCurrentForm']();},0x1f4));return bSuccess;},TriSysApex['UI']['PopupMessage'](parametersObject);}},'IconPicker':{'Show':function(fnCallbackOnLoad,fnCallbackOnDelete,sFieldID){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']='Icon\x20Picker',parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlIconPicker.html'),fnCallbackOnDelete&&(parametersObject['ButtonCentreText']='Delete',parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreFunction']=function(){return fnCallbackOnDelete(sFieldID),!![];}),parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',parametersObject['ButtonRightFunction']=function(){return!![];},parametersObject['OnLoadCallback']=function(){ctrlIconPicker['Load'](fnCallbackOnLoad);},TriSysApex['UI']['PopupMessage'](parametersObject);},'ControlHTML':function(sID,sHideFindButton,sClass){var sIconPickerLookupTableHTML=TriSysApex['FormsManager']['getControlTemplateHTML']('ctrlIconPicker.html');sIconPickerLookupTableHTML=sIconPickerLookupTableHTML['replace'](/{{ctrlIconPicker-FieldID}}/g,sID);var sStyle=TriSysAPI['Operators']['stringToBoolean'](sHideFindButton,![])?'display:\x20none;':'';sIconPickerLookupTableHTML=sIconPickerLookupTableHTML['replace']('{{ctrlIconPicker-PickStyle}}',sStyle);if(!sClass)sClass='';return sIconPickerLookupTableHTML=sIconPickerLookupTableHTML['replace']('{{ctrlIconPicker-ImageClass}}',sClass),sIconPickerLookupTableHTML=sIconPickerLookupTableHTML['replace']('{{ctrlIconPicker-ButtonClass}}',sClass),sIconPickerLookupTableHTML;},'Display':function(sFieldID,sIcon){const elem=$('#'+sFieldID);var sClass=elem['attr']('data-trisys-class');if(!sClass)sClass='';var sHTML='<i\x20class=\x22'+TriSysApex['ModalDialogue']['IconPicker']['DisplayIcon'](sIcon)+('\x20fa-2x\x20themed-color\x20'+sClass+'\x22></i>\x0a');elem['html'](sHTML);},'DisplayIcon':function(sIcon){if(!sIcon)sIcon='gi\x20gi-circle_question_mark';if(sIcon['indexOf']('\x20')<0x0)sIcon=sIcon['substring'](0x0,0x2)+'\x20'+sIcon;return sIcon;}},'CandidatePlacementSelection':function(lCandidateId,fnCallback){var CCandidatePlacementSelectionRequest={'ContactId':lCandidateId},payloadObject={};payloadObject['URL']='Placements/CandidatePlacementSelection',payloadObject['OutboundDataPacket']=CCandidatePlacementSelectionRequest,payloadObject['InboundDataFunction']=function(CCandidatePlacementSelectionResponse){TriSysApex['UI']['HideWait']();if(CCandidatePlacementSelectionResponse){if(CCandidatePlacementSelectionResponse['Success']){var sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Choose\x20Candidate\x20Placement',sqlParameters['PopulationByObject']=CCandidatePlacementSelectionResponse['Placements'],sqlParameters['Columns']=TriSysApex['Activities']['PlacementArrayColumns'];var fnSelectPlacement=function(selectedRow){if(!selectedRow)return;var lPlacementId=selectedRow['PlacementId'];return fnCallback(lPlacementId),!![];};sqlParameters['CallbackFunction']=fnSelectPlacement,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);return;}else TriSysApex['Logging']['LogMessage'](CCandidatePlacementSelectionResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['Logging']['LogMessage']('TriSysApex.ModalDialogue.CandidatePlacementSelection:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Placements...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'BigEdit':{'Popup':function(sTitle,sImage,fnSubmitCallback,options){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']=sImage,parametersObject['Maximize']=!![],parametersObject['CloseTopRightButton']=!![];if(options&&options['CloseTopRightButtonFunction'])parametersObject['CloseTopRightButtonFunction']=options['CloseTopRightButtonFunction'];parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlBigEdit.html');!options['ReadOnly']&&(parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='Save',parametersObject['ButtonLeftFunction']=function(){var sText=ctrlBigEdit['GetText'](),bError=![],bAllowEmpty=![];if(options&&options['AllowEmpty'])bAllowEmpty=!![];if(!bAllowEmpty){if(!sText)bError=TriSysApex['Toasters']['ErrorValidatingField'](options['Label']);if(bError)return![];}return fnSubmitCallback(sText);});parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']=options['ReadOnly']?'Close':'Cancel';if(options['CancelFunction'])parametersObject['ButtonRightFunction']=options['CancelFunction'];if(options){parametersObject['OnLoadCallback']=function(){options['Instructions']&&($('#ctrlBigEdit-Instructions-tr')['show'](),$('#ctrlBigEdit-Instructions')['html'](options['Instructions']));if(options['Value'])$('#ctrlBigEdit-Text')['val'](options['Value']);options['ReadOnly']&&ctrlBigEdit['ReadOnlyMode']();};if(options['ButtonLabel'])parametersObject['ButtonLeftText']=options['ButtonLabel'];}TriSysApex['UI']['PopupMessage'](parametersObject);}},'ContactRequirementSelection':function(lContactId,sFullName,fnCallback){var fnPopulationByFunction={'API':'Requirements/List','Parameters':function(request){request['ContactId']=lContactId;},'DataTableFunction':function(response){return response['List'];}},sqlParameters=new TriSysApex['ModalDialogue']['Selection']['SelectionParameters']();sqlParameters['Title']='Choose\x20Requirement\x20Linked\x20to\x20'+sFullName,sqlParameters['PopulationByFunction']=fnPopulationByFunction;var columns=TriSysSDK['Grid']['HideColumns'](TriSysApex['Pages']['RequirementsForm']['Columns'],['Requirement_EarliestStartDate','Requirement_Fee','Requirement_SiteAddress','Requirement_Comments']);sqlParameters['Columns']=columns;var fnSelectRequirement=function(selectedRow){if(!selectedRow)return;return fnCallback(selectedRow),!![];};sqlParameters['CallbackFunction']=fnSelectRequirement,TriSysApex['ModalDialogue']['Selection']['Show'](sqlParameters);},'WebPageView':{'Show':function(sTitle,sURL){TriSysApex['ModalDialogue']['WebPageView']['URL']=sURL;var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='gi-globe_af',parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlWebPageView.html'),parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightFunction']=function(){return!![];},TriSysApex['UI']['PopupMessage'](parametersObject);},'URL':null},'EMailViewer':{'Open':function(sFullPath){if(!sFullPath)return;var CConvertMSGtoHTMLRequest={'FilePath':sFullPath},bShowWait=!![],payloadObject={};payloadObject['URL']='Files/ConvertMSGtoHTML',payloadObject['OutboundDataPacket']=CConvertMSGtoHTMLRequest,payloadObject['InboundDataFunction']=function(CConvertMSGtoHTMLResponse){if(bShowWait)TriSysApex['UI']['HideWait']();if(CConvertMSGtoHTMLResponse){if(CConvertMSGtoHTMLResponse['Success']){var sFileName=TriSysSDK['Controls']['FileManager']['GetFileNameFromPath'](sFullPath),sTitle='E-Mail:\x20'+sFileName;TriSysApex['ModalDialogue']['EMailViewer']['Popup'](sTitle,CConvertMSGtoHTMLResponse,sFullPath);}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){if(bShowWait)TriSysApex['UI']['HideWait']();TriSysApex['UI']['errorAlert']('TriSysApex.ModalDialogue.EMailViewer.Open:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);};if(bShowWait)TriSysApex['UI']['ShowWait'](null,'Reading\x20e-mail...');TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'Popup':function(sTitle,CConvertMSGtoHTMLResponse,sGDrivePath){var fnLoad=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='email',parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlEMailViewer.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='View\x20Full\x20Screen',parametersObject['ButtonLeftFunction']=function(){TriSysSDK['Browser']['OpenURL'](CConvertMSGtoHTMLResponse['URL']);},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonCentreText']='Open\x20in\x20Outlook',parametersObject['ButtonCentreFunction']=function(){TriSysApex['Pages']['FileManagerForm']['FileOpenDrillDown'](sGDrivePath,!![]);},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',parametersObject['ButtonRightFunction']=function(){return!![];},parametersObject['OnLoadCallback']=function(){ctrlEMailViewer['Load'](CConvertMSGtoHTMLResponse,sGDrivePath);},TriSysApex['UI']['PopupMessage'](parametersObject);};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlEMailViewer.js',null,fnLoad);}}},'BrowserHistory':{'Replace':function(sPageName,lRecordId){var sDocumentTitle=TriSysApex['Copyright']['ShortProductName']+'\x20'+sPageName,sParameters='';if(lRecordId)sParameters='/'+lRecordId;history['replaceState'](null,sDocumentTitle,'?'+sPageName+sParameters);},'Add':function(sPageName,lRecordId){var sParameters='';if(!TriSysAPI['Operators']['isEmpty'](lRecordId)){if(lRecordId!='0'&&lRecordId!=-0x1)sParameters='/'+lRecordId;}if(!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID']){if(sParameters=='')sParameters='/0';if(sParameters['toLowerCase']()['indexOf']('/'+TriSysWebJobs['Agency']['CustomerID']['toLowerCase']())<0x0)sParameters+='/'+TriSysWebJobs['Agency']['CustomerID'];else{if(sParameters['toLowerCase']()=='/'+TriSysWebJobs['Agency']['CustomerID']['toLowerCase']()){var parts=window['location']['href']['split'](sPageName+'/'),sParameter=parts[0x1];if(sParameter){parts=sParameter['split']('/'),sParameter=parts[0x0];if(sParameter!=TriSysWebJobs['Agency']['CustomerID'])sParameters='/'+sParameter+'/'+TriSysWebJobs['Agency']['CustomerID'];}}}}var bAddHistory=sPageName!=TriSysApex['Constants']['LockFormName'];if(bAddHistory){var sDocumentTitle=TriSysApex['Copyright']['ShortProductName']+'\x20'+sPageName;try{history['pushState'](null,sDocumentTitle,'?'+sPageName+sParameters);}catch(e){}TriSysApex['BrowserHistory']['Menu']['Add'](sPageName,lRecordId);}},'Menu':{'ID':'#history-drop-down-item-list','PopulateAfterLogin':function(){$('#history-drop-down-menu')['show'](),TriSysApex['BrowserHistory']['Menu']['Clear'](),TriSysApex['BrowserHistory']['Menu']['PopulateFromWebService']();var elemList=$(TriSysApex['BrowserHistory']['Menu']['ID']),iHeight=$(window)['height']()-0xdc;elemList['css']('max-height',iHeight);},'Clear':function(bClearDatabaseHistory){$(TriSysApex['BrowserHistory']['Menu']['ID'])['empty']();if(bClearDatabaseHistory)TriSysApex['BrowserHistory']['Menu']['DeleteWebServiceData']();},'Add':function(sEntityName,lRecordId,sCaption,bDoNotRetain){if(!TriSysApex['Constants']['TriSysHostedCRM'])return;if(!lRecordId)lRecordId=null;if(lRecordId)try{if(lRecordId['indexOf']('#')>=0x0)return;}catch(e){}var sCallback='TriSysApex.FormsManager.OpenForm(\x27'+sEntityName+'\x27,\x20'+lRecordId+');\x20return\x20ApexIndexPage.PostMenuItemClick(e,\x20$(this));';if(!sCaption)sCaption=sEntityName;var sEntityIcon=TriSysApex['Forms']['Configuration']['GetImagePathFromEntity'](sEntityName),sID=TriSysApex['BrowserHistory']['Menu']['MenuItemID'](sEntityName,lRecordId);TriSysApex['BrowserHistory']['Menu']['EnumerateAndRemoveDuplicateItem'](sID);if(sCaption&&sCaption['indexOf']('\x20')<0x0)sCaption=TriSysSDK['Miscellaneous']['CamelCaseToMultipleWords'](sCaption);var sMenuItemHTML='<a\x20style=\x22cursor:\x20pointer;\x22\x20id=\x22'+sID+'\x22>'+'<i\x20class=\x22'+sEntityIcon+'\x20pull-left\x22></i>'+'\x20&nbsp;\x20&nbsp;\x20'+sCaption+'</a>';try{$(TriSysApex['BrowserHistory']['Menu']['ID'])['prepend'](sMenuItemHTML);var newRecordParentBlock=$('#new-record-drop-down-menu-block');$('#'+sID)['unbind'](),$('#'+sID)['on']('click',function(e){var historyDropDownMenu=$('#history-drop-down-menu-block');historyDropDownMenu['hide'](),setTimeout(function(){historyDropDownMenu['css']('display','');},0x3e8),TriSysApex['FormsManager']['OpenForm'](sEntityName,lRecordId);});}catch(e){return;}if(TriSysAPI['Operators']['isEmpty'](bDoNotRetain))TriSysApex['BrowserHistory']['Menu']['SaveToWebService'](sEntityName,lRecordId,sCaption);TriSysApex['BrowserHistory']['Menu']['LimitItems']();},'MenuItemID':function(sEntityName,lRecordId){var sID='history-menu-'+sEntityName+'-'+lRecordId;return sID;},'EnumerateAndRemoveDuplicateItem':function(sID){$(TriSysApex['BrowserHistory']['Menu']['ID'])['find']('a')['each'](function(){var sDuplicateID=$(this)['attr']('id');sDuplicateID==sID&&($(this)['remove'](),TriSysApex['BrowserHistory']['Menu']['EnumerateAndRemoveDuplicateItem'](sID));});},'LimitItems':function(){var iMaxItems=0x20,iItemCounter=0x0;$(TriSysApex['BrowserHistory']['Menu']['ID'])['find']('a')['each'](function(){iItemCounter+=0x1;if(iItemCounter>iMaxItems)$(this)['remove']();});},'Invoke':function(){},'PopulateFromWebService':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),lUserId=userCredentials['LoggedInUser']['UserId'],CFormHistoryReadRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='History/ReadFormHistory',payloadObject['OutboundDataPacket']=CFormHistoryReadRequest,payloadObject['InboundDataFunction']=function(data){var CFormHistoryReadResponse=data;if(CFormHistoryReadResponse){if(CFormHistoryReadResponse['Success']&&CFormHistoryReadResponse['History']){var lstOfHistory=CFormHistoryReadResponse['History'];for(var i=lstOfHistory['length']-0x1;i>=0x0;i--){var history=lstOfHistory[i],bDoNotWriteToServer=!![];TriSysApex['BrowserHistory']['Menu']['Add'](history['PageName'],history['RecordId'],history['DisplayString'],bDoNotWriteToServer);}}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.BrowserHistory.PopulateFromWebService:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'SaveToWebService':function(sEntityName,lRecordId,sCaption){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(!userCredentials)return;var lUserId=userCredentials['LoggedInUser']['UserId'],CHistory={'PageName':sEntityName,'DisplayString':sCaption,'RecordId':lRecordId},CFormHistoryWriteRequest={'UserId':lUserId,'Item':CHistory},payloadObject={};payloadObject['URL']='History/WriteFormHistory',payloadObject['OutboundDataPacket']=CFormHistoryWriteRequest,payloadObject['InboundDataFunction']=function(data){var CFormHistoryWriteResponse=data;if(CFormHistoryWriteResponse){if(CFormHistoryWriteResponse['Success']){}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.BrowserHistory.SaveToWebService:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DeleteWebServiceData':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials'](),lUserId=userCredentials['LoggedInUser']['UserId'],CFormHistoryDeleteRequest={'UserId':lUserId},payloadObject={};payloadObject['URL']='History/DeleteFormHistory',payloadObject['OutboundDataPacket']=CFormHistoryDeleteRequest,payloadObject['InboundDataFunction']=function(data){var CFormHistoryDeleteResponse=data;if(CFormHistoryDeleteResponse){if(CFormHistoryDeleteResponse['Success']){}}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['errorAlert']('TriSysApex.BrowserHistory.DeleteWebServiceData:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}}},'TourGuide':{'Impromptu':![],'IntroJSSteps':null,'Load':function(){if(TriSysApex['TourGuide']['Impromptu'])try{$['prompt']['setDefaults']({'zIndex':0x30d3f});}catch(e){}try{window['onhelp']=function(){return![];},window['onkeydown']=function(evt){switch(evt['keyCode']){case 0x70:TriSysApex['TourGuide']['StartTourForCurrentForm'](!![]);break;default:return!![];}return![];};}catch(e){}},'TourGuides':null,'LoadJSON':function(){var sJsonFile='tourguide-'+TriSysSDK['Resources']['Language']+'.json';TriSysApex['TourGuide']['TourGuides']=TriSysApex['Forms']['Configuration']['JsonFileData'](sJsonFile);var sLoadError='TriSysApex.TourGuide.LoadJSON:\x20missing,\x20empty\x20or\x20invalid\x20'+sJsonFile;!TriSysApex['TourGuide']['TourGuides']&&TriSysSDK['Resources']['Language']!='en'&&(TriSysApex['Logging']['LogMessage'](sLoadError),sJsonFile='tourguide-en.json',TriSysApex['TourGuide']['TourGuides']=TriSysApex['Forms']['Configuration']['JsonFileData'](sJsonFile));if(!TriSysApex['TourGuide']['TourGuides']){TriSysApex['Logging']['LogMessage'](sLoadError);return;}var gridGuide=TriSysApex['TourGuide']['GetTourGuideForFormName']('Grid')['Guide'],gridButtonsGuide=TriSysApex['TourGuide']['GetTourGuideForFormName']('Grid-Button-Menus')['Guide'];for(var i=0x0;i<TriSysApex['TourGuide']['TourGuides']['length'];i++){var tourGuide=TriSysApex['TourGuide']['TourGuides'][i];if(tourGuide){if(tourGuide['GridHelp']){var gridGuideCopy=JSON['parse'](JSON['stringify'](gridGuide));for(var g=0x0;g<gridGuideCopy['length'];g++){var guide=gridGuideCopy[g];guide['position']['container']=guide['position']['container']['replace'](/##GridName##/g,tourGuide['GridName']),guide['html']=guide['html']['replace'](/##GridEntityPlural##/g,tourGuide['GridEntityPlural']),guide['html']=guide['html']['replace'](/##GridEntitySingular##/g,tourGuide['GridEntitySingular']),tourGuide['Guide']['splice'](tourGuide['GridInsertIndex']+g,0x0,guide);}}if(tourGuide['GridButtonHelp']){var gridButtonsGuideCopy=JSON['parse'](JSON['stringify'](gridButtonsGuide));for(var g=0x0;g<gridButtonsGuideCopy['length'];g++){var guide=gridButtonsGuideCopy[g];guide['position']['container']=guide['position']['container']['replace'](/##GridButtons##/g,tourGuide['GridButtons']),guide['html']=guide['html']['replace'](/##GridEntityPlural##/g,tourGuide['GridEntityPlural']),guide['html']=guide['html']['replace'](/##GridEntitySingular##/g,tourGuide['GridEntitySingular']),tourGuide['Guide']['splice'](tourGuide['ButtonsInsertIndex']+g,0x0,guide);}}for(var g=0x0;g<tourGuide['Guide']['length'];g++){var guide=tourGuide['Guide'][g],fnSubmit=null;TriSysApex['TourGuide']['Impromptu']&&(fnSubmit=function(e,v,m,f){return TriSysApex['TourGuide']['Wizard'](e,v,m,f);});if(guide['PreviousNavigateFunction']||guide['NextNavigateFunction']||guide['PreNavigationFunction']||guide['PostNavigationFunction']){var sPreviousNavigateFunction=guide['PreviousNavigateFunction'],sNextNavigateFunction=guide['NextNavigateFunction'],sPreNavigationFunction=guide['PreNavigationFunction'],sPostNavigationFunction=guide['PostNavigationFunction'];fnSubmit=TriSysApex['TourGuide']['GetANewFunctionCallback'](sPreviousNavigateFunction,sNextNavigateFunction,sPreNavigationFunction,sPostNavigationFunction);}guide['submit']=fnSubmit;if(TriSysApex['TourGuide']['Impromptu']){var sOffHTML=TriSysApex['TourGuide']['TurnTourGuideHTML'](tourGuide);guide['html']+=sOffHTML;}}}}},'GetANewFunctionCallback':function(sPreviousNavigateFunction,sNextNavigateFunction,sPreNavigationFunction,sPostNavigationFunction){var fnSubmit=null;return TriSysApex['TourGuide']['Impromptu']?fnSubmit=function(e,v,m,f){if(v===-0x1&&sPreviousNavigateFunction)eval(sPreviousNavigateFunction);else v===0x1&&sNextNavigateFunction&&eval(sNextNavigateFunction);return TriSysApex['TourGuide']['Wizard'](e,v,m,f);}:fnSubmit=function(bAfterChange,iCurrentStepIndex,sDirection){if(sPreNavigationFunction&&!bAfterChange)eval(sPreNavigationFunction);if(sPostNavigationFunction&&bAfterChange)eval(sPostNavigationFunction);},fnSubmit;},'TourGuideHTMLPrefix':'<br\x20/><br\x20/><hr\x20style=\x22margin-bottom:\x2010px;\x22><table\x20style=\x22width:\x20100%;\x22><tr><td\x20style=\x22width:50%;\x22>'+'<div\x20id=\x22tourGuide-TurnTourGuideOnOrOff-{ID}\x22><i\x20class=\x22gi\x20gi-circle_question_mark\x22></i>\x20','TourGuideHTMLSufffix':function(tourGuide){var sTourGuideHTMLSufffix='</div>'+'</td><td\x20style=\x22text-align:\x20right;\x22><i\x20class=\x22gi\x20gi-facetime_video\x22\x20id=\x22tourGuide-WatchVideo-{ID}\x22></i>\x20'+'<a\x20href=\x22javascript:\x20void(-1);\x22\x20onclick=\x22TriSysApex.TourGuide.WatchVideo(\x27'+tourGuide['FormName']+'\x27);\x22\x20title=\x22Watch\x20a\x20video\x20explaining\x20this\x20application\x20feature\x22>Watch\x20Video</a></td></tr></table>',sRandom=TriSysSDK['Miscellaneous']['RandomNumber'](0x2710,0xf423f);return sTourGuideHTMLSufffix=sTourGuideHTMLSufffix['replace']('{ID}',sRandom),sTourGuideHTMLSufffix;},'TurnTourGuideHTML':function(tourGuide){var bOn=TriSysApex['UserOptions']['TourGuide'](![]),sPrefix=TriSysApex['TourGuide']['TourGuideHTMLPrefix'],sRandom=TriSysSDK['Miscellaneous']['RandomNumber'](0x2710,0xf423f);sPrefix=sPrefix['replace']('{ID}',sRandom);var sState=bOn?'Off':'On',sOffHTML=sPrefix+'Turn\x20tour\x20guide\x20<b><a\x20href=\x22javascript:\x20void(-1);\x22'+'\x20onclick=\x22TriSysApex.TourGuide.Toggle(this);\x22\x20title=\x22Turn\x20help\x20'+sState+'\x22>'+sState+'</a></b>'+TriSysApex['TourGuide']['TourGuideHTMLSufffix'](tourGuide);return sOffHTML;},'RefreshHelpStateHyperlinks':function(){if(TriSysApex['TourGuide']['TourGuides'])for(var i=0x0;i<TriSysApex['TourGuide']['TourGuides']['length'];i++){var tourGuide=TriSysApex['TourGuide']['TourGuides'][i];if(tourGuide)for(var g=0x0;g<tourGuide['Guide']['length'];g++){var guide=tourGuide['Guide'][g],sHTML=guide['html'],sPrefixPart='<br\x20/><br\x20/><hr',i=sHTML['indexOf'](sPrefixPart);if(i>=0x0)sHTML=sHTML['substring'](0x0,i-0x1)+TriSysApex['TourGuide']['TurnTourGuideHTML'](tourGuide);guide['html']=sHTML;}}},'WarnedWhenTurningOff':![],'Toggle':function(e){var bOn=TriSysApex['UserOptions']['TourGuide'](![]);bOn=!bOn,TriSysApex['UserOptions']['TourGuide'](!![],bOn,!![]),TriSysApex['TourGuide']['RefreshHelpStateHyperlinks']();if(e){var sState=!bOn?'On':'Off';$(e)['text'](sState),$(e)['attr']('title','Turn\x20help\x20'+sState);}if(!bOn){$['prompt']['close']();var bLoggedIn=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(bLoggedIn){var sMessage='You\x20can\x20turn\x20help\x20on\x20at\x20any\x20time\x20using\x20the\x20help\x20shortcut\x20icon\x20on\x20the\x20navigation\x20bar,\x20or\x20by\x20pressing\x20the\x20F1\x20key,\x20or\x20in\x20the\x20user\x20options\x20form.'+'</br\x20/>Turn\x20automatic\x20help\x20on?',fnTurnOn=function(){return TriSysApex['TourGuide']['WarnedWhenTurningOff']=!![],TriSysApex['TourGuide']['Toggle'](),TriSysApex['TourGuide']['ShowTourIfEnabled'](),!![];},fnNo=function(){return TriSysApex['TourGuide']['WarnedWhenTurningOff']=!![],!![];};if(!TriSysApex['TourGuide']['WarnedWhenTurningOff'])TriSysApex['UI']['questionYesNo'](sMessage,TriSysApex['Copyright']['ShortProductName'],'Yes',fnTurnOn,'No',fnNo);}}},'CurrentVideo':null,'DefaultVideoURL':'https://api.trisys.co.uk/apex/assets/video/apex.aspx?video=','DefaultVideoName':'april-2016-video','WatchVideo':function(sFormName,sTrainingVideoName,sTrainingVideoCaption){if(TriSysApex['TourGuide']['Impromptu'])$['prompt']['close']();else introJs()['exit'](!![]);var sHelpVideoPrefix='Help\x20Video:\x20',sVideo=TriSysApex['TourGuide']['DefaultVideoURL']+TriSysApex['TourGuide']['DefaultVideoName'],sWhatVideo=sHelpVideoPrefix+sFormName,bShowHelpButton=!![];if(sFormName){TriSysApex['TourGuide']['LoadJSON']();var tour=TriSysApex['TourGuide']['GetTourGuideForFormName'](sFormName);if(tour){if(tour['Video']){sVideo=TriSysApex['TourGuide']['DefaultVideoURL']+tour['Video'];if(tour['VideoTitle'])sWhatVideo=sHelpVideoPrefix+tour['VideoTitle'];}}}else{if(sTrainingVideoName)sVideo=TriSysApex['TourGuide']['DefaultVideoURL']+sTrainingVideoName;sWhatVideo='Training\x20Video:\x20'+sTrainingVideoCaption;if(!sWhatVideo)sWhatVideo='Missing\x20video\x20caption\x20directive!';bShowHelpButton=![];}sVideo&&(TriSysApex['TourGuide']['CurrentVideo']=sVideo,TriSysApex['TourGuide']['OpenVideoDialogue'](sWhatVideo,bShowHelpButton));},'VideoDialogueHeight':function(){var lHeight=$(window)['height']()*TriSysApex['TourGuide']['VideoHeightFactor'];return lHeight;},'VideoHeightFactor':0.75,'VideoDialogueWidth':function(){var lWidth=TriSysApex['TourGuide']['VideoDialogueHeight']()*TriSysApex['TourGuide']['VideoWidthFactor'];return lWidth;},'VideoWidthFactor':1.39,'OpenVideoDialogue':function(sTitle,bShowHelpButton){if(TriSysApex['Device']['PhoneGapEnabled']()){if(TriSysPhoneGap['PlayVideo'](TriSysApex['TourGuide']['CurrentVideo']))return;}var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='gi-facetime_video',parametersObject['Maximize']=![],parametersObject['CloseTopRightButton']=![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlHelpVideo.html'),parametersObject['Width']=TriSysApex['TourGuide']['VideoDialogueWidth']()-0x78;var fnSubtitleVideoNaming=function(){if(TriSysApex['Constants']['VideoSubtitles'])TriSysApex['TourGuide']['CurrentVideo']=TriSysApex['TourGuide']['CurrentVideo']['replace'](TriSysApex['Constants']['NoVideoSubtitlesSuffix'],'');else TriSysApex['TourGuide']['CurrentVideo']+=TriSysApex['Constants']['NoVideoSubtitlesSuffix'];};fnSubtitleVideoNaming();bShowHelpButton&&(parametersObject['ButtonLeftText']='Show\x20Help',parametersObject['ButtonLeftFunction']=function(){return setTimeout(TriSysApex['TourGuide']['StartTourForCurrentForm'],0xfa),!![];},parametersObject['ButtonLeftVisible']=!![]);TriSysApex['Constants']['VideoSubtitlesButton']&&(parametersObject['ButtonCentreText']='Subtitles\x20'+(TriSysApex['Constants']['VideoSubtitles']?'Off':'On'),parametersObject['ButtonCentreFunction']=function(){return setTimeout(function(){TriSysApex['Constants']['VideoSubtitles']=!TriSysApex['Constants']['VideoSubtitles'],TriSysApex['UI']['CloseModalPopup'](),TriSysApex['TourGuide']['OpenVideoDialogue'](sTitle,bShowHelpButton);},0xfa),!![];},parametersObject['ButtonCentreVisible']=!![]);parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close';var bShowShareButton=typeof Training!==TriSysApex['Constants']['Undefined'];bShowShareButton&&(parametersObject['ButtonFarLeftVisible']=!![],parametersObject['ButtonFarLeftText']='Share',parametersObject['ButtonFarLeftFunction']=function(){return setTimeout(function(){TriSysApex['TourGuide']['ShareVideoURL'](sTitle);},0x32),![];}),TriSysApex['UI']['PopupMessage'](parametersObject);},'ShareVideoURL':function(sTitle){var fnLoadTrainingVideoShare=function(){Training['Shared']['ShareVideoURL'](sTitle);};if(typeof Training===TriSysApex['Constants']['Undefined'])TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/Training.js',null,fnLoadTrainingVideoShare);else fnLoadTrainingVideoShare();},'ShowTourIfEnabled':function(){return;},'StopTourForCurrentForm':function(){try{if(TriSysApex['TourGuide']['Impromptu'])$['prompt']['close']();else introJs()['exit'](!![]);ApexIndexPage['SetHelpToolbarButtonMode'](![]);}catch(ex){}},'StartTourForCurrentForm':function(){TriSysApex['TourGuide']['StopTourForCurrentForm'](),ApexIndexPage['SetHelpToolbarButtonMode'](!![]);var sFormName=TriSysApex['TourGuide']['GetFormNameForCurrentForm']();if(sFormName)TriSysApex['TourGuide']['StartTourForSpecifiedForm'](sFormName);else TriSysApex['FormsManager']['OpenForm']('Welcome'),setTimeout(function(){TriSysApex['TourGuide']['StartTourForCurrentForm']();},0x3e8);},'StartTourForSpecifiedForm':function(sForm){TriSysApex['TourGuide']['StopTourForCurrentForm'](),ApexIndexPage['SetHelpToolbarButtonMode'](!![]);if(TriSysApex['Device']['isPhone']())return;TriSysApex['TourGuide']['LoadJSON']();var tourGuide=TriSysApex['TourGuide']['GetTourGuideForFormName'](sForm);tourGuide?TriSysApex['TourGuide']['ShowTourGuide'](tourGuide):(TriSysApex['Toasters']['Error']('No\x20F1\x20Help\x20available.'),setTimeout(function(){ApexIndexPage['SetHelpToolbarButtonMode'](![]);},0xbb8));},'ShowFormErrorsAsATourGuide':function(sTitle,lstErrors){if(!lstErrors)return;var tourGuide={'Guide':[]},iWidth=TriSysApex['Device']['isPhone']()?$(window)['width']()-0x50:0x190;for(var i=0x0;i<lstErrors['length'];i++){var error=lstErrors[i],bDOMitemVisible=TriSysSDK['DocumentObjectModel']['isVisible'](error['ID']),sDOMid=bDOMitemVisible?error['ID']:null,tourStep={'title':sTitle,'html':error['Message'],'position':{'container':sDOMid,'width':iWidth},'introPosition':'bottom'};tourGuide['Guide']['push'](tourStep);}TriSysApex['TourGuide']['ShowTourGuide'](tourGuide);},'ShowTourGuide':function(tourGuide){var guide=tourGuide['Guide'];if(TriSysApex['TourGuide']['Impromptu'])$['prompt'](guide);else{var fnHelpInvocationFunction=tourGuide['HelpInvocationFunction'];if(fnHelpInvocationFunction)try{eval(fnHelpInvocationFunction);}catch(ex){}TriSysApex['TourGuide']['IntroJSSteps']=null;var steps=[];for(var i=0x0;i<guide['length'];i++){var guideStep=guide[i],iWidth=guideStep['position']['width'],sPosition=guideStep['introPosition']?guideStep['introPosition']:'left';if(!guideStep['introPosition'])switch(guideStep['position']['arrow']){case'rb':case'tr':sPosition='right';break;case'tc':sPosition='top';break;case'bc':sPosition='bottom';break;}var sHelpHTML=guideStep['html'];if(guideStep['htmlList'])sHelpHTML=guideStep['htmlList']['join']('');tourGuide['Video']&&(sHelpHTML+='<br\x20/><h4\x20class=\x22sub-header\x22></h4>'+'<i\x20class=\x22gi\x20gi-film\x20themed-color\x22></i>\x20&nbsp;\x20'+'<a\x20href=\x22javascript:\x20void(-1);\x22\x20onclick=\x22TriSysApex.TourGuide.WatchVideo(\x27'+tourGuide['FormName']+'\x27);\x22\x20'+'\x20title=\x22Watch\x20a\x20video\x20explaining\x20this\x20application\x20feature\x22>Watch\x20Video</a>');sHelpHTML+='<h4\x20class=\x22sub-header\x22></h4>'+'<button\x20type=\x22button\x22\x20class=\x22btn\x20btn-sm\x20btn-success\x22\x20style=\x22margin-top:\x200px;\x20padding-left:\x202px;\x22'+'\x20\x20\x20\x20\x20\x20\x20title=\x22Show\x20user\x20guide\x22\x20onclick=\x22TriSysApex.FormsManager.OpenForm(\x27UserGuide\x27);\x22>'+'\x20\x20\x20<i\x20class=\x22fa\x20fa-book\x20fa-fw\x22\x20style=\x22vertical-align:\x20top;\x20margin-top:\x202px;\x20margin-right:\x204px;\x22></i>\x20User\x20Guide'+'</button>'+'\x20&nbsp;\x20'+'<button\x20type=\x22button\x22\x20class=\x22btn\x20btn-sm\x20btn-warning\x22\x20style=\x22margin-top:\x200px;\x20padding-left:\x202px;\x22'+'\x20\x20\x20\x20\x20\x20\x20title=\x22Show\x20training\x20course\x20videos\x22\x20onclick=\x22TriSysApex.FormsManager.OpenForm(\x27Training\x27);\x22>'+'\x20\x20\x20<i\x20class=\x22fa\x20fa-graduation-cap\x20fa-fw\x22\x20style=\x22vertical-align:\x20top;\x20margin-top:\x202px;\x20margin-right:\x204px;\x22></i>\x20Training\x20Courses'+'</button>'+'';var sBlock='<div\x20class=\x22block\x22>'+'\x09<div\x20class=\x22block-title\x22>'+'\x20\x20\x20\x20\x20\x20<i\x20class=\x22gi\x20gi-circle_question_mark\x20fa-2x\x20pull-left\x20themed-color\x22\x20style=\x22padding-left:\x208px;\x20padding-top:\x207px;\x22></i>'+'\x20\x20\x20\x20\x20\x20<h4\x20style=\x22font-size:\x2013px;\x20padding-left:\x208px;\x22><strong>'+guideStep['title']+'</strong></h4>'+'\x20\x20\x20</div>'+'\x20\x20\x20<p>'+sHelpHTML+'\x09</p>'+'</div>',step={'intro':sBlock,'position':sPosition,'width':iWidth,'onAfterChangeEvent':guideStep['submit']},bAddStep=!![];if(guideStep['position']['container']){step['element']=guideStep['position']['container'];var elem=$(step['element']),isVisible=elem['is'](':visible'),isHidden=elem['is'](':hidden');bAddStep=isVisible&&!isHidden;}if(bAddStep)steps['push'](step);}if(steps['length']==0x0){ApexIndexPage['SetHelpToolbarButtonMode'](![]);return;}TriSysApex['TourGuide']['IntroJSSteps']=steps;var bShowStepNumbers=tourGuide['HideStepNumbers']?![]:!![],bShowBullets=steps['length']>0x1?!![]:![],intro=introJs();intro['setOptions']({'steps':steps,'hidePrev':!![],'hideNext':!![],'skipLabel':'Close','doneLabel':'Close','showStepNumbers':bShowStepNumbers,'showBullets':bShowBullets,'overlayOpacity':0.15}),intro['onafterchange'](function(targetElement){if(TriSysApex['TourGuide']['IntroJSSteps']){var step=TriSysApex['TourGuide']['IntroJSSteps'][this['_currentStep']];if(step&&step['width']>0x0){var sWidth=step['width']+'px';$('.introjs-tooltip')['css']('min-width',sWidth),$('.introjs-tooltip')['css']('max-width',sWidth);}if(step&&step['onAfterChangeEvent']){var fnOnAfterChangeEvent=step['onAfterChangeEvent'],bAfterChange=!![];fnOnAfterChangeEvent(bAfterChange,this['_currentStep'],this['_direction']);}}}),intro['onbeforechange'](function(){if(TriSysApex['TourGuide']['IntroJSSteps']){var step=TriSysApex['TourGuide']['IntroJSSteps'][this['_currentStep']];if(step&&step['onAfterChangeEvent']){var fnOnAfterChangeEvent=step['onAfterChangeEvent'],bAfterChange=![];fnOnAfterChangeEvent(bAfterChange,this['_currentStep'],this['_direction']);}}}),intro['onexit'](function(){ApexIndexPage['SetHelpToolbarButtonMode'](![]),TriSysApex['TourGuide']['AfterTourGuideExits']();}),intro['start'](),TriSysProUI['introJS_Overrides']();}},'AfterTourGuideExits':function(){var sFormName=TriSysApex['TourGuide']['GetFormNameForCurrentForm']();if(!sFormName){var fnShowWelcomeForm=function(){TriSysApex['FormsManager']['OpenForm']('Welcome'),setTimeout(function(){TriSysApex['TourGuide']['StartTourForCurrentForm']();},0x3e8);},options={'ShowWelcomeWizard':!![],'CallbackIfWizardCompleted':fnShowWelcomeForm,'CallbackOnCompletingWelcomeWizard':fnShowWelcomeForm};TriSysApex['ModalDialogue']['WelcomeWizard']['Show'](!![],options),setTimeout(function(){TriSysApex['TourGuide']['StartTourForCurrentForm']();},0x7d0);}},'GetFormNameForCurrentForm':function(){var sFormName=TriSysApex['FormsManager']['SelectedFormName'];if(TriSysApex['ModalDialogue']['Current']['Name']&&(TriSysApex['UI']['isModalOpen']()||TriSysApex['ModalDialogue']['Current']['isKendoUIWindowVisible']()))sFormName=TriSysApex['ModalDialogue']['Current']['Name'];return sFormName;},'GetTourGuideForFormName':function(sFormName){if(TriSysApex['TourGuide']['TourGuides']&&sFormName)for(var i=0x0;i<TriSysApex['TourGuide']['TourGuides']['length'];i++){var tourGuide=TriSysApex['TourGuide']['TourGuides'][i];if(tourGuide&&sFormName){if(tourGuide['FormName']['toLowerCase']()==sFormName['toLowerCase']())return tourGuide;}}},'Wizard':function(e,v,m,f){if(v===-0x1)return $['prompt']['prevState'](),![];else{if(v===0x1)return $['prompt']['nextState'](),![];}},'TweakLittleQuestionMark':function(){$('div[id^=tourGuide-TurnTourGuideOnOrOff]')['filter'](function(){var sID=this['id'],elem=$('#'+sID);elem['find']('i')['css']('color',TriSysProUI['BackColour']());}),$('i[id^=tourGuide-WatchVideo]')['filter'](function(){var sID=this['id'],elem=$('#'+sID);elem['css']('color',TriSysProUI['BackColour']());});},'AfterLoginEvent':function(){var bShow=!TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('TourGuideOffAfterLogin',![]));bShow&&setTimeout(function(){TriSysApex['TourGuide']['StartTourForSpecifiedForm']('AfterLoginEvent');},0x7d0);},'TurnOffAfterLoginEvent':function(){TriSysApex['Cache']['UserSettingManager']['SetValue']('TourGuideOffAfterLogin',!![]);}},'FieldEvents':{'ComboClick':function(sFieldID,sText,objValue){if(TriSysApex['FieldEvents']['CustomComboClick'](sFieldID,sText,objValue))return;switch(sFieldID){case'Contact_ContactTitle':case'Contact_ContactMarried':case'ContactConfigFields_Gender':TriSysApex['SexManager']['SynchroniseFieldChange'](sFieldID,sText,'Contact_ContactTitle','ContactConfigFields_Gender','Contact_ContactMarried');break;case'newCompanyContact-Title':case'newCompanyContact-Gender':TriSysApex['SexManager']['SynchroniseFieldChange'](sFieldID,sText,'newCompanyContact-Title','newCompanyContact-Gender',null);break;case'cvautorecognition-form-Title':case'cvautorecognition-form-Gender':TriSysApex['SexManager']['SynchroniseFieldChange'](sFieldID,sText,'cvautorecognition-form-Title','cvautorecognition-form-Gender',null);break;case'cvautorecognition-form-new-Title':case'cvautorecognition-form-new-Gender':TriSysApex['SexManager']['SynchroniseFieldChange'](sFieldID,sText,'cvautorecognition-form-new-Title','cvautorecognition-form-new-Gender',null);break;case'cvautorecognition-form-existing-Title':case'cvautorecognition-form-existing-Gender':TriSysApex['SexManager']['SynchroniseFieldChange'](sFieldID,sText,'cvautorecognition-form-existing-Title','cvautorecognition-form-existing-Gender',null);break;case'Requirement_Type':var bPermanent=sText=='Permanent';TriSysApex['Pages']['RequirementForm']['DisplayTypeControls'](bPermanent);break;case'Placement_Type':var bPermanent=sText=='Permanent';TriSysApex['Pages']['PlacementForm']['DisplayTypeControls'](bPermanent);break;case'contractRate-Type':ctrlContractRate['RateTypeChange'](sText);break;case'RequirementConfigFields_CompanyCar':case'RequirementConfigFields_IncludeCarInFee':ctrlPermanentSalary['CompanyCarFields']('Requirement',!![]);break;case'PlacementConfigFields_Car':case'PlacementConfigFields_PlacementIncludeCarInFee':ctrlPermanentSalary['CompanyCarFields']('Placement',!![]);break;case'ctrlMailMerge-Template':ctrlMailMerge['ApplyPersistedSetting'](sText);break;case'ctrlMailMerge-Delivery':ctrlMailMerge['DeliveryComboClick'](sText);break;case'ctrlMailMerge-Entity':ctrlMailMerge['EntityComboClick'](sText);break;case'ctrlInterview-Stage':ctrlInterview['ApplyPersistedSetting'](sText);break;case'ctrlPlacementDocumentation-DocumentType':ctrlPlacementDocumentation['ApplyPersistedSetting'](sText);break;case'ContactConfigFields_UmbrellaReference':contactForm['UmbrellaReferenceChange'](sText);break;}},'CustomComboClick':function(sFieldID,sText,objValue){var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetComboClickFieldOfInterest'](sTableFieldName);if(field){try{field['FunctionCallback'](sTableFieldName,sText);}catch(ex){}return!![];}return![];},'AddComboClickFieldOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetComboClickFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['ComboClickFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetComboClickFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['ComboClickFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['ComboClickFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'ComboClickFieldsOfInterest':[{'Field':'','FunctionCallback':null}],'NumberChange':function(sFieldID,fValue){TriSysApex['Logging']['LogMessage']('TriSysApex.FieldEvents.NumberChange:\x20'+sFieldID+'='+fValue);if(sFieldID['indexOf']('contractRate-')==0x0)ctrlContractRate['CalculationEngine'](sFieldID,fValue);else{var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetNumberChangeFieldOfInterest'](sTableFieldName);if(!field){if(sFieldID['indexOf']('-')>0x0){var parts=sFieldID['split']('-');sTableFieldName=parts[0x0];}field=TriSysApex['FieldEvents']['GetNumberChangeFieldOfInterest'](sTableFieldName);}if(field)try{field['FunctionCallback'](sTableFieldName,fValue);}catch(ex){}}},'AddNumberChangeFieldOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetNumberChangeFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['NumberChangeFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetNumberChangeFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['NumberChangeFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['NumberChangeFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'NumberChangeFieldsOfInterest':[{'Field':'','FunctionCallback':null}],'DateChange':function(sFieldID,fValue){TriSysApex['Logging']['LogMessage']('TriSysApex.FieldEvents.DateChange:\x20'+sFieldID+'='+fValue);var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetDateChangeFieldOfInterest'](sTableFieldName);if(!field){if(sFieldID['indexOf']('-')>0x0){var parts=sFieldID['split']('-');sTableFieldName=parts[0x0];}field=TriSysApex['FieldEvents']['GetDateChangeFieldOfInterest'](sTableFieldName);}if(field)try{field['FunctionCallback'](sTableFieldName,fValue);}catch(ex){}},'AddDateChangeFieldOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetDateChangeFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['DateChangeFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetDateChangeFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['DateChangeFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['DateChangeFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'DateChangeFieldsOfInterest':[{'Field':'','FunctionCallback':null}],'FileReferenceFieldEvent':function(sFieldID,sFile,sOperation){var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetFileReferenceEventFieldOfInterest'](sTableFieldName);if(!field){if(sFieldID['indexOf']('-')>0x0){var parts=sFieldID['split']('-');sTableFieldName=parts[0x0];}field=TriSysApex['FieldEvents']['GetFileReferenceEventFieldOfInterest'](sTableFieldName);}if(field)try{field['FunctionCallback'](sTableFieldName,sFile,sOperation);}catch(ex){}},'AddFileReferenceFieldEventOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetFileReferenceEventFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['FileReferenceEventFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetFileReferenceEventFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['FileReferenceEventFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['FileReferenceEventFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'FileReferenceEventFieldsOfInterest':[{'Field':'','FunctionCallback':null}],'ContactPickerFieldEvent':function(sFieldID,lContactId,sContactName,sOperation){var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetContactPickerEventFieldOfInterest'](sTableFieldName);if(!field){if(sFieldID['indexOf']('-')>0x0){var parts=sFieldID['split']('-');sTableFieldName=parts[0x0];}field=TriSysApex['FieldEvents']['GetContactPickerEventFieldOfInterest'](sTableFieldName);}if(field)try{field['FunctionCallback'](sTableFieldName,lContactId,sContactName,sOperation);}catch(ex){}},'AddContactPickerFieldEventOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetContactPickerEventFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['ContactPickerEventFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetContactPickerEventFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['ContactPickerEventFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['ContactPickerEventFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'ContactPickerEventFieldsOfInterest':[{'Field':'','FunctionCallback':null}],'CompanyPickerFieldEvent':function(sFieldID,lCompanyId,sCompanyName,sOperation){var sTableFieldName=sFieldID,field=TriSysApex['FieldEvents']['GetCompanyPickerEventFieldOfInterest'](sTableFieldName);if(!field){if(sFieldID['indexOf']('-')>0x0){var parts=sFieldID['split']('-');sTableFieldName=parts[0x0];}field=TriSysApex['FieldEvents']['GetCompanyPickerEventFieldOfInterest'](sTableFieldName);}if(field)try{field['FunctionCallback'](sTableFieldName,lCompanyId,sCompanyName,sOperation);}catch(ex){}},'AddCompanyPickerFieldEventOfInterest':function(sField,fnCallback){var field=TriSysApex['FieldEvents']['GetCompanyPickerEventFieldOfInterest'](sField);!field?(field={'Field':sField,'FunctionCallback':fnCallback},TriSysApex['FieldEvents']['CompanyPickerEventFieldsOfInterest']['push'](field)):field['FunctionCallback']=fnCallback;},'GetCompanyPickerEventFieldOfInterest':function(sField){for(var i=0x0;i<TriSysApex['FieldEvents']['CompanyPickerEventFieldsOfInterest']['length'];i++){var field=TriSysApex['FieldEvents']['CompanyPickerEventFieldsOfInterest'][i],bMatched=sField==field['Field'];if(bMatched)return field;}},'CompanyPickerEventFieldsOfInterest':[{'Field':'','FunctionCallback':null}]},'SexManager':{'SynchroniseFieldChange':function(sChangingField,sText,sTitleField,sGenderField,sMarriedField){return;var contactTitles=TriSysApex['Cache']['ContactTitles']();if(sChangingField['indexOf']('Title')>0x0)sChangingField='GenericTitle';if(sChangingField['indexOf']('Gender')>0x0)sChangingField='GenericGender';switch(sChangingField){case'Contact_ContactTitle':case'GenericTitle':var contactTitle=TriSysApex['SexManager']['GetContactTitleObject'](sText);if(contactTitle){var iMale=contactTitle['Male'],iMarried=contactTitle['Married'];switch(iMale){case 0x0:TriSysSDK['CShowForm']['SetTextInCombo'](sMaleField,'Female');break;case 0x1:TriSysSDK['CShowForm']['SetTextInCombo'](sMaleField,'Male');break;}if(sMarriedField)switch(iMarried){case 0x0:TriSysSDK['CShowForm']['SetTextInCombo'](sMarriedField,'Single');break;case 0x1:TriSysSDK['CShowForm']['SetTextInCombo'](sMarriedField,'Married');break;}}break;case'Contact_ContactMarried':var sMaritalStatus=sText,sTitle=TriSysSDK['CShowForm']['GetTextFromCombo'](sTitleField),sSex=TriSysSDK['CShowForm']['GetTextFromCombo'](sMaleField),bMale=sSex=='Male',bMarried=sMaritalStatus=='Married',contactTitle=TriSysApex['SexManager']['GetContactTitleObject'](sTitle);if(contactTitle){var iMale=contactTitle['Male'],iMarried=contactTitle['Married'];if((iMarried==0x1&&bMarried||iMarried==0x0&&!bMarried)&&(iMale==0x1&&bMale||iMale==0x0&&!bMale))return;if(iMarried==0x2)return;}for(var i=0x0;i<contactTitles['length'];i++){contactTitle=contactTitles[i];if(bMarried){if(bMale&&contactTitle['Male']==0x1&&contactTitle['Married']==0x1||!bMale&&contactTitle['Male']==0x0&&contactTitle['Married']==0x1){TriSysSDK['CShowForm']['SetTextInCombo'](sTitleField,contactTitle['Name']);return;}}else{if(bMale&&contactTitle['Male']==0x1&&contactTitle['Married']==0x0||!bMale&&contactTitle['Male']==0x0&&contactTitle['Married']==0x0){TriSysSDK['CShowForm']['SetTextInCombo'](sTitleField,contactTitle['Name']);return;}}}break;case'ContactConfigFields_Gender':case'GenericGender':var sTitle=TriSysSDK['CShowForm']['GetTextFromCombo'](sTitleField),sGender=sText,sMaritalStatus=TriSysSDK['CShowForm']['GetTextFromCombo'](sMarriedField),bMale=sGender=='Male',bMarried=sMaritalStatus=='Married',contactTitle=TriSysApex['SexManager']['GetContactTitleObject'](sTitle);if(contactTitle){var iMale=contactTitle['Male'],iMarried=contactTitle['Married'];if((iMarried==0x1&&bMarried||iMarried==0x0&&!bMarried)&&(iMale==0x1&&bMale||iMale==0x0&&!bMale))return;if(iMale==0x2)return;}if(!bMale&&!bMarried){TriSysSDK['CShowForm']['SetTextInCombo'](sTitleField,'Miss');return;}else{if(!bMale&&bMarried){TriSysSDK['CShowForm']['SetTextInCombo'](sTitleField,'Mrs');return;}else{if(bMale){TriSysSDK['CShowForm']['SetTextInCombo'](sTitleField,'Mr');return;}}}break;}},'GetContactTitleObject':function(sTitle){var contactTitles=TriSysApex['Cache']['ContactTitles']();for(var i=0x0;i<contactTitles['length'];i++){var contactTitle=contactTitles[i];if(sTitle==contactTitle['Name'])return contactTitle;}}},'ControlPopulationDirty':{'PopulationAndDirtyStatus':[{'ParentDiv':'','Populated':![],'Dirty':![]}],'ClearPopulationAndDirtyStatus':function(parentDiv){TriSysApex['ControlPopulationDirty']['SetPopulated'](parentDiv,![]),TriSysApex['ControlPopulationDirty']['SetDirty'](parentDiv,![]);},'SetPopulated':function(parentDiv,bPopulated){var status=TriSysApex['ControlPopulationDirty']['GetPopulationAndDirtyStatus'](parentDiv);status['Populated']=bPopulated;},'GetPopulated':function(parentDiv){var status=TriSysApex['ControlPopulationDirty']['GetPopulationAndDirtyStatus'](parentDiv);return status['Populated'];},'SetDirty':function(parentDiv,bDirty){var status=TriSysApex['ControlPopulationDirty']['GetPopulationAndDirtyStatus'](parentDiv);status['Dirty']=bDirty;},'GetDirty':function(parentDiv){var status=TriSysApex['ControlPopulationDirty']['GetPopulationAndDirtyStatus'](parentDiv);return status['Dirty'];},'GetPopulationAndDirtyStatus':function(sParentDiv){for(var i=0x0;i<TriSysApex['ControlPopulationDirty']['PopulationAndDirtyStatus']['length'];i++){var status=TriSysApex['ControlPopulationDirty']['PopulationAndDirtyStatus'][i];if(status['ParentDiv']==sParentDiv)return status;}var newStatus={'ParentDiv':sParentDiv,'Populated':![],'Dirty':![]};return TriSysApex['ControlPopulationDirty']['PopulationAndDirtyStatus']['push'](newStatus),newStatus;}},'Alarms':{'IntervalId':null,'TaskAlarms':[],'PostItNotes':[],'ModalPopupTaskAlarms':![],'ModalPopupTaskAlarmsOptions':null,'Start':function(e){TriSysApex['Alarms']['FirePushNotification']();return;},'Stop':function(){if(TriSysApex['Alarms']['IntervalId'])clearInterval(TriSysApex['Alarms']['IntervalId']);},'Check':function(bDisablePopups,fnCallback,options){var now=moment()['format']('YYYY-MM-DD'),CTaskAlarmsRequest={'DateTime':now};if(options){if(options['CustomParameterCallback'])options['CustomParameterCallback'](CTaskAlarmsRequest);}var payloadObject={};payloadObject['URL']='Task/Alarms',payloadObject['OutboundDataPacket']=CTaskAlarmsRequest,payloadObject['InboundDataFunction']=function(CTaskAlarmsResponse){if(CTaskAlarmsResponse){if(options){if(options['CustomCallback']){options['CustomCallback'](CTaskAlarmsResponse);return;}}if(CTaskAlarmsResponse['Success']){var bShowPopups=!![];if(!TriSysAPI['Operators']['isEmpty'](bDisablePopups))bShowPopups=!bDisablePopups;TriSysApex['Alarms']['DisplayMetrics'](CTaskAlarmsResponse,bShowPopups);if(fnCallback)fnCallback();return;}else TriSysApex['Logging']['LogMessage'](CTaskAlarmsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('TriSysApex.Alarms.Check:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayTaskAlarmMetric':function(iCount){$('#trisys-task-alarm-count')['html'](TriSysSDK['Numbers']['ThousandsSeparator'](iCount)),$('#trisys-task-alarm-count2')['html'](TriSysSDK['Numbers']['ThousandsSeparator'](iCount));},'DisplayPostItNoteMetric':function(iCount){$('#trisys-task-postitnote-count')['html'](TriSysSDK['Numbers']['ThousandsSeparator'](iCount)),$('#trisys-task-postitnote-count2')['html'](TriSysSDK['Numbers']['ThousandsSeparator'](iCount));},'DisplayMetrics':function(CTaskAlarmsResponse,bShowPopups){CTaskAlarmsResponse['TaskAlarms']&&CTaskAlarmsResponse['PostItNotes']&&(TriSysApex['Alarms']['TaskAlarms']=CTaskAlarmsResponse['TaskAlarms'],TriSysApex['Alarms']['PostItNotes']=CTaskAlarmsResponse['PostItNotes'],TriSysApex['Alarms']['DisplayTaskAlarmMetric'](TriSysApex['Alarms']['TaskAlarms']['length']),TriSysApex['Alarms']['DisplayPostItNoteMetric'](TriSysApex['Alarms']['PostItNotes']['length']));if(CTaskAlarmsResponse['ActivitySummary']){var suffixes=['','2'];for(var i=0x0;i<suffixes['length'];i++){var suffix=suffixes[i];$('#trisys-task-activesearch-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['ActiveSearchCount'])),$('#trisys-task-today-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['TodaysTaskCount'])),$('#trisys-task-interviews-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['InterviewCount'])),$('#trisys-task-liverequirements-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['LiveRequirementCount'])),$('#trisys-task-contractorsworking-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['ContractorsWorkingCount'])),$('#trisys-task-starters-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['StarterCount'])),$('#trisys-task-finishers-count'+suffix)['html'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['FinisherCount']));}}bShowPopups&&(bShowPopups=TriSysApex['Cache']['UserSettingManager']['GetValueBoolean']('PopupTaskAlarms',![]));if(bShowPopups){var bToasters=![],bAlarmsModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlAlarms.js\x22></script>'}),bSnoozeModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlSnooze.js\x22></script>'});if(!TriSysApex['Alarms']['TaskAlarms']||TriSysApex['Alarms']['TaskAlarms']['length']==0x0){if(bAlarmsModalOpen&&!bSnoozeModalOpen)TriSysApex['UI']['CloseModalPopup']();}TriSysApex['Alarms']['TaskAlarms']['length']>0x0&&bToasters&&TriSysApex['Toasters']['Information'](TriSysSDK['Numbers']['ThousandsSeparator'](TriSysApex['Alarms']['TaskAlarms']['length'])+'\x20Task\x20Alarm'+(TriSysApex['Alarms']['TaskAlarms']['length']>0x1?'s':''));TriSysApex['Alarms']['PostItNotes']['length']>0x0&&(bToasters&&TriSysApex['Toasters']['Warning'](TriSysSDK['Numbers']['ThousandsSeparator'](TriSysApex['Alarms']['PostItNotes']['length'])+'\x20Post-It\x20Note'+(TriSysApex['Alarms']['PostItNotes']['length']>0x1?'s':'')),TriSysApex['PostItNotes']['OpenPostItNotes']());if(CTaskAlarmsResponse['ActivitySummary']&&bToasters){if(CTaskAlarmsResponse['ActivitySummary']['ActiveSearchCount']>0x0)TriSysApex['Toasters']['Success'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['ActiveSearchCount'])+'\x20Active\x20Search\x20Candidates');if(CTaskAlarmsResponse['ActivitySummary']['TodaysTaskCount']>0x0)TriSysApex['Toasters']['Information'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['TodaysTaskCount'])+'\x20Outstanding\x20Tasks\x20Today');if(CTaskAlarmsResponse['ActivitySummary']['InterviewCount']>0x0)TriSysApex['Toasters']['Warning'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['InterviewCount'])+'\x20Interviews\x20Today');if(CTaskAlarmsResponse['ActivitySummary']['LiveRequirementCount']>0x0)TriSysApex['Toasters']['Success'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['LiveRequirementCount'])+'\x20Live\x20Requirements');if(CTaskAlarmsResponse['ActivitySummary']['ContractorsWorkingCount']>0x0)TriSysApex['Toasters']['Information'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['ContractorsWorkingCount'])+'\x20Contractors\x20Working');if(CTaskAlarmsResponse['ActivitySummary']['StarterCount']>0x0)TriSysApex['Toasters']['Warning'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['StarterCount'])+'\x20Starters\x20Today');if(CTaskAlarmsResponse['ActivitySummary']['FinisherCount']>0x0)TriSysApex['Toasters']['Success'](TriSysSDK['Numbers']['ThousandsSeparator'](CTaskAlarmsResponse['ActivitySummary']['FinisherCount'])+'\x20Finishers\x20Today');}}},'PopupTaskAlarmList':function(options){var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup)return;var bUseTaskAlarmCache=options&&options['IgnoreCache']?![]:!![];if(!bUseTaskAlarmCache){TriSysApex['Alarms']['Popup'](!![],{'AllOutstandingAlarmedTasks':![],'TaskAlarmCount':options['TaskAlarmCount'],'OverrideTaskAlarmNotificationUserSetting':options['OverrideTaskAlarmNotificationUserSetting'],'SecondsBeforeAlarmDateTime':options['SecondsBeforeAlarmDateTime']});return;}if(TriSysApex['Alarms']['TaskAlarms']['length']==0x0){const sMessage='No\x20scheduled\x20task\x20alarms\x20are\x20primed\x20to\x20show\x20at\x20this\x20time.';var fnYes=function(){return setTimeout(function(){TriSysApex['Alarms']['Popup'](!![],{'AllOutstandingAlarmedTasks':!![]});},0xa),!![];};TriSysApex['UI']['questionYesNo'](sMessage,'Task\x20Alarms','Show\x20All\x20Historic\x20Alarmed\x20Tasks',fnYes,'Close');return;}TriSysApex['Alarms']['Popup'](!![]);},'PopupPostItNoteList':function(options){var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup)return;if(options&&options['IgnoreCache']){TriSysApex['Alarms']['Check'](![],null,{'CustomParameterCallback':function(CTaskAlarmsRequest){CTaskAlarmsRequest['AllOutstandingAlarmedTasks']=![];},'CustomCallback':function(CTaskAlarmsResponse){if(CTaskAlarmsResponse['Success']){TriSysApex['Alarms']['PostItNotes']=CTaskAlarmsResponse['PostItNotes'],TriSysApex['Alarms']['DisplayPostItNoteMetric'](TriSysApex['Alarms']['PostItNotes']['length']),TriSysApex['Alarms']['PopupPostItNoteList']({'SupressZeroLengthMessage':!![]});return;}}});return;}if(TriSysApex['Alarms']['PostItNotes']['length']==0x0){if(options&&options['SupressZeroLengthMessage'])return;TriSysApex['UI']['ShowMessage']('No\x20post-it\x20notes\x20are\x20primed\x20to\x20show\x20at\x20this\x20time.');return;}TriSysApex['PostItNotes']['OpenPostItNotes']();},'Popup':function(bTaskAlarms,options){var bModalsAreOpen=![];if(bTaskAlarms){var bPopupTaskAlarms=![];if(options&&options['OverrideTaskAlarmNotificationUserSetting'])bPopupTaskAlarms=!![];else var bPopupTaskAlarms=TriSysApex['Cache']['UserSettingManager']['GetValueBoolean']('PopupTaskAlarms',![]);if(!bPopupTaskAlarms)return;var iTaskAlarmCount=options&&options['TaskAlarmCount']>0x0?options['TaskAlarmCount']:0x0,bAlarmsModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlAlarms.js\x22></script>'}),bSnoozeModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlSnooze.js\x22></script>'});bModalsAreOpen=bAlarmsModalOpen||bSnoozeModalOpen||TriSysApex['UI']['isModalOpen']();var bCloseModals=TriSysApex['Alarms']['TaskAlarms']['length']==0x0&&iTaskAlarmCount>0x0||iTaskAlarmCount==0x0;if(bSnoozeModalOpen){if(bCloseModals)TriSysApex['UI']['CloseModalPopup']();else return;}if(bAlarmsModalOpen){if(bCloseModals)TriSysApex['UI']['CloseModalPopup']();else return;}if(TriSysApex['UI']['isModalOpen']()){if(bCloseModals)TriSysApex['UI']['CloseModalPopup']();else return;}var sSoundSelected=TriSysApex['Cache']['UserSettingManager']['GetValue']('Task.AlarmSound'),iDelayMilliSeconds=0xa;setTimeout(function(){TriSysSDK['Audio']['PlayTaskAlarmSound'](sSoundSelected,iTaskAlarmCount);},iDelayMilliSeconds);}TriSysApex['Alarms']['ModalPopupTaskAlarms']=bTaskAlarms,TriSysApex['Alarms']['ModalPopupTaskAlarmsOptions']=options;var fnOpenAlarmsPopup=function(){var parametersObject=new TriSysApex['UI']['ShowMessageParameters'](),sTitle=(bTaskAlarms?'Task\x20Alarms':'Post-It\x20Notes')+'\x20';parametersObject['Title']=sTitle,parametersObject['Image']='gi-alarm',parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['CloseTopRightButton']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlAlarms.html'),parametersObject['ButtonLeftVisible']=![],parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',TriSysApex['UI']['PopupMessage'](parametersObject);};if(bModalsAreOpen)setTimeout(fnOpenAlarmsPopup,0xfa);else fnOpenAlarmsPopup();},'Snooze':{'Popup':function(lstTaskId,bTaskAlarm,fnCallback){TriSysApex['Alarms']['Snooze']['TaskIdArray']=lstTaskId;var parametersObject=new TriSysApex['UI']['ShowMessageParameters'](),sTitle='Snooze\x20'+(bTaskAlarm?'Task\x20Alarm':'Post-It\x20Note')+'\x20';parametersObject['Title']=sTitle,parametersObject['Image']='gi-alarm',parametersObject['Maximize']=!![],parametersObject['FullScreen']=![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlSnooze.html'),parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']='OK',parametersObject['ButtonLeftFunction']=function(){if(ctrlSnooze['OKButtonClick']())return fnCallback(),!![];},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);},'TaskIdArray':null},'FirePushNotification':function(){var CAutomatedApexTaskAlarmsRequest={'LoggedInUserOnly':!![]},payloadObject={};payloadObject['URL']='Tasks/AutomatedApexTaskAlarms',payloadObject['OutboundDataPacket']=CAutomatedApexTaskAlarmsRequest,payloadObject['InboundDataFunction']=function(CAutomatedApexTaskAlarmsResponse){if(CAutomatedApexTaskAlarmsResponse){if(CAutomatedApexTaskAlarmsResponse['Success']){}else TriSysApex['Logging']['LogMessage'](CAutomatedApexTaskAlarmsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('TriSysApex.Alarms.FirePushNotification:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'ReceivedNotification':function(iTaskAlarmCount,iPostItNoteCount,bShowTaskAlarmPopup,iSecondsBeforeAlarmDateTime){var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup)return;TriSysApex['Alarms']['DisplayTaskAlarmMetric'](iTaskAlarmCount),TriSysApex['Alarms']['DisplayPostItNoteMetric'](iPostItNoteCount);if(iTaskAlarmCount>0x0){bShowTaskAlarmPopup&&TriSysApex['Alarms']['PopupTaskAlarmList']({'IgnoreCache':!![],'TaskAlarmCount':iTaskAlarmCount,'SecondsBeforeAlarmDateTime':iSecondsBeforeAlarmDateTime});var bDiaryOpen=TriSysApex['FormsManager']['isFormOpen']('DiaryManager');if(bDiaryOpen)TriSysSDK['Scheduler']['RefreshFromServer']();}iPostItNoteCount>0x0&&TriSysApex['Alarms']['PopupPostItNoteList']({'IgnoreCache':!![],'PostItNoteCount':iPostItNoteCount});TriSysApex['Alarms']['GetRecruitmentMetricsAfterLosingThemInJune24']();return;},'GetRecruitmentMetricsAfterLosingThemInJune24':function(){var now=moment()['format']('YYYY-MM-DD'),CRecruitmentSummaryRequest={'DateTime':now},payloadObject={};payloadObject['URL']='Task/RecruitmentSummary',payloadObject['OutboundDataPacket']=CRecruitmentSummaryRequest,payloadObject['InboundDataFunction']=function(CRecruitmentSummaryResponse){if(CRecruitmentSummaryResponse){if(CRecruitmentSummaryResponse['Success']){TriSysApex['Alarms']['DisplayMetrics'](CRecruitmentSummaryResponse,![]);return;}else TriSysApex['Logging']['LogMessage'](CRecruitmentSummaryResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['Logging']['LogMessage']('TriSysApex.Alarms.GetRecruitmentMetricsAfterLosingThemInJune24:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'DisplayTaskAlarms':function(lstAlarmedTask){var bAlarmsModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlAlarms.js\x22></script>'}),bSnoozeModalOpen=TriSysApex['UI']['isModalOpen']({'BodyMatchString':'<script\x20src=\x22js/pages/ctrlSnooze.js\x22></script>'});if(!lstAlarmedTask||lstAlarmedTask['length']==0x0){if(bAlarmsModalOpen&&!bSnoozeModalOpen)TriSysApex['UI']['CloseModalPopup']();return;}var bPopupTaskAlarms=TriSysApex['Cache']['UserSettingManager']['GetValueBoolean']('PopupTaskAlarms',![]);if(!bPopupTaskAlarms)return;var lstDisplayTask=[],dtNow=new Date();lstAlarmedTask['forEach'](function(taskSummary){var dtStart=new Date(taskSummary['StartDate']),dtEnd=new Date(taskSummary['EndDate']),dtAlert=new Date(taskSummary['AlertDate']),bAddTask=dtNow>=dtAlert;if(bAddTask)lstDisplayTask['push'](taskSummary);});if(lstDisplayTask['length']==0x0)return;var sSoundSelected=TriSysApex['Cache']['UserSettingManager']['GetValue']('Task.AlarmSound'),iDelayMilliSeconds=0xa;setTimeout(function(){TriSysSDK['Audio']['PlayTaskAlarmSound'](sSoundSelected,lstDisplayTask['length']);},iDelayMilliSeconds);var fnOpen=function(){!TriSysApex['UI']['isModalOpen']()&&(TriSysApex['Alarms']['TaskAlarms']=lstDisplayTask,TriSysApex['Alarms']['Popup'](!![]),TriSysApex['Alarms']['DisplayTaskAlarmMetric']());};if(bSnoozeModalOpen)return;if(bAlarmsModalOpen)TriSysApex['UI']['CloseModalPopup']();setTimeout(fnOpen,0x64);return;},'_popover':null},'PostItNotes':{'WindowPrefix':'post-it-note-','VisiblePostItNotes':0x0,'CurrentPosition':null,'StartPosition':function(){var iStartLeft=0xa0,iStartTop=0x32,iWidth=0x190,iHorizontalIncrement=0x64,iVerticalIncrement=0x64;return TriSysApex['Device']['isPhone']()&&(iStartLeft=0x1,iWidth=document['body']['offsetWidth']-0x14,iHorizontalIncrement=0x5,iVerticalIncrement=0x5),{'startTop':iStartTop,'startLeft':iStartLeft,'top':iStartTop,'left':iStartLeft,'height':0x14a,'width':iWidth,'horizontalIncrement':iHorizontalIncrement,'verticalIncrement':iVerticalIncrement};},'New':function(){TriSysApex['PostItNotes']['VisiblePostItNotes']=0x0,TriSysApex['PostItNotes']['CurrentPosition']=null;var postItNote={'TaskId':-0x1*TriSysSDK['Miscellaneous']['RandomNumber'](0x186a0,0xf423f),'StartDate':new Date()},sEntityHyperlinkPrefix='\x0a'+'<a\x20style=\x22cursor:pointer;\x22\x20onclick=\x22TriSysApex.FormsManager.OpenForm(\x27'+TriSysApex['FormsManager']['SelectedFormName']+'\x27,\x20',sEntityHyperlinkSuffix='</a>'+'\x0a',bCompanyFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Company';if(bCompanyFormOpen){var sCompany=$('#Company_Name')['val']();postItNote['DisplayDescription']=sEntityHyperlinkPrefix+TriSysApex['Pages']['CompanyForm']['CompanyId']+')\x22>'+sCompany+sEntityHyperlinkSuffix;}var bContactFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Contact';if(bContactFormOpen){var sContact=$('#Contact_Forenames')['val']()+'\x20'+$('#Contact_Surname')['val']();postItNote['DisplayDescription']=sEntityHyperlinkPrefix+TriSysApex['Pages']['ContactForm']['ContactId']+')\x22>'+sContact+sEntityHyperlinkSuffix;}var bRequirementFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Requirement';if(bRequirementFormOpen){var sRequirement=$('#RequirementConfigFields_RequirementReference')['val']()+':\x20'+$('#RequirementConfigFields_JobTitle')['val']()+',\x20'+$('#Requirement_CompanyId')['val']();postItNote['DisplayDescription']=sEntityHyperlinkPrefix+TriSysApex['Pages']['RequirementForm']['RequirementId']+')\x22>'+sRequirement+sEntityHyperlinkSuffix;}var bPlacementFormOpen=TriSysApex['FormsManager']['SelectedFormName']=='Placement';if(bPlacementFormOpen){var sPlacement=$('#PlacementConfigFields_Reference')['val']()+':\x20'+$('#PlacementConfigFields_JobTitle')['val']()+',\x20'+$('#PlacementConfigFields_Candidate')['val']()+'\x20at\x20'+$('#Placement_CompanyId')['val']();postItNote['DisplayDescription']=sEntityHyperlinkPrefix+TriSysApex['Pages']['PlacementForm']['PlacementId']+')\x22>'+sPlacement+sEntityHyperlinkSuffix;}TriSysApex['PostItNotes']['OpenPostItNoteWindow'](postItNote);},'CalculateNextPositionAndDimensions':function(){var iStartLeft=TriSysApex['Device']['isPhone']()?0x5:0xa,iStartTop=0xa;TriSysApex['PostItNotes']['VisiblePostItNotes']+=0x1;if(!TriSysApex['PostItNotes']['CurrentPosition'])TriSysApex['PostItNotes']['CurrentPosition']=TriSysApex['PostItNotes']['StartPosition']();if(!TriSysApex['Pages']['Index']['isNavBarVisible']())TriSysApex['PostItNotes']['CurrentPosition']['startLeft']=iStartLeft;TriSysApex['PostItNotes']['VisiblePostItNotes']>0x1&&(TriSysApex['PostItNotes']['CurrentPosition']['top']+=TriSysApex['PostItNotes']['CurrentPosition']['verticalIncrement'],TriSysApex['PostItNotes']['CurrentPosition']['left']+=TriSysApex['PostItNotes']['CurrentPosition']['horizontalIncrement'],TriSysApex['PostItNotes']['CurrentPosition']['top']+TriSysApex['PostItNotes']['CurrentPosition']['height']>$(window)['height']()&&(TriSysApex['PostItNotes']['CurrentPosition']['top']=TriSysApex['PostItNotes']['CurrentPosition']['startTop'],TriSysApex['PostItNotes']['CurrentPosition']['left']-=TriSysApex['PostItNotes']['CurrentPosition']['horizontalIncrement']),TriSysApex['PostItNotes']['CurrentPosition']['left']+TriSysApex['PostItNotes']['CurrentPosition']['width']>$(window)['width']()&&(TriSysApex['PostItNotes']['CurrentPosition']['top']=TriSysApex['PostItNotes']['CurrentPosition']['startTop']+iStartTop+(TriSysApex['PostItNotes']['VisiblePostItNotes']-0x1)*0x2,TriSysApex['PostItNotes']['CurrentPosition']['left']=TriSysApex['PostItNotes']['CurrentPosition']['startLeft']+iStartLeft+(TriSysApex['PostItNotes']['VisiblePostItNotes']-0x1)*0x2,TriSysApex['PostItNotes']['CurrentPosition']['horizontalIncrement']=TriSysApex['PostItNotes']['CurrentPosition']['horizontalIncrement']/0x2,TriSysApex['PostItNotes']['CurrentPosition']['verticalIncrement']=TriSysApex['PostItNotes']['CurrentPosition']['verticalIncrement']/0x2));},'OpenPostItNote':function(lTaskId){for(var i=0x0;i<TriSysApex['Alarms']['PostItNotes']['length'];i++){var postItNote=TriSysApex['Alarms']['PostItNotes'][i];if(postItNote['TaskId']==lTaskId){TriSysApex['PostItNotes']['OpenPostItNoteWindow'](postItNote);return;}}TriSysApex['PostItNotes']['OpenPostItNoteWindowUsingTaskId'](lTaskId);},'OpenPostItNotes':function(){var notOpen=[];TriSysApex['PostItNotes']['VisiblePostItNotes']=0x0,TriSysApex['PostItNotes']['CurrentPosition']=null,TriSysApex['PostItNotes']['CalculateNextPositionAndDimensions']();for(var i=0x0;i<TriSysApex['Alarms']['PostItNotes']['length'];i++){var postItNote=TriSysApex['Alarms']['PostItNotes'][i],sDiv=TriSysApex['PostItNotes']['WindowPrefix']+postItNote['TaskId'],bDOMObjectExists=$('#'+sDiv)['length']>0x0;if(bDOMObjectExists){TriSysApex['PostItNotes']['CurrentPosition']['top']+=0x5,TriSysApex['PostItNotes']['CurrentPosition']['left']+=TriSysApex['Device']['isPhone']()?0x3:0x5;var piNote=$('#'+sDiv)['data']('kendoWindow');piNote['setOptions']({'position':{'top':TriSysApex['PostItNotes']['CurrentPosition']['top'],'left':TriSysApex['PostItNotes']['CurrentPosition']['left']}}),piNote['toFront']();}else notOpen['push'](postItNote);}if(notOpen['length']==0x0)return;for(var i=0x0;i<notOpen['length'];i++){var postItNote=notOpen[i];TriSysApex['PostItNotes']['OpenPostItNoteWindow'](postItNote);}},'CountOpenInstances':function(){var iCount=0x0;return $('div[id^='+TriSysApex['PostItNotes']['WindowPrefix']+']')['filter'](function(){var sID=this['id'],piNote=$('#'+sID)['data']('kendoWindow');if(piNote)iCount+=0x1;}),iCount;},'HideAll':function(){$('div[id^='+TriSysApex['PostItNotes']['WindowPrefix']+']')['filter'](function(){var sID=this['id'],piNote=$('#'+sID)['data']('kendoWindow');if(piNote)piNote['close']();});},'Hide':function(lTaskId){var sID=TriSysApex['PostItNotes']['WindowPrefix']+lTaskId,piNote=$('#'+sID)['data']('kendoWindow');if(piNote)piNote['close']();},'OpenPostItNoteWindowUsingTaskId':function(lTaskId){var dataPacket={'TaskId':lTaskId},payloadObject={};payloadObject['URL']='Task/Read',payloadObject['OutboundDataPacket']=dataPacket,payloadObject['InboundDataFunction']=function(CTaskReadResponse){TriSysApex['UI']['HideWait']();if(CTaskReadResponse){if(CTaskReadResponse['Success']){var task=CTaskReadResponse['Task'];TriSysApex['PostItNotes']['OpenPostItNoteWindow'](task);return;}else TriSysApex['UI']['ShowMessage'](CTaskReadResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.PostItNotes.OpenPostItNoteWindowUsingTaskId:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Post-It\x20Note...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'OpenPostItNoteWindow':function(postItNote){if(!TriSysApex['PostItNotes']['CurrentPosition'])TriSysApex['PostItNotes']['CalculateNextPositionAndDimensions']();TriSysApex['PostItNotes']['CurrentPosition']['top']+=0x5,TriSysApex['PostItNotes']['CurrentPosition']['left']+=TriSysApex['Device']['isPhone']()?0x3:0x5;var sDiv=TriSysApex['PostItNotes']['WindowPrefix']+postItNote['TaskId'],sTitle='Post-It\x20Note:\x20'+moment(postItNote['StartDate'])['format']('HH:mm\x20dddd\x20DD\x20MMMM\x20YYYY');TriSysApex['ModalDialogue']['Current']['Name']='ctrlPostItNote';var bDOMObjectExists=$('#'+sDiv)['length']>0x0;if(bDOMObjectExists)return;$('<div\x20id=\x22'+sDiv+'\x22\x20/>')['appendTo']($('#main-container'))['kendoWindow']({'resizable':![],'width':TriSysApex['PostItNotes']['CurrentPosition']['width']+'px','height':TriSysApex['PostItNotes']['CurrentPosition']['height']+'px','position':{'top':TriSysApex['PostItNotes']['CurrentPosition']['top'],'left':TriSysApex['PostItNotes']['CurrentPosition']['left']},'pinned':!![],'title':sTitle,'scrollable':![],'content':{'url':TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlPostItNote.html'),'task':postItNote},'modal':![],'actions':['Close'],'close':function(e){TriSysApex['ModalDialogue']['Current']['Name']=null,this['destroy']();}}),$('#'+sDiv)['parent']()['find']('.k-window-titlebar,.k-window-actions')['css']('backgroundColor',TriSysApex['Constants']['PostItNoteColour']),$('#'+sDiv)['parent']()['find']('.k-window-content')['css']('backgroundColor',TriSysApex['Constants']['PostItNoteColour']);}},'EntityPreview':{'WindowPrefix':'-preview','_LastContactPreviewRequestTimeMilliseconds':0x0,'_LastPopupBrowserOpenTimeMilliseconds':0x0,'OpenWindow':function(sEntityName,fnCallback){var sDiv=sEntityName+TriSysApex['EntityPreview']['WindowPrefix'],bDOMObjectExists=$('#'+sDiv)['length']>0x0;if(bDOMObjectExists){fnCallback();return;}var sTitle=sEntityName+'\x20Preview',sHTMLFile='ctrl'+sEntityName+'Preview.html';TriSysApex['ModalDialogue']['Current']['SetName'](sHTMLFile);var iHeightFactor=0.75,iWidth=$(window)['width']()/0x3,iHeight=$(window)['height']()*iHeightFactor,iTop=0x32,iLeft=$(window)['width']()-iWidth,iDefaultHeight=0x302;iDefaultHeight=0x316;if($(window)['height']()>iTop+iDefaultHeight)iHeight=iDefaultHeight;var bContactPreviewMode=window['location']['href']['indexOf']('?ContactPreviewMode')>0x0,kendoWindow=null;const CustomIcon='hyperlink-open';var windowOptions={'resizable':!![],'width':iWidth+'px','height':iHeight+'px','minWidth':'370px','minHeight':'400px','position':{'top':iTop,'left':iLeft},'pinned':!![],'title':sTitle,'scrollable':![],'draggable':!![],'content':{'url':TriSysApex['CustomFormsAndComponents']['UserControlPath'](sHTMLFile),'callback':fnCallback},'modal':![],'actions':[CustomIcon,'Pin','Maximize','Close'],'close':function(e){TriSysApex['ModalDialogue']['Current']['Name']=null,this['destroy']();}};const baseID='<div\x20id=\x22'+sDiv+'\x22\x20/>';var jqueryElement=null;bContactPreviewMode?(windowOptions['modal']=!![],windowOptions['draggable']=![],windowOptions['actions']=null,windowOptions['title']=![],jqueryElement=$(baseID)['appendTo']($('body'))):jqueryElement=$(baseID)['appendTo']($('#main-container'));kendoWindow=jqueryElement['kendoWindow'](windowOptions)['data']('kendoWindow');var hyperlinkButton=kendoWindow['wrapper']['find']('.k-svg-i-'+CustomIcon);if(hyperlinkButton){var fnHyperlinkButton=function(e){TriSysApex['EntityPreview']['_LastPopupBrowserOpenTimeMilliseconds']=Date['now'](),TriSysApex['EntityPreview']['CustomButtonCallbackToLoadContactPreviewPopupBrowserWindow'](e,iWidth,iHeight,iLeft,iTop);},parentElement=hyperlinkButton['parent']();parentElement['click'](fnHyperlinkButton),parentElement['attr']('title','Open\x20contact\x20preview\x20in\x20a\x20new\x20pop-up\x20browser\x20window');}},'_PopupBrowserWindowName':'TriSysContactPreviewWindow','_PopupBrowserWindowInstance':null,'CustomButtonCallbackToLoadContactPreviewPopupBrowserWindow':function(e,iWidth,iHeight,iLeft,iTop){var sCurrentURL=window['location']['href'],parts=sCurrentURL['split']('/'),sURL='https://';for(var i=0x2;i<parts['length']-0x1;i++)sURL+=parts[i]+'/';var jsonObject={'ContactId':TriSysApex['EntityPreview']['Contact']['_MostRecentContactId'],'SearchCriteriaJson':TriSysApex['EntityPreview']['Contact']['_MostRecentSearchCriteriaJson'],'SiteKey':TriSysAPI['Session']['DeveloperSiteKey'](),'DataServicesKey':TriSysAPI['Session']['DataServicesKey'](),'SecureURL':TriSysAPI['Constants']['SecureURL']},sBase64=$['base64']['encode'](JSON['stringify'](jsonObject));sURL+=TriSysApex['Constants']['ContactPreviewPrefix']+sBase64,TriSysApex['EntityPreview']['_PopupBrowserWindowInstance']=window['open'](sURL,TriSysApex['EntityPreview']['_PopupBrowserWindowName'],'width='+iWidth+',\x20height='+iHeight+',\x20left='+iLeft+',\x20top='+iTop+',\x20menubar=no,\x20resizable=yes,\x20scrollbars=no,\x20status=no,\x20location=no');var fnClose=function(){TriSysApex['EntityPreview']['CloseWindow']('Contact');};setTimeout(fnClose,0x1),e['preventDefault']();},'CloseContactPreviewPopupBrowser':function(){if(TriSysApex['EntityPreview']['_PopupBrowserWindowInstance'])try{TriSysApex['EntityPreview']['_PopupBrowserWindowInstance']['close']();}catch(e){}},'CloseWindow':function(sEntityName){var sDiv='#'+sEntityName+TriSysApex['EntityPreview']['WindowPrefix'],bDOMObjectExists=$(sDiv)['length']>0x0;if(bDOMObjectExists){var window=$(sDiv);window['data']('kendoWindow')['close']();return;}},'SendEntityPreviewModeSignalRMessage':function(sEntityName,lRecordId,bOnlyOpenEntityRecordIfAlreadyLoaded){var msg={'EntityName':sEntityName,'RecordId':lRecordId,'OnlyOpenEntityRecordIfAlreadyLoaded':bOnlyOpenEntityRecordIfAlreadyLoaded,'Type':TriSysApex['SignalR']['Communication']['MessageType']['OpenEntityRecord']},sJSON=JSON['stringify'](msg),sRecipientLoginName=null;TriSysApex['SignalR']['Communication']['Send'](sRecipientLoginName,sJSON);},'Contact':{'_MostRecentContactId':0x0,'_MostRecentSearchCriteriaJson':null,'Open':function(lContactId,sSearchCriteriaJson,options){lContactId>0x0&&(TriSysApex['EntityPreview']['Contact']['_MostRecentContactId']=lContactId,TriSysApex['EntityPreview']['Contact']['_MostRecentSearchCriteriaJson']=sSearchCriteriaJson,TriSysApex['EntityPreview']['Contact']['OrchestrateContactPreview'](lContactId,sSearchCriteriaJson,options));},'ContactFromPreview':function(){try{var contact=ctrlContactPreview['CurrentContact'];return contact;}catch(e){}},'Data':{'BrowserPopupWindowResponded':![],'BrowserExtension':![]},'OrchestrateContactPreview':function(lContactId,sSearchCriteriaJson,options){TriSysApex['EntityPreview']['Contact']['Data']['BrowserPopupWindowResponded']=![];var iTimeoutMillesecondsToAllowPopupBrowserAcknowledgement=0x3e8,fnTimeoutWaitingForSignalR=function(bPopupBrowser){if(!bPopupBrowser){if(TriSysApex['EntityPreview']['Contact']['Data']['BrowserPopupWindowResponded'])return;var sWhat='Please\x20allow\x20the\x20popup\x20browser\x20contact\x20preview\x20window\x20to\x20',iNow=Date['now']();if(iNow-TriSysApex['EntityPreview']['_LastContactPreviewRequestTimeMilliseconds']<iTimeoutMillesecondsToAllowPopupBrowserAcknowledgement&&TriSysApex['EntityPreview']['_LastPopupBrowserOpenTimeMilliseconds']>0x0){var iCurrentModalIndex=TriSysApex['UI']['GetNextStackedModalIndex']();if(iCurrentModalIndex==0x0)TriSysApex['UI']['ShowMessage'](sWhat+'process\x20your\x20previous\x20request.');return;}if(iNow-TriSysApex['EntityPreview']['_LastPopupBrowserOpenTimeMilliseconds']<0x2710){var iCurrentModalIndex=TriSysApex['UI']['GetNextStackedModalIndex']();if(iCurrentModalIndex==0x0)TriSysApex['UI']['ShowMessage'](sWhat+'load.');return;}}var fnCallback=function(){ctrlContactPreview['Open'](lContactId,sSearchCriteriaJson,options);};TriSysApex['EntityPreview']['OpenWindow']('Contact',fnCallback);},bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup){fnTimeoutWaitingForSignalR(!![]);return;}else TriSysApex['EntityPreview']['Contact']['SendContactPreviewModeSignalRMessage'](lContactId,TriSysApex['SignalR']['Communication']['MessageType']['ContactPreviewRequest'],sSearchCriteriaJson);setTimeout(fnTimeoutWaitingForSignalR,iTimeoutMillesecondsToAllowPopupBrowserAcknowledgement),TriSysApex['EntityPreview']['_LastContactPreviewRequestTimeMilliseconds']=Date['now']();},'ReceivedAcknowledgementFromBrowserPopupWindow':function(lContactId){TriSysApex['EntityPreview']['Contact']['Data']['BrowserPopupWindowResponded']=!![];},'SendContactPreviewModeSignalRMessage':function(lContactId,eType,sSearchCriteriaJson){var msg={'EntityName':'Contact','RecordId':lContactId,'ContactId':lContactId,'SearchCriteriaJson':sSearchCriteriaJson,'Type':eType},sJSON=JSON['stringify'](msg);try{var sRecipientLoginName=null;TriSysApex['SignalR']['Communication']['Send'](sRecipientLoginName,sJSON);}catch(e){}}}},'InterprocessCommunication':{'ChannelPrefix':'TriSysApex-IPC-','ChannelName':null,'MessageType_OpenForm':'OpenForm','MessageType_TaskForm':'TaskForm','MessageType_RunAction':'RunAction','MessageType_TriSysToBrowser':'TriSysToBrowser','MessageType_LinkedInToTriSys':'LinkedInToTriSys','MessageType_GMailToTriSys':'GMailToTriSys','MessageType_ExtensionToTriSys':'ExtensionToTriSys','HideBrowserTopRegion':'TriSysExtension-Hide','ShowBrowserTopRegion':'TriSysExtension-Show','CloseBrowserPopupWindow':'TriSysExtension-ClosePopupWindow','ActivateApexTab':'TriSysExtension-ActivateApexTab','ReParsePage':'TriSysExtension-ReParsePage','NoApexTabFound':'TriSysExtension-NoApexTabFound','ApexTabFoundAndFocused':'TriSysExtension-ApexTabFoundAndFocused','LinkedInTabFocused':'TriSysExtension-LinkedInTabFocused','ToolbarButtonClicked':'TriSysExtension-ToolbarButtonClicked','ApexBrowserExtensionLoaded':'ApexBrowserExtensionLoaded','LoadMaster':function(sUserName){TriSysApex['InterprocessCommunication']['ChannelName']=TriSysApex['InterprocessCommunication']['ChannelPrefix']+sUserName,TriSysApex['InterprocessCommunication']['ListenForMessage'](TriSysApex['InterprocessCommunication']['ChannelName'],TriSysApex['InterprocessCommunication']['ProcessMasterMessage']);},'ProcessMasterMessage':function(sMessageID,messageObject){TriSysApex['Logging']['LogMessage']('TriSysApex.InterprocessCommunication.ProcessMasterMessage():\x20'+sMessageID+',\x20Type='+messageObject['Type']);switch(messageObject['Type']){case TriSysApex['InterprocessCommunication']['MessageType_OpenForm']:TriSysApex['FormsManager']['OpenForm'](messageObject['FormName'],messageObject['RecordId']);break;case TriSysApex['InterprocessCommunication']['MessageType_TaskForm']:if(messageObject['TaskId']>0x0)TriSysApex['ModalDialogue']['Task']['QuickShow'](messageObject['TaskId']);else{var params=new TriSysApex['ModalDialogue']['Task']['ShowParameters']();params['Scheduled']=messageObject['Scheduled'],messageObject['Contact']['ContactType']='Client',params['Contacts']['push'](messageObject['Contact']),TriSysApex['ModalDialogue']['Task']['Show'](params);}break;case TriSysApex['InterprocessCommunication']['MessageType_RunAction']:TriSysActions['Invocation']['RunEntityAction']('Contact',messageObject['ContactId'],messageObject['ActionId']);break;default:return;}},'ClientOpenForm':function(sFormName,lRecordId){var message={'Type':TriSysApex['InterprocessCommunication']['MessageType_OpenForm'],'FormName':sFormName,'RecordId':lRecordId};TriSysApex['InterprocessCommunication']['SendMessage'](TriSysApex['InterprocessCommunication']['ChannelName'],message);},'ClientTaskAutomation':function(lTaskId,contact,bScheduled){var message={'Type':TriSysApex['InterprocessCommunication']['MessageType_TaskForm'],'TaskId':lTaskId,'Contact':contact,'Scheduled':bScheduled};TriSysApex['InterprocessCommunication']['SendMessage'](TriSysApex['InterprocessCommunication']['ChannelName'],message);},'ContactActionAutomation':function(lContactId,sActionID){var message={'Type':TriSysApex['InterprocessCommunication']['MessageType_RunAction'],'EntityName':'Contact','RecordId':lContactId,'ActionId':sActionID};TriSysApex['InterprocessCommunication']['SendMessage'](TriSysApex['InterprocessCommunication']['ChannelName'],message);},'MessageAndCallbackList':[],'GetMessageAndCallback':function(sMessageID){for(var i=0x0;i<TriSysApex['InterprocessCommunication']['MessageAndCallbackList']['length'];i++){var messageAndCallback=TriSysApex['InterprocessCommunication']['MessageAndCallbackList'][i];if(messageAndCallback['MessageID']==sMessageID)return messageAndCallback;}return null;},'ListenForMessage':function(sMessageID,fnCallback){if(TriSysApex['InterprocessCommunication']['MessageAndCallbackList']['length']==0x0){if(window['addEventListener'])window['addEventListener']('storage',TriSysApex['InterprocessCommunication']['StorageEventHandler'],!![]);else alert('addEventListener\x20not\x20supported');}var messageAndCallback={'MessageID':sMessageID,'CallbackFunction':fnCallback};TriSysApex['InterprocessCommunication']['MessageAndCallbackList']['push'](messageAndCallback),TriSysApex['Logging']['LogMessage']('TriSysApex.InterprocessCommunication.ListenForMessage():\x20'+sMessageID);},'SendMessage':function(sMessageID,messageObject){var ourMessageObject={'Message':messageObject},sJSON=JSON['stringify'](ourMessageObject);if(!sMessageID){var sUserName='',userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser'])sUserName=userCredentials['LoggedInUser']['FullName'];else try{sUserName=TriSysExtension['Cookies']['GetEMail']();}catch(e){}sMessageID=TriSysApex['InterprocessCommunication']['ChannelPrefix']+sUserName;}localStorage['removeItem'](sMessageID),localStorage['setItem'](sMessageID,sJSON),TriSysApex['Logging']['LogMessage']('TriSysApex.InterprocessCommunication.SendMessage():\x20'+sMessageID+':\x20'+sJSON);},'StorageEventHandler':function(e){if(!e['newValue'])return;var sMessageID=e['key'];TriSysApex['Logging']['LogMessage']('TriSysApex.InterprocessCommunication.StorageEventHandler():\x20'+sMessageID);var messageAndCallback=TriSysApex['InterprocessCommunication']['GetMessageAndCallback'](sMessageID);if(messageAndCallback){var ourMessageObject=JSON['parse'](e['newValue']),messageObject=ourMessageObject['Message'];TriSysApex['Logging']['LogMessage']('TriSysApex.InterprocessCommunication.StorageEventHandler():\x20Passing\x20'+JSON['stringify'](messageObject)),messageAndCallback['CallbackFunction'](sMessageID,messageObject);}}},'SignalR':{'DebugOn':!![],'Communication':{'ThisApp':'TriSys/SignalR/Communication','SocketIO':null,'Connect':function(){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var bInDev=TriSysApex['Environment']['isDeployedInTestMode']();if(bInDev&&!TriSysApex['SignalR']['DebugOn'])return;var sUserHandle=TriSysApex['SignalR']['Communication']['FullSenderAndRecipientAddress'](userCredentials['LoggedInUser']['LoginName']);TriSysApex['SignalR']['Communication']['SocketIO']=new CTriSysSocketIO(TriSysApex['Constants']['DeveloperSiteKey'],TriSysAPI['Session']['DataServicesKey']()),TriSysApex['SignalR']['Communication']['SocketIO']['ConnectedCallback']=function(sMessage){TriSysApex['Logging']['LogMessage'](sMessage);},TriSysApex['SignalR']['Communication']['SocketIO']['ReceivedMessageCallback']=function(sMessage){var messageObject=JSON['parse'](sMessage);TriSysApex['SignalR']['Communication']['Receive'](messageObject['Sender'],messageObject['MessageJSON']);},TriSysApex['SignalR']['Communication']['SocketIO']['Connect'](sUserHandle,function(sMessage,bError){TriSysApex['Logging']['LogMessage'](bError?'ERROR:\x20':''+sMessage);});}TriSysApex['SignalR']['Communication']['RegisterCallbacksOnIncomingMessages']();},'RegisterCallbacksOnIncomingMessages':function(){var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'],fnCallback1=function(senderUser,msg){var sType=msg['Type'];if(sType){var bChatMessage=sType['indexOf']('Chat')>=0x0&&sType['indexOf']('Message')>0x0?!![]:![];bChatMessage&&(TriSysApex['Toasters']['Information']('Chat\x20message\x20from\x20'+senderUser['FullName']+'\x20at\x20'+moment()['format']('HH:mm')+'\x20on\x20'+moment()['format']('dddd\x20DD\x20MMMM')),TriSysSDK['Audio']['PlayWoosh']());}};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['All'],fnCallback1);var fnCallback3=function(senderUser,openEntityMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;switch(openEntityMessage['EntityName']){case'Task':TriSysApex['UI']['CloseModalPopup'](),TriSysApex['ModalDialogue']['Task']['QuickShow'](openEntityMessage['RecordId']);break;default:var options={'OnlyOpenEntityRecordIfAlreadyLoaded':openEntityMessage['OnlyOpenEntityRecordIfAlreadyLoaded']};TriSysApex['FormsManager']['OpenForm'](openEntityMessage['EntityName'],openEntityMessage['RecordId'],!![],options);break;}};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['OpenEntityRecord'],fnCallback3);var fnCallback4=function(senderUser,cvAutoRecognitionMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;TriSysApex['FormsManager']['OpenForm']('CVAutoRecognition');var openCVARFormAndAutoRec=function(){CVAutoRecognitionForm['DisplayAndParseCV'](cvAutoRecognitionMessage['FullPath'],cvAutoRecognitionMessage['FileName']);};setTimeout(function(){try{openCVARFormAndAutoRec();}catch(e){setTimeout(openCVARFormAndAutoRec,0x3e8);}},0x1f4);};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['CVAutoRecognition'],fnCallback4);var fnCallback5=function(senderUser,openCVMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;TriSysApex['FormsManager']['OpenForm']('Contact',openCVMessage['ContactId']),setTimeout(function(){contactForm['OpenCV'](openCVMessage['ContactId']);},0x3e8);};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['OpenCV'],fnCallback5);var fnCallback6=function(senderUser,CWebAPIFileUpdateMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;var sFilePath=CWebAPIFileUpdateMessage['File'],sErrorMessage=CWebAPIFileUpdateMessage['ErrorMessage'];if(sErrorMessage)TriSysApex['UI']['errorAlert'](sErrorMessage,'File\x20Save\x20Error');else TriSysApex['Pages']['FileManagerForm']['FileUpdateEvent'](sFilePath);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['FileManagerUpdate'],fnCallback6);var fnCallback7=function(senderUser,messageObject){if(TriSysApex['Forms']['Lock']['Enabled'])return;TriSysActions['Invocation']['RunEntityAction'](messageObject['EntityName'],messageObject['RecordId'],messageObject['ActionId']);};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['Action'],fnCallback7);var fnCallback9=function(senderUser,openEntityMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;var sEntityName=openEntityMessage['EntityName'],lRecordId=openEntityMessage['RecordId'],fnShowTask=function(){TriSysApex['ModalDialogue']['Task']['QuickShow'](lRecordId,openEntityMessage['Scheduled']);};if(sEntityName=='Task'&&lRecordId>0x0)fnShowTask();else{var lEntityRecordId=0x0;openEntityMessage['Contact']&&(sEntityName='Contact',lEntityRecordId=openEntityMessage['Contact']['ContactId']),fnShowTask=function(){TriSysApex['ModalDialogue']['Task']['ContextualNew'](openEntityMessage['Scheduled']);},TriSysApex['FormsManager']['OpenForm'](sEntityName,lEntityRecordId),setTimeout(fnShowTask,0x3e8);}};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['EntityTask'],fnCallback9);var fnCallbackLogoff=function(senderUser,logoffMessage){if(bWeAreTheRemoteBrowserPopup){self['close']();return;}var fnLogoff=function(){TriSysApex['LoginCredentials']['Logoff'](![]);},iDelayMilliseconds=0x1;if(logoffMessage['ShowMessage']){iDelayMilliseconds=logoffMessage['ShowMessage']['DisplaySeconds']*0x3e8;if(logoffMessage['ShowMessage']['Popup']&&logoffMessage['ShowMessage']['Text'])TriSysApex['UI']['ShowMessage'](logoffMessage['ShowMessage']['Text'],'Automatic\x20Logoff',function(){return fnLogoff(),!![];});}setTimeout(fnLogoff,iDelayMilliseconds);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['LogOff'],fnCallbackLogoff);var fnCallbackBroadcastMessage=function(senderUser,broadcastedMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;broadcastedMessage['ShowMessage']&&(broadcastedMessage['ShowMessage']['Popup']&&broadcastedMessage['ShowMessage']['Text']&&(TriSysApex['UI']['ShowMessage'](broadcastedMessage['ShowMessage']['Text'],broadcastedMessage['ShowMessage']['Title']),TriSysSDK['Audio']['PlayWoosh']()));};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['BroadcastedMessage'],fnCallbackBroadcastMessage);var fnCallbackContactPreviewRequestMessage=function(senderUser,contactPreviewMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;var lRecordId=contactPreviewMessage['RecordId'],sSearchCriteriaJson=contactPreviewMessage['SearchCriteriaJson'];if(typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined']){if(document['visibilityState']==='hidden'){self['close']();return;}ContactPreviewMode['ReceiveSignalRMessage'](lRecordId,sSearchCriteriaJson);}};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['ContactPreviewRequest'],fnCallbackContactPreviewRequestMessage);var fnCallbackContactAcknowledgementRequestMessage=function(senderUser,contactPreviewMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;var lRecordId=contactPreviewMessage['RecordId'];TriSysApex['EntityPreview']['Contact']['ReceivedAcknowledgementFromBrowserPopupWindow'](lRecordId);};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['ContactPreviewAcknowledgement'],fnCallbackContactAcknowledgementRequestMessage);var fnCallbackOAuthWorkflowCompletedMessage=function(senderUser,OAuthCompletedMessage){var sToken=OAuthCompletedMessage['Token'];if(typeof ctrlUserOptions!==TriSysApex['Constants']['Undefined'])ctrlUserOptions['CloudSync']['ReceivedOAuthWorkflowCompletedMessageFromBrowserPopupWindow'](sToken);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['OAuthWorkflowCompleted'],fnCallbackOAuthWorkflowCompletedMessage);var fnCallbackKeepAliveMessage=function(senderUser,keepAliveMessage){if(TriSysApex['SignalR']['Communication']['SocketIO'])TriSysApex['SignalR']['Communication']['SocketIO']['KeepAlive'](keepAliveMessage);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['KeepAliveMessage'],fnCallbackKeepAliveMessage);var fnCallbackDisplayTaskAlarms=function(senderUser,displayTaskAlarmsMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;TriSysApex['Alarms']['ReceivedNotification'](displayTaskAlarmsMessage['TaskAlarmCount'],displayTaskAlarmsMessage['PostItNoteCount'],displayTaskAlarmsMessage['ShowTaskAlarmPopup'],displayTaskAlarmsMessage['SecondsBeforeAlarmDateTime']);};if(!bWeAreTheRemoteBrowserPopup)TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['DisplayTaskAlarms'],fnCallbackDisplayTaskAlarms);var fnCallbackModifiedEntityRecord=function(senderUser,CModifiedEntityRecord){if(TriSysApex['Forms']['Lock']['Enabled'])return;TriSysApex['ConcurrencyHandler']['ModifiedEntityRecordEvent'](CModifiedEntityRecord);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['ModifiedEntityRecord'],fnCallbackModifiedEntityRecord);var fnCallbackBrowserExtensionMessageToSubscriber=function(senderUser,CSocketIOInstructions){if(TriSysApex['Forms']['Lock']['Enabled'])return;var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(!bWeAreTheRemoteBrowserPopup)return;ContactPreviewMode['BrowserExtensionMessageToSubscriber'](CSocketIOInstructions);};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['BrowserExtensionMessageToSubscriber'],fnCallbackBrowserExtensionMessageToSubscriber);var fnCallbackPostItNote=function(senderUser,CPostItNoteMessage){if(TriSysApex['Forms']['Lock']['Enabled'])return;var bWeAreTheRemoteBrowserPopup=typeof ContactPreviewMode!==TriSysApex['Constants']['Undefined'];if(bWeAreTheRemoteBrowserPopup)return;TriSysApex['Alarms']['PopupPostItNoteList']({'IgnoreCache':!![],'PostItNoteCount':0x1});};TriSysApex['SignalR']['Communication']['Callbacks']['Register'](TriSysApex['SignalR']['Communication']['MessageType']['PostItNote'],fnCallbackPostItNote);},'MessageType':{'All':'All','TaskUpdate':'TaskUpdate','OpenEntityRecord':'OpenEntityRecord','CVAutoRecognition':'CVAutoRecognition','OpenCV':'OpenCV','FileManagerUpdate':'Apex-File-Manager-Update','Action':'Action','EntityTask':'EntityTask','LogOff':'LogOff','RefreshTaskAlarms':'RefreshTaskAlarms','BroadcastedMessage':'BroadcastedMessage','ContactPreviewRequest':'ContactPreviewRequest','ContactPreviewAcknowledgement':'ContactPreviewAcknowledgement','OAuthWorkflowCompleted':'OAuthWorkflowCompleted','KeepAliveMessage':'KeepAliveMessage','DisplayTaskAlarms':'DisplayTaskAlarms','ModifiedEntityRecord':'ModifiedEntityRecord','BrowserExtensionMessageToSubscriber':'BrowserExtensionMessageToSubscriber','PostItNote':'PostItNote'},'Callbacks':{'_Callbacks':[],'Register':function(sMessageType,fnCallback){var callbackRegistration={'Type':sMessageType,'Function':fnCallback};TriSysApex['SignalR']['Communication']['Callbacks']['_Callbacks']['push'](callbackRegistration);},'Fire':function(userSender,messageObject){if(!userSender||!messageObject||TriSysApex['SignalR']['Communication']['Callbacks']['_Callbacks']['length']==0x0)return;for(var i=0x0;i<TriSysApex['SignalR']['Communication']['Callbacks']['_Callbacks']['length'];i++){var callbackRegistration=TriSysApex['SignalR']['Communication']['Callbacks']['_Callbacks'][i];const bMessageTypeAll=callbackRegistration['Type']==TriSysApex['SignalR']['Communication']['MessageType']['All'];var bProcessMessage=bMessageTypeAll;!messageObject['Type']&&messageObject['Message']&&(messageObject=JSON['parse'](messageObject['Message']));if(callbackRegistration['Type']==messageObject['Type']||bMessageTypeAll){if(!bMessageTypeAll){const bReceivedSameNotificationAlready=TriSysApex['SignalR']['Communication']['HaveWeReceivedSameNotificationAlready'](userSender,messageObject);if(!bReceivedSameNotificationAlready)bProcessMessage=!![];}if(bProcessMessage)try{callbackRegistration['Function'](userSender,messageObject);}catch(e){}}}}},'_LoggedInUserHandle':'','_HubURL':'','FullSenderAndRecipientAddress':function(sLoginName){var sAddress=TriSysApex['SignalR']['Communication']['_LoggedInUserHandle'];if(sAddress&&sLoginName){if(sAddress['toLowerCase']()['indexOf'](sLoginName['toLowerCase']())<0x0){var parts=sAddress['split']('/'),sPrefix='';for(var i=0x0;i<parts['length']-0x1;i++){sPrefix+=parts[i]+'/';}sAddress=sPrefix+sLoginName;}}return sAddress;},'FullLoggedInSenderAndRecipientAddress':function(){var sAddress=TriSysApex['SignalR']['Communication']['FullSenderAndRecipientAddress']();return sAddress;},'LoginNameFromSenderAddress':function(sFullAddress){if(sFullAddress){var parts=sFullAddress['split']('/'),sLoginName=parts[parts['length']-0x1];return sLoginName;}},'DatabaseNameFromSenderAddress':function(sFullAddress){if(sFullAddress){var parts=sFullAddress['split']('/'),sDatabaseName=parts[parts['length']-0x2];return sDatabaseName;}},'SQLServerNameFromSenderAddress':function(sFullAddress){if(sFullAddress){var parts=sFullAddress['split']('/'),sDatabaseName=parts[parts['length']-0x3];return sDatabaseName;}},'UserSenderFromSameSQLServerAndDatabase':function(sSender){var sSenderLoginName=TriSysApex['SignalR']['Communication']['LoginNameFromSenderAddress'](sSender),sSenderSQLServerName=TriSysApex['SignalR']['Communication']['SQLServerNameFromSenderAddress'](sSender),sSenderDatabaseName=TriSysApex['SignalR']['Communication']['DatabaseNameFromSenderAddress'](sSender),sMySignalRHandle=TriSysApex['SignalR']['Communication']['FullSenderAndRecipientAddress'](),sMySQLServerName=TriSysApex['SignalR']['Communication']['SQLServerNameFromSenderAddress'](sMySignalRHandle),sMyDatabaseName=TriSysApex['SignalR']['Communication']['DatabaseNameFromSenderAddress'](sMySignalRHandle),bSameSQLServerAndDatabase=sSenderSQLServerName==sMySQLServerName&&sSenderDatabaseName==sMyDatabaseName;if(bSameSQLServerAndDatabase){var userSender=TriSysApex['Cache']['UsersManager']['UserFromLoginName'](sSenderLoginName);return userSender;}},'isSenderFromSameSQLServerButTriSysCRMDatabase':function(sSender){var sSenderSQLServerName=TriSysApex['SignalR']['Communication']['SQLServerNameFromSenderAddress'](sSender),sSenderDatabaseName=TriSysApex['SignalR']['Communication']['DatabaseNameFromSenderAddress'](sSender),sMySignalRHandle=TriSysApex['SignalR']['Communication']['FullSenderAndRecipientAddress'](),sMySQLServerName=TriSysApex['SignalR']['Communication']['SQLServerNameFromSenderAddress'](sMySignalRHandle),bSameSQLServer=sSenderSQLServerName==sMySQLServerName;if(bSameSQLServer){var bTriSysCRM=sSenderDatabaseName=='TriSysCRM';return bTriSysCRM;}},'Send':function(sRecipientLoginName,sJSONDataPacket){var bInDev=TriSysApex['Environment']['isDeployedInTestMode']();if(bInDev&&!TriSysApex['SignalR']['DebugOn'])return;var sRecipient=TriSysApex['SignalR']['Communication']['FullSenderAndRecipientAddress'](sRecipientLoginName);if(!sRecipient||!sJSONDataPacket)return;var sSender=TriSysApex['SignalR']['Communication']['FullLoggedInSenderAndRecipientAddress']();if(TriSysApex['SignalR']['Communication']['SocketIO'])TriSysApex['SignalR']['Communication']['SocketIO']['SendMessage'](sSender,sRecipient,sJSONDataPacket);},'Receive':function(sSender,sJSONDataPacket){if(!sSender){TriSysApex['UI']['ShowMessage']('TriSysApex.SignalR.Communication.Receive:\x20Null\x20sender');return;}try{var messageObject=sJSONDataPacket?JSON['parse'](sJSONDataPacket):null,userSender=TriSysApex['SignalR']['Communication']['UserSenderFromSameSQLServerAndDatabase'](sSender);if(!userSender){var bSentByTriSysWebAPI=TriSysApex['SignalR']['Communication']['isSenderFromSameSQLServerButTriSysCRMDatabase'](sSender);if(bSentByTriSysWebAPI){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();userSender=TriSysApex['Cache']['UsersManager']['UserFromId'](userCredentials['LoggedInUser']['UserId']);}}userSender&&TriSysApex['SignalR']['Communication']['Callbacks']['Fire'](userSender,messageObject);}catch(e){TriSysApex['Logging']['LogMessage']('TriSysApex.SignalR.Receive:\x20caught\x20error:\x20'+TriSysApex['Logging']['CatchVariableToText'](e));}},'HaveWeReceivedSameNotificationAlready':function(userSender,messageObject){var bHaveWeReceivedSameNotificationAlready=![],lst=TriSysApex['SignalR']['Communication']['_NotificationHistory'];lst['forEach'](function(historyItem){if(historyItem['SenderJSON']==JSON['stringify'](userSender)&&historyItem['MessageJSON']==JSON['stringify'](messageObject)){const dtNow=moment(),iSecondsAgo=dtNow['diff'](historyItem['ReceivedTime'],'seconds');if(iSecondsAgo==0x0)bHaveWeReceivedSameNotificationAlready=!![];}});if(!bHaveWeReceivedSameNotificationAlready){var newHistoryItem={'ReceivedTime':moment(),'SenderJSON':JSON['stringify'](userSender),'MessageJSON':JSON['stringify'](messageObject)};lst['push'](newHistoryItem);}else for(var i=lst['length']-0x1;i>=0x0;i--){const historyItem=lst[i],dtNow=moment(),iSecondsAgo=dtNow['diff'](historyItem['ReceivedTime'],'seconds');if(iSecondsAgo>=0x1)lst['splice'](i,0x1);}return bHaveWeReceivedSameNotificationAlready;},'_NotificationHistory':[]},'ReadUserConnectionDetails':function(fnCallback){var payloadObject={};payloadObject['URL']='Chat/SignalRUserConnection',payloadObject['InboundDataFunction']=function(CSignalRUserConnectionResponse){CSignalRUserConnectionResponse&&(CSignalRUserConnectionResponse['Success']&&CSignalRUserConnectionResponse['UserConnection']&&(TriSysApex['SignalR']['Communication']['ThisApp']=CSignalRUserConnectionResponse['UserConnection']['Prefix'],TriSysApex['SignalR']['Communication']['_LoggedInUserHandle']=CSignalRUserConnectionResponse['UserConnection']['Handle'],TriSysApex['SignalR']['Communication']['_HubURL']=CSignalRUserConnectionResponse['UserConnection']['HubURL'],fnCallback()));},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.SignalR.ReadUserConnectionDetails:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'Application':{'_Version':null,'Version':function(){var sVersion=TriSysApex['Application']['_Version'];if(!sVersion)while(!![]){try{sVersion=TriSysApex['Application']['FileVersion']();if(sVersion){TriSysApex['Application']['_Version']=sVersion;break;}}catch(e){TriSysApex['Logging']['LogMessage']('TriSysApex.Application.Version():\x20'+TriSysApex['Logging']['CatchVariableToText'](e));}}return sVersion;},'FileVersion':function(){var sVersion='Unknown',jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('version.json');if(jsonData)sVersion=jsonData['Version'];return sVersion;}},'Trial':{'PostLoginStatus':function(){(TriSysApex['Constants']['TrialMode']||TriSysApex['Constants']['ShowDummyDashboardData'])&&TriSysApex['Pages']['Controller']['IsClientADeveloperIPAddress'](function(){TriSysApex['Trial']['SubscribeButtonVisible'](!![]);});},'SubscribeButtonVisible':function(bVisible){return;},'Subscribe':function(){var sTitle=TriSysApex['Copyright']['ShortProductName']+'\x20Subscription',parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='gi-gbp',parametersObject['Maximize']=!![],parametersObject['FullScreen']=!![],parametersObject['ContentURL']=TriSysApex['CustomFormsAndComponents']['UserControlPath']('ctrlSubscribe.html'),parametersObject['ButtonLeftText']='Subscribe',parametersObject['ButtonLeftFunction']=function(){return ctrlSubscribe['SubscribeNow']();},parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonCentreText']='Terms\x20&amp;\x20Conditions',parametersObject['ButtonCentreFunction']=function(){ctrlSubscribe['ShowTermsAndConditions']();},parametersObject['ButtonCentreVisible']=!![],parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Cancel',TriSysApex['UI']['PopupMessage'](parametersObject);}},'EntitySearch':{'LoadControl':function(sDivId,sEntityName){TriSysApex['FormsManager']['loadControlReplacingDiv'](sDivId,'ctrlEntitySearch.html',function(response,status,xhr){ctrlEntitySearch['Load'](sEntityName);});},'LoadContactSearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Contact');},'LoadCompanySearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Company');},'LoadRequirementSearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Requirement');},'LoadPlacementSearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Placement');},'LoadTimesheetSearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Timesheet');},'LoadTaskSearch':function(){TriSysApex['EntitySearch']['LoadEntitySearch']('Task');},'LoadEntitySearch':function(sEntity){if(typeof ctrlEntitySearch!=TriSysApex['Constants']['Undefined'])ctrlEntitySearch['Load'](sEntity);}},'CustomFormsAndComponents':{'_LoadingCustomModule':![],'AfterLogin':function(CDataConnectionKey){var sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](TriSysApex['Constants']['CustomerModuleFile']);if(sFileURL)try{$['getScript'](sFileURL+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),function(data,textStatus,jqxhr){TriSysApex['CustomFormsAndComponents']['CustomPostLoginPrePageRedirection'](CDataConnectionKey);if(TriSysApex['Constants']['WhiteLabelIntelligentRouting'])TriSysApex['Router']['ApplyIntelligentRouting'](TriSysApex['Constants']['WhiteLabelIntelligentRouting']);}),TriSysApex['CustomFormsAndComponents']['_LoadingCustomModule']=!![];return;}catch(e){}},'CustomPostLoginPrePageRedirection':function(CDataConnectionKey){if(typeof ApexCustomerModule!=TriSysApex['Constants']['Undefined']&&typeof ApexCustomerModule['PostLoginRedirection']!=TriSysApex['Constants']['Undefined'])try{var bCancel=ApexCustomerModule['PostLoginRedirection'](CDataConnectionKey);if(bCancel)return!![];}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}return TriSysApex['Forms']['Login']['PostLoginRedirection'](CDataConnectionKey),![];},'CustomCodeFolderURL':function(){var sCustomerCompanyHyphenated=null;if(TriSysApex['Constants']['WhiteLabelCustomFolder'])sCustomerCompanyHyphenated=TriSysApex['Constants']['WhiteLabelCustomFolder'];else{var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contact=userCredentials['LoggedInUser']['CRMContact'];if(contact){if(contact['CompanyName'])sCustomerCompanyHyphenated=contact['CompanyName']['toLowerCase']()['replace'](/ /g,'-');}var bCustomerCredentialsAreValid=TriSysApex['LoginCredentials']['areCustomerCredentialsValid']();if(bCustomerCredentialsAreValid)sCustomerCompanyHyphenated=TriSysApex['Constants']['WhiteLabelCustomFolder'];}else!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID']&&(sCustomerCompanyHyphenated=TriSysWebJobs['Agency']['CustomerID']);}if(sCustomerCompanyHyphenated){var sURL=TriSysAPI['Constants']['SecureURL']+TriSysApex['Constants']['ApexRootFolder']+'custom/'+sCustomerCompanyHyphenated+'/';return sURL;}},'getCustomFormURL':function(sFileName){if(!sFileName)return;var customForms=TriSysApex['CustomFormsAndComponents']['getCustomFormList']();if(customForms)for(var i=0x0;i<customForms['length'];i++){var customForm=customForms[i];if(sFileName['indexOf']('/')>=0x0){var parts=sFileName['split']('/');sFileName=parts[parts['length']-0x1];}if(customForm['FileName']){var bMatchedFile=customForm['FileName']['toLowerCase']()==sFileName['toLowerCase']();if(bMatchedFile){var sRootURL=TriSysAPI['Constants']['SecureURL']+TriSysApex['Constants']['ApexRootFolder'];if(TriSysApex['Constants']['WhiteLabelCustomApp'])sRootURL='';var sFileURL=sRootURL+customForm['FilePath'];return sFileURL;}}}},'getCustomFormList':function(){var customForms=null,bWebJobsMode=!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID'];if(!TriSysApex['Constants']['WhiteLabelBlockCustomerSpecificFiles']){if(!bWebJobsMode){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){if(userCredentials['LoggedInUser']['CRMContact'])customForms=userCredentials['LoggedInUser']['CRMContact']['CustomForms'];}}else customForms=TriSysWebJobs['CustomForms'];}return!customForms&&TriSysApex['Constants']['WhiteLabelled']&&(customForms=TriSysApex['Constants']['WhiteLabelPreLoginCustomForms']),customForms;},'debugCustomFormList':function(fnDisplayFunction){var customForms=TriSysApex['CustomFormsAndComponents']['getCustomFormList']();if(customForms)for(var i=0x0;i<customForms['length'];i++){var customForm=customForms[i],sRootURL=TriSysAPI['Constants']['SecureURL']+TriSysApex['Constants']['ApexRootFolder'];if(TriSysApex['Constants']['WhiteLabelCustomApp'])sRootURL='';var sFileURL=sRootURL+customForm['FilePath'];fnDisplayFunction((i>0x0?'<br\x20/>':'')+'['+TriSysSDK['Numbers']['Pad'](i+0x1,0x2)+']\x20&nbsp;\x20'+sFileURL);}},'isCustomForm':function(sFileName){var sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sFileName),bFound=sFileURL!=null;return bFound;},'AfterWebJobsAgencyDatabaseConnection':function(CCustomerWebJobsKeyResponse,fnOpenForm){var sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](TriSysApex['Constants']['WebJobsModuleFile']);if(sFileURL)try{$['getScript'](sFileURL+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),function(data,textStatus,jqxhr){TriSysApex['CustomFormsAndComponents']['CustomWebJobsPostConnectionPrePageRedirection'](CCustomerWebJobsKeyResponse,fnOpenForm);});return;}catch(e){}fnOpenForm();},'CustomWebJobsPostConnectionPrePageRedirection':function(CCustomerWebJobsKeyResponse,fnOpenForm){try{var bCancel=WebJobsModule['PostConnectionRedirection'](CCustomerWebJobsKeyResponse);if(!bCancel)fnOpenForm();}catch(e){TriSysApex['Logging']['LogMessage'](TriSysApex['Logging']['CatchVariableToText'](e));}},'UserControlPath':function(sControlFile,bAction){var sPath=TriSysApex['Constants']['UserControlFolder']+(bAction?'actions/':'')+sControlFile,sFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sControlFile);if(sFileURL)sPath=sFileURL;return sPath;}},'GoogleAnalytics':{'InjectScript':function(){var sTrackingID=TriSysApex['Cache']['SystemSettingManager']['GetValue']('Google\x20Analytics\x20Tracking\x20ID',null);if(!sTrackingID)return;var sDivId='google-analytics-placeholder';TriSysApex['FormsManager']['loadControlReplacingDiv'](sDivId,'ctrlGoogleAnalytics.html',function(response,status,xhr){try{ga('create',sTrackingID,'auto'),ga('send','pageview');}catch(e){var sError=TriSysApex['Logging']['CatchVariableToText'](e);TriSysApex['UI']['errorAlert'](sError,'Google\x20Analytics\x20Error:\x20'+sTrackingID);}});}},'WhiteLabelling':{'Configure':function(sSubDomain,intelligentRouting){var partner=TriSysApex['WhiteLabelling']['Partner'](sSubDomain);if(!partner)return![];TriSysApex['Constants']['WhiteLabelled']=!![];if(partner['LongName'])TriSysApex['Copyright']['AllRightsReserved']=partner['LongName'];if(partner['ShortName']){TriSysApex['Copyright']['ShortProductName']=partner['ShortName'],$('#brand-name')['html'](partner['ShortName']);if(partner['ShortNameFontSize'])$('#brand-name')['css']('font-size',partner['ShortNameFontSize']);}partner['ProductIcon']&&(TriSysApex['WhiteLabelling']['Overrides']['ProductIcon']=partner['ProductIcon'],$('#product-icon')['attr']('src',partner['ProductIcon']),$('#favicon')['attr']('href',partner['ProductIcon']));if(partner['ProductIconRadius'])$('#product-icon')['css']('border-radius',partner['ProductIconRadius']);partner['ProductName']&&(TriSysApex['WhiteLabelling']['Overrides']['ProductName']=partner['ProductName'],$('#product-name')['html'](partner['ProductName']),TriSysWeb['Constants']['ApplicationName']=partner['ShortName']+'\x20'+partner['ProductName'],TriSysApex['LoginCredentials']['ValidationMessageTitle']=TriSysWeb['Constants']['ApplicationName']+'\x20Login\x20Credentials');if(partner['AboutImage'])TriSysApex['Constants']['AboutImage']=partner['AboutImage'];if(partner['ThemePath']&&partner['ThemeName'])TriSysProUI['ForceThemeChange'](partner['ThemePath'],partner['ThemeName']);if(partner['PreventThemeChange'])TriSysApex['Constants']['WhiteLabelPreventThemeChange']=!![];if(partner['HomePage'])TriSysApex['Copyright']['HomePage']=partner['HomePage'];if(partner['TermsAndConditionsFile'])TriSysApex['Constants']['TermsAndConditionsFile']=partner['TermsAndConditionsFile'];if(partner['URL'])TriSysApex['Constants']['URL']=partner['URL'];if(partner['HideElements']){var fnHideElements=function(){for(var i=0x0;i<partner['HideElements']['length'];i++){var elem=partner['HideElements'][i];$('#'+elem)['hide']();}};setTimeout(fnHideElements,0x7d0);}if(partner['EMailSupportMessageHTML'])TriSysApex['WhiteLabelling']['Overrides']['EMailSupportMessageHTML']=partner['EMailSupportMessageHTML']['join']('');if(partner['DefaultMode']=='Custom')TriSysApex['Constants']['WhiteLabelCustomApp']=!![];partner['CustomForms']&&(TriSysApex['Constants']['WhiteLabelPreLoginCustomForms']=[],partner['CustomForms']['forEach'](function(sFormName){var customForm={'FileName':sFormName,'FilePath':'custom/'+partner['CustomFolder']+'/'+sFormName};TriSysApex['Constants']['WhiteLabelPreLoginCustomForms']['push'](customForm);}));TriSysApex['Forms']['Configuration']['Initialise']({'WhiteLabellingConfiguration':!![]});if(partner['CustomFolder']&&TriSysApex['Constants']['TriSysHostedCRM'])TriSysApex['WhiteLabelling']['InvokeCustomMainForm'](partner['CustomFolder'],intelligentRouting);else{if(intelligentRouting)TriSysApex['Router']['ApplyIntelligentRouting'](intelligentRouting);}if(partner['StartUpForm'])TriSysApex['Constants']['WhiteLabelStartupForm']=partner['StartUpForm'];if(!TriSysAPI['Operators']['isEmpty'](partner['AccountType']))TriSysApex['Constants']['WhiteLabelAccountType']=partner['AccountType'];if(partner['BlockCustomerSpecificFiles'])TriSysApex['Constants']['WhiteLabelBlockCustomerSpecificFiles']=partner['BlockCustomerSpecificFiles'];return TriSysApex['WhiteLabelling']['ApplyPartnerCSS'](partner),!![];},'ApplyPartnerCSS':function(partner){if(!partner){if(TriSysApex['Constants']['WhiteLabelIntelligentRouting']&&TriSysApex['Constants']['WhiteLabelIntelligentRouting']['Application'])partner=TriSysApex['WhiteLabelling']['Partner'](TriSysApex['Constants']['WhiteLabelIntelligentRouting']['Application']);if(!partner&&TriSysApex['Constants']['WhiteLabelCustomFolder'])partner=TriSysApex['WhiteLabelling']['Partner'](TriSysApex['Constants']['WhiteLabelCustomFolder']);if(!partner&&TriSysWebJobs['Agency']['CustomerID'])partner=TriSysApex['WhiteLabelling']['Partner'](TriSysWebJobs['Agency']['CustomerID']);}if(partner&&partner['CSS']){var styles=partner['CSS'];for(var i=0x0;i<styles['length'];i++){var style=styles[i];style['ID']&&TriSysWebJobs['Frame']['ApplyStyle'](style);}}},'Partner':function(sID,sFilePrefix){if(!sID)return;var partners=TriSysApex['WhiteLabelling']['WhiteLabelPartners'](sFilePrefix);if(partners)for(var i=0x0;i<partners['length'];i++){var partner=partners[i];if(partner['ID']['toLowerCase']()==sID['toLowerCase']())return partner;if(partner['AlternativeIDList'])for(var a=0x0;a<partner['AlternativeIDList']['length'];a++){var sAlternativeID=partner['AlternativeIDList'][a];if(sAlternativeID['toLowerCase']()==sID['toLowerCase']())return partner;}}return null;},'WhiteLabelPartners':function(sFilePrefix){var sFileName='white-label.json';if(sFilePrefix)sFileName=sFilePrefix+sFileName;var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData'](sFileName);if(jsonData)return jsonData['Partners'];},'Overrides':{'EMailSupportMessageHTML':null,'ProductIcon':null,'ProductName':null},'InvokeCustomMainForm':function(sCustomFolder,intelligentRouting){var sFolder=TriSysAPI['Constants']['SecureURL']+TriSysApex['Constants']['ApexRootFolder'];if(TriSysApex['Constants']['WhiteLabelCustomApp'])sFolder='configuration/';sFolder+='custom/'+sCustomFolder+'/';var sStartupCode=sFolder+'main.js';try{$['getScript'](sStartupCode+TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache'](),function(data,textStatus,jqxhr){TriSysApex['Constants']['WhiteLabelCustomFolder']=sCustomFolder;var bCancel=![];try{bCancel=ApexCustomPostLoadModule['PreLogin'](intelligentRouting);}catch(e){}if(intelligentRouting){if(intelligentRouting['Cancel']){}else TriSysApex['Constants']['WhiteLabelIntelligentRouting']=intelligentRouting,TriSysApex['Router']['ApplyIntelligentRouting'](intelligentRouting);}if(bCancel)return!![];});}catch(e){}},'LoadJavascriptFile':function(sFileName,sCustomFolderOrId,fnWhenLoadedCallback,jsonParameterForCallback){var bDoWeThough=!![];if(bDoWeThough&&TriSysApex['WhiteLabelling']['isJavascriptLoaded'](sFileName)){var removejscssfile=function(filename,filetype){var scripts=document['getElementsByTagName']('script');for(var i=scripts['length']-0x1;i>=0x0;i--){var script=scripts[i],src=script['getAttribute']('src');if(src&&src['indexOf'](filename)!==-0x1){var newScript=document['createElement']('script');newScript['type']='text/javascript',newScript['text']='',script['parentNode']['replaceChild'](newScript,script),newScript['remove']();}}};removejscssfile(sFileName,'js');}else{var fnGetAbsoluteUrlWithoutTimestamp=function(url){const link=document['createElement']('a');return link['href']=url,link['protocol']+'//'+link['host']+link['pathname'];};const absoluteSrc=fnGetAbsoluteUrlWithoutTimestamp(sFileName),scripts=document['querySelectorAll']('script');scripts['forEach'](script=>{const scriptSrc=fnGetAbsoluteUrlWithoutTimestamp(script['src']);scriptSrc===absoluteSrc&&script['remove']();});}var sCustomFileURL=TriSysApex['CustomFormsAndComponents']['getCustomFormURL'](sFileName);!sCustomFileURL&&(sCustomFileURL=sFileName);sCustomFileURL+=TriSysApex['FormsManager']['pageURLTimestampArgumentsToForceNoCache']();var fnCallbackAfterScriptLoaded=function(){if(!fnWhenLoadedCallback)return;if(typeof fnWhenLoadedCallback==='string')fnWhenLoadedCallback=TriSysApex['DynamicClasses']['GetObject'](fnWhenLoadedCallback);if(fnWhenLoadedCallback)try{fnWhenLoadedCallback(jsonParameterForCallback);}catch(e){var sError=TriSysApex['Logging']['CatchVariableToText'](e);TriSysApex['UI']['errorAlert'](sError,'Error');}};try{const script=document['createElement']('script');script['src']=sCustomFileURL,script['async']=!![],script['onload']=fnCallbackAfterScriptLoaded,script['onerror']=()=>TriSysApex['UI']['errorAlert']('Failed\x20to\x20load\x20script:\x20'+sCustomFileURL,'Error'),document['head']['appendChild'](script);}catch(e){var sError=TriSysApex['Logging']['CatchVariableToText'](e);TriSysApex['UI']['errorAlert'](sError,'Error');}},'isJavascriptLoaded':function(sFileName){var scripts=$('script');for(var i=scripts['length']-0x1;i>=0x0;i--){var scriptElement=scripts[i],sScriptSource=scriptElement['src'];if(sScriptSource['toLowerCase']()['indexOf'](sFileName['toLowerCase']())>=0x0)return!![];}return![];},'AfterOpeningForm':function(sFormName){var bApexCustomPostLoadModuleLoaded=typeof ApexCustomPostLoadModule!==TriSysApex['Constants']['Undefined'],bApexCustomerModuleLoaded=typeof ApexCustomerModule!==TriSysApex['Constants']['Undefined'];if(TriSysApex['Constants']['WhiteLabelled']&&bApexCustomPostLoadModuleLoaded)try{ApexCustomPostLoadModule['FormLoaded'](sFormName);}catch(e){}else{if(bApexCustomerModuleLoaded)try{ApexCustomerModule['FormLoaded'](sFormName);}catch(e){}}},'RoutingURLOverride':function(sURL,commandLineOverrides){var bFoundPartner=![],partners=TriSysApex['WhiteLabelling']['WhiteLabelPartners']('');if(partners)for(var i=0x0;i<partners['length'];i++){var partner=partners[i];if(partner['IntelligentRoutingURLActive']){bFoundPartner=!![],sURL=partner['IntelligentRoutingURL'];if(partner['WebAPIURL'])TriSysAPI['Constants']['SecureURL']=partner['WebAPIURL'];partner['APIKey']&&(TriSysApex['Constants']['DeveloperSiteKey']=partner['APIKey'],TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']));break;}}if(!bFoundPartner){var sWebAPIPrefix='#webapi~';if(window['location']['hash']&&window['location']['hash']['indexOf'](sWebAPIPrefix)>=0x0){var parts=window['location']['hash']['split'](sWebAPIPrefix);if(parts['length']==0x2){var sWebAPI=parts[0x1];if(sWebAPI){if(sWebAPI['indexOf'](',')>0x0){parts=sWebAPI['split'](','),sWebAPI=parts[0x0];var sSiteKeyOrCustomerID=parts[0x1];if(sSiteKeyOrCustomerID['length']==0x24)TriSysApex['Constants']['DeveloperSiteKey']=sSiteKeyOrCustomerID,TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']);else{if(commandLineOverrides)commandLineOverrides['SubDomain']=sSiteKeyOrCustomerID;}}}TriSysAPI['Constants']['SecureURL']=sWebAPI;if(partners)for(var i=0x0;i<partners['length'];i++){var partner=partners[i];if(partner['APIKey']==TriSysApex['Constants']['DeveloperSiteKey']){if(partner['IntelligentRoutingURL'])sURL=partner['IntelligentRoutingURL'];break;}}}}}return sURL;},'IntelligentRoutingURLActiveCustomerID':function(){var bFoundPartner=![],partners=TriSysApex['WhiteLabelling']['WhiteLabelPartners']('');if(partners)for(var i=0x0;i<partners['length'];i++){var partner=partners[i];if(partner['IntelligentRoutingURLActive'])return partner['ID'];}}},'Router':{'Redirect404':function(){var sHash404='#404=',sURL=window['location']['href'],i404Index=sURL['indexOf'](sHash404);TriSysApex['Constants']['OriginalURL']=sURL;if(i404Index<0x0){var urlParts=sURL['split']('/'),iSlashCount=urlParts['length'];if(iSlashCount>=0x4){sURL=sURL['replace']('/?','/'+sHash404+'/'),i404Index=sURL['indexOf'](sHash404);var sWebJobs='WebJobs=',iWebJobs=sURL['toLowerCase']()['indexOf'](sWebJobs['toLowerCase']());if(iWebJobs>0x0){var sCustomerId=sURL['substring'](iWebJobs+sWebJobs['length']);sURL=urlParts[0x0]+'//'+urlParts[0x2]+'/'+sHash404+'/CandidateVacancySearch/0/'+sCustomerId,i404Index=sURL['indexOf'](sHash404);}}}if(i404Index<0x0)return null;var sPre404=sURL['substring'](0x0,i404Index-0x1),s404=sURL['substring'](i404Index+sHash404['length']),redirectURL={'WebSite':sPre404,'Parameters':s404};return redirectURL;},'IntelligentRouting':function(redirectURL){var sApplication=null,sForm=null,sParameters=null,sCustomerID=null;if(TriSysApex['WhiteLabelling']['RoutingURLOverride'](null))redirectURL=null;if(!redirectURL){var sURL=window['location']['href'],commandLineOverrides={};sURL=TriSysApex['WhiteLabelling']['RoutingURLOverride'](sURL,commandLineOverrides);var sSitePartsDots=sURL['split']('.');if(sSitePartsDots['length']>0x1){var sSubDomain=sSitePartsDots[0x0]['replace']('http://','')['replace']('https://','');if(sURL['indexOf']('trisys.co.uk')<0x0){sSubDomain=TriSysApex['WhiteLabelling']['IntelligentRoutingURLActiveCustomerID']();var questionMarkParts=window['location']['href']['split']('?');if(questionMarkParts['length']==0x2){var sArguments='?'+questionMarkParts[0x1];sSitePartsDots[0x3]='uk/'+sArguments;}}if(commandLineOverrides['SubDomain']&&TriSysApex['Environment']['isDeployedInTestMode']())sSubDomain=commandLineOverrides['SubDomain'];var partner=TriSysApex['WhiteLabelling']['Partner'](sSubDomain);if(partner){var intelligentRouting=null;if(sSitePartsDots['length']==0x4){var sURLPart=sSitePartsDots[0x3],parameters=sURLPart['split']('/');parameters&&parameters['length']>=0x3?(sForm=parameters[0x1]['replace']('?',''),sParameters=parameters[0x2]):sForm=partner['StartUpForm'];sURL=window['location']['href'];var bRecruiterCommandLine=sURL['toLowerCase']()['indexOf']('?recruiter')>0x0||sURL['toLowerCase']()['indexOf']('#supportlogin~')>0x0;if(bRecruiterCommandLine)sForm='Login';intelligentRouting={'Application':sSubDomain,'Form':sForm,'Parameters':sParameters};TriSysWebJobs['Routing']['isWebJobsForm'](intelligentRouting['Form'])&&!bRecruiterCommandLine&&(TriSysWebJobs['Routing']['ParseURLParameters'](intelligentRouting['Parameters'],intelligentRouting['Form']),TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysWebJobs['Agency']['CustomerID']=sSubDomain);var bHandlingRouting=TriSysApex['WhiteLabelling']['Configure'](intelligentRouting['Application'],intelligentRouting);return bHandlingRouting;}partner['DefaultMode']&&(sForm=partner['DefaultMode'],sApplication=sSubDomain);}}if(!sApplication)return![];}else{var sSitePartsDots=redirectURL['WebSite']['split']('.');if(sSitePartsDots['length']>0x1){var sSubDomain=sSitePartsDots[0x0]['replace']('http://','')['replace']('https://',''),sDomain=sSitePartsDots[0x1];if(sSubDomain!='www'&&sSubDomain!='apex'&&sDomain=='trisys')sApplication=sSubDomain;}var parameters=redirectURL['Parameters']['split']('/');if(parameters){if(sSubDomain=='apex'||sSubDomain=='www'){sApplication=sSubDomain;if(parameters['length']>0x1)sForm=parameters[0x1];if(parameters['length']>0x2)sParameters=parameters[0x2];if(parameters['length']>0x3)sCustomerID=parameters[0x3];}else{var iApplicationIndex=!sApplication?0x1:0x0;if(!sApplication)sApplication=parameters[iApplicationIndex];var iFormIndex=iApplicationIndex+0x1;if(parameters['length']>=iFormIndex)sForm=parameters[iFormIndex];var iParametersIndex=iFormIndex+0x1;if(parameters['length']>=iParametersIndex){sParameters='';for(var i=iParametersIndex;i<parameters['length'];i++){if(sParameters)sParameters+='/';else sParameters='';sParameters+=parameters[i];}}}}}if(sApplication=='www'&&sSubDomain=='www'){sApplication=sForm,sForm=sParameters;if(parameters['length']>=0x4)sParameters=parameters[0x3];}if(redirectURL){if(redirectURL['Parameters']){var sDebugEquals='/debug=',sDebugParameters=redirectURL['Parameters'];if(sDebugParameters['indexOf'](sDebugEquals)==0x0){var oemParts=sDebugParameters['split'](sDebugEquals),sJSONDebug=oemParts[0x1];return TriSysApex['Router']['DebugMode'](sJSONDebug),!![];}}}var bWhiteLabelledApp=![];if(sApplication){var partner=TriSysApex['WhiteLabelling']['Partner'](sApplication);if(partner)switch(partner['DefaultMode']){case'Candidate':case'Client':bWhiteLabelledApp=!![];if(!sForm)sForm=partner['DefaultMode'];break;case'Recruiter':bWhiteLabelledApp=!![];break;}}if(bWhiteLabelledApp){if(!sForm)sForm='Recruiter';switch(sForm['toLowerCase']()){case'candidate':TriSysWebJobs['Agency']['CustomerID']=sApplication,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=!![],sForm=TriSysWebJobs['Constants']['CandidateVacancySearchForm'];break;case'client':TriSysWebJobs['Agency']['CustomerID']=sApplication,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=![],sForm=TriSysWebJobs['Constants']['ClientLoginForm'];break;case'agency':TriSysWebJobs['Agency']['CustomerID']=sApplication,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=![],TriSysWebJobs['Constants']['AgencyUmbrellaMode']=!![],sForm=TriSysWebJobs['Constants']['AgencyLoginForm'];break;case'recruiter':TriSysAPI['Session']['SetDataServicesKey'](null),sForm=TriSysApex['Constants']['LoginForm'];break;}}var intelligentRouting={'Application':sApplication,'Form':sForm,'Parameters':sParameters};if(TriSysWebJobs['Routing']['isWebJobsForm'](sForm)){TriSysWebJobs['Agency']['CustomerID']=sCustomerID?sCustomerID:sApplication,TriSysApex['Constants']['TriSysHostedCRM']=![];if(sApplication=='apex'||sApplication=='www')intelligentRouting['Application']=TriSysWebJobs['Agency']['CustomerID'];}else TriSysWebJobs['Routing']['isWebJobsForm'](sApplication)&&(TriSysWebJobs['Agency']['CustomerID']=sCustomerID,TriSysApex['Constants']['TriSysHostedCRM']=![],sForm=sApplication,intelligentRouting['Application']=TriSysWebJobs['Agency']['CustomerID'],intelligentRouting['Form']=sForm);var bHandlingRouting=TriSysApex['WhiteLabelling']['Configure'](intelligentRouting['Application'],intelligentRouting);TriSysApex['Forms']['Configuration']['Initialise']({'BeforeApplyingIntelligentRouting':!![]});!TriSysApex['Constants']['WhiteLabelled']&&!TriSysApex['Constants']['TriSysHostedCRM']&&TriSysWebJobs['Agency']['CustomerID']&&(TriSysApex['Router']['ApplyIntelligentRouting'](intelligentRouting),bHandlingRouting=!![]);if(!bHandlingRouting&&sForm){var iAmpersand=sForm['indexOf']('&');iAmpersand>0x0&&(sForm=sForm['substring'](0x0,iAmpersand),intelligentRouting['Form']=sForm);}else{if(TriSysApex['Constants']['WhiteLabelCustomApp'])return!![];}var pageConfig=TriSysApex['FormsManager']['getPageConfig'](sForm);if(!pageConfig)return![];else{if(!bHandlingRouting)TriSysApex['Router']['ApplyIntelligentRouting'](intelligentRouting);}return!![];},'DebugMode':function(sJSONDebug){sJSONDebug=sJSONDebug['replace'](/%22/g,'\x22'),sJSONDebug=sJSONDebug['replace'](/%20/g,'\x20');var debugObject=JSON['parse'](sJSONDebug),sCustomerID=debugObject['CustomerID'],bWhiteLabelledApp=![],partner=TriSysApex['WhiteLabelling']['Partner'](sCustomerID);if(partner)bWhiteLabelledApp=!![];var sParameters=null,sForm=null,sMode=debugObject['Mode'];if(!sMode)sMode='recruiter';switch(sMode['toLowerCase']()){case'candidate':TriSysWebJobs['Agency']['CustomerID']=sCustomerID,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=!![],sForm=TriSysWebJobs['Constants']['CandidateVacancySearchForm'];break;case'client':TriSysWebJobs['Agency']['CustomerID']=sCustomerID,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=![],sForm=TriSysWebJobs['Constants']['ClientLoginForm'];break;case'agency':TriSysWebJobs['Agency']['CustomerID']=sCustomerID,TriSysApex['Constants']['TriSysHostedCRM']=![],TriSysAPI['Session']['SetDataServicesKey'](null),TriSysWebJobs['Constants']['CandidateMode']=![],TriSysWebJobs['Constants']['AgencyUmbrellaMode']=!![],sForm=TriSysWebJobs['Constants']['AgencyLoginForm'];break;case'recruiter':TriSysAPI['Session']['SetDataServicesKey'](null),sForm=TriSysApex['Constants']['LoginForm'];break;}var sEMailAndPassword=debugObject['Credentials'];if(sEMailAndPassword){var eMailAndPassword=TriSysWeb['Security']['DecryptBase64Credentials'](sEMailAndPassword);if(eMailAndPassword){var bAutoLogin=debugObject['AutoLogin'];TriSysApex['LoginCredentials']['ClearCachedCredentials'](),TriSysApex['Cache']['Clear']();if(bAutoLogin){var credentialPacket={'EMailAddress':eMailAndPassword['EMail'],'Password':eMailAndPassword['Password']};TriSysWeb['Security']['WritePersistedLoginCredentials'](credentialPacket);}}}var intelligentRouting={'Application':sCustomerID,'Form':sForm,'Parameters':sParameters},bHandlingRouting=TriSysApex['WhiteLabelling']['Configure'](intelligentRouting['Application'],intelligentRouting);debugObject['APIKey']&&(TriSysApex['Constants']['DeveloperSiteKey']=debugObject['APIKey'],TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']));if(debugObject['APIUrl'])TriSysAPI['Constants']['SecureURL']=debugObject['APIUrl'];if(!bHandlingRouting)TriSysApex['FormsManager']['OpenForm'](sForm,0x0,![]);debugObject['ExtensionGUID']&&debugObject['TriSysGUID']&&(TriSysApex['OfficeAddIn']['ExtensionGUID']=debugObject['ExtensionGUID'],TriSysApex['OfficeAddIn']['TriSysGUID']=debugObject['TriSysGUID'],TriSysApex['OfficeAddIn']['AutoLogin']=debugObject['AutoLogin']);},'ApplyIntelligentRouting':function(intelligentRouting){if(intelligentRouting){var sURL=window['location']['href'];if(intelligentRouting['Form']&&!intelligentRouting['Opened']){var bHashURL=sURL['indexOf']('#')>0x0;if(bHashURL){TriSysApex['FormsManager']['OpenForm']('Login',null,![]);return;}TriSysApex['FormsManager']['OpenForm'](intelligentRouting['Form'],intelligentRouting['Parameters'],!![]),intelligentRouting['Opened']=TriSysApex['Router']['hasIntelligentRoutingFormBeenOpened'](intelligentRouting['Form']);}else{var bLoggedIn=TriSysApex['LoginCredentials']['areCustomerCredentialsValid']();if(!bLoggedIn&&intelligentRouting['PreLoginForm'])TriSysApex['FormsManager']['OpenForm'](intelligentRouting['PreLoginForm'],intelligentRouting['Parameters'],!![]);}}},'hasIntelligentRoutingFormBeenOpened':function(sFormName){var bLoggedIn=TriSysApex['LoginCredentials']['areCustomerCredentialsValid'](),pageConfig=TriSysApex['FormsManager']['getPageConfig'](sFormName);if(!pageConfig)return![];var bRequiresLogin=TriSysApex['NavigationBar']['MustBeLoggedIn'](pageConfig),bBeenOpened=!bRequiresLogin||bRequiresLogin&&bLoggedIn;return bBeenOpened;},'processWebJobsLoginURL':function(sPrefix,fnCallback){if(window['location']['hash']&&window['location']['hash']['indexOf'](sPrefix)>=0x0){var parts=window['location']['href']['split']('/');for(var i=0x0;i<parts['length'];i++){var sPart=parts[i];if(sPart['indexOf'](sPrefix)==0x0){sPart=sPart['substring'](sPrefix['length']);var eMailAndPassword=TriSysWeb['Security']['DecryptBase64Credentials'](sPart);return eMailAndPassword&&fnCallback(eMailAndPassword['EMail'],eMailAndPassword['Password'],eMailAndPassword['FormName']),!![];}}}},'WhiteLabelRedirectorCheck':function(){var sURL=window['location']['href']['replace']('https://',''),parts=sURL['split']('.trisys.co.uk'),sSubDomain=parts[0x0],sArguments=parts['length']>0x1?parts[0x1]:'',partner=TriSysApex['WhiteLabelling']['Partner'](sSubDomain);if(partner){if(partner['RedirectURL'])return sURL=partner['RedirectURL']+sArguments,window['location']['href']=sURL,!![];}}},'PropertySheet':{'Draw':function(sID,data,fnCompleted){var fnLoadControlHTML=function(){TriSysApex['FormsManager']['loadControlReplacingDiv'](sID,'ctrlPropertySheet.html',function(response,status,xhr){ctrlPropertySheet['Load'](sID,data,fnCompleted);});};TriSysApex['WhiteLabelling']['LoadJavascriptFile']('js/pages/ctrlPropertySheet.js',null,fnLoadControlHTML);}},'OnlinePortal':{'CompanyWebsite':function(){var payloadObject={};payloadObject['URL']='Website/OpenOptions',payloadObject['InboundDataFunction']=function(COpenOptionsResponse){TriSysApex['UI']['HideWait']();if(COpenOptionsResponse){if(COpenOptionsResponse['Success']){if(COpenOptionsResponse['EditableURL'])TriSysSDK['Browser']['OpenURL'](COpenOptionsResponse['EditableURL']);else{if(COpenOptionsResponse['URL'])TriSysSDK['Browser']['OpenURL'](COpenOptionsResponse['URL']);else TriSysApex['UI']['ShowMessage']('No\x20website\x20assigned\x20to\x20your\x20company.');}return;}else TriSysApex['UI']['ShowMessage'](COpenOptionsResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.OnlinePortal.CompanyWebsite:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Website...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);},'CandidatePortal':function(){TriSysApex['OnlinePortal']['PortalRequest'](!![]);},'ClientPortal':function(){TriSysApex['OnlinePortal']['PortalRequest'](![]);},'SiteTemplates':function(){var sURL='https://www.platformix.co.uk/templates';TriSysSDK['Browser']['OpenURL'](sURL);},'PortalRequest':function(bCandidate){var payloadObject={};payloadObject['URL']='Website/PortalLink',payloadObject['OutboundDataPacket']={'Candidate':bCandidate},payloadObject['InboundDataFunction']=function(CPortalLinkResponse){TriSysApex['UI']['HideWait']();if(CPortalLinkResponse){if(CPortalLinkResponse['Success']){if(CPortalLinkResponse['URL'])TriSysSDK['Browser']['OpenURL'](CPortalLinkResponse['URL']);else TriSysApex['UI']['ShowMessage']('No\x20portal\x20assigned\x20to\x20your\x20company.');return;}else TriSysApex['UI']['ShowMessage'](CPortalLinkResponse['ErrorMessage']);}},payloadObject['ErrorHandlerFunction']=function(request,status,error){TriSysApex['UI']['HideWait'](),TriSysApex['UI']['errorAlert']('TriSysApex.OnlinePortal.PortalRequest:\x20'+status+':\x20'+error+'.\x20responseText:\x20'+request['responseText']);},TriSysApex['UI']['ShowWait'](null,'Reading\x20Portals...'),TriSysAPI['Data']['PostToWebAPI'](payloadObject);}},'OfficeAddIn':{'ExtensionGUID':null,'TriSysGUID':null,'AutoLogin':![],'Mode':function(){var bOfficeAddInMode=TriSysApex['OfficeAddIn']['ExtensionGUID']&&TriSysApex['OfficeAddIn']['TriSysGUID'];return bOfficeAddInMode;},'InitialLoginMode':function(){var bOfficeAddInInitialLoginMode=TriSysApex['OfficeAddIn']['Mode']()&&!TriSysApex['OfficeAddIn']['AutoLogin'];return bOfficeAddInInitialLoginMode;},'PostLogin':function(){if(!TriSysApex['OfficeAddIn']['Mode']())return;var fnOnConnection=function(){var data=null,sCompanyName=null,sLoginEMail=null,sUserName=null,userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){sCompanyName=userCredentials['LoggedInUser']['CompanyName'],sLoginEMail=userCredentials['LoggedInUser']['FullName'];var contact=userCredentials['LoggedInUser']['Contact'];if(contact)sCompanyName=contact['CompanyName'],sUserName=contact['FullName'];else{var crmContact=userCredentials['LoggedInUser']['CRMContact'];crmContact&&(sUserName=crmContact['FullName'],sCompanyName=crmContact['CompanyName']);}data={'EMail':sLoginEMail,'UserName':sUserName,'Company':sCompanyName};}var object=TriSysApex['OfficeAddIn']['CreateTriSysToOfficeMessage']('Logged\x20In',data),sOutboundMessage=JSON['stringify'](object);TriSysApex['OfficeAddIn']['_TriSysSignalrOfficeInstance']['Communication']['Send'](TriSysApex['OfficeAddIn']['ExtensionGUID'],sOutboundMessage);},fnPostLoginCallback=fnOnConnection;TriSysApex['OfficeAddIn']['InitialLoginMode']()&&(fnPostLoginCallback=function(){fnOnConnection(),TriSysApex['OfficeAddIn']['SendAutomaticLoginURLToOffice']();});TriSysApex['OfficeAddIn']['Connect'](fnPostLoginCallback);var fnShowWelcome=function(){TriSysApex['FormsManager']['OpenForm']('WelcomeOffice',0x0,!![]);};setTimeout(fnShowWelcome,0x7d0);},'_TriSysSignalrOfficeInstance':null,'Connect':function(fnCallback){var options={'APIKey':TriSysApex['Constants']['DeveloperSiteKey'],'UserIdKey':TriSysApex['OfficeAddIn']['TriSysGUID'],'ConnectedStatus':function(sStatus){if(sStatus['indexOf']('SignalR\x20started')>=0x0){if(fnCallback)fnCallback();}},'ReceivedMessage':function(sSender,sJSONDataPacket){TriSysApex['OfficeAddIn']['ReceivedMessageHandler'](sSender,sJSONDataPacket);},'SentMessage':function(sRecipient,sJSONDataPacket){}};TriSysApex['OfficeAddIn']['_TriSysSignalrOfficeInstance']=new TriSysSignalr(),TriSysApex['OfficeAddIn']['_TriSysSignalrOfficeInstance']['Communication']['Connect'](options);},'ReceivedMessageHandler':function(sSender,sJSONDataPacket){if(sSender==TriSysApex['OfficeAddIn']['ExtensionGUID']){var sError='';try{var object=JSON['parse'](sJSONDataPacket);if(object){var data=object['Data'];switch(object['Type']){case'Lookup\x20Contact':if(data['EMail']){var sSearchText=data['EMail'];TriSysApex['FormsManager']['OpenForm']('Contacts',sSearchText,!![]);}return;}}}catch(e){sError='<br/>'+TriSysApex['Logging']['CatchVariableToText'](e);}TriSysApex['Toasters']['Warning']('Unrecognised\x20Message\x20from\x20'+sSender+':\x20'+sJSONDataPacket+sError);}},'SendAutomaticLoginURLToOffice':function(){var sURL='https://apex.trisys.co.uk/?debug='+'{\x22Mode\x22:\x20\x22Recruiter\x22,\x20\x22ExtensionGUID\x22:\x20\x22{{OfficeGUID}}\x22,\x20\x22TriSysGUID\x22:\x20\x22{{TriSysGUID}}\x22,'+'\x20\x22APIKey\x22:\x20\x22'+TriSysApex['Constants']['DeveloperSiteKey']+'\x22,\x20'+'\x20\x22AutoLogin\x22:\x20true\x20}',data={'URL':sURL},object=TriSysApex['OfficeAddIn']['CreateTriSysToOfficeMessage']('Initial\x20Login',data),sOutboundMessage=JSON['stringify'](object);TriSysApex['OfficeAddIn']['_TriSysSignalrOfficeInstance']['Communication']['Send'](TriSysApex['OfficeAddIn']['ExtensionGUID'],sOutboundMessage);},'CreateTriSysToOfficeMessage':function(sType,data){var msg={'MessageType':sType,'Data':data};return msg;}},'Advertising':{'_CurrentAdvert':null,'Load':function(){var advertising=TriSysApex['Advertising']['Data']['Read']();if(!TriSysApex['Constants']['TriSysHostedCRM']||!advertising||TriSysApex['Device']['isPhone']())return;if(!advertising['Enabled'])return;var advert=TriSysApex['Advertising']['Data']['Displayed']();if(advert){$('#advertising-button')['attr']('title',advert['Tooltip']);var sHTML='<i\x20class=\x22'+advert['Icon']+'\x22></i>\x20&nbsp;\x20'+advert['Text'];$('#advertising-text')['html'](sHTML),TriSysApex['Advertising']['_CurrentAdvert']=advert;}},'Show':function(){TriSysApex['Advertising']['BlinkElement']('advertising-button',![]);var advert=TriSysApex['Advertising']['_CurrentAdvert'];if(advert){if(advert['Page']){var sActionButtonText='View\x20All\x20Products',sActionButtonForm='PlugIns',sActionButtonURL=null,sActionButtonRedirect=null;if(advert['ActionButton']){sActionButtonText=advert['ActionButton']['Text'],sActionButtonForm=null;switch(advert['ActionButton']['Type']){case'Form':sActionButtonForm=advert['ActionButton']['Instruction'];break;case'URL':sActionButtonURL=advert['ActionButton']['Instruction'];break;case'Redirect':sActionButtonRedirect=advert['ActionButton']['Instruction'];break;}}var parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=advert['Title'],parametersObject['Image']=advert['Icon'],parametersObject['CloseTopRightButton']=!![],parametersObject['VerticalScrollbar']=!![];if(advert['Width'])parametersObject['Width']=advert['Width'];parametersObject['ContentURL']=advert['Page'],parametersObject['ButtonLeftVisible']=!![],parametersObject['ButtonLeftText']=sActionButtonText,parametersObject['ButtonLeftFunction']=function(){return setTimeout(function(){if(sActionButtonForm)TriSysApex['FormsManager']['OpenForm'](sActionButtonForm);else{if(sActionButtonURL)TriSysSDK['Browser']['OpenURL'](sActionButtonURL);else{if(sActionButtonRedirect)window['localtion']['href']=sActionButtonRedirect;}}},0xa),!![];},parametersObject['ButtonRightVisible']=!![],parametersObject['ButtonRightText']='Close',TriSysApex['UI']['PopupMessage'](parametersObject);}else{if(advert['HTML'])TriSysApex['UI']['ShowMessage'](advert['HTML']['join'](''),advert['Title']);}}},'ContactUs':function(){setTimeout(function(){TriSysApex['FormsManager']['OpenForm']('ContactUs');},0xa),TriSysApex['UI']['CloseModalPopup']();},'AfterLoginEvent':function(){TriSysApex['Advertising']['Load']();var advert=TriSysApex['Advertising']['_CurrentAdvert'];if(!advert)return;var elemAdvertisingGroup=$('#advertising-group');elemAdvertisingGroup['show'](),TriSysApex['Advertising']['BlinkElement']('advertising-button',!![]);if(!advert['HighlightButtonEnabled'])return;var iSeconds=advert['HighlightButtonTimeoutSeconds']?advert['HighlightButtonTimeoutSeconds']:0x1,bShowTourGuide=!TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('TourGuideOffAfterLogin',![]));if(bShowTourGuide){var iStartAfterMillseconds=0x7d0;setTimeout(function(){var sTourGuideFormName=advert['TourGuideFormName']?advert['TourGuideFormName']:'AfterLoginEventForAdvert';TriSysApex['TourGuide']['StartTourForSpecifiedForm'](sTourGuideFormName),TriSysSDK['Audio']['PlayWoosh']();},iStartAfterMillseconds);var iEndAfterMillseconds=iSeconds*0x3e8+iStartAfterMillseconds;setTimeout(function(){TriSysApex['TourGuide']['StopTourForCurrentForm']();},iEndAfterMillseconds);}},'BlinkElement':function(sID,bShow){var sClass='text-blink',elem=$('#'+sID);bShow?elem['addClass'](sClass):elem['removeClass'](sClass);},'Data':{'Read':function(){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('new-product-features.json');return jsonData;},'Displayed':function(){var advertising=TriSysApex['Advertising']['Data']['Read']();if(advertising){var displayedAdverts=[];advertising['Adverts']['forEach'](function(advert){if(advert['Enabled'])displayedAdverts['push'](advert);});var displayedAdvert=null;if(displayedAdverts['length']>0x0){var iIndex=-0x1;if(displayedAdverts['length']>0x1){var bRandomise=!![];for(var i=0x0;i<displayedAdverts['length'];i++){var advert=displayedAdverts[i];advert['EnabledDates']&&advert['EnabledDates']['forEach'](function(sDate){TriSysApex['Advertising']['Data']['isAdvertToBeDisplayedToday'](sDate)&&(iIndex=i,bRandomise=![]);});}if(bRandomise){}}else{var advert=displayedAdverts[0x0];advert['EnabledDates']&&advert['EnabledDates']['forEach'](function(sDate){if(TriSysApex['Advertising']['Data']['isAdvertToBeDisplayedToday'](sDate))iIndex=0x0;});}if(iIndex>=0x0)displayedAdvert=displayedAdverts[iIndex];}return displayedAdvert;}},'isAdvertToBeDisplayedToday':function(sDate){var dt=new Date(sDate),dToday=new Date();if(dt['getFullYear']()==dToday['getFullYear']()&&dt['getMonth']()==dToday['getMonth']()&&dt['getDate']()==dToday['getDate']())return!![];}}},'Resourcer':{'isResourcerWebSite':function(){var bResourcer=TriSysApex['Constants']['WhiteLabelCustomFolder']=='trisys-resourcer';return bResourcer;},'PostLogin':function(){if(TriSysApex['Resourcer']['isResourcerWebSite']()){var lstDOMHidden=['drop-down-tasks-contractorsworking','drop-down-tasks-starters','drop-down-tasks-finishers','drop-down-tasks-liverequirements','nav-bar-activities-contractorsworking','nav-bar-activities-starters','nav-bar-activities-finishers','nav-bar-activities-liverequirements','new-record-recruitment-divider','new-record-requirement','new-record-placement','new-record-timesheet'];lstDOMHidden['forEach'](function(sID){$('#'+sID)['hide']();});}},'ApplyFormSecurity':function(){if(TriSysApex['Resourcer']['isResourcerWebSite']()){var lstDOMHidden=['contact-form-tab-requirements','contact-form-tab-placements','contact-form-tab-timesheets','company-form-tab-requirements','company-form-tab-placements','company-form-tab-timesheets','taskForm-tab-links','useroptions-form-tab-recruitment-defaults','dashboard-view-menu-Workers','dashboard-view-menu-Profits','dashboard-view-menu-PieCharts','dashboard-view-menu-ConsultantPlacementSummary','dashboard-view-menu-LiveVacancies','dashboard-view-menu-ConsultantSummaryByDateRange','admin-console-tab-users','system-admin-panel-users','admin-console-tab-groups','admin-console-tab-performance-targets','admin-console-tab-field-descriptions'];lstDOMHidden['forEach'](function(sID){$('#'+sID)['hide']();});}}},'SessionManager':{'Start':function(){TriSysApex['SessionManager']['Data']['_TimeoutInMinutes']=parseInt(TriSysApex['Cache']['SystemSettingManager']['GetValue'](TriSysApex['SessionManager']['Data']['SystemSetting'],TriSysApex['SessionManager']['Data']['DefaultTimeoutInMinutes']));if(TriSysApex['SessionManager']['Data']['_TimeoutInMinutes']<=0x0)return;var fnStartTimer=function(){var iIntervalMilliseconds=0xea60;TriSysApex['SessionManager']['Data']['_IntervalId']=setInterval(TriSysApex['SessionManager']['Check'],iIntervalMilliseconds);};setTimeout(fnStartTimer,0x7530),TriSysApex['SessionManager']['EventListeners'](!![]),TriSysApex['SessionManager']['RecordUserActivity']('Starting...');},'Stop':function(){if(!TriSysApex['SessionManager']['Data']['_IntervalId'])return;clearInterval(TriSysApex['SessionManager']['Data']['_IntervalId']),TriSysApex['SessionManager']['Data']['_IntervalId']=null,TriSysApex['SessionManager']['EventListeners'](![]);},'EventListeners':function(bEnable){bEnable?(window['addEventListener']('mousemove',TriSysApex['SessionManager']['EventListener']),window['addEventListener']('scroll',TriSysApex['SessionManager']['EventListener']),window['addEventListener']('keydown',TriSysApex['SessionManager']['EventListener'])):(window['removeEventListener']('mousemove',TriSysApex['SessionManager']['EventListener']),window['removeEventListener']('scroll',TriSysApex['SessionManager']['EventListener']),window['removeEventListener']('keydown',TriSysApex['SessionManager']['EventListener']));},'EventListener':function(){TriSysApex['SessionManager']['RecordUserActivity']('Mouse,\x20scroll\x20or\x20keydown');},'Check':function(){if(!TriSysApex['SessionManager']['Data']['_LastSessionActivity'])return;var dtNow=new Date(),iMinutesDifference=moment(dtNow)['diff'](moment(TriSysApex['SessionManager']['Data']['_LastSessionActivity']),'minutes');iMinutesDifference>=TriSysApex['SessionManager']['Data']['_TimeoutInMinutes']&&TriSysApex['SessionManager']['ExpiredSessionWorkflow'](iMinutesDifference);},'ExpiredSessionWorkflow':function(iMinutesOfInactivity){if(TriSysApex['Forms']['Lock']['Enabled'])return;var sLockStatus='locking',fnKeepSessionOpen=function(){return sLockStatus='no-lock',TriSysApex['SessionManager']['RecordUserActivity'](),!![];},fnLock=function(){sLockStatus=='locking'&&(TriSysApex['Forms']['Lock']['OpenForm'](),sLockStatus='locked');},bPrompt=!![];if(iMinutesOfInactivity>=TriSysApex['SessionManager']['Data']['_TimeoutInMinutes']+0x5)bPrompt=![];if(bPrompt){var sMessage='You\x20have\x20been\x20inactive\x20for\x20'+iMinutesOfInactivity+'\x20minute'+(iMinutesOfInactivity==0x1?'':'s')+'.'+'<br>'+'Your\x20session\x20will\x20be\x20locked,\x20unless\x20you\x20wish\x20to\x20keep\x20it\x20open?';TriSysApex['UI']['questionYesNo'](sMessage,TriSysApex['Copyright']['ShortProductName']+'\x20Session\x20Inactivity\x20Warning','Lock\x20Session',fnLock,'Keep\x20Session\x20Open',fnKeepSessionOpen),setTimeout(fnLock,0x2710);}else fnLock();TriSysSDK['Audio']['PlayAsset']('audio-tag-session-timeout');},'RecordUserActivity':function(sWhat){TriSysApex['SessionManager']['Data']['_LastSessionActivity']=new Date();},'Data':{'SystemSetting':'Session\x20Inactivity\x20Threshold\x20Minutes','DefaultTimeoutInMinutes':0x0,'_TimeoutInMinutes':0x0,'_IntervalId':null,'_LastSessionActivity':null}},'VideoConferencing':{'MeetInRoom':function(sRoomName,sURL,sFullName){TriSysApex['FormsManager']['OpenForm']('VideoChat',0x0),setTimeout(function(){VideoChat['StartMeetingInRoom'](sRoomName,sURL,sFullName);},0x1f4);}},'LoadBalancer':{'IdentifyWebAPI':function(fnCallback,options){var jsonData=TriSysApex['Forms']['Configuration']['JsonFileData']('web-api-load-balancing.json',![]);if(jsonData&&jsonData['Configurations']){var sSiteKey=TriSysAPI['Session']['DeveloperSiteKey']();if(!sSiteKey)sSiteKey=TriSysApex['Constants']['DeveloperSiteKey'];var UP_Status='UP',leastUsedUPconfiguration={'SecureURL':TriSysAPI['Constants']['SecureURL'],'DeveloperSiteKey':sSiteKey,'Status':UP_Status,'UsagePercentage':0x64};jsonData['Configurations']['forEach'](function(configuration){if(configuration['Status']==UP_Status&&configuration['UsagePercentage']<leastUsedUPconfiguration['UsagePercentage']){var bAssignConfiguration=!![];options&&options['email']&&configuration['EMailAddressWhiteList']&&(bAssignConfiguration=configuration['EMailAddressWhiteList']['indexOf'](options['email'])>=0x0);if(configuration['DoNotAssignForThisApexURL']){var sURL=window['location']['href'];if(sURL['indexOf'](configuration['DoNotAssignForThisApexURL'])>=0x0)bAssignConfiguration=![];}if(bAssignConfiguration)leastUsedUPconfiguration=configuration;}}),TriSysAPI['Constants']['SecureURL']=leastUsedUPconfiguration['SecureURL'],leastUsedUPconfiguration['DeveloperSiteKey']&&(TriSysApex['Constants']['DeveloperSiteKey']=leastUsedUPconfiguration['DeveloperSiteKey'],TriSysAPI['Session']['SetDeveloperSiteKey'](TriSysApex['Constants']['DeveloperSiteKey']));}try{fnCallback();}catch(ex){TriSysApex['UI']['errorAlert']('TriSysApex.LoadBalancer.IdentifyWebAPI:\x20'+TriSysApex['Logging']['CatchVariableToText'](ex));}}},'DebugLogging':{'InitialiseApplication':function(sApp){var fnAfterVersionGetIPAddress=function(sVersion){TriSysAPI['Data']['IPAddress'](!![],null,function(sIPAddress){TriSysAPI['DebugLogging']['On']=TriSysApex['DebugLogging']['EnableConditions']();var sURL=window['location']['href'];TriSysAPI['DebugLogging']['Write'](sApp,'Start',sIPAddress,'Starting\x20'+sApp+'\x20version:\x20'+sVersion+'\x20via\x20URL:\x20'+sURL+'...');});};TriSysAPI['Data']['Version'](fnAfterVersionGetIPAddress);},'LoggedIn':function(sApp){var sURL=window['location']['href'],fnCreateMessage=function(sIPAddress,sVersion,sEMail){var sMessage='User:\x20'+sEMail+'\x20logged\x20into\x20'+sApp+'\x20version:\x20'+sVersion+'\x20via\x20URL:\x20'+sURL;return sMessage;};TriSysApex['DebugLogging']['LoggedInUserMessage'](sApp,'Login',fnCreateMessage);},'LoggedInUserMessage':function(sApp,sProcess,fnGetMessage){var fnAfterVersionGetIPAddress=function(sVersion){TriSysAPI['Data']['IPAddress'](!![],null,function(sIPAddress){var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contact=userCredentials['LoggedInUser']['CRMContact'];if(contact){var sEMail=contact['WorkEMail'];if(sEMail){var sMessage=fnGetMessage(sIPAddress,sVersion,sEMail);TriSysAPI['DebugLogging']['Write'](sApp,sProcess,sIPAddress,sMessage);}}}});};TriSysAPI['Data']['Version'](fnAfterVersionGetIPAddress);},'EnableConditions':function(){var sURL=window['location']['href'],bSupportPortal=sURL['indexOf']('https://support.trisys.co.uk/')==0x0,bEnableDebugLogging=!![];return bEnableDebugLogging;},'SendMessageToSignalR':function(sTitle,sMessage){var bInDev=TriSysApex['Pages']['Controller']['isDeveloper'](),bLoggedInAsUser=TriSysApex['LoginCredentials']['areUserCredentialsValid']();if(bInDev&&bLoggedInAsUser){var lRecipientContactId=TriSysApex['LoginCredentials']['UserCredentials']()['LoggedInUser']['ContactId'];TriSysApex['EntityPreview']['Contact']['SendContactPreviewModeSignalRMessage'](lRecipientContactId,sTitle,sMessage);}}},'ConcurrencyHandler':{'ModifiedEntityRecordEvent':function(CModifiedEntityRecord){const sEntityName=CModifiedEntityRecord['EntityName'],lRecordId=CModifiedEntityRecord['RecordId'],lUserId=CModifiedEntityRecord['UserId'];var sMessage='TriSysApex.ConcurrencyHandler.ModifiedEntityRecordEvent:\x20'+'Entity:\x20'+sEntityName+',\x20RecordId:\x20'+lRecordId,userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(lUserId==userCredentials['LoggedInUser']['UserId'])return;var bEntityFormOpen=TriSysApex['FormsManager']['isFormOpen'](sEntityName);if(!bEntityFormOpen)return;var sCurrentFormName=TriSysApex['FormsManager']['SelectedFormName'];if(sCurrentFormName!=sEntityName)return;var sOtherUser=TriSysApex['Pages']['ContactForm']['GetUserNameFromID'](lUserId),bEntityRecordOpen=![];switch(sEntityName){case'Contact':bEntityRecordOpen=TriSysApex['Pages']['ContactForm']['ContactId']==lRecordId;break;case'Company':bEntityRecordOpen=TriSysApex['Pages']['CompanyForm']['CompanyId']==lRecordId;break;case'Requirement':bEntityRecordOpen=TriSysApex['Pages']['RequirementForm']['RequirementId']==lRecordId;break;case'Placement':bEntityRecordOpen=TriSysApex['Pages']['PlacementForm']['PlacementId']==lRecordId;break;case'Timesheet':bEntityRecordOpen=TriSysApex['Pages']['TimesheetForm']['TimesheetId']==lRecordId;break;}if(bEntityRecordOpen){var sAction=CModifiedEntityRecord['Deleted']?'deleted':'updated',sTitle=sEntityName+'\x20'+(CModifiedEntityRecord['Deleted']?'Delete':'Update'),sReloadButtonText=CModifiedEntityRecord['Deleted']?'Close':'Reload',sWhatToDo='It\x20is\x20advisable\x20that\x20you\x20click\x20\x22'+sReloadButtonText+'\x22\x20to\x20'+(CModifiedEntityRecord['Deleted']?'close':'refresh')+'\x20the\x20'+sEntityName['toLowerCase']()+',\x20otherwise\x20click\x20\x22Ignore\x22.',sPrompt=sOtherUser+'\x20has\x20'+sAction+'\x20this\x20'+sEntityName['toLowerCase']()+'\x20record\x20['+lRecordId+'].<br>'+sWhatToDo,fnYes=function(){return setTimeout(function(){if(CModifiedEntityRecord['Deleted'])TriSysApex['FormsManager']['CloseCurrentForm']();else TriSysApex['Forms']['EntityForm']['LoadRecord'](sEntityName,lRecordId),sEntityName=='Company'&&setTimeout(function(){const bForceRefresh=!![];TriSysApex['Pages']['CompanyForm']['LoadAddressesAndContactsGrid']('companyForm-AddressesGrid',null,bForceRefresh);},0x7d0);},0xa),!![];};TriSysApex['UI']['questionYesNo'](sPrompt,sTitle,sReloadButtonText,fnYes,'Ignore');}}},'AI':{'ChatBOT':{'AfterLoginEvent':function(){var bShowAIChatbot=TriSysAPI['Operators']['stringToBoolean'](TriSysApex['Cache']['UserSettingManager']['GetValue']('ShowAIChatbot',![]));if(bShowAIChatbot)TriSysApex['AI']['ChatBOT']['Show'](bShowAIChatbot);},'_scriptID':'trisys-apex-ai-chatbot','Show':function(bShow){if(bShow){const script=document['createElement']('script');var securityParam='ewogIkFQSUtleSI6ICIyMDEzMTIyMi1iYTA5LTRlNGMtOGJjYi1hcGV4LndlYi5hcHAiLAogIlVSTCI6ICJodHRwczovL2FwaS50cmlzeXMuY28udWsvIiwKICJFbmdpbmVLZXkiOiAiOTk0N2JhZTEtODFhYi00NmFjLWFkNGMtYmY1Yzc5NWUxMTM5IiwKICJDbGllbnRJRFByZWZpeCI6ICJUcmlTeXMtQXBleC1IZWxwOiIKfQ==',sJSON=atob(securityParam);const securityObject=JSON['parse'](sJSON);var userCredentials=TriSysApex['LoginCredentials']['UserCredentials']();if(userCredentials&&userCredentials['LoggedInUser']){var contact=userCredentials['LoggedInUser']['CRMContact'];contact&&(securityObject['FullName']=contact['FullName'],securityObject['EMail']=contact['WorkEMail'],securityObject['PhotoURL']=$('#imgLoggedInUserImage')['attr']('src'));}sJSON=JSON['stringify'](securityObject),securityParam=btoa(sJSON),script['src']='https://trisys-business-software.github.io/web-chat/inject.js?security='+securityParam,script['id']=TriSysApex['AI']['ChatBOT']['_scriptID'],document['head']['appendChild'](script),script['onload']=function(){LoadCodeAfterLoadingInjectionScript();};}else{$('.trisys-floating-button-container')['remove'](),$('.trisys-popup-window')['remove'](),$('#'+TriSysApex['AI']['ChatBOT']['_scriptID'])['remove'](),$('script[src*=\x22trisys.js\x22]')['remove'](),$('script[src*=\x22chatbot.js\x22]')['remove']();if(window['CTriSysWebAPI'])delete window['CTriSysWebAPI'];if(window['triSysWebAPI'])delete window['triSysWebAPI'];}}}},'AccountTypes':{'LoginTypes':[{'text':'Subscriber','value':0x0},{'text':'Company\x20On\x20Premise','value':0x1},{'text':'Agency\x20Client\x20Or\x20Candidate','value':0x2},{'text':'Agency\x20Vacancies\x20Only','value':0x3},{'text':'Partner','value':0x4},{'text':'Agency\x20Candidate','value':0x5},{'text':'Agency\x20Client','value':0x6},{'text':'Customer','value':0x7},{'text':'Third-Party\x20Agency\x20Umbrella','value':0x8},{'text':'Read-Only\x20Recruiter\x20User\x20Client','value':0x9},{'text':'Read-Only\x20Recruiter\x20User\x20Candidate','value':0xa},{'text':'Read-Only\x20Recruiter\x20User\x20Agency\x20Umbrella','value':0xb},{'text':'Non-Customer','value':0xc},{'text':'Smart-Client\x20CV\x20Parser','value':0xd}],'LoginTypeDescription':function(iAccountType){for(const item of TriSysApex['AccountTypes']['LoginTypes']){if(item['value']==iAccountType)return item['text'];}},'LoginTypeFromDescription':function(sDescription){for(const item of TriSysApex['AccountTypes']['LoginTypes']){if(item['text']==sDescription)return item['value'];}}},'Constants':{'ApplicationName':'Flexiva','URL':'https://app.flexiva.co.uk','DeveloperSiteKey':'20241002-re90-9e2c-2904-flexiva.app.','iMillisecondsInSecond':0x3e8,'iMinimumPasswordLength':0x6,'Cookie_LoginName':'TriSysFlexiva_LoginForm_EMail','VATPercentage':0x14,'ModalPopupJQueryDiv':'#divTriSysMessageBoxWindow','FormLoadDataDelay':0x5,'NewRecordFormDelay':0x2ee,'UserControlFolder':'usercontrols/','ProfileImageSize':0x28,'ProfileImageSizeLarge':0xc8,'DefaultContactImage':'https://apex.trisys.co.uk/images/profile-grey.png','DefaultContactGreyImage':'images/profile-grey.png','DefaultCompanyImage':'images/company-grey.png','PostItNoteColour':'#fcf0ad','LoadEntityDelay':0x7d0,'SinglePageApplication':!![],'TriSysHostedCRM':!![],'ShowDummyDashboardData':![],'ModalDraggable':!![],'LoginForm':'Login','ForgottenPasswordForm':'ForgottenPassword','RegistrationForm':'Registration','TrialMode':![],'Cookie_Prefix':'Flexiva-','CookieAndUserSetting_Theme':'Flexiva.Theme','CookieAndUserSetting_PageStyle':'Flexiva.PageStyle','ShowWaitTopLeftIcon':'images/t-logo-flat-bw-16x16.png?ts=202405101430','VideoSubtitles':!![],'VideoSubtitlesButton':!![],'NoVideoSubtitlesSuffix':'-NoSubtitles','DashboardHideViewMenu':'Dashboard\x20Hide\x20View\x20Menu','MobileFriendlyDefaultDashboardView':'Wall','CustomerModuleFile':'CustomerModule.js','WebJobsModuleFile':'WebJobsModule.js','ApexRootFolder':'flexiva/','TermsAndConditionsFile':'ctrlTermsAndConditions.html','ShowTermsAndConditionsButtonOnHelpAbout':!![],'WhiteLabelled':![],'AboutImage':null,'WhiteLabelCustomFolder':null,'WhiteLabelPreLoginCustomForms':null,'WhiteLabelIntelligentRouting':null,'WhiteLabelStartupForm':null,'WhiteLabelAccountType':null,'WhiteLabelCustomApp':![],'WhiteLabelPreventThemeChange':![],'WhiteLabelBlockCustomerSpecificFiles':![],'WhiteLabelAllowedSubDomains':['apex','support','crm','crm2','resourcer','generix','video','bullwhippers','search-consultancy','search','tennis','flexiva','trisys-business-software'],'GridRowOpenButtonPositionLeft':![],'OriginalURL':null,'AllowEmptySearchCriteria':!![],'SupportEMail':'support@trisys.co.uk','CustomSearchCriteriaEntityFields':![],'LockFormName':'Lock','ContactPreviewIgnoreActions':['Interested','Offer','OfferAccepted','OfferRejected','Placement','Reject','Withdrawn'],'SessionExpiredMessage':'Your\x20session\x20has\x20expired.\x20You\x20will\x20be\x20logged\x20out\x20of\x20the\x20application\x20now.','ShowFileErrorsAsAToaster':!![],'Undefined':'undefined','ContactPreviewPrefix':'#contact-preview-popup~','AccountType':0x0,'DefaultFont':'Poppins','DefaultTheme':'TriSys','_Data':{}}};