var TriSysCMS={'Copyright':{'AllRightsReserved':'TriSys\x20Business\x20Software','LongProductDescription':'Content\x20Management\x20System\x20for\x20TriSys\x20Web\x20Technologies','ShortProductName':'TriSysCMS','HomePage':'www.trisys.co.uk'},'Security':{'ValidateLogin':function(){var bValidated=TriSysApex['LoginCredentials']['areUserCredentialsValid']();return bValidated=!![],bValidated;}},'PageManager':{'PageName':function(){var sURL=window['location']['href'],sPageName=TriSysApex['URL']['Parser'](sURL)['getPath']();return sPageName;},'LoadContent':function(bPageInvocation){var arrMatches=TriSysCMS['PageManager']['GetTags']('trisys-cms-');if(!arrMatches)return;var pageContentTags=TriSysCMS['Data']['Cache']['Read']();TriSysCMS['PageManager']['WriteContentToTags'](arrMatches,pageContentTags);if(bPageInvocation){var asyncContent=TriSysCMS['Data']['ReadCachedData']();asyncContent&&(TriSysCMS['Data']['Cache']['Write'](asyncContent),TriSysCMS['PageManager']['LoadContent'](![]));}},'WriteContentToTags':function(arrMatches,pageContentTags){if(!arrMatches||!pageContentTags)return;for(var i=0x0;i<arrMatches['length'];i++){var element=arrMatches[i];for(var k=0x0;k<pageContentTags['length'];k++){var pageContentTag=pageContentTags[k];if(pageContentTag['ID']==element['id']){element['innerHTML']=pageContentTag['InnerHTML'];break;}}}},'GetTags':function(sStartTagName){var matchingTags=[],divs=document['getElementsByTagName']('*');for(var i=0x0;i<divs['length'];i++){var divTag=divs[i];if(divTag['nodeType']===0x1){if(divTag['id']['indexOf'](sStartTagName)==0x0)matchingTags['push'](divTag);}}return matchingTags;}},'Data':{'ReadCachedData':function(){return TriSysCMS['Data']['Cache']['Read']();},'WriteCachedData':function(editorObject){var contentTag={'ID':editorObject['ID'],'InnerHTML':editorObject['InnerHTML']},cachedData=TriSysCMS['Data']['Cache']['Read']();if(cachedData)for(var i=0x0;i<cachedData['length'];i++){var cachedElement=cachedData[i];if(cachedElement['ID']==contentTag['ID']){cachedData['splice'](i,0x1);break;}}else cachedData=[];cachedData['push'](contentTag),TriSysCMS['Data']['Cache']['Write'](cachedData);},'Cache':{'Read':function(){var sCookieName=TriSysCMS['Constants']['PageContent']+'.'+TriSysCMS['PageManager']['PageName']();TriSysAPI['Cookies']['CookiePrefix']=TriSysCMS['Constants']['CookieName'];var sStringifiedJSON=TriSysAPI['Cookies']['getCookie'](sCookieName);if(sStringifiedJSON){var pageContentTags=JSON['parse'](sStringifiedJSON);return pageContentTags;}},'Write':function(pageContent){var sCookieName=TriSysCMS['Constants']['PageContent']+'.'+TriSysCMS['PageManager']['PageName'](),sStringifiedJSON=JSON['stringify'](pageContent);TriSysAPI['Cookies']['CookiePrefix']=TriSysCMS['Constants']['CookieName'],TriSysAPI['Cookies']['setCookie'](sCookieName,sStringifiedJSON);}}},'Editor':{'Open':function(this_divTag){if(!this_divTag)return;var sID=this_divTag['id'];if(!sID)return;if(!TriSysCMS['Security']['ValidateLogin']()){TriSysApex['UI']['ShowMessage']('Please\x20login\x20as\x20a\x20user\x20to\x20edit\x20content');return;}var sHTML=this_divTag['innerHTML'],iTop=this_divTag['offsetTop'],iLeft=this_divTag['offsetLeft'],editorObject={'ID':sID,'InnerHTML':sHTML,'Height':0x2bc,'Width':0x384,'EventType':''};TriSysCMS['Editor']['SetEditObject'](editorObject),window['addEventListener']('storage',TriSysCMS['Editor']['EditorEventHandler'],![]),TriSysCMS['Editor']['OpenModalDialogue']('Edit\x20Web\x20Page\x20Content',editorObject['Height'],editorObject['Width']);},'SetEditObject':function(editorObject){TriSysAPI['Cookies']['CookiePrefix']=TriSysCMS['Constants']['CookieName'];var sStringifiedJSON=JSON['stringify'](editorObject);TriSysAPI['Cookies']['setCookie'](TriSysCMS['Constants']['EditObject'],sStringifiedJSON);},'GetEditObject':function(){TriSysAPI['Cookies']['CookiePrefix']=TriSysCMS['Constants']['CookieName'];var sStringifiedJSON=TriSysAPI['Cookies']['getCookie'](TriSysCMS['Constants']['EditObject']);if(!sStringifiedJSON)return;var editorObject=JSON['parse'](sStringifiedJSON);return editorObject;},'OpenModalDialogue':function(sTitle,lHeight,lWidth){var fnCancelSend=function(){TriSysApex['UI']['CloseModalPopup']();},parametersObject=new TriSysApex['UI']['ShowMessageParameters']();parametersObject['Title']=sTitle,parametersObject['Image']='information',parametersObject['Height']=lHeight,parametersObject['Width']=lWidth+0x2,parametersObject['Resizable']=![],parametersObject['ContentURL']='http://www.trisys.co.uk/development/test/cms/editor.aspx',TriSysApex['UI']['PopupMessage'](parametersObject);return;},'SendSaveEventToPageBeingEdited':function(editorObjectContent,sEditedText){editorObjectContent['InnerHTML']=sEditedText,editorObjectContent['EventType']='Edit';var sJSON=JSON['stringify'](editorObjectContent);sessionStorage['setItem']('storage',sJSON);},'CloseEditorEvent':function(editorObjectContent){editorObjectContent['EventType']='Close';var sJSON=JSON['stringify'](editorObjectContent);sessionStorage['setItem']('storage',sJSON);},'EditorEventHandler':function(event){var sJSON=event['newValue'];if(sJSON){var editorObject=JSON['parse'](sJSON);if(editorObject){var sEventType=editorObject['EventType'];switch(sEventType){case'Edit':document['getElementById'](editorObject['ID'])['innerHTML']=editorObject['InnerHTML'],TriSysCMS['Editor']['SetEditObject'](editorObject),TriSysCMS['Data']['WriteCachedData'](editorObject);break;case'Close':TriSysApex['UI']['CloseModalPopup']();break;}}}}},'Constants':{'CookieName':'TriSysCMS.Editor','EditObject':'EditObject','PageContent':'PageContent'}};